var h=Object.defineProperty;var p=(i,t,e)=>t in i?h(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var c=(i,t,e)=>(p(i,typeof t!="symbol"?t+"":t,e),e);import{A as l}from"./utils.3371dfe5.js";import{D as w,a as y,w as m,d as u}from"./runnerData.9e14dd92.js";class g{async list(){return await(await fetch("/_editor/api/dashes")).json()}async create(){return await(await fetch("/_editor/api/dashes",{method:"POST",headers:{"Content-Type":"application/json"}})).json()}async get(t){return await(await fetch(`/_editor/api/dashes/${t}`)).json()}async update(t,e){return await(await fetch(`/_editor/api/dashes/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json()}async delete(t){await fetch(`/_editor/api/dashes/${t}`,{method:"DELETE",headers:{"Content-Type":"application/json"}})}async duplicate(t){return await(await fetch(`/_editor/api/dashes/${t}/duplicate`,{method:"POST",headers:{"Content-Type":"application/json"}})).json()}async addVariableToCode(t,e){await fetch(`/_editor/api/dashes/${t}/add-variable`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({variable:e})})}}const a=new g;class n{constructor(t){c(this,"record");this.record=new l(a,t,"path")}static async list(){return(await a.list()).map(e=>new n(e))}static async create(){const t=await a.create();return new n(t)}static async get(t){const e=await a.get(t);return new n(e)}get path(){return this.record.get("path")}set path(t){this.record.set("path",t)}get file(){return this.record.get("file")}set file(t){this.record.set("file",t)}get title(){return this.record.get("title")}set title(t){this.record.set("title",t)}get theme(){return this.record.get("theme")}set theme(t){this.record.set("theme",t)}get brandName(){return this.record.get("brand_name")}set brandName(t){this.record.set("brand_name",t)}get mainColor(){var t;return(t=this.record.get("main_color"))!=null?t:w}set mainColor(t){this.record.set("main_color",t)}get fontFamily(){var t;return(t=this.record.get("font_family"))!=null?t:y}set fontFamily(t){this.record.set("font_family",t)}get logoUrl(){return this.record.get("logo_url")}set logoUrl(t){this.record.set("logo_url",t)}get layout(){const t=this.record.get("layout");return{version:"0.2",props:t.props,slot:{...Object.entries(t.slot).reduce((e,[o,r])=>({...e,[o]:{id:r.id,type:r.type,colStart:r.position.colStart,colEnd:r.position.colEnd,rowStart:r.position.rowStart,rowEnd:r.position.rowEnd,props:r.props,events:r.events,variable:r.variable}}),{})}}}set layout(t){if(t.version==="0.1")throw new Error("TODO: convert 0.1 to 0.2");const e={version:"0.2",props:t.props,slot:{...Object.entries(t.slot).reduce((o,[r,d])=>{if(!(d.type in m))throw new Error("TODO: implement slot support");const s=d;return{...o,[r]:{events:s.events,id:s.id,props:s.props,position:{rowStart:s.rowStart,rowEnd:s.rowEnd,colStart:s.colStart,colEnd:s.colEnd},type:s.type,variable:s.variable}}},{})}};this.record.set("layout",e)}async save(){await this.record.save()}onUpdate(t){this.record.pubsub.subscribe("update",t)}hasChanges(){return this.record.hasChanges()}async delete(){await a.delete(this.path)}async duplicate(){const t=await a.duplicate(this.path);return new n(t)}async addVariableToCode(t){await a.addVariableToCode(this.path,t)}get rootSlot(){if(this.layout.version==="0.1")throw new Error("TODO: convert 0.1 to 0.2");return this.layout.slot}makeRunnerData(t,e){var o,r;return{id:this.path,path:this.path,title:this.title,theme:this.theme,brandName:(o=this.brandName)!=null?o:null,logoUrl:(r=this.logoUrl)!=null?r:null,mainColor:this.mainColor,fontFamily:this.fontFamily,layout:u(e!=null?e:this.layout),idOrPath:this.path,workspaceName:"Untitled Workspace",sidebar:[],runtimeType:"dash"}}}export{n as D};
//# sourceMappingURL=dashes.da7ff1db.js.map
