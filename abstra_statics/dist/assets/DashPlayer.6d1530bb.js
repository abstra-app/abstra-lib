var B=Object.defineProperty;var z=(s,t,e)=>t in s?B(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var r=(s,t,e)=>(z(s,typeof t!="symbol"?t+"":t,e),e);import{R as V,ao as U,q as P,b as p,c as S,O as q,Q as J,x as C,d as M,K as y,r as R,a as Y,F as K,L as Q,A as I,e as k,z as m,D as L,t as b,am as X,an as Z,a8 as tt,G as H,y as et,w as E,B as G,ap as st,aq as it}from"./registerWidgets.cb3a7b8d.js";import{w as O,l as w,m as at}from"./runnerData.7b7cb682.js";import{e as nt,R as ot}from"./executeJs.87b204c8.js";import{p as rt}from"./passwordlessManager.afd7d1d0.js";import{P as lt}from"./Passwordless.7161b834.js";import{W as ht}from"./WidgetsFrame.aac2edff.js";import{e as ct}from"./icons.39dfa322.js";(function(){try{var s=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},t=new Error().stack;t&&(s._sentryDebugIds=s._sentryDebugIds||{},s._sentryDebugIds[t]="a2df752d-3f8c-4e6a-a691-ef47f4e90f58",s._sentryDebugIdIdentifier="sentry-dbid-a2df752d-3f8c-4e6a-a691-ef47f4e90f58")}catch{}})();function se(s,t){return{dx:t.x-s.x,dy:t.y-s.y,referential:s.referential}}function dt(s,t){return s.rowEnd<t.rowStart||s.colEnd<t.colStart&&s.rowStart<t.rowEnd?-1:1}function ie(s,t){const e=t.margin+s.colStart*(t.gap+t.cellWidth),i=t.margin+t.navbarLength+s.rowStart*(t.gap+t.cellHeight),a=t.margin-t.gap+(t.gap+t.cellWidth)*(s.colEnd+1),n=t.margin+t.navbarLength-t.gap+(t.gap+t.cellHeight)*(s.rowEnd+1);return{x:e,y:i,width:a-e,height:n-i,referential:"world"}}function ut(s,t){return{...s,position:{colStart:s.position.colStart+t.deltaI,colEnd:s.position.colEnd+t.deltaI,rowStart:s.position.rowStart+t.deltaJ,rowEnd:s.position.rowEnd+t.deltaJ}}}function ae(s,t,e=!1){return e?t.x<=s.x&&t.x+t.width>=s.x&&t.y<=s.y&&t.y+t.height>=s.y:t.x<s.x&&t.x+t.width>s.x&&t.y<s.y&&t.y+t.height>s.y}function ne(s,t){return!(s.x>t.x+t.width||t.x>s.x+s.width||s.y>t.y+t.height||t.y>s.y+s.height)}function oe(s,t){return!(s.colStart>t.colEnd||t.colStart>s.colEnd||s.rowStart>t.rowEnd||t.rowStart>s.rowEnd)}function re(s,t,e){const i=s.y===t.y,a=s.x===t.x,n=s.x+s.width===t.x+t.width,o=s.y+s.height===t.y+t.height;switch(e){case"left":return a;case"right":return n;case"top":return i;case"bottom":return o;case"top-left":return i&&a;case"top-right":return i&&n;case"bottom-left":return o&&a;case"bottom-right":return o&&n}}const le=s=>s.reduce((t,e)=>{const i=t?Math.min(t.x,e.x):e.x,a=t?Math.min(t.y,e.y):e.y,n=t?Math.max(t.x+t.width,e.x+e.width):e.x+e.width,o=t?Math.max(t.y+t.height,e.y+e.height):e.y+e.height;return{x:i,y:a,width:n-i,height:o-a,referential:e.referential}},null);function he(s,t){return Math.sqrt((s.x-t.x)**2+(s.y-t.y)**2)}function gt(s){const t=[];let e=0;for(const i in s){const[a,n]=s[i];e+=s.filter(([c,d,f],l)=>!(n.position.colStart>d.position.colEnd||d.position.colStart>n.position.colEnd)&&d.position.rowEnd+f>n.position.rowStart&&l<+i).reduce((c,d)=>c+Math.max(d[2],0),0);const o=ut(n,{deltaJ:e,deltaI:0});t.push([a,o])}return t}function pt(s,t){const e=Object.entries(s).sort((n,o)=>dt(n[1].position,o[1].position)),i=n=>document.querySelector(`[widget-id='${n}']`);return gt(e.map(([n,o])=>[n,o,i(n)?t.height2rows(i(n).offsetHeight)-(o.position.rowEnd-o.position.rowStart):0])).reduce((n,[o,c])=>({...n,[o]:{...c,position:{...c.position,rowEnd:O[c.type].autoHeight&&i(o)?c.position.rowStart+t.height2rows(i(o).offsetHeight):c.position.rowEnd}}}),{})}const wt=(s,t,e)=>t&&!t.condition?{computedElement:{...s,position:{...s.position,row:s.position.row+e,height:0}},updateOffset:0,addOffset:0,slot:{}}:{computedElement:{...s,position:{...s.position,row:s.position.row+e}},updateOffset:s.position.height,addOffset:s.position.row,slot:s.slot},yt={"if-block":wt},mt=(s,t,e)=>ft(T(Object.values(s),{widgets:[],slottables:[]},0,t),e),ft=(s,t)=>({widgets:pt(s.widgets.reduce((e,i)=>({...e,[i.id]:i}),{}),t),slottables:s.slottables.reduce((e,i)=>({...e,[i.id]:i}),{})}),vt=(s,t)=>{if(w(s)&&w(t))return t.position.rowStart-s.position.rowStart;if(w(s)&&!w(t))return t.position.row-s.position.rowStart===0?-1:t.position.row-s.position.rowStart;if(!w(s)&&w(t))return t.position.rowStart-s.position.row===0?1:t.position.rowStart-s.position.row;if(!w(s)&&!w(t)){if(t.position.row-s.position.row===0){if(t.position.order===s.position.order)throw new Error("Two slottables with the same order in the same row");return t.position.order-s.position.order}return t.position.row-s.position.row}return 0},T=(s,t,e,i)=>s.sort(vt).reduce((a,n)=>St(n,e,a,i),t),St=(s,t,e,i)=>w(s)?bt(s,t,e):Ct(s,t,e,i),bt=(s,t,e)=>(e.widgets.push({...s,position:j(s.position,t)}),e),Ct=(s,t,e,i)=>{const{computedElement:a,slot:n,updateOffset:o,addOffset:c}=yt[s.type](s,i[s.id],t),d=kt(e,o);return d.slottables.push(a),T(Object.values(n),d,t+c,i)},kt=(s,t)=>({widgets:Et(s.widgets,t),slottables:xt(s.slottables,t)}),Et=(s,t)=>s.map(e=>({...e,position:j(e.position,t)})),xt=(s,t)=>s.map(e=>({...e,position:{...e.position,row:e.position.row+t}})),j=(s,t)=>({...s,rowStart:s.rowStart+t,rowEnd:s.rowEnd+t}),Pt=960,$=12,Nt=0,Wt=24,Rt=32,It=8;class D{constructor(t,e){r(this,"width");r(this,"columns");r(this,"gap");r(this,"margin");r(this,"padding");r(this,"calculatePositions");r(this,"_cellHeight");r(this,"dashPlayerService");this.dashPlayerService=t,this.width=Pt,this.columns=$,this.gap=Nt,this.margin=Wt,this.padding=It,this._cellHeight=Rt,this.calculatePositions=e}static create(t,e){return new D(t,e)}static get columns(){return $}get cellHeight(){return this._cellHeight}get navbarLength(){return this.dashPlayerService.navbarVisible?48:0}get cellWidth(){const t=this.columns-1;return(this.width-2*this.margin-t*this.gap)/this.columns}get rows(){const{widgets:t,slottables:e}=this.calculatePositions();return Math.max(Object.values(t!=null?t:{}).map(i=>i.position.rowEnd).reduce((i,a)=>Math.max(i,a),0)+4,Object.values(e!=null?e:{}).map(i=>i.position.row+i.position.height).reduce((i,a)=>Math.max(i,a),0)+4,20)}get sidebarWidth(){return this.dashPlayerService.hasSidebar?240:0}getCell(t,e){return{x:this.margin+t*(this.cellWidth+(t>0?this.gap:0)),y:this.margin+this.navbarLength+e*(this._cellHeight+(e>0?this.gap:0)),width:this.cellWidth,height:this._cellHeight,referential:"world"}}getCellFrom(t,e){const i=this.getCell(t.i,t.j);return this.cellAt(i.x+e.dx,i.y+e.dy)}areaFromRect(t){const e=this.cellAt(t.x,t.y),i={dx:t.width-1,dy:t.height-1,referential:"world"},a=this.getCellFrom(e,i);return{colStart:e.i,rowStart:e.j,colEnd:a.i,rowEnd:a.j}}rectFromArea(t){const e=this.getCell(t.colStart,t.rowStart),i=this.getCell(t.colEnd,t.rowEnd);return{x:e.x,y:e.y,width:i.x+i.width-e.x,height:i.y+i.height-e.y,referential:"world"}}get height(){return this.rows*(this._cellHeight+this.gap)-this.gap+2*this.margin}cellAt(t,e){return{i:Math.floor((t-this.margin)/(this.cellWidth+this.gap)),j:Math.floor((e-this.margin-this.navbarLength)/(this._cellHeight+this.gap))}}snap(t,e){const i=e==="bottom-right"||e==="top-right"?1:0,a=e==="bottom-left"||e==="bottom-right"?1:0,n=this.cellWidth+this.gap,o=this._cellHeight+this.gap,c=this.margin+this.cellWidth*i,d=this.margin+this.navbarLength+this.cellHeight*a,f=t.x-c,l=t.y-d;return{x:c+n*Math.round(f/n),y:d+o*Math.round(l/o),referential:"world"}}snapDelta(t){const e=this.cellWidth+this.gap,i=this._cellHeight+this.gap;return{dx:e*Math.round(t.dx/e),dy:i*Math.round(t.dy/i),referential:"world"}}height2rows(t){return Math.ceil((t+this.gap)/(this.cellHeight+this.gap))}}class _{constructor(t,e,i){r(this,"_stateTimestamp",Date.now());r(this,"_state");r(this,"runnerData");r(this,"passwordlessManager");r(this,"websocketClient");r(this,"_autocompleteState");r(this,"layoutGrid");r(this,"stateChangeCallbacks",[]);r(this,"updateUserCallbacks",[]);r(this,"onWidgetsComputedCallbacks",[]);r(this,"onCloseCallbacks",[]);r(this,"onNoCreditsMessageCallbacks",[]);r(this,"onRedirectCallback",null);this._state=V({type:"IDLE"}),this._autocompleteState={suggestionsFor:null,suggestions:[]},this.runnerData=t,this.passwordlessManager=e,this.websocketClient=i,this.layoutGrid=D.create(this,()=>this.calculatePositions()),window.__playerService=()=>this}notifyStateChange(t){this.stateChangeCallbacks.forEach(e=>e(t))}onStateChange(t){this.stateChangeCallbacks.push(t)}setState(t){this._state.value=t,this.notifyStateChange(t)}get state(){return this._state.value}static create(t,e,i){return new _(t,e,i)}updateRunnerData(t){this.runnerData=t}resetState(){this.websocketClient.close(),this.clearSuggestions(),this.start()}get brokerIsClosed(){var t;return(t=this.websocketClient.isClosed)!=null?t:!0}calculatePositions(t,e){const i=t||(this.state.type==="RUNNING"?this.state.props:{}),a=e!=null?e:this.runnerData.layout.slot;return mt(a,i,this.layoutGrid)}updateDashData(t){if(!t)throw new Error("dash is null");if(!t.layout)throw new Error("dash.layout is null");switch(this.state.type){case"RUNNING":{this.runnerData=t;const{widgets:e}=this.calculatePositions();this.setState({...this.state,widgets:e});break}default:throw new Error(`Invalid state ${this.state.type} for updateDashData`)}}start(t={}){this.websocketClient.onClose(e=>{this.closeCallback(e)}),this.websocketClient.on("execution-id",()=>{this.websocketClient.send({type:"client-start",state:{widgets:at(this.runnerData.layout).reduce((e,i)=>({...e,[i]:{value:null}}),{})},params:t}),this.setState({type:"READY"})}),this.websocketClient.on("program-start-failed",e=>{this.setState({...e,type:"ERROR",cause:"PROGRAM_START_FAILED"})}),this.websocketClient.on("widgets-computed",e=>{const{widgets:i,slottables:a}=this.calculatePositions(e.props);if(this.state.type==="READY"){const n={};if(e.variables)for(const o in e.variables){if(!(o in e.variables)){console.warn(`widget ${o} not found in layout`);continue}n[o]=new U(e.props[o]),n[o].setValue(e.variables[o])}this.setState({...e,type:"RUNNING",eventProcessing:!1,alerts:[],widgets:i,responses:n,slottables:a,authenticatedUser:this.passwordlessManager.getUser()})}if(this.passwordlessManager.pubsub.subscribe("authenticated",()=>this.endAuth()),this.state.type==="RUNNING"){const n={...this.state.responses};for(const o in e.variables)if(!n[o]){if(!(o in e.variables)){console.warn(`widget ${o} not found in layout`);continue}n[o]=new U(e.props[o]),n[o].setValue(e.variables[o])}this.setState({...this.state,eventProcessing:!1,widgets:i,props:e.props})}this.widgetsComputedMessage(e)}),this.websocketClient.on("not-enough-credits",()=>{this.noCreditsMessage()}),this.websocketClient.on("redirect",e=>{this.redirect(e)}),this.websocketClient.on("auth:require-info",()=>{this.passwordlessManager.getUser()?this.endAuth():this.startAuth()}),this.websocketClient.on("auth:valid-jwt",()=>{this.setState({type:"READY"})}),this.websocketClient.on("auth:invalid-jwt",()=>{console.warn("invalid jwt"),this.badAuth()}),this.websocketClient.on("autocomplete:suggestions",({suggestionsFor:e,suggestions:i})=>{this._autocompleteState={suggestionsFor:e,suggestions:i}}),this.websocketClient.on("alert",e=>{this.state.type==="RUNNING"&&this.setState({...this.state,alerts:[...this.state.alerts,{message:e.message,severity:e.severity,id:this.state.alerts.length}]})}),this.websocketClient.on("execute-js:request",async e=>{this.websocketClient.send({type:"execute-js:response",value:await nt(e)})}),this.websocketClient.connect()}sendWidgetsChanged(t){this.websocketClient.send({type:"widgets-changed",state:this.apiPageState,dashDefinition:{slot:t}})}sendEvalRequest(t){this.websocketClient.send({type:"eval",expression:t,state:this.apiPageState})}sendVariableCreated(t){this.websocketClient.send({name:t,value:null,type:"variable-created",state:this.apiPageState})}makeWidgetsError(t){return{widgets:Object.keys(this.runnerData.layout.slot).reduce((i,a)=>(i[a]={repr:t},i),{}),props:{},variables:{}}}onUpdateUser(t){this.updateUserCallbacks.push(t)}onWidgetsComputedMessage(t){this.onWidgetsComputedCallbacks.push(t)}widgetsComputedMessage(t){this.onWidgetsComputedCallbacks.forEach(e=>e(t))}onClose(t){this.onCloseCallbacks.push(t)}closeCallback(t){this.onCloseCallbacks.forEach(e=>e(t))}onNoCreditsMessage(t){this.onNoCreditsMessageCallbacks.push(t)}noCreditsMessage(){this.onNoCreditsMessageCallbacks.forEach(t=>t())}onRedirect(t){this.onRedirectCallback=t}redirect(t){!this.onRedirectCallback||this.onRedirectCallback(t)}on(t,e){this.websocketClient.on(t,e)}onMany(t,e){t.forEach(i=>this.on(i,e))}get apiPageState(){switch(this.state.type){case"RUNNING":{const t=this.state.responses,e=Object.keys(this.state.widgets).reduce((i,a)=>{var n,o;return{...i,[a]:{value:(o=(n=t[a])==null?void 0:n.value)!=null?o:null}}},{});return{timestamp:this._stateTimestamp,widgets:e}}default:throw new Error(`Invalid state ${this.state.type} for apiPageState`)}}getUserEmail(){var t,e;switch(this.state.type){case"RUNNING":return(e=(t=this.state.authenticatedUser)==null?void 0:t.claims.email)!=null?e:null;default:return null}}startAuth(){switch(this.state.type){case"RUNNING":if(this.state.authenticatedUser)return;this.setState({type:"AUTHENTICATING",previousState:this.state});break;case"READY":this.setState({type:"AUTHENTICATING",previousState:this.state});break;default:throw new Error(`Invalid state ${this.state.type} for startAuth`)}}endAuth(){this.websocketClient.send({type:"auth:saved-jwt",jwt:this.passwordlessManager.getUser().jwt})}badAuth(){if(this.state.type!=="AUTHENTICATING")throw new Error(`Invalid state ${this.state.type} for badAuth`);this.state.previousState.type==="RUNNING"?this.setState({...this.state.previousState,authenticatedUser:null}):this.state.previousState.type==="READY"&&this.setState({...this.state.previousState})}logout(){this.passwordlessManager.removeUser(),this.resetState()}isAuthenticating(){return this.state.type==="AUTHENTICATING"}get suggestionsFor(){return this._autocompleteState.suggestionsFor}get suggestions(){return this._autocompleteState.suggestions}clearSuggestions(){this._autocompleteState={suggestionsFor:null,suggestions:[]}}getAutocompleteSuggestions(t,e){t!==this.suggestionsFor&&this.clearSuggestions(),this.websocketClient.send({type:"autocomplete:load",suggestionsFor:t,code:e})}get navbarVisible(){const{logoUrl:t,brandName:e}=this.runnerData,i=this.getUserEmail();return!!(this.hasSidebar||t||e||i)}get hasSidebar(){const t=this.runnerData.sidebar;return!t||t.length==0?!1:t.some(e=>e.visible)}getWidgetsListeners(){switch(this.state.type){case"RUNNING":return Object.entries(this.state.widgets).reduce((t,[e,i])=>({...t,[e]:this.listenersFromWidget(e,i.type)}),{});default:return{}}}listenersFromWidget(t,e){return O[e].events.reduce((i,a)=>({...i,[a.key]:n=>{this.sendWidgetInputMessage(t),this.sendWidgetEventMessage(t,a.key,n)}}),{})}sendWidgetInputMessage(t){!this.websocketClient||this.websocketClient.send({type:"widget-input",widgetId:t,state:this.apiPageState})}sendWidgetEventMessage(t,e,i){if(!this.websocketClient||this.state.type!=="RUNNING")return;const a=this.apiPageState;this.websocketClient.send({type:"widget-event",event:{type:e,payload:i},widgetId:t,state:a}),this.setState({...this.state,eventProcessing:!0})}}function Mt(s,t){const e=s[t.type];if(!e){console.warn("no callback for",t.type);return}e.forEach(i=>i(t))}const Dt=s=>({wasClean:s.wasClean,code:s.code,reason:s.reason});class A{constructor(t){r(this,"ws");r(this,"callbacks");r(this,"onCloseCallbacks",[]);r(this,"dash");this.callbacks={},this.ws=null,this.dash=t}static create(t){return new A(t)}get url(){return`${location.protocol==="https:"?"wss:":"ws:"}//${location.host}/_socket?dashPath=${encodeURIComponent(this.dash.path)}`}get isClosed(){return this.ws?this.ws.readyState!==WebSocket.OPEN:!0}on(t,e){this.callbacks[t]||(this.callbacks[t]=[]),this.callbacks[t].push(e)}clearWSEvents(){!this.ws||(this.ws.onclose=()=>{},this.ws.onerror=()=>{},this.ws.onmessage=()=>{})}async connect(t=1){t>3||await new Promise(e=>{this.clearWSEvents(),this.ws=new WebSocket(this.url),this.ws.onopen=()=>{e()},this.ws.onclose=i=>{this.onCloseCallbacks.forEach(a=>a(Dt(i)))},this.ws.onmessage=i=>{const a=JSON.parse(i.data);Mt(this.callbacks,a)}}).catch(e=>{console.error(e),this.connect(t+1)})}onClose(t){this.onCloseCallbacks.push(t)}close(){if(!this.ws){console.warn("no websocket to close");return}this.clearWSEvents(),this.ws.close()}async send(t){if(!this.ws){console.warn("no websocket to send");return}this.isClosed&&await this.connect(),this.ws.send(JSON.stringify(t))}}function ce(s){const t=A.create(s);return _.create(s,rt,t)}const _t={},At=s=>(q("data-v-5d7ea65b"),s=s(),J(),s),Ut={class:"dash-loading"},Gt=At(()=>C("div",{class:"dash-loading-container"},[C("div",{class:"loading-bar-background"}),C("div",{class:"loading-bar"})],-1)),$t=[Gt];function Lt(s,t){return p(),S("div",Ut,$t)}const Ht=P(_t,[["render",Lt],["__scopeId","data-v-5d7ea65b"]]);function x(){return window.matchMedia("(min-width: 1200px)").matches}const Ot={key:0,class:"error-widget"},Tt={key:0},jt={key:2,class:"loading"},Ft=M({__name:"WidgetsGrid",props:{camera:null,isPreview:{type:Boolean},widgetsWithErrors:null,grid:null,widgetsListeners:null,widgetsProps:null,widgetsResponses:null,widgets:null,forceResponsivity:null},setup(s){const t=s,e=y(()=>({...i.value,padding:`${t.grid.margin}px`,gap:`${t.grid.gap}px`,maxWidth:`${t.grid.width}px`,height:`${t.grid.height}px`,gridTemplateColumns:`repeat(${t.grid.columns}, ${t.grid.cellWidth}px)`,gridTemplateRows:`repeat(auto-fill, ${t.grid.cellHeight}px)`})),i=y(()=>{const l=x()?t.grid.sidebarWidth+(a.value-t.grid.sidebarWidth-960)/2:(a.value-960)/2;return{"--dash-right-margin":`${x()?(a.value-t.grid.sidebarWidth-960)/2:(a.value-960)/2}px`,"--dash-left-margin":`${l}px`}}),a=R(window.innerWidth);window.addEventListener("resize",()=>{a.value=window.innerWidth});const n=l=>{const u=l.target;u.scrollHeight>u.clientHeight&&l.stopPropagation()};function o(l){return{gridColumnStart:`${l.position.colStart+1}`,gridColumnEnd:`${l.position.colEnd+2}`,gridRowStart:`${l.position.rowStart+1}`,gridRowEnd:`${l.position.rowEnd+2}`,padding:`${t.grid.padding}px`}}const c=l=>{const u=l.position.rowEnd-l.position.rowStart+1;return u*t.grid.cellHeight+(u-1)*t.grid.gap-2*t.grid.padding},d=l=>{const u=l.position.colEnd-l.position.colStart+1;return u*t.grid.cellWidth+(u-1)*t.grid.gap-2*t.grid.padding},f=l=>{var u;return l in((u=t.widgetsProps)!=null?u:{})};return(l,u)=>{const N=Y("icon");return p(),S("div",{class:H(["dash",s.forceResponsivity]),style:I(m(e))},[(p(!0),S(K,null,Q(s.widgets,(h,g)=>{var v,W;return p(),S("div",{key:g,class:"widget",style:I(o(h)),onWheel:n},[((v=s.widgetsWithErrors)==null?void 0:v.find(F=>F==g))&&s.isPreview?(p(),S("div",Ot,[k(N,{width:"20",height:"20",path:m(ct),fill:"#D35249"},null,8,["path"]),d(h)>=160&&c(h)>=120?(p(),S("p",Tt," Ops! There is an error in this widget's properties ")):L("",!0)])):f(g)?(p(),b(tt(h.type),X({key:1,data:s.widgetsProps[g],response:s.widgetsResponses[g],runtime:"dash","container-width":d(h),"container-height":c(h),zoom:(W=s.camera)==null?void 0:W.zoom,"widget-id":g},Z(s.widgetsListeners[g])),null,16,["data","response","container-width","container-height","zoom","widget-id"])):(p(),S("div",jt))],36)}),128))],6)}}});const Bt=P(Ft,[["__scopeId","data-v-4d2eaf45"]]),zt=M({__name:"LayoutPresenter",props:{widgets:null,props:null,responses:null,widgetsListeners:null,camera:null,forceResponsivity:null,grid:null,widgetsWithErrors:null,runnerData:null,isPreview:{type:Boolean}},setup(s){const t=et();return(e,i)=>(p(),b(ht,{class:"dash-player","main-color":s.runnerData.mainColor,"font-family":s.runnerData.fontFamily,theme:s.runnerData.theme,runtime:"dash"},{default:E(()=>[G(e.$slots,"header",{},void 0,!0),m(t).overrideMain?G(e.$slots,"overrideMain",{key:1},void 0,!0):(p(),b(Bt,{key:0,camera:s.camera,"is-preview":s.isPreview,"widgets-with-errors":s.widgetsWithErrors,grid:s.grid,"widgets-listeners":s.widgetsListeners,"widgets-props":s.props,"widgets-responses":s.responses,widgets:s.widgets,"force-responsivity":s.forceResponsivity},null,8,["camera","is-preview","widgets-with-errors","grid","widgets-listeners","widgets-props","widgets-responses","widgets","force-responsivity"]))]),_:3},8,["main-color","font-family","theme"]))}});const Vt=P(zt,[["__scopeId","data-v-4c9ad021"]]),qt=M({__name:"DashPlayer",props:{isPreview:{type:Boolean},dashPlayerService:null,forceResponsivity:null,camera:null,widgetsWithErrors:null,editingMode:{type:Boolean},params:null},emits:["navigate","logout"],setup(s,{emit:t}){const e=s,i=R(null),a=R(window.innerWidth);window.addEventListener("resize",()=>{a.value=window.innerWidth});const n=h=>t("navigate",h),o=y(()=>{var h;return(h=e.dashPlayerService.getUserEmail())!=null?h:void 0}),c=y(()=>e.dashPlayerService.state.type==="RUNNING"?e.dashPlayerService.state.widgets:Object.entries(e.dashPlayerService.runnerData.layout.slot).reduce((h,[g,v])=>Object.assign(h,{[g]:v}),{})),d=y(()=>e.dashPlayerService.state.type==="RUNNING"?e.dashPlayerService.state.responses:{}),f=y(()=>e.dashPlayerService.state.type==="RUNNING"?e.dashPlayerService.state.alerts:[]),l=y(()=>e.dashPlayerService.state.type==="RUNNING"?e.dashPlayerService.state.props:{}),u=y(()=>{const h=x()?e.dashPlayerService.layoutGrid.sidebarWidth+(a.value-e.dashPlayerService.layoutGrid.sidebarWidth-960)/2:(a.value-960)/2;return{"--dash-right-margin":`${x()?(a.value-e.dashPlayerService.layoutGrid.sidebarWidth-960)/2:(a.value-960)/2}px`,"--dash-left-margin":`${h}px`}}),N=y(()=>({...u.value,padding:`${e.dashPlayerService.layoutGrid.margin}px`,width:`${e.dashPlayerService.layoutGrid.width}px`,gap:`${e.dashPlayerService.layoutGrid.gap}px`,height:"100%",boxSizing:"border-box"}));return e.dashPlayerService.start(e.params),e.dashPlayerService.onNoCreditsMessage(()=>{var h;(h=i.value)==null||h.open()}),(h,g)=>{var v;return p(),b(Vt,{widgets:m(c),props:m(l),responses:m(d),"widgets-listeners":s.dashPlayerService.getWidgetsListeners(),camera:s.camera,"force-responsivity":s.forceResponsivity,grid:s.dashPlayerService.layoutGrid,"widgets-with-errors":(v=s.widgetsWithErrors)!=null?v:[],"runner-data":s.dashPlayerService.runnerData,"is-preview":s.isPreview},st({header:E(()=>[k(ot,{ref_key:"runtimeCommonsRef",ref:i,type:"dashes",runtime:s.dashPlayerService.runnerData,"full-width":!0,"is-preview":s.isPreview,"user-email":m(o),"force-responsivity":s.forceResponsivity,alerts:m(f),onNavigate:n,onLogout:g[0]||(g[0]=W=>s.dashPlayerService.logout())},null,8,["runtime","is-preview","user-email","force-responsivity","alerts"]),k(it,null,{default:E(()=>[s.dashPlayerService.state.type==="RUNNING"&&s.dashPlayerService.state.eventProcessing?(p(),b(Ht,{key:0})):L("",!0)]),_:1})]),_:2},[s.dashPlayerService.isAuthenticating()?{name:"overrideMain",fn:E(()=>[C("div",{class:H(["auth-form",s.forceResponsivity]),style:I(m(N))},[k(lt,{class:"form-auth"})],6)]),key:"0"}:void 0]),1032,["widgets","props","responses","widgets-listeners","camera","force-responsivity","grid","widgets-with-errors","runner-data","is-preview"])}}});const de=P(qt,[["__scopeId","data-v-541764d8"]]);export{de as D,re as a,oe as b,ne as c,se as d,ae as i,ce as m,he as p,le as r,dt as v,ie as w};
//# sourceMappingURL=DashPlayer.6d1530bb.js.map
