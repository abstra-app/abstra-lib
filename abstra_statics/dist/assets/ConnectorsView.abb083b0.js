var de=Object.defineProperty;var pe=(y,e,a)=>e in y?de(y,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):y[e]=a;var Z=(y,e,a)=>(pe(y,typeof e!="symbol"?e+"":e,a),a);import{_ as ge}from"./DocsButton.vue_vue_type_script_setup_true_lang.60a32eb8.js";import{_ as Q}from"./AbstraButton.vue_vue_type_script_setup_true_lang.7e1cadb5.js";import{d as P,at as z,c as U,o as i,ac as _,ae as ie,h as I,ed as se,e as $,r as R,M as G,w as ae,a as C,b as l,ej as B,u as t,cE as he,bQ as O,cW as ve,aY as N,cU as ye,g as w,t as b,cA as fe,bT as me,aI as _e,cJ as Ce,dg as ke,f as r,i as m,df as F,cD as we,dj as A,de as q,c$ as be,d9 as He,eh as Ve,_ as ce,ei as Ae,Z as oe,cM as J,A as W,bW as $e,bE as Ie,bD as le,es as Te,et as Se}from"./jwt-decode.esm.aec58354.js";import{G as Ue}from"./PhDotsThreeVertical.vue.3a69ca0f.js";import{k as L,o as je}from"./router.7deddc24.js";import{U as Ne}from"./UploadOutlined.5b3c4dca.js";import{_ as Me}from"./AbstraLogo.vue_vue_type_script_setup_true_lang.32ff0162.js";import{L as Ke}from"./Logo.64a128c9.js";import{G as Ze}from"./PhWebhooksLogo.vue.e2f64f1d.js";import{A as re}from"./index.9095a5a8.js";import{C as ue}from"./Card.d76384f2.js";import{A as Ee}from"./index.8997472c.js";import"./constants.e94f5190.js";import"./index.6e906fa2.js";(function(){try{var y=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},e=new Error().stack;e&&(y._sentryDebugIds=y._sentryDebugIds||{},y._sentryDebugIds[e]="ec8eb93a-1ce0-47f6-abd3-f9a522ff6f5e",y._sentryDebugIdIdentifier="sentry-dbid-ec8eb93a-1ce0-47f6-abd3-f9a522ff6f5e")}catch{}})();const Le=["width","height","fill","transform"],Fe={key:0},ze=$("path",{d:"M216.49,184.49l-32,32a12,12,0,0,1-17-17L179,188H48a12,12,0,0,1,0-24H179l-11.52-11.51a12,12,0,0,1,17-17l32,32A12,12,0,0,1,216.49,184.49Zm-145-64a12,12,0,0,0,17-17L77,92H208a12,12,0,0,0,0-24H77L88.49,56.49a12,12,0,0,0-17-17l-32,32a12,12,0,0,0,0,17Z"},null,-1),xe=[ze],Re={key:1},Pe=$("path",{d:"M208,80v96H48V80Z",opacity:"0.2"},null,-1),Be=$("path",{d:"M213.66,181.66l-32,32a8,8,0,0,1-11.32-11.32L188.69,184H48a8,8,0,0,1,0-16H188.69l-18.35-18.34a8,8,0,0,1,11.32-11.32l32,32A8,8,0,0,1,213.66,181.66Zm-139.32-64a8,8,0,0,0,11.32-11.32L67.31,88H208a8,8,0,0,0,0-16H67.31L85.66,53.66A8,8,0,0,0,74.34,42.34l-32,32a8,8,0,0,0,0,11.32Z"},null,-1),De=[Pe,Be],qe={key:2},Ge=$("path",{d:"M42.34,85.66a8,8,0,0,1,0-11.32l32-32A8,8,0,0,1,88,48V72H208a8,8,0,0,1,0,16H88v24a8,8,0,0,1-13.66,5.66Zm171.32,84.68-32-32A8,8,0,0,0,168,144v24H48a8,8,0,0,0,0,16H168v24a8,8,0,0,0,13.66,5.66l32-32A8,8,0,0,0,213.66,170.34Z"},null,-1),Oe=[Ge],Je={key:3},We=$("path",{d:"M212.24,171.76a6,6,0,0,1,0,8.48l-32,32a6,6,0,0,1-8.48-8.48L193.51,182H48a6,6,0,0,1,0-12H193.51l-21.75-21.76a6,6,0,0,1,8.48-8.48ZM75.76,116.24a6,6,0,0,0,8.48-8.48L62.49,86H208a6,6,0,0,0,0-12H62.49L84.24,52.24a6,6,0,0,0-8.48-8.48l-32,32a6,6,0,0,0,0,8.48Z"},null,-1),Ye=[We],Qe={key:4},Xe=$("path",{d:"M213.66,181.66l-32,32a8,8,0,0,1-11.32-11.32L188.69,184H48a8,8,0,0,1,0-16H188.69l-18.35-18.34a8,8,0,0,1,11.32-11.32l32,32A8,8,0,0,1,213.66,181.66Zm-139.32-64a8,8,0,0,0,11.32-11.32L67.31,88H208a8,8,0,0,0,0-16H67.31L85.66,53.66A8,8,0,0,0,74.34,42.34l-32,32a8,8,0,0,0,0,11.32Z"},null,-1),en=[Xe],nn={key:5},tn=$("path",{d:"M210.83,173.17a4,4,0,0,1,0,5.66l-32,32a4,4,0,0,1-5.66-5.66L198.34,180H48a4,4,0,0,1,0-8H198.34l-25.17-25.17a4,4,0,0,1,5.66-5.66ZM77.17,114.83a4,4,0,0,0,5.66-5.66L57.66,84H208a4,4,0,0,0,0-8H57.66L82.83,50.83a4,4,0,0,0-5.66-5.66l-32,32a4,4,0,0,0,0,5.66Z"},null,-1),an=[tn],on={name:"PhArrowsLeftRight"},ln=P({...on,props:{weight:{type:String},size:{type:[String,Number]},color:{type:String},mirrored:{type:Boolean}},setup(y){const e=y,a=z("weight","regular"),n=z("size","1em"),s=z("color","currentColor"),p=z("mirrored",!1),c=U(()=>{var v;return(v=e.weight)!=null?v:a}),k=U(()=>{var v;return(v=e.size)!=null?v:n}),T=U(()=>{var v;return(v=e.color)!=null?v:s}),j=U(()=>e.mirrored!==void 0?e.mirrored?"scale(-1, 1)":void 0:p?"scale(-1, 1)":void 0);return(v,d)=>(i(),_("svg",se({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256",width:k.value,height:k.value,fill:T.value,transform:j.value},v.$attrs),[ie(v.$slots,"default"),c.value==="bold"?(i(),_("g",Fe,xe)):c.value==="duotone"?(i(),_("g",Re,De)):c.value==="fill"?(i(),_("g",qe,Oe)):c.value==="light"?(i(),_("g",Je,Ye)):c.value==="regular"?(i(),_("g",Qe,en)):c.value==="thin"?(i(),_("g",nn,an)):I("",!0)],16,Le))}}),sn=["width","height","fill","transform"],cn={key:0},rn=$("path",{d:"M224,64H180V56a28,28,0,0,0-28-28H104A28,28,0,0,0,76,56v8H32A20,20,0,0,0,12,84V192a20,20,0,0,0,20,20H224a20,20,0,0,0,20-20V84A20,20,0,0,0,224,64ZM100,56a4,4,0,0,1,4-4h48a4,4,0,0,1,4,4v8H100ZM220,88v32H196v-4a12,12,0,0,0-24,0v4H84v-4a12,12,0,0,0-24,0v4H36V88ZM36,188V144H60v4a12,12,0,0,0,24,0v-4h88v4a12,12,0,0,0,24,0v-4h24v44Z"},null,-1),un=[rn],dn={key:1},pn=$("path",{d:"M232,120v72a8,8,0,0,1-8,8H32a8,8,0,0,1-8-8V120Z",opacity:"0.2"},null,-1),gn=$("path",{d:"M224,64H176V56a24,24,0,0,0-24-24H104A24,24,0,0,0,80,56v8H32A16,16,0,0,0,16,80V192a16,16,0,0,0,16,16H224a16,16,0,0,0,16-16V80A16,16,0,0,0,224,64ZM96,56a8,8,0,0,1,8-8h48a8,8,0,0,1,8,8v8H96ZM32,80H224v32H192v-8a8,8,0,0,0-16,0v8H80v-8a8,8,0,0,0-16,0v8H32ZM224,192H32V128H64v8a8,8,0,0,0,16,0v-8h96v8a8,8,0,0,0,16,0v-8h32v64Z"},null,-1),hn=[pn,gn],vn={key:2},yn=$("path",{d:"M224,64H176V56a24,24,0,0,0-24-24H104A24,24,0,0,0,80,56v8H32A16,16,0,0,0,16,80v28a4,4,0,0,0,4,4H64V96.27A8.17,8.17,0,0,1,71.47,88,8,8,0,0,1,80,96v16h96V96.27A8.17,8.17,0,0,1,183.47,88,8,8,0,0,1,192,96v16h44a4,4,0,0,0,4-4V80A16,16,0,0,0,224,64Zm-64,0H96V56a8,8,0,0,1,8-8h48a8,8,0,0,1,8,8Zm80,68v60a16,16,0,0,1-16,16H32a16,16,0,0,1-16-16V132a4,4,0,0,1,4-4H64v16a8,8,0,0,0,8.53,8A8.17,8.17,0,0,0,80,143.73V128h96v16a8,8,0,0,0,8.53,8,8.17,8.17,0,0,0,7.47-8.25V128h44A4,4,0,0,1,240,132Z"},null,-1),fn=[yn],mn={key:3},_n=$("path",{d:"M224,66H174V56a22,22,0,0,0-22-22H104A22,22,0,0,0,82,56V66H32A14,14,0,0,0,18,80V192a14,14,0,0,0,14,14H224a14,14,0,0,0,14-14V80A14,14,0,0,0,224,66ZM94,56a10,10,0,0,1,10-10h48a10,10,0,0,1,10,10V66H94ZM32,78H224a2,2,0,0,1,2,2v34H190V104a6,6,0,0,0-12,0v10H78V104a6,6,0,0,0-12,0v10H30V80A2,2,0,0,1,32,78ZM224,194H32a2,2,0,0,1-2-2V126H66v10a6,6,0,0,0,12,0V126H178v10a6,6,0,0,0,12,0V126h36v66A2,2,0,0,1,224,194Z"},null,-1),Cn=[_n],kn={key:4},wn=$("path",{d:"M224,64H176V56a24,24,0,0,0-24-24H104A24,24,0,0,0,80,56v8H32A16,16,0,0,0,16,80V192a16,16,0,0,0,16,16H224a16,16,0,0,0,16-16V80A16,16,0,0,0,224,64ZM96,56a8,8,0,0,1,8-8h48a8,8,0,0,1,8,8v8H96ZM224,80v32H192v-8a8,8,0,0,0-16,0v8H80v-8a8,8,0,0,0-16,0v8H32V80Zm0,112H32V128H64v8a8,8,0,0,0,16,0v-8h96v8a8,8,0,0,0,16,0v-8h32v64Z"},null,-1),bn=[wn],Hn={key:5},Vn=$("path",{d:"M224,68H172V56a20,20,0,0,0-20-20H104A20,20,0,0,0,84,56V68H32A12,12,0,0,0,20,80V192a12,12,0,0,0,12,12H224a12,12,0,0,0,12-12V80A12,12,0,0,0,224,68ZM92,56a12,12,0,0,1,12-12h48a12,12,0,0,1,12,12V68H92ZM32,76H224a4,4,0,0,1,4,4v36H188V104a4,4,0,0,0-8,0v12H76V104a4,4,0,0,0-8,0v12H28V80A4,4,0,0,1,32,76ZM224,196H32a4,4,0,0,1-4-4V124H68v12a4,4,0,0,0,8,0V124H180v12a4,4,0,0,0,8,0V124h40v68A4,4,0,0,1,224,196Z"},null,-1),An=[Vn],$n={name:"PhToolbox"},In=P({...$n,props:{weight:{type:String},size:{type:[String,Number]},color:{type:String},mirrored:{type:Boolean}},setup(y){const e=y,a=z("weight","regular"),n=z("size","1em"),s=z("color","currentColor"),p=z("mirrored",!1),c=U(()=>{var v;return(v=e.weight)!=null?v:a}),k=U(()=>{var v;return(v=e.size)!=null?v:n}),T=U(()=>{var v;return(v=e.color)!=null?v:s}),j=U(()=>e.mirrored!==void 0?e.mirrored?"scale(-1, 1)":void 0:p?"scale(-1, 1)":void 0);return(v,d)=>(i(),_("svg",se({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256",width:k.value,height:k.value,fill:T.value,transform:j.value},v.$attrs),[ie(v.$slots,"default"),c.value==="bold"?(i(),_("g",cn,un)):c.value==="duotone"?(i(),_("g",dn,hn)):c.value==="fill"?(i(),_("g",vn,fn)):c.value==="light"?(i(),_("g",mn,Cn)):c.value==="regular"?(i(),_("g",kn,bn)):c.value==="thin"?(i(),_("g",Hn,An)):I("",!0)],16,sn))}});class Tn{async generateEcdsaKey(e){const{projectId:a,connectionName:n,connectorType:s}=e;return L.post(`projects/${a}/connectors/${s}/connections/${n}/ecdsa-key`,{})}async createEcdsaConnection(e){const{projectId:a,connectionName:n,connectorType:s,publicKey:p,privateKey:c,accessId:k}=e;return L.post(`projects/${a}/connectors/${s}/connections/${n}/create-ecdsa`,{publicKey:p,privateKey:c,accessId:k})}async generateRsaKey(e){const{projectId:a,connectionName:n,connectorType:s}=e;return L.post(`projects/${a}/connectors/${s}/connections/${n}/rsa-key`,{})}async createRsaConnection(e){const{projectId:a,connectionName:n,connectorType:s,publicKey:p,privateKey:c,apiToken:k}=e;return L.post(`projects/${a}/connectors/${s}/connections/${n}/create-rsa`,{publicKey:p,privateKey:c,apiToken:k})}async getLoginUrl(e,a,n,s,p){return L.get(`projects/${e}/connectors/${n}/connections/${a}/login-url`,{scopeIds:s.join(","),...p})}async listConnectors(e){return L.get(`projects/${e}/connectors`)}async createTokenConnection(e){const{projectId:a,connectionName:n,connectorType:s,tokens:p}=e,c={type:"tokens",tokens:p};return L.post(`projects/${a}/connectors/${s}/connections/${n}`,c)}async listConnections(e){return L.get(`projects/${e}/connections`)}async deleteConnection(e){const{projectId:a,connectionName:n,connectorType:s}=e;return L.delete(`projects/${a}/connectors/${s}/connections/${n}`)}async renameConnection(e){const{projectId:a,connectionName:n,connectorType:s,newConnectionName:p}=e;return L.patch(`projects/${a}/connectors/${s}/connections/${n}`,{newConnectionName:p})}}class Sn{constructor(e,a){Z(this,"state");Z(this,"hasChanges",U(()=>!!this.state.value.editingConnection&&this.state.value.editingConnection.name!==this.state.value.editingConnection.newName));Z(this,"handleDeletionClick",async e=>{G.confirm({title:"Delete connection",content:"Are you sure you want to delete this connection?",onOk:()=>this.handleDeleteConnection(e)})});Z(this,"handleDeleteConnection",async e=>{await this.api.deleteConnection({projectId:this.projectId,connectionName:e.name,connectorType:e.connectorType}),this.state.value.editingConnection=null,await this.refetchConnections()});Z(this,"handleAddConnectionSubmit",async()=>{var p,c,k,T;const e=(p=this.state.value.addingConnection)==null?void 0:p.connector.metadata.key,a=(c=this.state.value.addingConnection)==null?void 0:c.selectedScopeIds,n=(T=(k=this.state.value.addingConnection)==null?void 0:k.tokenValues)!=null?T:{};if(!e||!a)throw new Error("No connector or scope selected");const{url:s}=await this.getLoginUrl(e,this.getUniqueName(e),a,n);window.location.href=s});Z(this,"handleAddTokenConnectionSubmit",async()=>{const e=this.state.value.addingConnection;if(!e)throw new Error("No connection is being added");const a=e.connector.metadata.key,n=this.getUniqueName(a);await this.api.createTokenConnection({projectId:this.projectId,connectionName:n,connectorType:a,tokens:e.tokenValues}),this.state.value.addingConnection=null,await this.refetchConnections()});Z(this,"handleAddEcdsaConnectionSubmit",async(e,a)=>{const n=this.state.value.addingConnection;if(!n||!e)throw new Error("No connection is being added or public key is missing");if(!n.connectionName||!n.ecdsaKeys)throw new Error("Keys or connection name not found");const s=n.connector.metadata.key;if(s==="iugu"){if(!a)throw new Error("API Token is missing");await this.api.createRsaConnection({projectId:this.projectId,connectionName:n.connectionName,connectorType:s,publicKey:n.ecdsaKeys.publicKey,privateKey:n.ecdsaKeys.privateKey,apiToken:a})}else{if(!a)throw new Error("Project ID is missing");await this.api.createEcdsaConnection({projectId:this.projectId,connectionName:n.connectionName,connectorType:s,publicKey:n.ecdsaKeys.publicKey,privateKey:n.ecdsaKeys.privateKey,accessId:a})}this.state.value.addingConnection=null,await this.refetchConnections()});Z(this,"renameConnection",async()=>{const{editingConnection:e}=this.state.value;if(!e)throw new Error("No connection is being edited");const a=async()=>{await this.api.renameConnection({projectId:this.projectId,connectionName:e.name,connectorType:e.connectorType,newConnectionName:e.newName}),await this.refetchConnections(),this.state.value.editingConnection=null};G.confirm({title:"Rename connection",content:"Are you sure you want to rename this connection? This will break any existing references to the old name.",onOk:a})});Z(this,"showAddConfirmationModal",e=>{this.state.value.addingConnection={selectedScopeIds:e.auth.type==="oauth2"?e.auth.scopes.map(a=>a.key):[],connector:e,tokenValues:{}}});Z(this,"handleScopeToggle",(e,a)=>{a?this.state.value.addingConnection.selectedScopeIds.push(e):this.state.value.addingConnection.selectedScopeIds=this.state.value.addingConnection.selectedScopeIds.filter(n=>n!==e)});this.projectId=e,this.api=a,this.state=R({connectors:[],connections:[],addingConnection:null,editingConnection:null})}async fetchConnectors(){this.state.value.connectors=await this.api.listConnectors(this.projectId)}async fetchInitialState(){await this.fetchConnectors(),await this.refetchConnections()}async refetchConnections(){const e=await this.api.listConnections(this.projectId);this.state.value.connections=e.map(a=>{const n=this.state.value.connectors.find(s=>s.metadata.key===a.connectionType);return n?{name:a.name,connectorTitle:n.metadata.label,connectorType:a.connectionType,icon:n.metadata.logoUrl}:null}).filter(a=>a!==null)}handleEditConnectionClick(e){this.state.value.editingConnection={...e,newName:e.name}}async getLoginUrl(e,a,n,s){return this.api.getLoginUrl(this.projectId,a,e,n,s)}slugify(e){return e.toString().toLowerCase().replace(/\s+/g,"-").replace(/[^\w-]+/g,"").replace(/--+/g,"-")}getUniqueName(e){const a=this.state.value.connections.filter(n=>n.connectorType===e).length;return a===0?e:`${e}-${a}`}async generateEcdsaKey(){const e=this.state.value.addingConnection;if(!e)throw new Error("No connection is being added");const a=e.connector.metadata.key,n=this.getUniqueName(a),p=a==="iugu"?await this.api.generateRsaKey({projectId:this.projectId,connectionName:n,connectorType:a}):await this.api.generateEcdsaKey({projectId:this.projectId,connectionName:n,connectorType:a});return this.state.value.addingConnection&&(this.state.value.addingConnection.connectionName=n,this.state.value.addingConnection.ecdsaKeys=p),p.publicKey}}function Un(y){return new Promise((e,a)=>{const n=new FileReader;n.onload=()=>{const p=n.result.split(",")[1];e(p)},n.onerror=()=>a(n.error),n.readAsDataURL(y)})}const jn={key:6,style:{"margin-top":"16px"}},Y=P({__name:"AuthFormFields",props:{tokens:{},tokenValues:{},uploadedFiles:{default:()=>({})}},emits:["update:tokenValues","update:uploadedFiles","tokenChange"],setup(y,{emit:e}){const a=y,n=R(a.uploadedFiles||{});function s(u){const g=c.value[u];return g?g.split(",").map(o=>o.trim()):[]}function p(u,g){Array.isArray(g)?k(u,g.join(",")):console.error("Expected array for checkbox/select value")}const c=R({...a.tokenValues});ae(()=>a.tokenValues,u=>{c.value={...u}},{deep:!0}),ae(()=>a.uploadedFiles,u=>{n.value=u||{}},{deep:!0});function k(u,g){c.value[u]=g;const o={...c.value};e("update:tokenValues",o),e("tokenChange")}function T(u){var o,S;const g=[];return u.key&&g.push({required:!0,message:m.translate("i18n_auth_form_field_required",null,u.label||u.key)}),(o=u.input)!=null&&o.minSize&&g.push({min:u.input.minSize,message:m.translate("i18n_auth_form_field_min_length",null,u.input.minSize)}),(S=u.input)!=null&&S.maxSize&&g.push({max:u.input.maxSize,message:m.translate("i18n_auth_form_field_max_length",null,u.input.maxSize)}),g}async function j(u,g){try{const o=await Un(u),S={...n.value,[g]:{file:u,base64:o}};n.value=S,e("update:uploadedFiles",S),c.value[g]=o;const h={...c.value};e("update:tokenValues",h),e("tokenChange")}catch(o){console.error("Error converting file to base64:",o)}return!1}function v(u){const g={...n.value};delete g[u],n.value=g,e("update:uploadedFiles",g),c.value[u]="";const o={...c.value};e("update:tokenValues",o),e("tokenChange")}function d(u){const g=n.value[u];return g?[{uid:u,name:g.file.name,status:"done",size:g.file.size}]:[]}return(u,g)=>(i(),C(t(we),{model:c.value,layout:"vertical"},{default:l(()=>[(i(!0),_(N,null,B(u.tokens,o=>(i(),C(t(he),{key:o.key,label:o.label,name:o.key,rules:T(o)},{default:l(()=>{var S,h,V,f,E,M,x,K,D,X,ee,ne,te;return[((S=o.input)==null?void 0:S.type)==="small-string"?(i(),C(t(O),{key:0,value:c.value[o.key],"onUpdate:value":H=>c.value[o.key]=H,placeholder:o.description,maxlength:(h=o.input)==null?void 0:h.maxSize,minlength:(V=o.input)==null?void 0:V.minSize,type:"password",onInput:()=>k(o.key,c.value[o.key]||"")},null,8,["value","onUpdate:value","placeholder","maxlength","minlength","onInput"])):((f=o.input)==null?void 0:f.type)==="radiobox"?(i(),C(t(ve),{key:1,value:c.value[o.key],"onUpdate:value":H=>c.value[o.key]=H,onChange:()=>k(o.key,c.value[o.key]||"")},{default:l(()=>[(i(!0),_(N,null,B(o.input.options,H=>(i(),C(t(ye),{key:H.value,value:H.value},{default:l(()=>[w(b(H.label),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onUpdate:value","onChange"])):((E=o.input)==null?void 0:E.type)==="checkbox"?(i(),_(N,{key:2},[((K=(x=(M=o.input)==null?void 0:M.options)==null?void 0:x.length)!=null?K:0)<=10?(i(),C(t(fe),{key:0,value:s(o.key),onChange:H=>p(o.key,H)},{default:l(()=>[(i(!0),_(N,null,B(o.input.options,H=>(i(),C(t(me),{key:H.value,value:H.value},{default:l(()=>[w(b(H.label),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onChange"])):(i(),C(t(_e),{key:1,mode:"multiple",style:{width:"100%"},value:s(o.key),options:(D=o.input.options)!=null?D:[],onChange:H=>p(o.key,H)},null,8,["value","options","onChange"]))],64)):((X=o.input)==null?void 0:X.type)==="large-text"?(i(),C(t(Ce),{key:3,value:c.value[o.key],"onUpdate:value":H=>c.value[o.key]=H,placeholder:o.description,maxlength:(ee=o.input)==null?void 0:ee.maxSize,minlength:(ne=o.input)==null?void 0:ne.minSize,rows:4,onInput:()=>k(o.key,c.value[o.key]||"")},null,8,["value","onUpdate:value","placeholder","maxlength","minlength","onInput"])):((te=o.input)==null?void 0:te.type)==="file"?(i(),C(t(ke),{key:4,"file-list":d(o.key),"before-upload":H=>j(H,o.key),"max-count":1,"show-upload-list":!0,onRemove:()=>v(o.key)},{default:l(()=>[r(Q,null,{default:l(()=>[r(t(Ne)),w(" "+b(t(m).translate("i18n_auth_form_upload_file",null)),1)]),_:1})]),_:2},1032,["file-list","before-upload","onRemove"])):(i(),C(t(O),{key:5,value:c.value[o.key],"onUpdate:value":H=>c.value[o.key]=H,placeholder:o.description,type:"password",onInput:()=>k(o.key,c.value[o.key]||"")},null,8,["value","onUpdate:value","placeholder","onInput"])),o.instructions?(i(),_("div",jn,[r(t(F),{type:"secondary",style:{"white-space":"pre-line","font-size":"14px"}},{default:l(()=>[w(b(o.instructions),1)]),_:2},1024)])):I("",!0),o.description&&!o.instructions?(i(),C(t(F),{key:7,type:"secondary",style:{display:"block","font-size":"12px","margin-top":"8px"}},{default:l(()=>[w(b(o.description),1)]),_:2},1024)):I("",!0)]}),_:2},1032,["label","name","rules"]))),128))]),_:1},8,["model"]))}}),Nn=P({__name:"ConnectionHeader",props:{connectorLogoUrl:{},connectorLabel:{}},setup(y){return(e,a)=>(i(),C(t(A),{justify:"center",align:"center",gap:20,style:{"margin-bottom":"24px",padding:"20px 0"}},{default:l(()=>[r(Me,{"hide-text":"",size:"large"}),r(t(ln),{size:24}),r(Ke,{"image-url":e.connectorLogoUrl,"brand-name":e.connectorLabel,size:"medium","hide-text":""},null,8,["image-url","brand-name"])]),_:1}))}}),Mn=P({__name:"ConnectionModal",props:{addingConnection:{},ecdsaPublicKey:{},ecdsaKeyLoading:{type:Boolean},uploadedFiles:{},loading:{type:Boolean}},emits:["cancel","submit","scope-toggle","generate-ecdsa-key","update:token-values","update:uploaded-files","token-change"],setup(y,{emit:e}){const a=y,n=U(()=>{var u,g,o;switch((u=a.addingConnection)==null?void 0:u.connector.auth.type){case"oauth2":return m.translate("i18n_connection_modal_button_authorize",null);case"tokens":return m.translate("i18n_connection_modal_button_create",null);case"ecdsa":{if(!a.ecdsaPublicKey)return m.translate("i18n_connection_modal_button_ok",null);const S=((g=a.addingConnection)==null?void 0:g.connector.auth.params)||[],h=((o=a.addingConnection)==null?void 0:o.tokenValues)||{};return S.every(f=>h[f.key]&&h[f.key].trim().length>0)?m.translate("i18n_connection_modal_button_create",null):m.translate("i18n_connection_modal_button_create_missing_fields",null)}default:return m.translate("i18n_connection_modal_button_ok",null)}});function s(){e("cancel")}function p(){e("submit")}function c(d,u){e("scope-toggle",d,u)}function k(){e("generate-ecdsa-key")}function T(d){e("update:token-values",d)}function j(d){e("update:uploaded-files",d)}function v(){e("token-change")}return(d,u)=>(i(),C(t(G),{open:!!d.addingConnection,title:d.addingConnection?t(m).translate("i18n_connection_modal_title_add",null,d.addingConnection.connector.metadata.label):"","ok-text":n.value,"ok-button-props":{disabled:n.value.includes("Required")},"confirm-loading":d.loading,"wrap-class-name":"full-modal",onCancel:s,onOk:p},{default:l(()=>[d.addingConnection?(i(),_(N,{key:0},[r(Nn,{"connector-logo-url":d.addingConnection.connector.metadata.logoUrl,"connector-label":d.addingConnection.connector.metadata.label},null,8,["connector-logo-url","connector-label"]),d.addingConnection.connector.auth.type==="oauth2"?(i(),_(N,{key:0},[r(t(q),null,{default:l(()=>[w(b(t(m).translate("i18n_connection_modal_oauth2_scopes_instruction",null)),1)]),_:1}),r(t(A),{vertical:"",gap:"10",style:{margin:"30px 0px"}},{default:l(()=>{var g;return[(i(!0),_(N,null,B(d.addingConnection.connector.auth.scopes,o=>(i(),C(t(A),{key:o.key,justify:"space-between",align:"center"},{default:l(()=>[r(t(A),{vertical:""},{default:l(()=>[r(t(F),null,{default:l(()=>[w(b(o.description),1)]),_:2},1024),r(t(F),{type:"secondary"},{default:l(()=>[w(b(o.key),1)]),_:2},1024)]),_:2},1024),r(t(be),{checked:d.addingConnection.selectedScopeIds.includes(o.key),onChange:S=>c(o.key,S)},null,8,["checked","onChange"])]),_:2},1024))),128)),(g=d.addingConnection.connector.auth.params)!=null&&g.length?(i(),C(Y,{key:0,tokens:d.addingConnection.connector.auth.params,"token-values":d.addingConnection.tokenValues,"uploaded-files":d.uploadedFiles,"onUpdate:tokenValues":T,"onUpdate:uploadedFiles":j,onTokenChange:v},null,8,["tokens","token-values","uploaded-files"])):I("",!0)]}),_:1})],64)):I("",!0),d.addingConnection.connector.auth.type==="tokens"?(i(),_(N,{key:1},[r(t(q),null,{default:l(()=>[w(b(t(m).translate("i18n_connection_modal_tokens_instruction",null)),1)]),_:1}),r(Y,{tokens:d.addingConnection.connector.auth.tokens,"token-values":d.addingConnection.tokenValues,"uploaded-files":d.uploadedFiles,"onUpdate:tokenValues":T,"onUpdate:uploadedFiles":j,onTokenChange:v},null,8,["tokens","token-values","uploaded-files"])],64)):I("",!0),d.addingConnection.connector.auth.type==="ecdsa"?(i(),_(N,{key:2},[d.ecdsaPublicKey?(i(),C(t(A),{key:1,vertical:"",gap:"16"},{default:l(()=>[r(t(F),{strong:""},{default:l(()=>[w(b(t(m).translate("i18n_connection_modal_ecdsa_keys_generated",null)),1)]),_:1}),r(t(F),{strong:""},{default:l(()=>[w(b(t(m).translate("i18n_connection_modal_ecdsa_copy_public_key",null)),1)]),_:1}),r(t(O),{value:d.ecdsaPublicKey,readonly:"",copyable:"",code:""},null,8,["value"]),r(Y,{tokens:d.addingConnection.connector.auth.params,"token-values":d.addingConnection.tokenValues,"uploaded-files":d.uploadedFiles,"onUpdate:tokenValues":T,"onUpdate:uploadedFiles":j,onTokenChange:v},null,8,["tokens","token-values","uploaded-files"])]),_:1})):(i(),_(N,{key:0},[r(t(q),null,{default:l(()=>[w(b(t(m).translate("i18n_connection_modal_ecdsa_generate_instruction",null)),1)]),_:1}),r(t(A),{vertical:"",gap:"16"},{default:l(()=>[r(Q,{loading:d.ecdsaKeyLoading,onClick:k},{default:l(()=>[w(b(t(m).translate("i18n_connection_modal_ecdsa_generate_button",null)),1)]),_:1},8,["loading"])]),_:1})],64))],64)):I("",!0)],64)):I("",!0)]),_:1},8,["open","title","ok-text","ok-button-props","confirm-loading"]))}}),Kn=P({__name:"ConnectorCard",props:{title:{},logoUrl:{},description:{},unavailable:{type:Boolean},connector:{}},setup(y){const e=y,a=U(()=>{var s;return((s=e.connector)==null?void 0:s.triggers)&&e.connector.triggers.length>0}),n=U(()=>{var s;return((s=e.connector)==null?void 0:s.actions)&&e.connector.actions.length>0});return(s,p)=>(i(),C(t(ue),{class:Ve({"connector-card":!0,unavailable:s.unavailable})},{default:l(()=>[r(t(A),{style:{width:"100%"},vertical:"",gap:12},{default:l(()=>[r(t(A),{justify:"space-between"},{default:l(()=>[r(t(re),{src:s.logoUrl,shape:"square",size:"large"},null,8,["src"]),r(t(A),{gap:8},{default:l(()=>[a.value?(i(),C(t(Ze),{key:0,size:16})):I("",!0),n.value?(i(),C(t(In),{key:1,size:16})):I("",!0),s.unavailable?(i(),C(t(He),{key:2,style:{height:"fit-content"}},{default:l(()=>[w(b(t(m).translate("i18n_connector_card_talk_to_us",null)),1)]),_:1})):I("",!0)]),_:1})]),_:1}),r(t(A),{vertical:""},{default:l(()=>[r(t(F),{strong:""},{default:l(()=>[w(b(s.title),1)]),_:1}),r(t(F),{type:"secondary"},{default:l(()=>[w(b(s.description),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["class"]))}});const Zn=ce(Kn,[["__scopeId","data-v-24009903"]]),En=y=>(Te("data-v-f22be01c"),y=y(),Se(),y),Ln=En(()=>$("div",{style:{"flex-grow":"1"}},null,-1)),Fn={class:"connectors-grid"},zn=P({__name:"ConnectorsView",setup(y){const a=Ae().params.projectId,n=new Sn(a,new Tn),s=R(null),p=R(!1),c=R({}),k=R(!1),T=U(()=>[...n.state.value.connectors.filter(h=>h.auth.type==="oauth2"),...n.state.value.connectors.filter(h=>h.auth.type==="tokens"),...n.state.value.connectors.filter(h=>h.auth.type==="ecdsa"),...n.state.value.connectors.filter(h=>h.auth.type==="manual")]),j=U(()=>n.state.value.connections.filter(h=>h&&h.name&&h.connectorTitle&&h.connectorType));n.fetchInitialState();function v(h){n.state.value.addingConnection&&(n.state.value.addingConnection.tokenValues=h)}function d(h){c.value=h}function u(){s.value=null,p.value=!1,c.value={}}async function g(){p.value=!0;try{const V=(await n.generateEcdsaKey()).replace("-----BEGIN PUBLIC KEY-----","").replace("-----END PUBLIC KEY-----","").replace(/\s/g,"");s.value=V}finally{p.value=!1}}async function o(){var V,f,E;const h=(V=n.state.value.addingConnection)==null?void 0:V.connector.auth.type;k.value=!0;try{switch(h){case"oauth2":return await n.handleAddConnectionSubmit();case"tokens":return await n.handleAddTokenConnectionSubmit();case"ecdsa":{const M=((f=n.state.value.addingConnection)==null?void 0:f.tokenValues)||{},x=(E=n.state.value.addingConnection)==null?void 0:E.connector.metadata.key;let K="";x==="starkbank"?K=M.projectId||"":x==="iugu"&&(K=M.apiToken||"");const D=await n.handleAddEcdsaConnectionSubmit(s.value,K);return u(),D}default:break}}catch(M){const x=K=>{try{return JSON.parse(K),!0}catch{return!1}};if(M instanceof Error&&x(M.message)){const K=oe.object({error:oe.string()}).safeParse(JSON.parse(M.message));if(K.success){J.error(K.data.error);return}else{J.error(m.translate("i18n_connectorsview_failed_to_create_with_message",void 0,{message:M instanceof Error?M.message:"Unknown error"}));return}}else J.error(m.translate("i18n_connectorsview_failed_to_create"))}finally{k.value=!1}}function S(h){h.auth.type==="manual"?je.showNewMessage(m.translate("i18n_connectors_ask_for_access",null,h.metadata.label)):n.showAddConfirmationModal(h)}return(h,V)=>(i(),_(N,null,[r(t(Ee),{direction:"vertical",style:{width:"100%","margin-bottom":"30px"}},{default:l(()=>[r(t(A),{align:"center",justify:"space-between"},{default:l(()=>[r(t(W),null,{default:l(()=>[w(b(t(m).translate("i18n_connectorsview_title")),1)]),_:1})]),_:1}),r(t(q),null,{default:l(()=>[w(b(t(m).translate("i18n_connectorsview_description"))+" ",1),r(ge)]),_:1}),j.value.length?(i(),C(t(A),{key:0,vertical:""},{default:l(()=>[r(t(W),{level:2},{default:l(()=>[w(b(t(m).translate("i18n_connectorsview_installed")),1)]),_:1}),r(t(A),{vertical:"",gap:10},{default:l(()=>[(i(!0),_(N,null,B(j.value,f=>(i(),C(t(ue),{key:f.name},{default:l(()=>[r(t(A),{align:"center",gap:20},{default:l(()=>[r(t(re),{src:f.icon,height:"40px",shape:"square"},null,8,["src"]),r(t(F),{strong:""},{default:l(()=>[w(b(f.connectorTitle),1)]),_:2},1024),Ln,r(t(F),{content:f.name,copyable:"",code:""},null,8,["content"]),r(t($e),null,{overlay:l(()=>[r(t(Ie),null,{default:l(()=>[r(t(le),{onClick:E=>t(n).handleEditConnectionClick(f)},{default:l(()=>[w(b(t(m).translate("i18n_connectorsview_rename")),1)]),_:2},1032,["onClick"]),r(t(le),{danger:"",onClick:E=>t(n).handleDeletionClick(f)},{default:l(()=>[w(b(t(m).translate("i18n_connectorsview_delete")),1)]),_:2},1032,["onClick"])]),_:2},1024)]),default:l(()=>[r(t(Ue))]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})):I("",!0),r(t(A),{vertical:""},{default:l(()=>[j.value.length?(i(),C(t(W),{key:0,level:2},{default:l(()=>[w(b(t(m).translate("i18n_connectorsview_available")),1)]),_:1})):I("",!0),$("div",Fn,[(i(!0),_(N,null,B(T.value,f=>(i(),C(Zn,{key:f.metadata.key,title:f.metadata.label,"logo-url":f.metadata.logoUrl,description:f.metadata.description,unavailable:f.auth.type==="manual",connector:f,onClick:E=>S(f)},null,8,["title","logo-url","description","unavailable","connector","onClick"]))),128))])]),_:1})]),_:1}),r(t(G),{open:!!t(n).state.value.editingConnection,title:t(n).state.value.editingConnection?t(m).translate("i18n_connectorsview_connection_modal_title",void 0,{connector:t(n).state.value.editingConnection.connectorTitle}):"",onCancel:V[2]||(V[2]=f=>t(n).state.value.editingConnection=null)},{footer:l(()=>[r(t(A),{justify:"end"},{default:l(()=>[r(Q,{disabled:!t(n).hasChanges.value,onClick:V[1]||(V[1]=f=>t(n).renameConnection())},{default:l(()=>[w(b(t(m).translate("i18n_connectorsview_save")),1)]),_:1},8,["disabled"])]),_:1})]),default:l(()=>[t(n).state.value.editingConnection?(i(),C(t(O),{key:0,value:t(n).state.value.editingConnection.newName,"onUpdate:value":V[0]||(V[0]=f=>t(n).state.value.editingConnection.newName=f)},null,8,["value"])):I("",!0)]),_:1},8,["open","title"]),r(Mn,{"adding-connection":t(n).state.value.addingConnection,"ecdsa-public-key":s.value,"ecdsa-key-loading":p.value,"uploaded-files":c.value,loading:k.value,onCancel:V[3]||(V[3]=()=>{t(n).state.value.addingConnection=null,u()}),onSubmit:o,onScopeToggle:V[4]||(V[4]=(f,E)=>t(n).handleScopeToggle(f,E)),onGenerateEcdsaKey:g,"onUpdate:tokenValues":v,"onUpdate:uploadedFiles":d},null,8,["adding-connection","ecdsa-public-key","ecdsa-key-loading","uploaded-files","loading"])],64))}});const tt=ce(zn,[["__scopeId","data-v-f22be01c"]]);export{tt as default};
//# sourceMappingURL=ConnectorsView.abb083b0.js.map
