var w=Object.defineProperty;var g=(o,t,e)=>t in o?w(o,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[t]=e;var h=(o,t,e)=>(g(o,typeof t!="symbol"?t+"":t,e),e);import{c$ as l,L as y,K as b,N as E}from"./vue-router.54864aea.js";import{p as m}from"./popupNotifcation.2a8529b1.js";(function(){try{var o=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},t=new Error().stack;t&&(o._sentryDebugIds=o._sentryDebugIds||{},o._sentryDebugIds[t]="1daea4a0-e746-4aa6-8cba-e49588445b49",o._sentryDebugIdIdentifier="sentry-dbid-1daea4a0-e746-4aa6-8cba-e49588445b49")}catch{}})();const A=()=>window.location.host.includes(".abstra.io"),T={"cloud-api":"/api/cloud-api",onboarding:"https://onboarding.abstra.app"},R={"cloud-api":"https://cloud-api.abstra.cloud",onboarding:"https://onboarding.abstra.app"},d=o=>{const t="VITE_"+l.toUpper(l.snakeCase(o)),e={VITE_SENTRY_RELEASE:"8afa6e561f7341cb057606c3915dd52484236673",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0}[t];return e||(A()?T[o]:R[o])},i={cloudApi:d("cloud-api"),onboarding:d("onboarding")};class ${constructor(){h(this,"storage");this.storage=new y(b.string(),"auth:jwt")}async authenticate(t){try{return await f.post("authn/authenticate",{email:t}),null}catch(e){return e.message}}async verify(t,e){const a=await f.post("authn/verify",{email:t,token:e});if(!(a&&"jwt"in a))throw new Error("Invalid token");return this.saveJWT(a.jwt),this.getAuthor()}saveJWT(t){this.storage.set(t)}getAuthor(){const t=this.storage.get();if(t)try{const e=E(t);if(e.exp&&e.exp>Date.now()/1e3)return{jwt:t,claims:e}}catch{console.warn("Invalid JWT")}return null}removeAuthor(){this.storage.remove()}get headers(){const t=this.getAuthor();return t?{"Author-Authorization":`Bearer ${t.jwt}`}:{}}}const c=new $;class u extends Error{constructor(t,e){super(t),this.status=e}static async fromResponse(t){const e=await t.text();return new u(e,t.status)}}class f{static async get(t,e){const a=Object.fromEntries(Object.entries(e!=null?e:{}).filter(([,p])=>p!=null)),n=Object.keys(a).length>0?`?${new URLSearchParams(a).toString()}`:"",s=await fetch(`${i.cloudApi}/console/${t}${n}`,{headers:{...c.headers}});if(s.status===403){m("You are not authorized to access this resource","Click here to go back to the home page.",()=>{window.location.href="/"});return}const r=await s.text();return r?JSON.parse(r):null}static async getBlob(t){return await(await fetch(`${i.cloudApi}/console/${t}`,{headers:{...c.headers}})).blob()}static async post(t,e,a){const n=!!(a!=null&&a["Content-Type"])&&a["Content-Type"]!=="application/json",s=await fetch(`${i.cloudApi}/console/${t}`,{method:"POST",headers:{"Content-Type":"application/json",...c.headers,...a},body:n?e:JSON.stringify(e)});if(!s.ok)throw await u.fromResponse(s);const r=await s.text();return r?JSON.parse(r):null}static async patch(t,e){const a=await fetch(`${i.cloudApi}/console/${t}`,{method:"PATCH",headers:{"Content-Type":"application/json",...c.headers},body:JSON.stringify(e)});if(!a.ok)throw await u.fromResponse(a);const n=await a.text();return n?JSON.parse(n):null}static async delete(t){const e=await fetch(`${i.cloudApi}/console/${t}`,{method:"DELETE",headers:{"Content-Type":"application/json",...c.headers}});if(!e.ok)throw await u.fromResponse(e)}}export{f as C,i as E,c as a};
//# sourceMappingURL=gateway.26a7fc87.js.map
