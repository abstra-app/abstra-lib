import{u as P}from"./index.2a837d8f.js";import{d as b,H as U,b as d,ev as m,e as n,eD as y,eE as A,eF as W,v as k,a as $,f as g,u as a,ar as q,eA as L,eB as M,r as w,c as V,eL as N}from"./outputWidgets.0ce95940.js";import{b as T,c as H,d as O,r as j}from"./FormRunner.72ae0ee9.js";import{a as J}from"./asyncComputed.ccac9f92.js";import{L as z}from"./CircularLoading.86a8a1a1.js";import{F as G}from"./forms.2b00364a.js";import{W as E}from"./workspaces.a4e61c29.js";import"./envVars.1dfbd7a0.js";import{J as K}from"./icons.cafa1f54.js";import"./pubsub.4ef12c55.js";import"./url.1acc4d8d.js";import"./Passwordless.9d696e20.js";import"./index.15aaa98a.js";import"./PlayerNavbar.01c6074c.js";import"./WidgetsFrame.5322940f.js";import"./Steps.d9a12d8a.js";import"./Card.7a33edb1.js";import"./TabPane.6ff17ab6.js";import"./hasIn.8e0662ea.js";import"./Typography.b54fb2d7.js";import"./record.1e618d23.js";import"./runnerData.01c7550d.js";(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},r=new Error().stack;r&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[r]="2a751d1e-9174-4f2a-8a8f-19cc2225ee97",e._sentryDebugIdIdentifier="sentry-dbid-2a751d1e-9174-4f2a-8a8f-19cc2225ee97")}catch{}})();const I=e=>(A("data-v-3e46b76c"),e=e(),W(),e),Q={class:"error"},X=I(()=>n("h1",{class:"error-header"},"Error",-1)),Y={class:"error-body"},Z={class:"error-message"},ee={class:"error-details"},re=I(()=>n("span",null,"Reload",-1)),te=[re],oe=b({__name:"Error",props:{error:{type:Object,required:!0},repeated:{type:Boolean,required:!1}},emits:["reload"],setup(e,{emit:r}){const s=e,o=U(()=>s.repeated?"Ooops. The same error occured, please try again later.":"An error occurred while loading.");function i(){r("reload")}return(h,_)=>(d(),m("div",Q,[X,n("div",Y,[n("div",Z,[n("p",null,y(o.value),1),n("p",ee,y(e.error.name)+": "+y(e.error.message),1)]),n("div",{class:"error-actions"},[n("button",{class:"btn btn-primary",onClick:i},te)])])]))}});const ae=k(oe,[["__scopeId","data-v-3e46b76c"]]),ne=b({__name:"BackButton",emits:["exitFullscreenPreview"],setup(e,{emit:r}){return(s,o)=>{const i=$("icon");return d(),m("button",{class:"back-btn",onClick:o[0]||(o[0]=h=>r("exitFullscreenPreview"))},[g(i,{class:"icon",path:a(K),width:"20",height:"20",fill:"#5A677A"},null,8,["path"]),q(" Editor ")])}}});const se=k(ne,[["__scopeId","data-v-a3f31716"]]),ie={class:"page"},ce={key:1,class:"error"},le={key:2,style:{width:"100%",height:"100%",display:"flex"}},de={style:{width:"100%",height:"100%",display:"flex"}},ue=b({__name:"FormPreview",setup(e){const r=L(),s=M(),o=w(null),i=w(null),h=s.query,_=w(null);function S(t,c){j("preview",r,t,c)}const{result:f,loading:B,refetch:x,error:F}=J(async()=>{const[t,c,v]=await Promise.all([G.get(s.params.id),E.get(),E.readTestData()]),u=new H({formRunnerData:t.makeRunnerData(c),queryParams:h,userManager:P,connectionManager:new O(t.id),onFormStart:()=>{},onFormEnd:()=>{},onRedirect:S,onAuthUpdate:l=>_.value=l,onStateUpdate:l=>o.value=l,logService:null,onStackTraceUpdate:null});t.updateInitialState("test_data",v),i.value=t.makeRunnerData(c);const p=u.getState();return o.value=p.formState,_.value=p.passwordlessUser,N({form:t,workspace:c,controller:u})}),D=async({id:t})=>{await r.push({params:{id:t},name:"formPreview",query:s.query}),x()},C=()=>{r.push(`/_editor/form/${encodeURIComponent(s.params.id)}`)};return(t,c)=>{var v,u,p,l,R;return d(),m("div",ie,[a(B)||!o.value||!i.value?(d(),V(z,{key:0})):a(F)?(d(),m("div",ce,[g(ae,{error:a(F),onReload:a(x)},null,8,["error","onReload"])])):(d(),m("main",le,[n("div",de,[g(T,{style:{height:"unset",flex:1,overflow:"hidden"},"is-preview":!1,"form-runner-data":i.value,"form-state":o.value,"user-email":(v=_.value)==null?void 0:v.claims.email,onUpdateWidgetErrors:(u=a(f))==null?void 0:u.controller.updateWidgetFrontendErrors,onUpdateWidgetValue:(p=a(f))==null?void 0:p.controller.updateWidgetValue,onActionClicked:(l=a(f))==null?void 0:l.controller.handleActionClick,onNavigate:D,onLogout:(R=a(f))==null?void 0:R.controller.logout},null,8,["form-runner-data","form-state","user-email","onUpdateWidgetErrors","onUpdateWidgetValue","onActionClicked","onLogout"]),g(se,{onExitFullscreenPreview:C})])]))])}}});const Ae=k(ue,[["__scopeId","data-v-c5c2a66b"]]);export{Ae as default};
//# sourceMappingURL=FormPreview.1a50b0e5.js.map
