var Y=Object.defineProperty;var X=(c,e,t)=>e in c?Y(c,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):c[e]=t;var E=(c,e,t)=>(X(c,typeof e!="symbol"?e+"":e,t),t);import{d as $,af as B,g as I,o as l,K as h,O as S,F as b,e4 as x,a as _,Q as N,c as w,w as u,b as i,u as s,az as O,da as C,eb as R,aP as F,e3 as J,f as T,h as ee,am as U,J as W,aj as te,a8 as K,N as ae,e9 as se,ea as z,aL as G,aT as oe,aU as ne,ec as le,bE as re,a6 as ie,cs as ue}from"./index.56a4aa2e.js";import{B as ce}from"./BaseLayout.d9bc47ce.js";import{S as de}from"./SaveButton.eafe8d71.js";import{S as pe,L as me,a as ve,b as q}from"./OmniChat.b31632d8.js";import{N as ge,_ as fe}from"./Navbar.c6e4b101.js";import{S as he}from"./SourceCode.11bde9ae.js";import{T as ye}from"./TasksManager.d860d962.js";import{G as j}from"./PhCaretRight.vue.006ebba4.js";import{B as _e}from"./Badge.19f199e3.js";import"./Card.e1cbf4fc.js";import{T as D,A as V}from"./TabPane.f81b8fb1.js";import"./linters.bbf68979.js";import{H as be,J as ke,S as we}from"./scripts.cb0f8348.js";import{n as Te}from"./validations.38f1d22d.js";import{u as Se}from"./editor.a4e238ac.js";(function(){try{var c=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},e=new Error().stack;e&&(c._sentryDebugIds=c._sentryDebugIds||{},c._sentryDebugIds[e]="693d99cd-a645-4681-bc0d-5465e648b306",c._sentryDebugIdIdentifier="sentry-dbid-693d99cd-a645-4681-bc0d-5465e648b306")}catch{}})();const He=["width","height","fill","transform"],Ce={key:0},$e=_("path",{d:"M72.5,150.63,100.79,128,72.5,105.37a12,12,0,1,1,15-18.74l40,32a12,12,0,0,1,0,18.74l-40,32a12,12,0,0,1-15-18.74ZM144,172h32a12,12,0,0,0,0-24H144a12,12,0,0,0,0,24ZM236,56V200a20,20,0,0,1-20,20H40a20,20,0,0,1-20-20V56A20,20,0,0,1,40,36H216A20,20,0,0,1,236,56Zm-24,4H44V196H212Z"},null,-1),Le=[$e],Me={key:1},Ve=_("path",{d:"M224,56V200a8,8,0,0,1-8,8H40a8,8,0,0,1-8-8V56a8,8,0,0,1,8-8H216A8,8,0,0,1,224,56Z",opacity:"0.2"},null,-1),Ie=_("path",{d:"M128,128a8,8,0,0,1-3,6.25l-40,32a8,8,0,1,1-10-12.5L107.19,128,75,102.25a8,8,0,1,1,10-12.5l40,32A8,8,0,0,1,128,128Zm48,24H136a8,8,0,0,0,0,16h40a8,8,0,0,0,0-16Zm56-96V200a16,16,0,0,1-16,16H40a16,16,0,0,1-16-16V56A16,16,0,0,1,40,40H216A16,16,0,0,1,232,56ZM216,200V56H40V200H216Z"},null,-1),Ze=[Ve,Ie],Ae={key:2},Ee=_("path",{d:"M216,40H40A16,16,0,0,0,24,56V200a16,16,0,0,0,16,16H216a16,16,0,0,0,16-16V56A16,16,0,0,0,216,40Zm-91,94.25-40,32a8,8,0,1,1-10-12.5L107.19,128,75,102.25a8,8,0,1,1,10-12.5l40,32a8,8,0,0,1,0,12.5ZM176,168H136a8,8,0,0,1,0-16h40a8,8,0,0,1,0,16Z"},null,-1),Be=[Ee],ze={key:3},Ne=_("path",{d:"M126,128a6,6,0,0,1-2.25,4.69l-40,32a6,6,0,0,1-7.5-9.38L110.4,128,76.25,100.69a6,6,0,1,1,7.5-9.38l40,32A6,6,0,0,1,126,128Zm50,26H136a6,6,0,0,0,0,12h40a6,6,0,0,0,0-12Zm54-98V200a14,14,0,0,1-14,14H40a14,14,0,0,1-14-14V56A14,14,0,0,1,40,42H216A14,14,0,0,1,230,56Zm-12,0a2,2,0,0,0-2-2H40a2,2,0,0,0-2,2V200a2,2,0,0,0,2,2H216a2,2,0,0,0,2-2Z"},null,-1),Pe=[Ne],Oe={key:4},Re=_("path",{d:"M128,128a8,8,0,0,1-3,6.25l-40,32a8,8,0,1,1-10-12.5L107.19,128,75,102.25a8,8,0,1,1,10-12.5l40,32A8,8,0,0,1,128,128Zm48,24H136a8,8,0,0,0,0,16h40a8,8,0,0,0,0-16Zm56-96V200a16,16,0,0,1-16,16H40a16,16,0,0,1-16-16V56A16,16,0,0,1,40,40H216A16,16,0,0,1,232,56ZM216,200V56H40V200H216Z"},null,-1),Ue=[Re],je={key:5},De=_("path",{d:"M122.5,124.88a4,4,0,0,1,0,6.24l-40,32a4,4,0,0,1-5-6.24L113.6,128,77.5,99.12a4,4,0,0,1,5-6.24ZM176,156H136a4,4,0,0,0,0,8h40a4,4,0,0,0,0-8ZM228,56V200a12,12,0,0,1-12,12H40a12,12,0,0,1-12-12V56A12,12,0,0,1,40,44H216A12,12,0,0,1,228,56Zm-8,0a4,4,0,0,0-4-4H40a4,4,0,0,0-4,4V200a4,4,0,0,0,4,4H216a4,4,0,0,0,4-4Z"},null,-1),Fe=[De],Je={name:"PhTerminalWindow"},We=$({...Je,props:{weight:{type:String},size:{type:[String,Number]},color:{type:String},mirrored:{type:Boolean}},setup(c){const e=c,t=B("weight","regular"),g=B("size","1em"),o=B("color","currentColor"),d=B("mirrored",!1),r=I(()=>{var p;return(p=e.weight)!=null?p:t}),v=I(()=>{var p;return(p=e.size)!=null?p:g}),f=I(()=>{var p;return(p=e.color)!=null?p:o}),k=I(()=>e.mirrored!==void 0?e.mirrored?"scale(-1, 1)":void 0:d?"scale(-1, 1)":void 0);return(p,L)=>(l(),h("svg",x({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256",width:v.value,height:v.value,fill:f.value,transform:k.value},p.$attrs),[S(p.$slots,"default"),r.value==="bold"?(l(),h("g",Ce,Le)):r.value==="duotone"?(l(),h("g",Me,Ze)):r.value==="fill"?(l(),h("g",Ae,Be)):r.value==="light"?(l(),h("g",ze,Pe)):r.value==="regular"?(l(),h("g",Oe,Ue)):r.value==="thin"?(l(),h("g",je,Fe)):b("",!0)],16,He))}}),Ke={class:"editor-layout"},Ge={class:"layout-left"},qe={class:"layout-center"},Qe={class:"layout-right"},Ye=$({__name:"EditorLayout",props:{fullWidth:{type:Boolean}},setup(c){return(e,t)=>(l(),h("div",Ke,[_("section",Ge,[S(e.$slots,"left",{},void 0,!0)]),_("section",qe,[S(e.$slots,"center",{},void 0,!0)]),_("section",Qe,[S(e.$slots,"right",{},void 0,!0)])]))}});const Xe=N(Ye,[["__scopeId","data-v-10d349a3"]]);class Q{constructor(e,t){E(this,"ws",null);E(this,"selfClosed",!1);E(this,"reconnectInterval");this.onMessage=e,this.stageId=t}get url(){return"/_editor/api/stdio/listen"}handleMessage(e){const t=JSON.parse(e.data);t.stage_id===this.stageId&&this.onMessage(t)}handleClose(e){this.selfClosed||this.reconnectInterval||(this.reconnectInterval=setInterval(()=>this.reset(),2e3))}clearReconnectInterval(){this.reconnectInterval&&(clearInterval(this.reconnectInterval),this.reconnectInterval=void 0)}async close(){if(!!this.ws){this.selfClosed=!0;try{this.ws.close()}catch{console.warn("already closed")}this.ws=null}}async reset(){await this.close(),await this.connect()}async connect(){return await new Promise(e=>{this.ws=new WebSocket(this.url),this.ws.onopen=()=>e(),this.ws.onclose=t=>this.handleClose(t),this.ws.onmessage=t=>this.handleMessage(t),this.selfClosed=!1,this.clearReconnectInterval()})}}const xe={class:"toggle-button"},et=$({__name:"TerminalOutputHeader",props:{controller:{},open:{type:Boolean}},emits:["toggle-console"],setup(c,{emit:e}){return(t,g)=>(l(),w(s(C),{class:"header",justify:"space-between"},{default:u(()=>[i(s(C),{align:"center",gap:"middle"},{default:u(()=>[i(s(We),{size:"20"}),O(" Terminal Output ")]),_:1}),i(s(F),{placement:"left","mouse-enter-delay":.5,title:t.open?"Hide Smart Console":"Show Smart Console"},{default:u(()=>{var o,d,r;return[_("div",xe,[((o=t.controller)==null?void 0:o.badgeState.type)==="unseen"?(l(),w(s(_e),{key:0,count:(d=t.controller)==null?void 0:d.badgeState.count,"number-style":{backgroundColor:((r=t.controller)==null?void 0:r.badgeState.severity)==="error"?"#e03636":"#606060"}},{default:u(()=>[i(s(j),{class:R(["icon",{open:t.open}]),onClick:g[0]||(g[0]=v=>e("toggle-console"))},null,8,["class"])]),_:1},8,["count","number-style"])):(l(),w(s(j),{key:1,class:R(["icon",{open:t.open}]),onClick:g[1]||(g[1]=v=>e("toggle-console"))},null,8,["class"]))])]}),_:1},8,["title"])]),_:1}))}});const tt=N(et,[["__scopeId","data-v-e08ca106"]]),at={key:0,class:"entry ai-output"},st={key:0,class:"local-entry"},ot=$({__name:"TerminalOutput",props:{workspace:{},stage:{}},setup(c,{expose:e}){const t=c,g=J(),o=T(null),d=T(!1),r=T(200),v=T(!1),f=q.create(),k=new Q(n=>f.log(n),t.stage.id),p=new pe(new me,f,t.stage.id,{origin:"editor"}),L=I(()=>({height:`${r.value}px`})),H=T(!0);async function M(){var n;if(d.value=!d.value,d.value){if(p.setSeen(),await U(),!o.value)return;o.value.addEventListener("wheel",Z),H.value&&(o.value.scrollTop=(n=o.value)==null?void 0:n.scrollHeight)}else{if(!o.value)return;o.value.removeEventListener("wheel",Z)}}const Z=()=>{if(!o.value)return;const{scrollTop:n,scrollHeight:m,clientHeight:y}=o.value;n+y>=m?H.value=!0:H.value=!1};ee(g,()=>f.clear()),e({closeTerminal:()=>d.value=!1,fixJson:async(n,m)=>{d.value=!0,await p.fixJson(n,m)}}),f.listen(async n=>{d.value||p.setUnseen(n),n.type!=="restart"&&(await U(),!!o.value&&H.value&&(o.value.scrollTop=o.value.scrollHeight))});const P=n=>{!v.value||(r.value=document.body.clientHeight-n.clientY)},a=()=>v.value=!1;return W(async()=>{document.addEventListener("mousemove",P),document.addEventListener("mouseup",a),await k.connect()}),te(async()=>{o.value&&o.value.removeEventListener("wheel",Z)}),K(async()=>{document.removeEventListener("mousemove",P),document.removeEventListener("mouseup",a),await k.close()}),(n,m)=>(l(),w(s(C),{vertical:""},{default:u(()=>[i(tt,{controller:s(p),open:d.value,onToggleConsole:M},null,8,["controller","open"]),d.value?(l(),w(s(C),{key:0,class:"terminal",style:ae(L.value),vertical:""},{default:u(()=>[_("div",{class:"resize-handler",onMousedown:m[0]||(m[0]=y=>v.value=!0)},null,32),i(s(C),{class:"cli"},{default:u(()=>[i(s(C),{class:"left",vertical:""},{default:u(()=>[_("div",{ref_key:"entriesContainer",ref:o,class:"entries"},[s(f).logs.length===0?(l(),h("div",at," The output and errors generated by your code will be printed here. ")):b("",!0),(l(!0),h(G,null,se(s(f).logs,(y,A)=>(l(),h("div",{key:A,class:R([y.type,"entry"])},[y.type==="stdout"||y.type==="stderr"||y.type==="restart"?(l(),h("div",st,z(y.type==="restart"?"-- restarted --":y.log),1)):b("",!0)],2))),128))],512)]),_:1}),i(s(C),{class:"right",vertical:"",justify:"space-between",align:"center"},{default:u(()=>[i(s(F),{placement:"left",title:"Start new conversation"},{default:u(()=>[i(s(ve),{size:20,class:"broom-icon",onClick:m[1]||(m[1]=y=>s(p).clearLogService())})]),_:1})]),_:1})]),_:1})]),_:1},8,["style"])):b("",!0)]),_:1}))}});const nt=N(ot,[["__scopeId","data-v-edd3b7c0"]]),Ht=$({__name:"Editor",props:{workspace:{},stage:{},stageType:{},testTabName:{},extraTab:{},docsPath:{}},emits:["refetch-tasks","on-save"],setup(c,{expose:e,emit:t}){const g=c,o=J(),d=T(null),r=T(null),v=a=>{g.stage.file=a},f=T("source-code"),k=T("test");function p(){var n;const a=g.stage.codeContent;(n=d.value)==null||n.updateLocalEditorCode(a)}const L=q.create(),H=new Q(a=>L.log(a),o.params.id);W(()=>{H.connect()}),K(()=>{H.close()});const M=a=>a!==f.value&&g.stage.hasChanges();return e({code:d,logService:L,goToTestTab:()=>{k.value="test"},closeTerminal:()=>{var a;(a=r.value)==null||a.closeTerminal()}}),(a,n)=>(l(),w(ce,null,{navbar:u(()=>[i(ge,{"page-title":a.stage.title},null,8,["page-title"])]),content:u(()=>[i(Xe,null,{left:u(()=>{var m,y;return[i(s(D),{"active-key":f.value,"onUpdate:activeKey":n[0]||(n[0]=A=>f.value=A)},{rightExtra:u(()=>[i(de,{model:a.stage,onSave:p},null,8,["model"])]),default:u(()=>[i(s(V),{key:"source-code",tab:"Source code",disabled:M("source-code")},null,8,["disabled"]),i(s(V),{key:"settings",tab:"Settings",disabled:M("settings")},null,8,["disabled"]),a.extraTab?(l(),w(s(V),{key:a.extraTab.key,tab:a.extraTab.name,disabled:M(a.extraTab.key)},null,8,["tab","disabled"])):b("",!0)]),_:1},8,["active-key"]),oe(i(he,{ref_key:"code",ref:d,script:a.stage,workspace:a.workspace,onUpdateFile:v,onSave:n[1]||(n[1]=A=>t("on-save"))},null,8,["script","workspace"]),[[ne,f.value==="source-code"]]),a.stage&&f.value==="settings"?S(a.$slots,"settings",{key:0}):b("",!0),a.stage&&f.value===((m=a.extraTab)==null?void 0:m.key)?S(a.$slots,(y=a.extraTab)==null?void 0:y.key,{key:1}):b("",!0)]}),center:u(()=>[i(s(D),{"active-key":k.value,"onUpdate:activeKey":n[2]||(n[2]=m=>k.value=m)},{rightExtra:u(()=>[S(a.$slots,"action-button")]),default:u(()=>{var m;return[i(s(V),{key:"test",tab:(m=a.testTabName)!=null?m:"Test"},null,8,["tab"]),i(s(V),{key:"tasks",tab:"Tasks"})]}),_:3},8,["active-key"]),a.stage&&k.value==="tasks"?(l(),w(ye,{key:0,ref:"tasksManager","stage-id":a.stage.id,onRefetchTasks:n[3]||(n[3]=m=>t("refetch-tasks"))},null,8,["stage-id"])):b("",!0),a.stage&&k.value==="test"?S(a.$slots,"test",{key:1}):b("",!0)]),right:u(()=>[i(fe,{"always-open":"","stage-editor-info":{stage:a.stage,workspace:a.workspace,logService:s(L)}},null,8,["stage-editor-info"])]),_:3})]),footer:u(()=>[i(nt,{ref_key:"terminalOutput",ref:r,stage:a.stage,workspace:a.workspace},null,8,["stage","workspace"])]),_:3}))}}),lt=$({__name:"PathInput",props:{runtime:{}},setup(c){const e=c,{cloudProject:t}=Se(),g=()=>{const o=Te(e.runtime.path);o&&o!==e.runtime.path&&(e.runtime.path=o)};return(o,d)=>(l(),w(s(re),{value:o.runtime.path,"onUpdate:value":d[0]||(d[0]=r=>o.runtime.path=r),type:"text",onBlur:g},le({_:2},[o.runtime instanceof s(be)?{name:"addonBefore",fn:u(()=>{var r,v;return[O(" https://"+z((v=(r=s(t))==null?void 0:r.subdomain)!=null?v:"your-project-domain")+".abstra.app/_hooks/ ",1)]}),key:"0"}:{name:"addonBefore",fn:u(()=>{var r,v;return[O(" https://"+z((v=(r=s(t))==null?void 0:r.subdomain)!=null?v:"your-project-domain")+".abstra.app/ ",1)]}),key:"1"}]),1032,["value"]))}}),rt={key:1},it=$({__name:"RuntimeCommonSettings",props:{runtime:{}},setup(c){const e=ie({pathError:null});return(t,g)=>(l(),h(G,null,[t.runtime instanceof s(ke)||t.runtime instanceof s(we)?b("",!0):(l(),w(s(ue),{key:0,label:"URL path"},{default:u(()=>[i(lt,{runtime:t.runtime},null,8,["runtime"])]),_:1})),e.pathError?(l(),h("div",rt,z(e.pathError),1)):b("",!0)],64))}});const Ct=N(it,[["__scopeId","data-v-18856675"]]);export{Ct as R,Ht as _};
//# sourceMappingURL=RuntimeCommonSettings.a7837bcc.js.map
