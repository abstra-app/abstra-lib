const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ImageViewer-BDY5NROt.js","assets/asyncComputed-BCer8oop.js","assets/jwt-decode.esm-BB_D8b27.js","assets/jwt-decode-D9e-DIPp.css","assets/string-BL-xaPAE.js","assets/PhArrowUp.vue-C85dPruj.js","assets/PhFolderPlus.vue-Bo1N5pNU.js","assets/PhWebhooksLogo.vue-C2cXqR6z.js","assets/AbstraButton.vue_vue_type_script_setup_true_lang-vW44dA3M.js","assets/ScrollArea.vue_vue_type_script_setup_true_lang-alBgsbu-.js","assets/index-Bwt0XPQG.js","assets/UploadOutlined-CH2DRgib.js","assets/router-m2y41l_X.js","assets/ts.worker-DbfLESpW.js","assets/index-Bsl2p9td.js","assets/xlsx-sIPcJk3-.js","assets/ImageViewer-BmhnRDlA.css"])))=>i.map(i=>d[i]);
import{_ as R}from"./DocsButton.vue_vue_type_script_setup_true_lang-2mZZUzzO.js";import{F as A,I as H,S as U,a as q}from"./ImageViewer-BDY5NROt.js";import{_ as W,a as L,ag as N,r as h,H as V,p as D,k as y,l as J,f as n,h as d,m as x,u as l,b4 as O,t as _,aK as M,N as $,w as m,g as I,i as F,ak as K,aN as G,E as S,Q,Z as X,b as C,e as Y,X as Z}from"./jwt-decode.esm-BB_D8b27.js";import"./router-m2y41l_X.js";import{F as P}from"./file-DnIoGb4K.js";import"./tables-QluWJUYt.js";import{e as B}from"./editor.main-C9Ym_LiN.js";import{G as ee}from"./PhFolderPlus.vue-Bo1N5pNU.js";import{T as te,A as E,C as ae}from"./index-BjXlHrln.js";import"./constants-DoEDLsr3.js";import"./asyncComputed-BCer8oop.js";import"./string-BL-xaPAE.js";import"./PhArrowUp.vue-C85dPruj.js";import"./PhWebhooksLogo.vue-C2cXqR6z.js";import"./AbstraButton.vue_vue_type_script_setup_true_lang-vW44dA3M.js";import"./ScrollArea.vue_vue_type_script_setup_true_lang-alBgsbu-.js";import"./index-Bwt0XPQG.js";import"./UploadOutlined-CH2DRgib.js";import"./index-Bsl2p9td.js";import"./xlsx-sIPcJk3-.js";import"./ts.worker-DbfLESpW.js";import"./record-tPUblyic.js";(function(){try{var p=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},e=new Error().stack;e&&(p._sentryDebugIds=p._sentryDebugIds||{},p._sentryDebugIds[e]="d76953cf-5299-42e8-b150-11ed10ca39dc",p._sentryDebugIdIdentifier="sentry-dbid-d76953cf-5299-42e8-b150-11ed10ca39dc")}catch{}})();class se{constructor(e){this.filesModel=e}async list(e){const i=await this.filesModel.list(e.limit||20,e.offset||0,e.search,e.path);return{items:i.items.map(r=>this.mapToFileItem(r)),totalCount:i.totalCount}}async upload(e,i,r){await this.filesModel.upload(e,i,r)}async delete(e){await this.filesModel.delete(e)}async download(e){return await this.filesModel.download(e)}async createFolder(e){await this.filesModel.createFolder(e)}async move(e,i){await this.filesModel.move(e,i)}async preview(e){const i=await this.filesModel.download(e),r=e.split("/").pop()||e,{FileTypeHelper:g}=await W(async()=>{const{FileTypeHelper:u}=await import("./ImageViewer-BDY5NROt.js").then(b=>b.f);return{FileTypeHelper:u}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16])),a=g.getMimeType(r);return{blob:new Blob([i],{type:a}),mimeType:a}}mapToFileItem(e){return{name:e.name,path:e.path,type:e.type,size:e.sizeBytes,_original:e}}}const oe={key:0,class:"loading-container"},le={key:1,class:"error-container"},ne={class:"error-message"},ie=L({__name:"ConsoleFileAdapter",props:{filePath:{},loadingText:{default:"Loading file..."}},setup(p){const e=p,r=N().params.projectId,g=h(!0),a=h(null),t=h(null),u=h(null),b=w=>{const f=w.toLowerCase().split(".").pop();return["txt","md","json","js","ts","jsx","tsx","py","html","css","scss","yaml","yml","xml","sql","sh","vue","csv"].includes(f||"")};return V(async()=>{try{const f=await P.fromProjectId(r).download(e.filePath);if(f.size<1e3){const T=await f.slice(0,f.size,f.type).text();if(T.includes("<!DOCTYPE")||T.includes("<html"))throw new Error("Downloaded file appears to be an HTML error page")}if(t.value=URL.createObjectURL(f),b(e.filePath)&&(u.value=await f.text(),e.filePath.toLowerCase().endsWith(".json")))try{const k=JSON.parse(u.value);u.value=JSON.stringify(k,null,2)}catch{}}catch(w){a.value=`Failed to load file: ${String(w)}`}finally{g.value=!1}}),D(()=>{t.value&&URL.revokeObjectURL(t.value)}),(w,f)=>g.value?(n(),y("div",oe,[d(l(O),{size:"large"}),x("p",null,_(p.loadingText),1)])):a.value?(n(),y("div",le,[x("p",ne,_(a.value),1)])):J(w.$slots,"default",{key:2,blobUrl:t.value,fileContent:u.value},void 0,!0)}}),re=M(ie,[["__scopeId","data-v-3ce1506a"]]),ce={key:0,class:"loading-container"},de={key:1,class:"error-container"},pe={class:"error-message"},ue=L({__name:"CodeViewer",props:{content:{},language:{default:"plaintext"},loadingText:{default:"Loading..."},readonly:{type:Boolean,default:!0}},setup(p){const e=p,i=h(!1),r=h(null),g=h();let a=null;return V(()=>{if(g.value)try{a=B.create(g.value,{value:e.content,language:e.language,readOnly:e.readonly,theme:"vs",automaticLayout:!0,minimap:{enabled:!1},scrollBeyondLastLine:!1,lineNumbers:"on",renderWhitespace:"selection",folding:!0,wordWrap:"on",quickSuggestions:!1,parameterHints:{enabled:!1},suggestOnTriggerCharacters:!1,acceptSuggestionOnCommitCharacter:!1,tabCompletion:"off",wordBasedSuggestions:!1})}catch(t){console.error("[CodeViewer] Failed to create editor:",t),r.value=`Failed to create editor: ${String(t)}`}}),$(()=>e.content,t=>{a&&t!==a.getValue()&&a.setValue(t)}),$(()=>e.language,t=>{if(a){const u=a.getModel();u&&B.setModelLanguage(u,t)}}),D(()=>{a?.dispose()}),(t,u)=>i.value?(n(),y("div",ce,[d(l(O),{size:"large"}),x("p",null,_(p.loadingText),1)])):r.value?(n(),y("div",de,[x("p",pe,_(r.value),1)])):(n(),y("div",{key:2,ref_key:"editorContainer",ref:g,class:"code-viewer-container"},null,512))}}),fe=M(ue,[["__scopeId","data-v-f3162ce8"]]),me={class:"files-container"},ge={class:"tab-content"},_e={key:1,class:"pdf-viewer-container"},ye=["data"],ve={class:"pdf-fallback"},he={key:1,class:"pdf-loading"},we=L({__name:"Files",setup(p){const i=N().params.projectId,r=P.fromProjectId(i),g=new se(r),a=h("all-files"),t=h([]);function u(o){const c=o.split("/").pop()||o,s=t.value.find(j=>j.path===o);if(s){a.value=s.key;return}const v={key:`file-${Date.now()}`,name:c,path:o};t.value.push(v),a.value=v.key}function b(o,c){if(c==="remove"&&typeof o=="string"){const s=t.value.findIndex(v=>v.key===o);s!==-1&&(t.value.splice(s,1),t.value.length>0?a.value=t.value[Math.max(0,s-1)].key:a.value="all-files")}}function w(o){return q.getFileIcon(o)}function f(o){const c=o.toLowerCase().split(".").pop();return["jpg","jpeg","png","gif","webp","svg","bmp","ico"].includes(c||"")}function k(o){return o.toLowerCase().split(".").pop()==="pdf"}function T(o){const c=o.toLowerCase().split(".").pop();return["xlsx","xls","csv"].includes(c||"")}function z(o){const c=o.toLowerCase().split(".").pop();return{json:"json",py:"python",js:"javascript",ts:"typescript",jsx:"javascript",tsx:"typescript",html:"html",css:"css",scss:"scss",md:"markdown",yaml:"yaml",yml:"yaml",xml:"xml",sql:"sql",sh:"shell",vue:"vue"}[c||""]||"plaintext"}return(o,c)=>(n(),y("div",me,[d(l(K),null,{default:m(()=>[I(_(l(F).translate("i18n_filesview_title")),1)]),_:1}),d(l(G),null,{default:m(()=>[I(_(l(F).translate("i18n_filesview_description"))+" ",1),d(R,{path:"tools/files"})]),_:1}),d(l(ae),{class:"files-card"},{default:m(()=>[d(l(te),{"active-key":a.value,"onUpdate:activeKey":c[0]||(c[0]=s=>a.value=s),"hide-add":"",type:"editable-card",size:"small",onEdit:b},{default:m(()=>[d(l(E),{key:"all-files",closable:!1},{tab:m(()=>[d(l(S),{align:"center",gap:"small"},{default:m(()=>[d(l(ee),{size:16}),x("span",null,_(l(F).translate("i18n_filesview_all_files")),1)]),_:1})]),default:m(()=>[d(A,{repository:l(g),"show-pagination":!0,"enable-preview":!1,"enable-move":!0,"on-open":u},null,8,["repository"])]),_:1}),(n(!0),y(Q,null,X(t.value,s=>(n(),C(l(E),{key:s.key,closable:!0},{tab:m(()=>[d(l(S),{align:"center",gap:"small"},{default:m(()=>[(n(),C(Z(w(s.name)),{size:16})),I(" "+_(s.name),1)]),_:2},1024)]),default:m(()=>[x("div",ge,[d(re,{"file-path":s.path},{default:m(({blobUrl:v,fileContent:j})=>[f(s.name)&&v?(n(),C(H,{key:0,src:v},null,8,["src"])):k(s.name)?(n(),y("div",_e,[v?(n(),y("object",{key:0,data:v,type:"application/pdf",class:"pdf-object"},[x("p",ve,_(l(F).translate("i18n_filesview_pdf_fallback")),1)],8,ye)):(n(),y("div",he,[x("p",null,_(l(F).translate("i18n_filesview_pdf_loading")),1)]))])):T(s.name)?(n(),C(U,{key:2,"file-path":s.path},null,8,["file-path"])):j?(n(),C(fe,{key:3,content:j,language:z(s.name)},null,8,["content","language"])):Y("",!0)]),_:2},1032,["file-path"])])]),_:2},1024))),128))]),_:1},8,["active-key"])]),_:1})]))}}),He=M(we,[["__scopeId","data-v-e1a51961"]]);export{He as default};
//# sourceMappingURL=Files-Z7IvEfIg.js.map
