var ue=Object.defineProperty;var de=(v,e,t)=>e in v?ue(v,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):v[e]=t;var N=(v,e,t)=>(de(v,typeof e!="symbol"?e+"":e,t),t);import{_ as pe}from"./DocsButton.vue_vue_type_script_setup_true_lang.61381525.js";import{_ as W}from"./AbstraButton.vue_vue_type_script_setup_true_lang.441fcdfd.js";import{d as P,am as x,c as T,o as s,a5 as y,a7 as le,h as I,e6 as se,e as A,r as K,M as D,w as ae,a as C,b as l,ec as R,u as a,cz as he,bJ as q,cR as ge,aR as M,cP as ve,g as k,ed as E,cv as ye,bM as fe,aB as me,cE as Ce,db as ke,f as i,da as Z,cy as be,de as V,d9 as B,cW as we,d4 as _e,ea as He,_ as ie,eb as Ve,L as te,cH as G,A as O,bP as Ae,bx as $e,bw as oe,eG as Ie,er as Se,es as Te}from"./jwt-decode.esm.7f2ef0df.js";import{G as Ue}from"./PhDotsThreeVertical.vue.0ea03d82.js";import{h as L,l as Me}from"./router.8fd5b2ad.js";import{U as je}from"./UploadOutlined.e3072945.js";import{_ as Ne}from"./AbstraLogo.vue_vue_type_script_setup_true_lang.3f03a3ef.js";import{L as Ze}from"./Logo.2de02c4a.js";import{G as Fe}from"./PhWebhooksLogo.vue.a704632d.js";import{A as ce}from"./index.03d222dd.js";import{C as re}from"./Card.1d1a9fb7.js";import{A as Ee}from"./index.23283fbb.js";import"./constants.56e8988f.js";import"./index.9021ba5d.js";(function(){try{var v=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},e=new Error().stack;e&&(v._sentryDebugIds=v._sentryDebugIds||{},v._sentryDebugIds[e]="91c17712-ab01-4fda-94e3-931cf8bbe9e9",v._sentryDebugIdIdentifier="sentry-dbid-91c17712-ab01-4fda-94e3-931cf8bbe9e9")}catch{}})();const Le=["width","height","fill","transform"],xe={key:0},ze=A("path",{d:"M216.49,184.49l-32,32a12,12,0,0,1-17-17L179,188H48a12,12,0,0,1,0-24H179l-11.52-11.51a12,12,0,0,1,17-17l32,32A12,12,0,0,1,216.49,184.49Zm-145-64a12,12,0,0,0,17-17L77,92H208a12,12,0,0,0,0-24H77L88.49,56.49a12,12,0,0,0-17-17l-32,32a12,12,0,0,0,0,17Z"},null,-1),Ke=[ze],Pe={key:1},Re=A("path",{d:"M208,80v96H48V80Z",opacity:"0.2"},null,-1),Be=A("path",{d:"M213.66,181.66l-32,32a8,8,0,0,1-11.32-11.32L188.69,184H48a8,8,0,0,1,0-16H188.69l-18.35-18.34a8,8,0,0,1,11.32-11.32l32,32A8,8,0,0,1,213.66,181.66Zm-139.32-64a8,8,0,0,0,11.32-11.32L67.31,88H208a8,8,0,0,0,0-16H67.31L85.66,53.66A8,8,0,0,0,74.34,42.34l-32,32a8,8,0,0,0,0,11.32Z"},null,-1),De=[Re,Be],qe={key:2},Ge=A("path",{d:"M42.34,85.66a8,8,0,0,1,0-11.32l32-32A8,8,0,0,1,88,48V72H208a8,8,0,0,1,0,16H88v24a8,8,0,0,1-13.66,5.66Zm171.32,84.68-32-32A8,8,0,0,0,168,144v24H48a8,8,0,0,0,0,16H168v24a8,8,0,0,0,13.66,5.66l32-32A8,8,0,0,0,213.66,170.34Z"},null,-1),Oe=[Ge],Je={key:3},We=A("path",{d:"M212.24,171.76a6,6,0,0,1,0,8.48l-32,32a6,6,0,0,1-8.48-8.48L193.51,182H48a6,6,0,0,1,0-12H193.51l-21.75-21.76a6,6,0,0,1,8.48-8.48ZM75.76,116.24a6,6,0,0,0,8.48-8.48L62.49,86H208a6,6,0,0,0,0-12H62.49L84.24,52.24a6,6,0,0,0-8.48-8.48l-32,32a6,6,0,0,0,0,8.48Z"},null,-1),Ye=[We],Qe={key:4},Xe=A("path",{d:"M213.66,181.66l-32,32a8,8,0,0,1-11.32-11.32L188.69,184H48a8,8,0,0,1,0-16H188.69l-18.35-18.34a8,8,0,0,1,11.32-11.32l32,32A8,8,0,0,1,213.66,181.66Zm-139.32-64a8,8,0,0,0,11.32-11.32L67.31,88H208a8,8,0,0,0,0-16H67.31L85.66,53.66A8,8,0,0,0,74.34,42.34l-32,32a8,8,0,0,0,0,11.32Z"},null,-1),en=[Xe],nn={key:5},an=A("path",{d:"M210.83,173.17a4,4,0,0,1,0,5.66l-32,32a4,4,0,0,1-5.66-5.66L198.34,180H48a4,4,0,0,1,0-8H198.34l-25.17-25.17a4,4,0,0,1,5.66-5.66ZM77.17,114.83a4,4,0,0,0,5.66-5.66L57.66,84H208a4,4,0,0,0,0-8H57.66L82.83,50.83a4,4,0,0,0-5.66-5.66l-32,32a4,4,0,0,0,0,5.66Z"},null,-1),tn=[an],on={name:"PhArrowsLeftRight"},ln=P({...on,props:{weight:{type:String},size:{type:[String,Number]},color:{type:String},mirrored:{type:Boolean}},setup(v){const e=v,t=x("weight","regular"),n=x("size","1em"),r=x("color","currentColor"),f=x("mirrored",!1),c=T(()=>{var g;return(g=e.weight)!=null?g:t}),b=T(()=>{var g;return(g=e.size)!=null?g:n}),S=T(()=>{var g;return(g=e.color)!=null?g:r}),U=T(()=>e.mirrored!==void 0?e.mirrored?"scale(-1, 1)":void 0:f?"scale(-1, 1)":void 0);return(g,d)=>(s(),y("svg",se({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256",width:b.value,height:b.value,fill:S.value,transform:U.value},g.$attrs),[le(g.$slots,"default"),c.value==="bold"?(s(),y("g",xe,Ke)):c.value==="duotone"?(s(),y("g",Pe,De)):c.value==="fill"?(s(),y("g",qe,Oe)):c.value==="light"?(s(),y("g",Je,Ye)):c.value==="regular"?(s(),y("g",Qe,en)):c.value==="thin"?(s(),y("g",nn,tn)):I("",!0)],16,Le))}}),sn=["width","height","fill","transform"],cn={key:0},rn=A("path",{d:"M224,64H180V56a28,28,0,0,0-28-28H104A28,28,0,0,0,76,56v8H32A20,20,0,0,0,12,84V192a20,20,0,0,0,20,20H224a20,20,0,0,0,20-20V84A20,20,0,0,0,224,64ZM100,56a4,4,0,0,1,4-4h48a4,4,0,0,1,4,4v8H100ZM220,88v32H196v-4a12,12,0,0,0-24,0v4H84v-4a12,12,0,0,0-24,0v4H36V88ZM36,188V144H60v4a12,12,0,0,0,24,0v-4h88v4a12,12,0,0,0,24,0v-4h24v44Z"},null,-1),un=[rn],dn={key:1},pn=A("path",{d:"M232,120v72a8,8,0,0,1-8,8H32a8,8,0,0,1-8-8V120Z",opacity:"0.2"},null,-1),hn=A("path",{d:"M224,64H176V56a24,24,0,0,0-24-24H104A24,24,0,0,0,80,56v8H32A16,16,0,0,0,16,80V192a16,16,0,0,0,16,16H224a16,16,0,0,0,16-16V80A16,16,0,0,0,224,64ZM96,56a8,8,0,0,1,8-8h48a8,8,0,0,1,8,8v8H96ZM32,80H224v32H192v-8a8,8,0,0,0-16,0v8H80v-8a8,8,0,0,0-16,0v8H32ZM224,192H32V128H64v8a8,8,0,0,0,16,0v-8h96v8a8,8,0,0,0,16,0v-8h32v64Z"},null,-1),gn=[pn,hn],vn={key:2},yn=A("path",{d:"M224,64H176V56a24,24,0,0,0-24-24H104A24,24,0,0,0,80,56v8H32A16,16,0,0,0,16,80v28a4,4,0,0,0,4,4H64V96.27A8.17,8.17,0,0,1,71.47,88,8,8,0,0,1,80,96v16h96V96.27A8.17,8.17,0,0,1,183.47,88,8,8,0,0,1,192,96v16h44a4,4,0,0,0,4-4V80A16,16,0,0,0,224,64Zm-64,0H96V56a8,8,0,0,1,8-8h48a8,8,0,0,1,8,8Zm80,68v60a16,16,0,0,1-16,16H32a16,16,0,0,1-16-16V132a4,4,0,0,1,4-4H64v16a8,8,0,0,0,8.53,8A8.17,8.17,0,0,0,80,143.73V128h96v16a8,8,0,0,0,8.53,8,8.17,8.17,0,0,0,7.47-8.25V128h44A4,4,0,0,1,240,132Z"},null,-1),fn=[yn],mn={key:3},Cn=A("path",{d:"M224,66H174V56a22,22,0,0,0-22-22H104A22,22,0,0,0,82,56V66H32A14,14,0,0,0,18,80V192a14,14,0,0,0,14,14H224a14,14,0,0,0,14-14V80A14,14,0,0,0,224,66ZM94,56a10,10,0,0,1,10-10h48a10,10,0,0,1,10,10V66H94ZM32,78H224a2,2,0,0,1,2,2v34H190V104a6,6,0,0,0-12,0v10H78V104a6,6,0,0,0-12,0v10H30V80A2,2,0,0,1,32,78ZM224,194H32a2,2,0,0,1-2-2V126H66v10a6,6,0,0,0,12,0V126H178v10a6,6,0,0,0,12,0V126h36v66A2,2,0,0,1,224,194Z"},null,-1),kn=[Cn],bn={key:4},wn=A("path",{d:"M224,64H176V56a24,24,0,0,0-24-24H104A24,24,0,0,0,80,56v8H32A16,16,0,0,0,16,80V192a16,16,0,0,0,16,16H224a16,16,0,0,0,16-16V80A16,16,0,0,0,224,64ZM96,56a8,8,0,0,1,8-8h48a8,8,0,0,1,8,8v8H96ZM224,80v32H192v-8a8,8,0,0,0-16,0v8H80v-8a8,8,0,0,0-16,0v8H32V80Zm0,112H32V128H64v8a8,8,0,0,0,16,0v-8h96v8a8,8,0,0,0,16,0v-8h32v64Z"},null,-1),_n=[wn],Hn={key:5},Vn=A("path",{d:"M224,68H172V56a20,20,0,0,0-20-20H104A20,20,0,0,0,84,56V68H32A12,12,0,0,0,20,80V192a12,12,0,0,0,12,12H224a12,12,0,0,0,12-12V80A12,12,0,0,0,224,68ZM92,56a12,12,0,0,1,12-12h48a12,12,0,0,1,12,12V68H92ZM32,76H224a4,4,0,0,1,4,4v36H188V104a4,4,0,0,0-8,0v12H76V104a4,4,0,0,0-8,0v12H28V80A4,4,0,0,1,32,76ZM224,196H32a4,4,0,0,1-4-4V124H68v12a4,4,0,0,0,8,0V124H180v12a4,4,0,0,0,8,0V124h40v68A4,4,0,0,1,224,196Z"},null,-1),An=[Vn],$n={name:"PhToolbox"},In=P({...$n,props:{weight:{type:String},size:{type:[String,Number]},color:{type:String},mirrored:{type:Boolean}},setup(v){const e=v,t=x("weight","regular"),n=x("size","1em"),r=x("color","currentColor"),f=x("mirrored",!1),c=T(()=>{var g;return(g=e.weight)!=null?g:t}),b=T(()=>{var g;return(g=e.size)!=null?g:n}),S=T(()=>{var g;return(g=e.color)!=null?g:r}),U=T(()=>e.mirrored!==void 0?e.mirrored?"scale(-1, 1)":void 0:f?"scale(-1, 1)":void 0);return(g,d)=>(s(),y("svg",se({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256",width:b.value,height:b.value,fill:S.value,transform:U.value},g.$attrs),[le(g.$slots,"default"),c.value==="bold"?(s(),y("g",cn,un)):c.value==="duotone"?(s(),y("g",dn,gn)):c.value==="fill"?(s(),y("g",vn,fn)):c.value==="light"?(s(),y("g",mn,kn)):c.value==="regular"?(s(),y("g",bn,_n)):c.value==="thin"?(s(),y("g",Hn,An)):I("",!0)],16,sn))}});class Sn{async generateEcdsaKey(e){const{projectId:t,connectionName:n,connectorType:r}=e;return L.post(`projects/${t}/connectors/${r}/connections/${n}/ecdsa-key`,{})}async createEcdsaConnection(e){const{projectId:t,connectionName:n,connectorType:r,publicKey:f,privateKey:c,accessId:b}=e;return L.post(`projects/${t}/connectors/${r}/connections/${n}/create-ecdsa`,{publicKey:f,privateKey:c,accessId:b})}async getLoginUrl(e,t,n,r,f){return L.get(`projects/${e}/connectors/${n}/connections/${t}/login-url`,{scopeIds:r.join(","),...f})}async listConnectors(e){return L.get(`projects/${e}/connectors`)}async createTokenConnection(e){const{projectId:t,connectionName:n,connectorType:r,tokens:f}=e,c={type:"tokens",tokens:f};return L.post(`projects/${t}/connectors/${r}/connections/${n}`,c)}async listConnections(e){return L.get(`projects/${e}/connections`)}async deleteConnection(e){const{projectId:t,connectionName:n,connectorType:r}=e;return L.delete(`projects/${t}/connectors/${r}/connections/${n}`)}async renameConnection(e){const{projectId:t,connectionName:n,connectorType:r,newConnectionName:f}=e;return L.patch(`projects/${t}/connectors/${r}/connections/${n}`,{newConnectionName:f})}}class Tn{constructor(e,t){N(this,"state");N(this,"hasChanges",T(()=>!!this.state.value.editingConnection&&this.state.value.editingConnection.name!==this.state.value.editingConnection.newName));N(this,"handleDeletionClick",async e=>{D.confirm({title:"Delete connection",content:"Are you sure you want to delete this connection?",onOk:()=>this.handleDeleteConnection(e)})});N(this,"handleDeleteConnection",async e=>{await this.api.deleteConnection({projectId:this.projectId,connectionName:e.name,connectorType:e.connectorType}),this.state.value.editingConnection=null,await this.refetchConnections()});N(this,"handleAddConnectionSubmit",async()=>{var f,c,b,S;const e=(f=this.state.value.addingConnection)==null?void 0:f.connector.metadata.key,t=(c=this.state.value.addingConnection)==null?void 0:c.selectedScopeIds,n=(S=(b=this.state.value.addingConnection)==null?void 0:b.tokenValues)!=null?S:{};if(!e||!t)throw new Error("No connector or scope selected");const{url:r}=await this.getLoginUrl(e,this.getUniqueName(e),t,n);window.location.href=r});N(this,"handleAddTokenConnectionSubmit",async()=>{const e=this.state.value.addingConnection;if(!e)throw new Error("No connection is being added");const t=e.connector.metadata.key,n=this.getUniqueName(t);await this.api.createTokenConnection({projectId:this.projectId,connectionName:n,connectorType:t,tokens:e.tokenValues}),this.state.value.addingConnection=null,await this.refetchConnections()});N(this,"handleAddEcdsaConnectionSubmit",async(e,t)=>{const n=this.state.value.addingConnection;if(!n||!e||!t)throw new Error("No connection is being added, public key or project ID is missing");if(!n.connectionName||!n.ecdsaKeys)throw new Error("Keys or connection name not found");await this.api.createEcdsaConnection({projectId:this.projectId,connectionName:n.connectionName,connectorType:n.connector.metadata.key,publicKey:n.ecdsaKeys.publicKey,privateKey:n.ecdsaKeys.privateKey,accessId:t}),this.state.value.addingConnection=null,await this.refetchConnections()});N(this,"renameConnection",async()=>{const{editingConnection:e}=this.state.value;if(!e)throw new Error("No connection is being edited");const t=async()=>{await this.api.renameConnection({projectId:this.projectId,connectionName:e.name,connectorType:e.connectorType,newConnectionName:e.newName}),await this.refetchConnections(),this.state.value.editingConnection=null};D.confirm({title:"Rename connection",content:"Are you sure you want to rename this connection? This will break any existing references to the old name.",onOk:t})});N(this,"showAddConfirmationModal",e=>{this.state.value.addingConnection={selectedScopeIds:e.auth.type==="oauth2"?e.auth.scopes.map(t=>t.key):[],connector:e,tokenValues:{}}});N(this,"handleScopeToggle",(e,t)=>{t?this.state.value.addingConnection.selectedScopeIds.push(e):this.state.value.addingConnection.selectedScopeIds=this.state.value.addingConnection.selectedScopeIds.filter(n=>n!==e)});this.projectId=e,this.api=t,this.state=K({connectors:[],connections:[],addingConnection:null,editingConnection:null})}async fetchConnectors(){this.state.value.connectors=await this.api.listConnectors(this.projectId)}async fetchInitialState(){await this.fetchConnectors(),await this.refetchConnections()}async refetchConnections(){const e=await this.api.listConnections(this.projectId);this.state.value.connections=e.map(t=>{const n=this.state.value.connectors.find(r=>r.metadata.key===t.connectionType);return n?{name:t.name,connectorTitle:n.metadata.label,connectorType:t.connectionType,icon:n.metadata.logoUrl}:null}).filter(t=>t!==null)}handleEditConnectionClick(e){this.state.value.editingConnection={...e,newName:e.name}}async getLoginUrl(e,t,n,r){return this.api.getLoginUrl(this.projectId,t,e,n,r)}slugify(e){return e.toString().toLowerCase().replace(/\s+/g,"-").replace(/[^\w-]+/g,"").replace(/--+/g,"-")}getUniqueName(e){const t=this.state.value.connections.filter(n=>n.connectorType===e).length;return t===0?e:`${e}-${t}`}async generateEcdsaKey(){const e=this.state.value.addingConnection;if(!e)throw new Error("No connection is being added");const t=e.connector.metadata.key,n=this.getUniqueName(t),r=await this.api.generateEcdsaKey({projectId:this.projectId,connectionName:n,connectorType:t});return this.state.value.addingConnection&&(this.state.value.addingConnection.connectionName=n,this.state.value.addingConnection.ecdsaKeys=r),r.publicKey}}function Un(v){return new Promise((e,t)=>{const n=new FileReader;n.onload=()=>{const f=n.result.split(",")[1];e(f)},n.onerror=()=>t(n.error),n.readAsDataURL(v)})}const Mn={key:6,style:{"margin-top":"16px"}},J=P({__name:"AuthFormFields",props:{tokens:{},tokenValues:{},uploadedFiles:{default:()=>({})}},emits:["update:tokenValues","update:uploadedFiles","tokenChange"],setup(v,{emit:e}){const t=v,n=K(t.uploadedFiles||{});function r(u){const h=c.value[u];return h?h.split(",").map(o=>o.trim()):[]}function f(u,h){Array.isArray(h)?b(u,h.join(",")):console.error("Expected array for checkbox/select value")}const c=K({...t.tokenValues});ae(()=>t.tokenValues,u=>{c.value={...u}},{deep:!0}),ae(()=>t.uploadedFiles,u=>{n.value=u||{}},{deep:!0});function b(u,h){c.value[u]=h;const o={...c.value};e("update:tokenValues",o),e("tokenChange")}function S(u){var o,H;const h=[];return u.key&&h.push({required:!0,message:`${u.label||u.key} is required`}),(o=u.input)!=null&&o.minSize&&h.push({min:u.input.minSize,message:`Minimum length is ${u.input.minSize}`}),(H=u.input)!=null&&H.maxSize&&h.push({max:u.input.maxSize,message:`Maximum length is ${u.input.maxSize}`}),h}async function U(u,h){try{const o=await Un(u),H={...n.value,[h]:{file:u,base64:o}};n.value=H,e("update:uploadedFiles",H),c.value[h]=o;const p={...c.value};e("update:tokenValues",p),e("tokenChange")}catch(o){console.error("Error converting file to base64:",o)}return!1}function g(u){const h={...n.value};delete h[u],n.value=h,e("update:uploadedFiles",h),c.value[u]="";const o={...c.value};e("update:tokenValues",o),e("tokenChange")}function d(u){const h=n.value[u];return h?[{uid:u,name:h.file.name,status:"done",size:h.file.size}]:[]}return(u,h)=>(s(),C(a(be),{model:c.value,layout:"vertical"},{default:l(()=>[(s(!0),y(M,null,R(u.tokens,o=>(s(),C(a(he),{key:o.key,label:o.label,name:o.key,rules:S(o)},{default:l(()=>{var H,p,_,j,m,$,z,F,Y,Q,X,ee,ne;return[((H=o.input)==null?void 0:H.type)==="small-string"?(s(),C(a(q),{key:0,value:c.value[o.key],"onUpdate:value":w=>c.value[o.key]=w,placeholder:o.description,maxlength:(p=o.input)==null?void 0:p.maxSize,minlength:(_=o.input)==null?void 0:_.minSize,type:"password",onInput:()=>b(o.key,c.value[o.key]||"")},null,8,["value","onUpdate:value","placeholder","maxlength","minlength","onInput"])):((j=o.input)==null?void 0:j.type)==="radiobox"?(s(),C(a(ge),{key:1,value:c.value[o.key],"onUpdate:value":w=>c.value[o.key]=w,onChange:()=>b(o.key,c.value[o.key]||"")},{default:l(()=>[(s(!0),y(M,null,R(o.input.options,w=>(s(),C(a(ve),{key:w.value,value:w.value},{default:l(()=>[k(E(w.label),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onUpdate:value","onChange"])):((m=o.input)==null?void 0:m.type)==="checkbox"?(s(),y(M,{key:2},[((F=(z=($=o.input)==null?void 0:$.options)==null?void 0:z.length)!=null?F:0)<=10?(s(),C(a(ye),{key:0,value:r(o.key),onChange:w=>f(o.key,w)},{default:l(()=>[(s(!0),y(M,null,R(o.input.options,w=>(s(),C(a(fe),{key:w.value,value:w.value},{default:l(()=>[k(E(w.label),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onChange"])):(s(),C(a(me),{key:1,mode:"multiple",style:{width:"100%"},value:r(o.key),options:(Y=o.input.options)!=null?Y:[],onChange:w=>f(o.key,w)},null,8,["value","options","onChange"]))],64)):((Q=o.input)==null?void 0:Q.type)==="large-text"?(s(),C(a(Ce),{key:3,value:c.value[o.key],"onUpdate:value":w=>c.value[o.key]=w,placeholder:o.description,maxlength:(X=o.input)==null?void 0:X.maxSize,minlength:(ee=o.input)==null?void 0:ee.minSize,rows:4,onInput:()=>b(o.key,c.value[o.key]||"")},null,8,["value","onUpdate:value","placeholder","maxlength","minlength","onInput"])):((ne=o.input)==null?void 0:ne.type)==="file"?(s(),C(a(ke),{key:4,"file-list":d(o.key),"before-upload":w=>U(w,o.key),"max-count":1,"show-upload-list":!0,onRemove:()=>g(o.key)},{default:l(()=>[i(W,null,{default:l(()=>[i(a(je)),k(" Upload File ")]),_:1})]),_:2},1032,["file-list","before-upload","onRemove"])):(s(),C(a(q),{key:5,value:c.value[o.key],"onUpdate:value":w=>c.value[o.key]=w,placeholder:o.description,type:"password",onInput:()=>b(o.key,c.value[o.key]||"")},null,8,["value","onUpdate:value","placeholder","onInput"])),o.instructions?(s(),y("div",Mn,[i(a(Z),{type:"secondary",style:{"white-space":"pre-line","font-size":"14px"}},{default:l(()=>[k(E(o.instructions),1)]),_:2},1024)])):I("",!0),o.description&&!o.instructions?(s(),C(a(Z),{key:7,type:"secondary",style:{display:"block","font-size":"12px","margin-top":"8px"}},{default:l(()=>[k(E(o.description),1)]),_:2},1024)):I("",!0)]}),_:2},1032,["label","name","rules"]))),128))]),_:1},8,["model"]))}}),jn=P({__name:"ConnectionHeader",props:{connectorLogoUrl:{},connectorLabel:{}},setup(v){return(e,t)=>(s(),C(a(V),{justify:"center",align:"center",gap:20,style:{"margin-bottom":"24px",padding:"20px 0"}},{default:l(()=>[i(Ne,{"hide-text":"",size:"large"}),i(a(ln),{size:24}),i(Ze,{"image-url":e.connectorLogoUrl,"brand-name":e.connectorLabel,size:"medium","hide-text":""},null,8,["image-url","brand-name"])]),_:1}))}}),Nn=P({__name:"ConnectionModal",props:{addingConnection:{},ecdsaPublicKey:{},ecdsaKeyLoading:{type:Boolean},uploadedFiles:{},loading:{type:Boolean}},emits:["cancel","submit","scope-toggle","generate-ecdsa-key","update:token-values","update:uploaded-files","token-change"],setup(v,{emit:e}){const t=v,n=T(()=>{var u,h,o;switch((u=t.addingConnection)==null?void 0:u.connector.auth.type){case"oauth2":return"Authorize";case"tokens":return"Create Connection";case"ecdsa":{if(!t.ecdsaPublicKey)return"OK";const H=((h=t.addingConnection)==null?void 0:h.connector.auth.params)||[],p=((o=t.addingConnection)==null?void 0:o.tokenValues)||{};return H.every(j=>p[j.key]&&p[j.key].trim().length>0)?"Create Connection":"Create Connection (Required fields missing)"}default:return"OK"}});function r(){e("cancel")}function f(){e("submit")}function c(d,u){e("scope-toggle",d,u)}function b(){e("generate-ecdsa-key")}function S(d){e("update:token-values",d)}function U(d){e("update:uploaded-files",d)}function g(){e("token-change")}return(d,u)=>{var h;return s(),C(a(D),{open:!!d.addingConnection,title:`Add ${(h=d.addingConnection)==null?void 0:h.connector.metadata.label} Connection`,"ok-text":n.value,"ok-button-props":{disabled:n.value.includes("Required")},"confirm-loading":d.loading,"wrap-class-name":"full-modal",onCancel:r,onOk:f},{default:l(()=>[d.addingConnection?(s(),y(M,{key:0},[i(jn,{"connector-logo-url":d.addingConnection.connector.metadata.logoUrl,"connector-label":d.addingConnection.connector.metadata.label},null,8,["connector-logo-url","connector-label"]),d.addingConnection.connector.auth.type==="oauth2"?(s(),y(M,{key:0},[i(a(B),null,{default:l(()=>[k(" Please select the scopes you want to authorize for this connection. You can change these later by deleting and re-adding the connection. ")]),_:1}),i(a(V),{vertical:"",gap:"10",style:{margin:"30px 0px"}},{default:l(()=>{var o;return[(s(!0),y(M,null,R(d.addingConnection.connector.auth.scopes,H=>(s(),C(a(V),{key:H.key,justify:"space-between",align:"center"},{default:l(()=>[i(a(V),{vertical:""},{default:l(()=>[i(a(Z),null,{default:l(()=>[k(E(H.description),1)]),_:2},1024),i(a(Z),{type:"secondary"},{default:l(()=>[k(E(H.key),1)]),_:2},1024)]),_:2},1024),i(a(we),{checked:d.addingConnection.selectedScopeIds.includes(H.key),onChange:p=>c(H.key,p)},null,8,["checked","onChange"])]),_:2},1024))),128)),(o=d.addingConnection.connector.auth.params)!=null&&o.length?(s(),C(J,{key:0,tokens:d.addingConnection.connector.auth.params,"token-values":d.addingConnection.tokenValues,"uploaded-files":d.uploadedFiles,"onUpdate:tokenValues":S,"onUpdate:uploadedFiles":U,onTokenChange:g},null,8,["tokens","token-values","uploaded-files"])):I("",!0)]}),_:1})],64)):I("",!0),d.addingConnection.connector.auth.type==="tokens"?(s(),y(M,{key:1},[i(a(B),null,{default:l(()=>[k(" Please provide the required tokens/credentials for this connection. ")]),_:1}),i(J,{tokens:d.addingConnection.connector.auth.tokens,"token-values":d.addingConnection.tokenValues,"uploaded-files":d.uploadedFiles,"onUpdate:tokenValues":S,"onUpdate:uploadedFiles":U,onTokenChange:g},null,8,["tokens","token-values","uploaded-files"])],64)):I("",!0),d.addingConnection.connector.auth.type==="ecdsa"?(s(),y(M,{key:2},[d.ecdsaPublicKey?(s(),C(a(V),{key:1,vertical:"",gap:"16"},{default:l(()=>[i(a(Z),{strong:""},{default:l(()=>[k("Chaves geradas! Agora siga os pr\xF3ximos passos:")]),_:1}),i(a(Z),{strong:""},{default:l(()=>[k("1. Copie sua chave p\xFAblica:")]),_:1}),i(a(q),{value:d.ecdsaPublicKey,readonly:"",copyable:"",code:""},null,8,["value"]),i(J,{tokens:d.addingConnection.connector.auth.params,"token-values":d.addingConnection.tokenValues,"uploaded-files":d.uploadedFiles,"onUpdate:tokenValues":S,"onUpdate:uploadedFiles":U,onTokenChange:g},null,8,["tokens","token-values","uploaded-files"])]),_:1})):(s(),y(M,{key:0},[i(a(B),null,{default:l(()=>[k(" Primeiro vamos gerar um par de chaves ECDSA para estabelecer a conex\xE3o segura. ")]),_:1}),i(a(V),{vertical:"",gap:"16"},{default:l(()=>[i(W,{loading:d.ecdsaKeyLoading,onClick:b},{default:l(()=>[k(" Gerar chaves ECDSA ")]),_:1},8,["loading"])]),_:1})],64))],64)):I("",!0)],64)):I("",!0)]),_:1},8,["open","title","ok-text","ok-button-props","confirm-loading"])}}}),Zn=P({__name:"ConnectorCard",props:{title:{},logoUrl:{},description:{},unavailable:{type:Boolean},connector:{}},setup(v){const e=v,t=T(()=>{var r;return((r=e.connector)==null?void 0:r.triggers)&&e.connector.triggers.length>0}),n=T(()=>{var r;return((r=e.connector)==null?void 0:r.actions)&&e.connector.actions.length>0});return(r,f)=>(s(),C(a(re),{class:He({"connector-card":!0,unavailable:r.unavailable})},{default:l(()=>[i(a(V),{style:{width:"100%"},vertical:"",gap:12},{default:l(()=>[i(a(V),{justify:"space-between"},{default:l(()=>[i(a(ce),{src:r.logoUrl,shape:"square",size:"large"},null,8,["src"]),i(a(V),{gap:8},{default:l(()=>[t.value?(s(),C(a(Fe),{key:0,size:16})):I("",!0),n.value?(s(),C(a(In),{key:1,size:16})):I("",!0),r.unavailable?(s(),C(a(_e),{key:2,style:{height:"fit-content"}},{default:l(()=>[k("Talk to us")]),_:1})):I("",!0)]),_:1})]),_:1}),i(a(V),{vertical:""},{default:l(()=>[i(a(Z),{strong:""},{default:l(()=>[k(E(r.title),1)]),_:1}),i(a(Z),{type:"secondary"},{default:l(()=>[k(E(r.description),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["class"]))}});const Fn=ie(Zn,[["__scopeId","data-v-f5866f99"]]),En=v=>(Se("data-v-1b384acc"),v=v(),Te(),v),Ln=En(()=>A("div",{style:{"flex-grow":"1"}},null,-1)),xn={class:"connectors-grid"},zn=P({__name:"ConnectorsView",setup(v){const t=Ve().params.projectId,n=new Tn(t,new Sn),r=K(null),f=K(!1),c=K({}),b=K(!1),S=T(()=>[...n.state.value.connectors.filter(p=>p.auth.type==="oauth2"),...n.state.value.connectors.filter(p=>p.auth.type==="tokens"),...n.state.value.connectors.filter(p=>p.auth.type==="ecdsa"),...n.state.value.connectors.filter(p=>p.auth.type==="manual")]),U=T(()=>n.state.value.connections.filter(p=>p&&p.name&&p.connectorTitle&&p.connectorType));n.fetchInitialState();function g(p){n.state.value.addingConnection&&(n.state.value.addingConnection.tokenValues=p)}function d(p){c.value=p}function u(){r.value=null,f.value=!1,c.value={}}async function h(){f.value=!0;try{const _=(await n.generateEcdsaKey()).replace("-----BEGIN PUBLIC KEY-----","").replace("-----END PUBLIC KEY-----","").replace(/\s/g,"");r.value=_}finally{f.value=!1}}async function o(){var _,j,m;const p=(_=n.state.value.addingConnection)==null?void 0:_.connector.auth.type;b.value=!0;try{switch(p){case"oauth2":return await n.handleAddConnectionSubmit();case"tokens":return await n.handleAddTokenConnectionSubmit();case"ecdsa":{const $=((j=n.state.value.addingConnection)==null?void 0:j.tokenValues)||{};let z="";((m=n.state.value.addingConnection)==null?void 0:m.connector.metadata.key)==="starkbank"&&(z=$.projectId||"");const F=await n.handleAddEcdsaConnectionSubmit(r.value,z);return u(),F}default:break}}catch($){const z=F=>{try{return JSON.parse(F),!0}catch{return!1}};if($ instanceof Error&&z($.message)){const F=te.object({error:te.string()}).safeParse(JSON.parse($.message));if(F.success){G.error(F.data.error);return}else{G.error(`Failed to create connector: ${$ instanceof Error?$.message:"Unknown error"}`);return}}else G.error("Failed to create connector")}finally{b.value=!1}}function H(p){p.auth.type==="manual"?Me.showNewMessage(Ie.translate("i18n_connectors_ask_for_access",null,p.metadata.label)):n.showAddConfirmationModal(p)}return(p,_)=>{var j;return s(),y(M,null,[i(a(Ee),{direction:"vertical",style:{width:"100%","margin-bottom":"30px"}},{default:l(()=>[i(a(V),{align:"center",justify:"space-between"},{default:l(()=>[i(a(O),null,{default:l(()=>[k("Connectors")]),_:1})]),_:1}),i(a(B),null,{default:l(()=>[k(" Add and manage external integrations to your project. "),i(pe)]),_:1}),U.value.length?(s(),C(a(V),{key:0,vertical:""},{default:l(()=>[i(a(O),{level:2},{default:l(()=>[k("Installed")]),_:1}),i(a(V),{vertical:"",gap:10},{default:l(()=>[(s(!0),y(M,null,R(U.value,m=>(s(),C(a(re),{key:m.name},{default:l(()=>[i(a(V),{align:"center",gap:20},{default:l(()=>[i(a(ce),{src:m.icon,height:"40px",shape:"square"},null,8,["src"]),i(a(Z),{strong:""},{default:l(()=>[k(E(m.connectorTitle),1)]),_:2},1024),Ln,i(a(Z),{content:m.name,copyable:"",code:""},null,8,["content"]),i(a(Ae),null,{overlay:l(()=>[i(a($e),null,{default:l(()=>[i(a(oe),{onClick:$=>a(n).handleEditConnectionClick(m)},{default:l(()=>[k(" Rename ")]),_:2},1032,["onClick"]),i(a(oe),{danger:"",onClick:$=>a(n).handleDeletionClick(m)},{default:l(()=>[k(" Delete ")]),_:2},1032,["onClick"])]),_:2},1024)]),default:l(()=>[i(a(Ue))]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})):I("",!0),i(a(V),{vertical:""},{default:l(()=>[U.value.length?(s(),C(a(O),{key:0,level:2},{default:l(()=>[k("Available")]),_:1})):I("",!0),A("div",xn,[(s(!0),y(M,null,R(S.value,m=>(s(),C(Fn,{key:m.metadata.key,title:m.metadata.label,"logo-url":m.metadata.logoUrl,description:m.metadata.description,unavailable:m.auth.type==="manual",connector:m,onClick:$=>H(m)},null,8,["title","logo-url","description","unavailable","connector","onClick"]))),128))])]),_:1})]),_:1}),i(a(D),{open:!!a(n).state.value.editingConnection,title:`${(j=a(n).state.value.editingConnection)==null?void 0:j.connectorTitle} Connection`,onCancel:_[2]||(_[2]=m=>a(n).state.value.editingConnection=null)},{footer:l(()=>[i(a(V),{justify:"end"},{default:l(()=>[i(W,{disabled:!a(n).hasChanges.value,onClick:_[1]||(_[1]=m=>a(n).renameConnection())},{default:l(()=>[k(" Save ")]),_:1},8,["disabled"])]),_:1})]),default:l(()=>[a(n).state.value.editingConnection?(s(),C(a(q),{key:0,value:a(n).state.value.editingConnection.newName,"onUpdate:value":_[0]||(_[0]=m=>a(n).state.value.editingConnection.newName=m)},null,8,["value"])):I("",!0)]),_:1},8,["open","title"]),i(Nn,{"adding-connection":a(n).state.value.addingConnection,"ecdsa-public-key":r.value,"ecdsa-key-loading":f.value,"uploaded-files":c.value,loading:b.value,onCancel:_[3]||(_[3]=()=>{a(n).state.value.addingConnection=null,u()}),onSubmit:o,onScopeToggle:_[4]||(_[4]=(m,$)=>a(n).handleScopeToggle(m,$)),onGenerateEcdsaKey:h,"onUpdate:tokenValues":g,"onUpdate:uploadedFiles":d},null,8,["adding-connection","ecdsa-public-key","ecdsa-key-loading","uploaded-files","loading"])],64)}}});const aa=ie(zn,[["__scopeId","data-v-1b384acc"]]);export{aa as default};
//# sourceMappingURL=ConnectorsView.b428e487.js.map
