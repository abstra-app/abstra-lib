import{B as L,a as U,g as Y,r as Q}from"./router.ef7a08cf.js";import{_ as G}from"./DocsButton.vue_vue_type_script_setup_true_lang.e6d1d3ad.js";import{i as J}from"./url.4aa6f272.js";import{G as W}from"./PhDotsThreeVertical.vue.b3fda5f6.js";import{d as O,i as D,al as q,r as N,a as i,b as a,u as n,cQ as H,o as s,f as d,ac as A,ej as T,cE as X,bQ as Z,cJ as K,aI as ee,aY as B,cY as te,g as y,t as f,h as b,cD as le,M as ae,c as ne,j as se,dj as F,A as oe,ae as x,de as j,bY as re,d0 as ue,ad as ie,df as C,d9 as E,bW as pe,bE as ce,bD as de,cS as P,e as ye,el as R,S as fe,_ as me}from"./jwt-decode.esm.4071145e.js";import{A as z}from"./index.c25fb6e2.js";(function(){try{var g=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},m=new Error().stack;m&&(g._sentryDebugIds=g._sentryDebugIds||{},g._sentryDebugIds[m]="9546f5bf-0b0e-4c28-8dd7-4ab067bf48e5",g._sentryDebugIdIdentifier="sentry-dbid-9546f5bf-0b0e-4c28-8dd7-4ab067bf48e5")}catch{}})();const ve=O({__name:"CreationModal",props:{entityName:{},fields:{},create:{type:Function}},setup(g,{expose:m}){const _=g,I=D.translate("i18n_creationmodal_title",null,{entityName:_.entityName}),c=q({inputValue:{}}),w=N(!1),k=()=>w.value=!0,V=()=>{w.value=!1,c.inputValue={}},S=async()=>{try{await _.create(c.inputValue),V()}catch(p){p instanceof Error&&H.error({message:D.translate("i18n_creationmodal_failed_to_create"),description:p.message})}},t=(p,r)=>{const e=p.target.value,l=_.fields.find(o=>o.key===r);l!=null&&l.format?c.inputValue[r]=l.format(e):c.inputValue[r]=e},v=(p,r)=>{const e=p.target.value,l=_.fields.find(o=>o.key===r);l!=null&&l.blur?c.inputValue[r]=l.blur(e):c.inputValue[r]=e};return m({open:k,close:V}),(p,r)=>(s(),i(n(ae),{open:w.value,title:n(I),onCancel:V,onOk:S},{default:a(()=>[d(n(le),{layout:"vertical"},{default:a(()=>[(s(!0),A(B,null,T(p.fields,e=>{var l;return s(),i(n(X),{key:e.key,label:e.label,help:(l=e.hint)==null?void 0:l.call(e,c.inputValue[e.key]),tooltip:e.tooltip},{default:a(()=>{var o,h,$,M;return[!e.type||e.type==="text"||e.type==="password"?(s(),i(n(Z),{key:0,value:c.inputValue[e.key],"onUpdate:value":u=>c.inputValue[e.key]=u,placeholder:(o=e.placeholder)!=null?o:"",type:(h=e.type)!=null?h:"text",onInput:u=>t(u,e.key),onBlur:u=>v(u,e.key)},null,8,["value","onUpdate:value","placeholder","type","onInput","onBlur"])):e.type==="multiline-text"?(s(),i(n(K),{key:1,value:c.inputValue[e.key],"onUpdate:value":u=>c.inputValue[e.key]=u,placeholder:($=e.placeholder)!=null?$:"",onInput:u=>t(u,e.key),onBlur:u=>v(u,e.key)},null,8,["value","onUpdate:value","placeholder","onInput","onBlur"])):e.type==="select"?(s(),i(n(ee),{key:2,value:c.inputValue[e.key],"onUpdate:value":u=>c.inputValue[e.key]=u,mode:e.mode,"show-search":!0,"option-filter-prop":"label",placeholder:(M=e.placeholder)!=null?M:"Select options..."},{default:a(()=>[(s(!0),A(B,null,T(e.options,u=>(s(),i(n(te),{key:typeof u=="string"?u:u.value,value:typeof u=="string"?u:u.value,label:typeof u=="string"?u:u.label},{default:a(()=>[y(f(typeof u=="string"?u:u.label),1)]),_:2},1032,["value","label"]))),128))]),_:2},1032,["value","onUpdate:value","mode","placeholder"])):b("",!0)]}),_:2},1032,["label","help","tooltip"])}),128))]),_:1})]),_:1},8,["open","title"]))}}),be={class:"action-warning"},ge=O({__name:"CrudView",props:{table:{},loading:{type:Boolean},title:{},emptyTitle:{},entityName:{},description:{},create:{type:Function},createButtonText:{},docsPath:{},live:{type:Boolean},fields:{}},setup(g){const m=g,_=N(null),I=(t,v)=>{var r;const p=(r=m.table.rows[0])==null?void 0:r.cells[v].type;if(!(p==="actions"||p==="slot"))return(e,l)=>c(e,l,v)},c=(t,v,p)=>{const r=t.cells[p],e=v.cells[p];return r.type==="text"&&e.type==="text"||r.type==="tag"&&e.type==="tag"?r.text.localeCompare(e.text):r.type==="tags"&&e.type==="tags"?r.tags[0].text.localeCompare(e.tags[0].text):r.type==="secret"&&e.type==="secret"||r.type==="link"&&e.type==="link"?r.text.localeCompare(e.text):(r.type==="actions"&&e.type==="actions",0)},w=async()=>{var t;m.fields?(t=_.value)==null||t.open():m.create&&await m.create({})},k=N(!1);async function V(t,v){if(!k.value){k.value=!0;try{"onClick"in t?await t.onClick({key:v.key}):"link"in t&&(typeof t.link=="string"&&J(t.link)?open(t.link,"_blank"):Q.push(t.link))}finally{k.value=!1}}}const S=ne(()=>({"--columnCount":`${m.table.columns.length}`}));return(t,v)=>{const p=se("RouterLink");return s(),A(B,null,[d(n(z),{direction:"vertical",class:"crud-view"},{default:a(()=>{var r;return[d(n(F),{align:"center",justify:"space-between"},{default:a(()=>[t.title?(s(),i(n(oe),{key:0},{default:a(()=>[y(f(t.title),1)]),_:1})):b("",!0),x(t.$slots,"more",{},void 0,!0)]),_:3}),t.description?(s(),i(n(j),{key:0},{default:a(()=>[y(f(t.description)+" ",1),x(t.$slots,"description",{},void 0,!0),t.docsPath?(s(),i(G,{key:0,path:t.docsPath},null,8,["path"])):b("",!0)]),_:3})):b("",!0),d(n(F),{gap:"middle"},{default:a(()=>[t.createButtonText?(s(),i(n(re),{key:0,type:"primary",onClick:w},{default:a(()=>[y(f(t.createButtonText),1)]),_:1})):b("",!0),x(t.$slots,"secondary",{},void 0,!0)]),_:3}),x(t.$slots,"extra",{},void 0,!0),d(n(ue),{"filter-dropdown":!0,size:"small",style:ie(S.value),"data-source":t.table.rows,loading:k.value||t.loading&&!t.live,height:400,columns:(r=t.table.columns)==null?void 0:r.map((e,l)=>{var o;return{...e,key:l,filtered:!0,align:(o=e.align)!=null?o:"center",sorter:I(e,l)}})},{emptyText:a(()=>[y(f(t.emptyTitle),1)]),headerCell:a(e=>[y(f(e.title),1)]),bodyCell:a(({column:{key:e},record:l})=>[l.cells[e].type==="slot"?x(t.$slots,l.cells[e].key,{key:0,payload:l.cells[e].payload},void 0,!0):(s(),i(n(P),{key:1,open:l.cells[e].hover?void 0:!1},{content:a(()=>[d(n(j),{style:{width:"300px",overflow:"auto","font-family":"monospace"},copyable:"",content:l.cells[e].hover},null,8,["content"])]),default:a(()=>[l.cells[e].type==="text"?(s(),i(n(C),{key:0,secondary:l.cells[e].secondary,code:l.cells[e].code},{default:a(()=>[d(n(L),{dot:l.cells[e].contentType==="warning",color:"#faad14"},{default:a(()=>[y(f(l.cells[e].text),1)]),_:2},1032,["dot"])]),_:2},1032,["secondary","code"])):l.cells[e].type==="secret"?(s(),i(n(C),{key:1,copyable:{text:l.cells[e].text}},{default:a(()=>[y(" ******** ")]),_:2},1032,["copyable"])):l.cells[e].type==="tag"?(s(),i(n(E),{key:2,color:l.cells[e].tagColor},{default:a(()=>[y(f(l.cells[e].text),1)]),_:2},1032,["color"])):l.cells[e].type==="tags"?(s(),i(n(z),{key:3},{default:a(()=>[(s(!0),A(B,null,T(l.cells[e].tags,(o,h)=>(s(),i(n(E),{key:h,color:o.color},{default:a(()=>[y(f(o.text),1)]),_:2},1032,["color"]))),128))]),_:2},1024)):l.cells[e].type==="link"?(s(),i(p,{key:4,to:l.cells[e].to},{default:a(()=>[y(f(l.cells[e].text),1)]),_:2},1032,["to"])):l.cells[e].type==="actions"?(s(),i(n(pe),{key:5},{overlay:a(()=>[d(n(ce),{disabled:k.value},{default:a(()=>[(s(!0),A(B,null,T(l.cells[e].actions.filter(o=>!o.hide),(o,h)=>(s(),i(n(de),{key:h,danger:o.dangerous,onClick:$=>V(o,l)},{default:a(()=>[o.popoverMessage?(s(),i(n(P),{key:0,placement:"left"},{content:a(()=>[ye("div",be,[d(n(C),null,{default:a(()=>[y(f(o.popoverMessage),1)]),_:2},1024)])]),default:a(()=>[d(n(C),{disabled:o.disabled,class:"action-item"},{default:a(()=>[o.icon?(s(),i(R(o.icon),{key:0})):b("",!0),y(" "+f(o.label),1)]),_:2},1032,["disabled"])]),_:2},1024)):(s(),i(n(C),{key:1,disabled:o.disabled,class:"action-item"},{default:a(()=>[o.icon?(s(),i(R(o.icon),{key:0})):b("",!0),y(" "+f(o.label),1)]),_:2},1032,["disabled"]))]),_:2},1032,["danger","onClick"]))),128))]),_:2},1032,["disabled"])]),default:a(()=>[d(n(W),{style:{cursor:"pointer"},size:"25px"})]),_:2},1024)):b("",!0)]),_:2},1032,["open"]))]),footer:a(()=>[t.live?(s(),i(n(Y),{key:0,justify:"end",gutter:10},{default:a(()=>[d(n(U),{style:{display:"flex","align-items":"center"}},{default:a(()=>[d(n(fe),{size:"small",style:{display:"flex","align-items":"center"}})]),_:1}),d(n(U),null,{default:a(()=>[d(n(C),null,{default:a(()=>[y(f(n(D).translate("i18n_crudview_auto_updating")),1)]),_:1})]),_:1})]),_:1})):b("",!0)]),_:3},8,["style","data-source","loading","columns"])]}),_:3}),t.fields&&t.create?(s(),i(ve,{key:0,ref_key:"modalRef",ref:_,fields:t.fields,"entity-name":t.entityName,create:t.create},null,8,["fields","entity-name","create"])):b("",!0)],64)}}});const xe=me(ge,[["__scopeId","data-v-21fb039e"]]);export{xe as C};
//# sourceMappingURL=CrudView.391f0e9f.js.map
