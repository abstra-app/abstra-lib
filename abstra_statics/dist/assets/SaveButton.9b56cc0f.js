import{d as w,L as C,B as S,f as m,o as k,K as B,b as n,w as s,a as D,u as t,d2 as E,az as r,d3 as I,bM as L,O as c,cH as A,cF as V,Q as $}from"./index.6d326114.js";import{G as z,U as K}from"./UnsavedChangesHandler.6e37d333.js";(function(){try{var a=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},d=new Error().stack;d&&(a._sentryDebugIds=a._sentryDebugIds||{},a._sentryDebugIds[d]="08128df5-0d75-4e4e-817c-6c4e8f3304d0",a._sentryDebugIdIdentifier="sentry-dbid-08128df5-0d75-4e4e-817c-6c4e8f3304d0")}catch{}})();const N={class:"popup-container"},P={style:{padding:"0px 4px"}},U=w({__name:"SaveButton",props:{model:{},neverShowPopover:{type:Boolean},disabled:{type:Boolean}},emits:["save"],setup(a,{emit:d}){var h;const l=a,_=e=>{var o;return(o=e.parentElement)!=null?o:document.body},f=new C(S.boolean(),"dontShowUnsavedChanges"),p=m((h=f.get())!=null?h:!1),b=()=>{f.set(!0),p.value=!0},i=m(!1);async function v(){i.value=!0;try{await l.model.save(),d("save")}catch(e){console.error(e),V.error({message:"Error saving"})}finally{i.value=!1}}return addEventListener("keydown",e=>{(e.metaKey||e.ctrlKey)&&e.key==="s"&&(e.preventDefault(),v())}),addEventListener("beforeunload",e=>{l.model.hasChanges()&&(e.preventDefault(),e.returnValue="")}),(e,o)=>{var g;return k(),B("div",N,[n(t(A),{placement:"left",open:e.model.hasChanges()&&!p.value&&!e.neverShowPopover,"get-popup-container":_},{content:s(()=>[D("div",P,[n(t(E),null,{default:s(()=>[r("You have unsaved changes")]),_:1}),n(t(I),{onClick:b},{default:s(()=>[r("Don't show this again")]),_:1})])]),default:s(()=>{var y;return[n(t(L),{class:"save-button",loading:i.value,disabled:!((y=e.model)!=null&&y.hasChanges())||e.disabled,onClick:o[0]||(o[0]=u=>v())},{icon:s(()=>[c(e.$slots,"icon",{},()=>[n(t(z),{size:"18"})],!0)]),default:s(()=>{var u;return[(u=e.model)!=null&&u.hasChanges()?c(e.$slots,"with-changes",{key:0},()=>[r(" Save ")],!0):c(e.$slots,"without-changes",{key:1},()=>[r(" Saved ")],!0)]}),_:3},8,["loading","disabled"])]}),_:3},8,["open"]),n(K,{"has-changes":(g=e.model)==null?void 0:g.hasChanges()},null,8,["has-changes"])])}}});const F=$(U,[["__scopeId","data-v-80b2ff4e"]]);export{F as S};
//# sourceMappingURL=SaveButton.9b56cc0f.js.map
