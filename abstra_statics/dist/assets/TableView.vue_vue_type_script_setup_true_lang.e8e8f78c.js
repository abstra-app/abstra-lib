import{l as Ae}from"./fetch.1fc8b3e7.js";import{d as V,X as F,H as O,b as l,eu as v,dj as se,ew as P,ez as re,e as w,f as d,eG as ie,eR as Ne,r as M,c as y,w as i,eB as H,aq as k,eD as D,u as a,cI as Ue,aC as K,cA as U,v as Q,bf as qe,eJ as ve,eC as ee,aG as ne,ci as Ce,eE as Be,eF as He,eS as Ke,bE as W,eI as We,I as Je,o as _e,K as Re,ad as Ge,cz as Qe,eL as Xe,bx as Ye,eT as et,cC as tt}from"./outputWidgets.b2f2adf2.js";import{d as at}from"./vuedraggable.umd.a5a06993.js";import"./workspaces.4fed9670.js";import{S as nt}from"./scripts.b274e126.js";import"./envVars.db9c582c.js";import{A as ot}from"./api.8e69ff2e.js";import{t as st}from"./ant-design.c95e6c48.js";import{A as B}from"./Text.9554a64b.js";import{a as we}from"./asyncComputed.0eb432f7.js";import{A as j}from"./index.c47b0dc1.js";import{s as te}from"./metadata.555f07fb.js";import{A as G}from"./index.0f294ac7.js";import{f as rt}from"./index.230f82f6.js";import{A as ge}from"./Paragraph.038d3c4a.js";import"./index.eb1aefdf.js";import{A as X}from"./Title.d1ce9cd1.js";import{T as it,A as lt}from"./index.2c6a9a73.js";import{A as Le,C as ke}from"./CollapsePanel.fe8905e3.js";import{A as ct}from"./Link.326bc6ef.js";import{A as ut}from"./index.3df7bcb5.js";import{A as dt}from"./index.72771e2c.js";import{C as mt,A as pt}from"./Card.1ffebbef.js";import{L as Pe}from"./LoadingOutlined.010813e4.js";import"./index.5e4f7e9b.js";import{F as gt,A as ht}from"./Form.151a806c.js";import{c as St}from"./string.f1ed14cd.js";import{z as e}from"./index.cf4c23b9.js";(function(){try{var o=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},t=new Error().stack;t&&(o._sentryDebugIds=o._sentryDebugIds||{},o._sentryDebugIds[t]="c076b2fa-58fc-4ffd-9050-1487aa87c9e2",o._sentryDebugIdIdentifier="sentry-dbid-c076b2fa-58fc-4ffd-9050-1487aa87c9e2")}catch{}})();var bt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zM641.7 520.8L442.3 677.6c-7.4 5.8-18.3.6-18.3-8.8V355.3c0-9.4 10.9-14.7 18.3-8.8l199.4 156.7a11.2 11.2 0 010 17.6z"}}]},name:"play-square",theme:"filled"};const yt=bt;var ft={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M168 504.2c1-43.7 10-86.1 26.9-126 17.3-41 42.1-77.7 73.7-109.4S337 212.3 378 195c42.4-17.9 87.4-27 133.9-27s91.5 9.1 133.8 27A341.5 341.5 0 01755 268.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.7 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c0-6.7-7.7-10.5-12.9-6.3l-56.4 44.1C765.8 155.1 646.2 92 511.8 92 282.7 92 96.3 275.6 92 503.8a8 8 0 008 8.2h60c4.4 0 7.9-3.5 8-7.8zm756 7.8h-60c-4.4 0-7.9 3.5-8 7.8-1 43.7-10 86.1-26.9 126-17.3 41-42.1 77.8-73.7 109.4A342.45 342.45 0 01512.1 856a342.24 342.24 0 01-243.2-100.8c-9.9-9.9-19.2-20.4-27.8-31.4l60.2-47a8 8 0 00-3-14.1l-175.7-43c-5-1.2-9.9 2.6-9.9 7.7l-.7 181c0 6.7 7.7 10.5 12.9 6.3l56.4-44.1C258.2 868.9 377.8 932 512.2 932c229.2 0 415.5-183.7 419.8-411.8a8 8 0 00-8-8.2z"}}]},name:"sync",theme:"outlined"};const At=ft,vt=["width","height","fill","transform"],Ct={key:0},_t=w("path",{d:"M128,20A108,108,0,1,0,236,128,108.12,108.12,0,0,0,128,20Zm0,192a84,84,0,1,1,84-84A84.09,84.09,0,0,1,128,212Zm68-84a12,12,0,0,1-12,12H128a12,12,0,0,1-12-12V72a12,12,0,0,1,24,0v44h44A12,12,0,0,1,196,128Z"},null,-1),Rt=[_t],wt={key:1},Lt=w("path",{d:"M224,128a96,96,0,1,1-96-96A96,96,0,0,1,224,128Z",opacity:"0.2"},null,-1),kt=w("path",{d:"M128,24A104,104,0,1,0,232,128,104.11,104.11,0,0,0,128,24Zm0,192a88,88,0,1,1,88-88A88.1,88.1,0,0,1,128,216Zm64-88a8,8,0,0,1-8,8H128a8,8,0,0,1-8-8V72a8,8,0,0,1,16,0v48h48A8,8,0,0,1,192,128Z"},null,-1),Pt=[Lt,kt],Et={key:2},It=w("path",{d:"M128,24A104,104,0,1,0,232,128,104.11,104.11,0,0,0,128,24Zm56,112H128a8,8,0,0,1-8-8V72a8,8,0,0,1,16,0v48h48a8,8,0,0,1,0,16Z"},null,-1),Ot=[It],xt={key:3},$t=w("path",{d:"M128,26A102,102,0,1,0,230,128,102.12,102.12,0,0,0,128,26Zm0,192a90,90,0,1,1,90-90A90.1,90.1,0,0,1,128,218Zm62-90a6,6,0,0,1-6,6H128a6,6,0,0,1-6-6V72a6,6,0,0,1,12,0v50h50A6,6,0,0,1,190,128Z"},null,-1),Mt=[$t],jt={key:4},Dt=w("path",{d:"M128,24A104,104,0,1,0,232,128,104.11,104.11,0,0,0,128,24Zm0,192a88,88,0,1,1,88-88A88.1,88.1,0,0,1,128,216Zm64-88a8,8,0,0,1-8,8H128a8,8,0,0,1-8-8V72a8,8,0,0,1,16,0v48h48A8,8,0,0,1,192,128Z"},null,-1),Tt=[Dt],zt={key:5},Zt=w("path",{d:"M128,28A100,100,0,1,0,228,128,100.11,100.11,0,0,0,128,28Zm0,192a92,92,0,1,1,92-92A92.1,92.1,0,0,1,128,220Zm60-92a4,4,0,0,1-4,4H128a4,4,0,0,1-4-4V72a4,4,0,0,1,8,0v52h52A4,4,0,0,1,188,128Z"},null,-1),Ft=[Zt],Vt={name:"PhClock"},Nt=V({...Vt,props:{weight:{type:String},size:{type:[String,Number]},color:{type:String},mirrored:{type:Boolean}},setup(o){const t=o,n=F("weight","regular"),s=F("size","1em"),r=F("color","currentColor"),m=F("mirrored",!1),u=O(()=>{var c;return(c=t.weight)!=null?c:n}),p=O(()=>{var c;return(c=t.size)!=null?c:s}),_=O(()=>{var c;return(c=t.color)!=null?c:r}),A=O(()=>t.mirrored!==void 0?t.mirrored?"scale(-1, 1)":void 0:m?"scale(-1, 1)":void 0);return(c,f)=>(l(),v("svg",re({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256",width:p.value,height:p.value,fill:_.value,transform:A.value},c.$attrs),[se(c.$slots,"default"),u.value==="bold"?(l(),v("g",Ct,Rt)):u.value==="duotone"?(l(),v("g",wt,Pt)):u.value==="fill"?(l(),v("g",Et,Ot)):u.value==="light"?(l(),v("g",xt,Mt)):u.value==="regular"?(l(),v("g",jt,Tt)):u.value==="thin"?(l(),v("g",zt,Ft)):P("",!0)],16,vt))}}),Ut=["width","height","fill","transform"],qt={key:0},Bt=w("path",{d:"M228,64a36,36,0,1,0-48,33.94V112a4,4,0,0,1-4,4H80a4,4,0,0,1-4-4V97.94a36,36,0,1,0-24,0V112a28,28,0,0,0,28,28h36v18.06a36,36,0,1,0,24,0V140h36a28,28,0,0,0,28-28V97.94A36.07,36.07,0,0,0,228,64ZM64,52A12,12,0,1,1,52,64,12,12,0,0,1,64,52Zm64,152a12,12,0,1,1,12-12A12,12,0,0,1,128,204ZM192,76a12,12,0,1,1,12-12A12,12,0,0,1,192,76Z"},null,-1),Ht=[Bt],Kt={key:1},Wt=w("path",{d:"M88,64A24,24,0,1,1,64,40,24,24,0,0,1,88,64ZM192,40a24,24,0,1,0,24,24A24,24,0,0,0,192,40Z",opacity:"0.2"},null,-1),Jt=w("path",{d:"M224,64a32,32,0,1,0-40,31v17a8,8,0,0,1-8,8H80a8,8,0,0,1-8-8V95a32,32,0,1,0-16,0v17a24,24,0,0,0,24,24h40v25a32,32,0,1,0,16,0V136h40a24,24,0,0,0,24-24V95A32.06,32.06,0,0,0,224,64ZM48,64A16,16,0,1,1,64,80,16,16,0,0,1,48,64Zm96,128a16,16,0,1,1-16-16A16,16,0,0,1,144,192ZM192,80a16,16,0,1,1,16-16A16,16,0,0,1,192,80Z"},null,-1),Gt=[Wt,Jt],Qt={key:2},Xt=w("path",{d:"M224,64a32,32,0,1,0-40,31v17a8,8,0,0,1-8,8H80a8,8,0,0,1-8-8V95a32,32,0,1,0-16,0v17a24,24,0,0,0,24,24h40v25a32,32,0,1,0,16,0V136h40a24,24,0,0,0,24-24V95A32.06,32.06,0,0,0,224,64ZM144,192a16,16,0,1,1-16-16A16,16,0,0,1,144,192Z"},null,-1),Yt=[Xt],ea={key:3},ta=w("path",{d:"M222,64a30,30,0,1,0-36,29.4V112a10,10,0,0,1-10,10H80a10,10,0,0,1-10-10V93.4a30,30,0,1,0-12,0V112a22,22,0,0,0,22,22h42v28.6a30,30,0,1,0,12,0V134h42a22,22,0,0,0,22-22V93.4A30.05,30.05,0,0,0,222,64ZM46,64A18,18,0,1,1,64,82,18,18,0,0,1,46,64ZM146,192a18,18,0,1,1-18-18A18,18,0,0,1,146,192ZM192,82a18,18,0,1,1,18-18A18,18,0,0,1,192,82Z"},null,-1),aa=[ta],na={key:4},oa=w("path",{d:"M224,64a32,32,0,1,0-40,31v17a8,8,0,0,1-8,8H80a8,8,0,0,1-8-8V95a32,32,0,1,0-16,0v17a24,24,0,0,0,24,24h40v25a32,32,0,1,0,16,0V136h40a24,24,0,0,0,24-24V95A32.06,32.06,0,0,0,224,64ZM48,64A16,16,0,1,1,64,80,16,16,0,0,1,48,64Zm96,128a16,16,0,1,1-16-16A16,16,0,0,1,144,192ZM192,80a16,16,0,1,1,16-16A16,16,0,0,1,192,80Z"},null,-1),sa=[oa],ra={key:5},ia=w("path",{d:"M220,64a28,28,0,1,0-32,27.71V112a12,12,0,0,1-12,12H80a12,12,0,0,1-12-12V91.71a28,28,0,1,0-8,0V112a20,20,0,0,0,20,20h44v32.29a28,28,0,1,0,8,0V132h44a20,20,0,0,0,20-20V91.71A28,28,0,0,0,220,64ZM44,64A20,20,0,1,1,64,84,20,20,0,0,1,44,64ZM148,192a20,20,0,1,1-20-20A20,20,0,0,1,148,192ZM192,84a20,20,0,1,1,20-20A20,20,0,0,1,192,84Z"},null,-1),la=[ia],ca={name:"PhGitFork"},ua=V({...ca,props:{weight:{type:String},size:{type:[String,Number]},color:{type:String},mirrored:{type:Boolean}},setup(o){const t=o,n=F("weight","regular"),s=F("size","1em"),r=F("color","currentColor"),m=F("mirrored",!1),u=O(()=>{var c;return(c=t.weight)!=null?c:n}),p=O(()=>{var c;return(c=t.size)!=null?c:s}),_=O(()=>{var c;return(c=t.color)!=null?c:r}),A=O(()=>t.mirrored!==void 0?t.mirrored?"scale(-1, 1)":void 0:m?"scale(-1, 1)":void 0);return(c,f)=>(l(),v("svg",re({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256",width:p.value,height:p.value,fill:_.value,transform:A.value},c.$attrs),[se(c.$slots,"default"),u.value==="bold"?(l(),v("g",qt,Ht)):u.value==="duotone"?(l(),v("g",Kt,Gt)):u.value==="fill"?(l(),v("g",Qt,Yt)):u.value==="light"?(l(),v("g",ea,aa)):u.value==="regular"?(l(),v("g",na,sa)):u.value==="thin"?(l(),v("g",ra,la)):P("",!0)],16,Ut))}}),da=["width","height","fill","transform"],ma={key:0},pa=w("path",{d:"M144,180a16,16,0,1,1-16-16A16,16,0,0,1,144,180Zm92-52A108,108,0,1,1,128,20,108.12,108.12,0,0,1,236,128Zm-24,0a84,84,0,1,0-84,84A84.09,84.09,0,0,0,212,128ZM128,64c-24.26,0-44,17.94-44,40v4a12,12,0,0,0,24,0v-4c0-8.82,9-16,20-16s20,7.18,20,16-9,16-20,16a12,12,0,0,0-12,12v8a12,12,0,0,0,23.73,2.56C158.31,137.88,172,122.37,172,104,172,81.94,152.26,64,128,64Z"},null,-1),ga=[pa],ha={key:1},Sa=w("path",{d:"M224,128a96,96,0,1,1-96-96A96,96,0,0,1,224,128Z",opacity:"0.2"},null,-1),ba=w("path",{d:"M140,180a12,12,0,1,1-12-12A12,12,0,0,1,140,180ZM128,72c-22.06,0-40,16.15-40,36v4a8,8,0,0,0,16,0v-4c0-11,10.77-20,24-20s24,9,24,20-10.77,20-24,20a8,8,0,0,0-8,8v8a8,8,0,0,0,16,0v-.72c18.24-3.35,32-17.9,32-35.28C168,88.15,150.06,72,128,72Zm104,56A104,104,0,1,1,128,24,104.11,104.11,0,0,1,232,128Zm-16,0a88,88,0,1,0-88,88A88.1,88.1,0,0,0,216,128Z"},null,-1),ya=[Sa,ba],fa={key:2},Aa=w("path",{d:"M128,24A104,104,0,1,0,232,128,104.11,104.11,0,0,0,128,24Zm0,168a12,12,0,1,1,12-12A12,12,0,0,1,128,192Zm8-48.72V144a8,8,0,0,1-16,0v-8a8,8,0,0,1,8-8c13.23,0,24-9,24-20s-10.77-20-24-20-24,9-24,20v4a8,8,0,0,1-16,0v-4c0-19.85,17.94-36,40-36s40,16.15,40,36C168,125.38,154.24,139.93,136,143.28Z"},null,-1),va=[Aa],Ca={key:3},_a=w("path",{d:"M138,180a10,10,0,1,1-10-10A10,10,0,0,1,138,180ZM128,74c-21,0-38,15.25-38,34v4a6,6,0,0,0,12,0v-4c0-12.13,11.66-22,26-22s26,9.87,26,22-11.66,22-26,22a6,6,0,0,0-6,6v8a6,6,0,0,0,12,0v-2.42c18.11-2.58,32-16.66,32-33.58C166,89.25,149,74,128,74Zm102,54A102,102,0,1,1,128,26,102.12,102.12,0,0,1,230,128Zm-12,0a90,90,0,1,0-90,90A90.1,90.1,0,0,0,218,128Z"},null,-1),Ra=[_a],wa={key:4},La=w("path",{d:"M140,180a12,12,0,1,1-12-12A12,12,0,0,1,140,180ZM128,72c-22.06,0-40,16.15-40,36v4a8,8,0,0,0,16,0v-4c0-11,10.77-20,24-20s24,9,24,20-10.77,20-24,20a8,8,0,0,0-8,8v8a8,8,0,0,0,16,0v-.72c18.24-3.35,32-17.9,32-35.28C168,88.15,150.06,72,128,72Zm104,56A104,104,0,1,1,128,24,104.11,104.11,0,0,1,232,128Zm-16,0a88,88,0,1,0-88,88A88.1,88.1,0,0,0,216,128Z"},null,-1),ka=[La],Pa={key:5},Ea=w("path",{d:"M136,180a8,8,0,1,1-8-8A8,8,0,0,1,136,180ZM128,76c-19.85,0-36,14.36-36,32v4a4,4,0,0,0,8,0v-4c0-13.23,12.56-24,28-24s28,10.77,28,24-12.56,24-28,24a4,4,0,0,0-4,4v8a4,4,0,0,0,8,0v-4.2c18-1.77,32-15.36,32-31.8C164,90.36,147.85,76,128,76Zm100,52A100,100,0,1,1,128,28,100.11,100.11,0,0,1,228,128Zm-8,0a92,92,0,1,0-92,92A92.1,92.1,0,0,0,220,128Z"},null,-1),Ia=[Ea],Oa={name:"PhQuestion"},xa=V({...Oa,props:{weight:{type:String},size:{type:[String,Number]},color:{type:String},mirrored:{type:Boolean}},setup(o){const t=o,n=F("weight","regular"),s=F("size","1em"),r=F("color","currentColor"),m=F("mirrored",!1),u=O(()=>{var c;return(c=t.weight)!=null?c:n}),p=O(()=>{var c;return(c=t.size)!=null?c:s}),_=O(()=>{var c;return(c=t.color)!=null?c:r}),A=O(()=>t.mirrored!==void 0?t.mirrored?"scale(-1, 1)":void 0:m?"scale(-1, 1)":void 0);return(c,f)=>(l(),v("svg",re({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256",width:p.value,height:p.value,fill:_.value,transform:A.value},c.$attrs),[se(c.$slots,"default"),u.value==="bold"?(l(),v("g",ma,ga)):u.value==="duotone"?(l(),v("g",ha,ya)):u.value==="fill"?(l(),v("g",fa,va)):u.value==="light"?(l(),v("g",Ca,Ra)):u.value==="regular"?(l(),v("g",wa,ka)):u.value==="thin"?(l(),v("g",Pa,Ia)):P("",!0)],16,da))}});function he(o){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?Object(arguments[t]):{},s=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(n).filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable}))),s.forEach(function(r){$a(o,r,n[r])})}return o}function $a(o,t,n){return t in o?Object.defineProperty(o,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):o[t]=n,o}var le=function(t,n){var s=he({},t,n.attrs);return d(ie,he({},s,{icon:Ne}),null)};le.displayName="EyeInvisibleOutlined";le.inheritAttrs=!1;const Ma=le;function Se(o){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?Object(arguments[t]):{},s=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(n).filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable}))),s.forEach(function(r){ja(o,r,n[r])})}return o}function ja(o,t,n){return t in o?Object.defineProperty(o,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):o[t]=n,o}var ce=function(t,n){var s=Se({},t,n.attrs);return d(ie,Se({},s,{icon:yt}),null)};ce.displayName="PlaySquareFilled";ce.inheritAttrs=!1;const Da=ce;function be(o){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?Object(arguments[t]):{},s=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(n).filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable}))),s.forEach(function(r){Ta(o,r,n[r])})}return o}function Ta(o,t,n){return t in o?Object.defineProperty(o,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):o[t]=n,o}var ue=function(t,n){var s=be({},t,n.attrs);return d(ie,be({},s,{icon:At}),null)};ue.displayName="SyncOutlined";ue.inheritAttrs=!1;const Ee=ue;class Dr{constructor(t=Ae){this.fetch=t}async getStages(){return(await this.fetch("/_editor/api/kanban/stages")).json()}async getData(t){return(await this.fetch("/_editor/api/kanban",{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}})).json()}async getLogs(t){return(await this.fetch(`/_editor/api/kanban/logs/${t}`)).json()}async startJob(t){await this.fetch(`/_editor/api/kanban/jobs/${t}/start`,{method:"POST"})}}class Tr{constructor(t,n=Ae){this.authProvider=t,this.fetch=n}get headers(){return{"Content-Type":"application/json",...this.authProvider.authHeaders()}}async getStages(){return(await this.fetch("/_kanban/stages",{headers:this.headers})).json()}async getData(t){return(await this.fetch("/_kanban/",{method:"POST",body:JSON.stringify(t),headers:this.headers})).json()}async getLogs(t){return(await this.fetch(`/_kanban/logs/${t}`,{headers:this.headers})).json()}async startJob(t){await this.fetch(`/_kanban/jobs/${t}/start`,{method:"POST",headers:this.headers})}}class zr{constructor(t,n=localStorage){this.contextKey=t,this.storage=n}makeKey(t){return`${this.contextKey}:${t}`}async get(t){const n=this.storage.getItem(this.makeKey(t));return n?JSON.parse(n):null}async set(t,n){this.storage.setItem(this.makeKey(t),JSON.stringify(n))}}const za=e.boolean(),Za=e.boolean(),Fa=e.boolean(),Va=e.boolean();e.object({PROJECT_LIVE:za.optional(),ALLOW_RELEASE:Za.optional(),CONNECTORS_CONSOLE:Fa.optional(),DUPLICATE_PROJECTS:Va.optional()});const Na=e.string(),Ua=e.string(),qa=e.string(),Ba=e.string(),Ha=e.string();e.object({plan:Na.optional(),expires:Ua.optional(),message:qa.optional(),messageLink:Ba.optional(),messageCTA:Ha.optional()});const Ka=e.string(),Ie=e.string(),de=e.string(),Wa=e.string(),Ja=e.string(),Ga=e.object({id:Ka,name:Ie,description:de.optional(),projectId:Wa,createdAt:Ja}),Qa=e.string(),Xa=e.string(),Ya=e.string(),en=e.string(),tn=e.string().regex(new RegExp("^[0-9]+m$")),an=e.string().regex(new RegExp("^[0-9]+m$")),nn=e.string().regex(new RegExp("^[0-9]+Mi$")),on=e.string().regex(new RegExp("^[0-9]+Mi$")),sn=e.string().regex(new RegExp("^[0-9]+$")),rn=e.string().regex(new RegExp("^[0-9]+$")),ln=e.enum(["shared","clickbus","test"]),cn=e.object({requestsCPU:tn.optional(),limitsCPU:an.optional(),requestsMemory:nn.optional(),limitsMemory:on.optional(),minReplicas:sn.optional(),timeoutSeconds:rn.optional(),workerType:ln.optional()});e.object({id:Qa,name:Xa,subdomain:Ya,organizationId:en,deploymentResources:cn.optional()});const un=e.string(),dn=e.string(),Oe=e.array(dn),xe=e.string(),mn=e.string();e.object({id:un,emailPatterns:Oe,projectId:xe,createdAt:mn});const pn=e.string().regex(new RegExp("^[0-9]+m$")),gn=e.string().regex(new RegExp("^[0-9]+m$")),hn=e.string().regex(new RegExp("^[0-9]+Mi$")),Sn=e.string().regex(new RegExp("^[0-9]+Mi$")),bn=e.string().regex(new RegExp("^[0-9]+$")),yn=e.string().regex(new RegExp("^[0-9]+$")),fn=e.enum(["shared","clickbus","test"]);e.object({requestsCPU:pn.optional(),limitsCPU:gn.optional(),requestsMemory:hn.optional(),limitsMemory:Sn.optional(),minReplicas:bn.optional(),timeoutSeconds:yn.optional(),workerType:fn.optional()});const An=e.string(),ae=e.string().email(),vn=e.string(),me=e.array(vn),Cn=e.string(),_n=e.string(),Rn=e.object({id:An,email:ae,roles:me,projectId:Cn,createdAt:_n}),$e=e.string(),Me=e.string(),wn=e.boolean(),Ln=e.boolean(),kn=e.boolean(),Pn=e.boolean(),je=e.object({PROJECT_LIVE:wn,ALLOW_RELEASE:Ln,CONNECTORS_CONSOLE:kn,DUPLICATE_PROJECTS:Pn}),En=e.string(),In=e.string(),On=e.string(),xn=e.string(),$n=e.string(),De=e.object({plan:En.optional(),expires:In.optional(),message:On.optional(),messageLink:xn.optional(),messageCTA:$n.optional()}),Mn=e.string().regex(new RegExp("^[0-9]+m$")),jn=e.string().regex(new RegExp("^[0-9]+m$")),Dn=e.string().regex(new RegExp("^[0-9]+Mi$")),Tn=e.string().regex(new RegExp("^[0-9]+Mi$")),zn=e.string().regex(new RegExp("^[0-9]+$")),Zn=e.string().regex(new RegExp("^[0-9]+$")),Fn=e.enum(["shared","clickbus","test"]),Vn=e.object({requestsCPU:Mn.optional(),limitsCPU:jn.optional(),requestsMemory:Dn.optional(),limitsMemory:Tn.optional(),minReplicas:zn.optional(),timeoutSeconds:Zn.optional(),workerType:Fn.optional()}),Nn=e.string(),Un=e.array(Nn),qn=e.object({whitelistPatterns:Un.optional()});e.object({id:$e,name:Me,featureFlags:je,billingMetadata:De,deploymentResources:Vn.optional(),membershipsMetadata:qn.optional()});const Bn=e.string(),Hn=e.array(Bn);e.object({whitelistPatterns:Hn.optional()});const Kn=$e,Wn=Me,Jn=je,Gn=De;e.object({id:Kn,name:Wn,featureFlags:Jn,billingMetadata:Gn});const Qn=de;e.object({description:Qn});const Xn=e.number(),Yn=e.number();e.object({offset:Xn.optional(),limit:Yn.optional()});const eo=Ga;e.array(eo);const to=Ie,ao=de;e.object({name:to,description:ao.optional()});const no=ae,oo=me;e.object({email:no.optional(),roles:oo.optional()});const so=e.number(),ro=e.number();e.object({offset:so.optional(),limit:ro.optional()});const io=Rn;e.array(io);const lo=ae,co=me;e.object({email:lo,roles:co});const uo=Oe;e.object({emailPatterns:uo});const mo=xe;e.object({projectId:mo});const po=e.boolean();e.object({shouldBeOnboarded:po.optional()});const go=e.string(),ho=e.string(),So=e.string(),bo=e.string();e.object({name:go.optional(),companyName:ho.optional(),source:So.optional(),authorEmail:bo.optional()});const yo=e.string(),fo=e.record(e.any()),Ao=e.string(),vo=e.object({key:yo,value:fo,type:Ao}),Co=vo,_o=e.array(Co),Ro=e.string(),wo=e.enum(["text","image","table","progress-bar"]),Lo=e.object({name:Ro,type:wo}),ko=e.string(),Po=e.string(),Eo=e.record(e.any()),Te=e.enum(["waiting","running","processing","finished","failed","abandoned"]),Io=["waiting","running","processing","finished","failed","abandoned"],Oo=e.string(),xo=e.string(),$o=e.string(),Mo=e.string();e.object({id:ko,stage:Po,data:Eo,status:Te,created_at:Oo,updated_at:xo,parent_id:$o.optional(),execution_id:Mo.optional()});const jo=e.string(),Do=e.string(),To=e.string(),zo=e.string(),Zo=Te,Fo=_o,Vo=e.string(),No=e.object({id:jo,created_at:Do,updated_at:To.optional(),assignee:zo.optional(),status:Zo,content:Fo,stage:Vo.optional()}),Uo=No,ze=e.array(Uo),qo=e.string(),Bo=e.enum(["form","hook","job","script","iterator","condition"]),Ho=e.string(),Ko=e.string(),Wo=e.boolean(),Ze=e.object({id:qo,type:Bo,title:Ho,path:Ko.optional(),can_be_started:Wo}),Jo=Ze,Go=ze,Qo=e.number(),Xo=e.boolean(),Yo=e.object({selected_stage:Jo,stage_run_cards:Go,total_count:Qo,loading:Xo.optional()}),es=Yo,ts=e.array(es),as=ts;e.object({columns:as});const ns=ze,os=e.string(),ss=e.array(os),rs=e.number();e.object({stage_run_cards:ns,not_found_stages:ss,total_count:rs});const is=Lo;e.array(is);const ls=Ze;e.array(ls);const cs=e.string(),us=e.string(),ds=e.literal("bug"),ms=e.string(),ps=e.string(),gs=e.string(),hs=e.object({name:ps,label:gs}),Ss=hs,bs=e.array(Ss),ys=e.object({label:ms,fixes:bs}),fs=ys,As=e.array(fs),vs=e.object({name:cs,label:us,type:ds,issues:As}),Cs=e.boolean();e.object({success:Cs});const _s=vs;e.array(_s);const Rs=e.string(),ws=e.string(),Ls=e.object({key:Rs,value:ws}),ks=Ls;e.array(ks);const Ps=ae;e.object({email:Ps});const Es=e.enum(["ALLOWED","UNAUTHORIZED","FORBIDEN"]);e.object({status:Es});function pe(o){switch(o.status){case"waiting":return{color:"blue",text:"Waiting"};case"running":case"processing":return{color:"processing",text:"Running"};case"finished":return{color:"success",text:"Success"};case"failed":return{color:"error",text:"Failed"};case"abandoned":return{color:"warning",text:"Abandoned"}}}const Is=10,Os=[...Io].filter(o=>o!=="processing"),Fe=()=>{const o=M([]),t=M({}),n=M(""),s=M([]),r=M(Is),m=M(0),u=()=>({status:o.value,data:t.value,search:n.value,stage:s.value});return{stageIds:s,filterStatus:o,filterData:t,filterSearch:n,limit:r,offset:m,filterFactory:u,labelOption:A=>pe({status:A}).text,requestDataFactory:()=>({filter:u(),limit:r.value,offset:m.value})}},Y="kanban-selected-stage-ids",xs=({storage:o,kanbanRepository:t})=>{const n=M([]),s=M([]),r=O(()=>n.value.filter(c=>!s.value.map(f=>f.stage.id).includes(c.id))),m=async()=>{s.value=[]},u=c=>{s.value=s.value.filter(f=>f.stage.id!==c),o.set(Y,s.value.map(f=>f.stage).filter(f=>f.id!==c))},p=async(c,f)=>{if(c)s.value=[...s.value.slice(0,f),{stage:c,limit:J,offset:0},...s.value.slice(f+1)];else{const R=s.value[f].stage;return s.value=[...s.value.slice(0,f),...s.value.slice(f+1)],R}return await o.set(Y,s.value.map(R=>R.stage)),c};return{setup:async()=>{const c=await o.get(Y)||[];s.value=c.map(f=>({stage:f,limit:J,offset:0})),n.value=await t.getStages()},allStages:n,selectedStages:s,nonSelectedStages:r,clearSelection:m,unselect:u,setStage:p,reorderStages:async c=>{const f=s.value[c.moved.oldIndex];p(null,c.moved.oldIndex),s.value=[...s.value.slice(0,c.moved.newIndex),f,...s.value.slice(c.moved.newIndex)],await o.set(Y,s.value.map(R=>R.stage))}}},J=10,$s=1e3,Ms=({kanbanRepository:o,storage:t,router:n})=>{const s=Fe(),r=xs({storage:t,kanbanRepository:o}),m=M({columns:[],next_stage_options:[]}),u=async()=>{try{const S=r.selectedStages.value,C=S.map($=>(s.stageIds.value=[$.stage.id],o.getData(s.requestDataFactory()))),b={columns:[]},g=new Set,h=(await Promise.all(C)).map(($,z)=>({...$,stage:S[z].stage})),E=r.selectedStages.value;for(const $ of E){const z=h.find(q=>q.stage.id===$.stage.id);if(!z){b.columns.push({stage_run_cards:[],selected_stage:$.stage,total_count:0,loading:!1});continue}b.columns.push({stage_run_cards:z.stage_run_cards,selected_stage:$.stage,total_count:z.total_count,loading:!1});for(const q of z.not_found_stages)g.add(q)}const I=Array.from(g);for(const $ of I)r.unselect($);return{columns:b.columns,next_stage_options:r.nonSelectedStages.value}}catch{return r.clearSelection(),{columns:[],next_stage_options:[]}}};function p(S){const C=S.selected_stage.id,b=r.selectedStages.value.find(g=>g.stage.id===C);return b!=null&&b.limit?b.limit<S.total_count:!1}async function _(S){var b;const C=r.selectedStages.value.find(g=>g.stage.id===S.selected_stage.id);C&&(C.limit=((b=C.limit)!=null?b:0)+J,m.value=await u())}async function A(S){const C=r.selectedStages.value.find(b=>b.stage.id===S);C&&C.limit&&C.limit>J&&(C.limit-=J,m.value=await u())}async function c(S,C){const b=await r.setStage(S,C);if(S===null){m.value.columns=m.value.columns.filter(E=>E.selected_stage.id!==b.id);const g=r.allStages.value,L=g.findIndex(E=>E.id===b.id);let h=0;for(const E of m.value.next_stage_options)g.findIndex($=>$.id===E.id)<L&&h++;m.value.next_stage_options=[...m.value.next_stage_options.slice(0,h),b,...m.value.next_stage_options.slice(h)]}}async function f(S){await r.setStage(S,r.selectedStages.value.length),S&&(m.value.columns.push({stage_run_cards:[],selected_stage:S,total_count:0,loading:!0}),s.stageIds.value=[S.id],m.value.next_stage_options=r.nonSelectedStages.value)}async function R(S){await r.reorderStages(S)}let x=null;return{kanbanState:m,increasePagination:_,hasPagination:p,seeLess:A,setStage:c,addStage:f,cardActionHandler:async(S,C)=>{const b=S.selected_stage,g=C.id;if(b.type==="script"){const L=await nt.get(b.id);if(!L)return;await L.run(g)}if(b.type==="form"){const L=n.resolve({path:`/${b.path}`,query:g?{[ot]:g}:{}});window.open(L.href,g)}},setup:async()=>{await r.setup(),m.value={columns:r.selectedStages.value.map(C=>({stage_run_cards:[],selected_stage:C.stage,total_count:0,loading:!0})),next_stage_options:r.nonSelectedStages.value};let S=!1;m.value=await u(),x=setInterval(async()=>{S||(S=!0,m.value=await u(),S=!1)},$s)},tearDown:()=>{x&&clearInterval(x)},reorderStages:R,filterController:s}},oe=V({__name:"StageRunData",props:{data:{}},setup(o){return(t,n)=>(l(),y(a(U),{direction:"vertical",style:{overflow:"hidden"}},{default:i(()=>[(l(!0),v(K,null,H(t.data,s=>(l(),v("div",{key:s.key},[d(a(B),{strong:""},{default:i(()=>[k(D(s.key),1)]),_:2},1024),d(a(Ue),{"tree-data":a(st)(s.value),selectable:!1},null,8,["tree-data"])]))),128))]),_:1}))}}),js={key:0},Ds={key:1,class:"terminal"},Ts=V({__name:"ExecutionInspector",props:{logs:{}},setup(o){return(t,n)=>t.logs.length===0?(l(),v("span",js)):(l(),v("div",Ds,[d(a(j),{vertical:""},{default:i(()=>[(l(!0),v(K,null,H(t.logs,s=>(l(),v("pre",{key:s.executionId,class:"log-text"},D(s.payload.text),1))),128))]),_:1})]))}});const zs=Q(Ts,[["__scopeId","data-v-4e71a195"]]),Zs=o=>(Be("data-v-b7151dd7"),o=o(),He(),o),Fs={key:1},Vs={key:1},Ns=Zs(()=>w("span",null,"[Deleted Stage]",-1)),Us=["onClick"],qs=V({__name:"StageRunInspector",props:{stageRun:{},kanbanRepository:{},stageRunRepository:{}},emits:["close"],setup(o,{emit:t}){const n=o;function s(p){return Object.entries(p).map(([_,A])=>({key:_,value:A,type:typeof A}))}const{result:r,loading:m}=we(()=>{var p;return n.kanbanRepository.getLogs((p=n.stageRun)==null?void 0:p.id)}),u=(p,_)=>{var A;p.stopPropagation(),(A=n.stageRunRepository)==null||A.fork(_),t("close")};return(p,_)=>(l(),y(a(dt),{open:"",title:"Thread details",size:"large",onClose:_[0]||(_[0]=A=>t("close"))},{extra:i(()=>[d(a(ge),null,{default:i(()=>[d(a(G),{style:{"font-weight":"600"}},{default:i(()=>{var A;return[k(D(a(pe)({status:(A=p.stageRun)==null?void 0:A.status}).text),1)]}),_:1}),k(" "+D(a(rt)(new Date(p.stageRun.created_at),{addSuffix:!0})),1)]),_:1})]),default:i(()=>{var A,c,f;return[(A=p.stageRun)!=null&&A.assignee?(l(),y(a(ge),{key:0},{default:i(()=>{var R;return[k(" Assignee: "+D((R=p.stageRun)==null?void 0:R.assignee),1)]}),_:1})):P("",!0),((c=p.stageRun)==null?void 0:c.content)&&((f=p.stageRun)==null?void 0:f.content.length)>0?(l(),v("div",Fs,[d(a(X),{level:4},{default:i(()=>[k("Current data")]),_:1}),d(oe,{data:p.stageRun.content},null,8,["data"])])):P("",!0),d(a(X),{level:4,style:{"margin-bottom":"30px"}},{default:i(()=>[k(" Timeline ")]),_:1}),a(m)?(l(),y(a(qe),{key:2})):a(r)?(l(),y(a(it),{key:3},{default:i(()=>[(l(!0),v(K,null,H(a(r),({stage:R,stage_run:x,logs:T})=>(l(),y(a(lt),{key:x.id},{default:i(()=>[d(a(ke),{ghost:"","expand-icon-position":"end"},{default:i(()=>[d(a(Le),{class:"panel"},ve({header:i(()=>[R?(l(),y(a(j),{key:0,align:"center",gap:15},{default:i(()=>[(l(),y(ee(a(te)(R.type)))),T.length?(l(),v("span",Vs,D(R.title),1)):(l(),y(a(ne),{key:0,placement:"right",title:"No logs"},{default:i(()=>[k(D(R.title),1)]),_:2},1024))]),_:2},1024)):(l(),y(a(j),{key:1,align:"center",gap:15},{default:i(()=>[d(a(xa)),Ns]),_:1}))]),default:i(()=>[s(x.data).length||T.length?(l(),y(a(j),{key:0,vertical:""},{default:i(()=>[s(x.data).length?(l(),y(a(j),{key:0,gap:0,vertical:""},{default:i(()=>[d(a(X),{level:5},{default:i(()=>[k(" Output data ")]),_:1}),d(oe,{data:s(x.data)},null,8,["data"])]),_:2},1024)):P("",!0),T.length?(l(),y(a(j),{key:1,vertical:"",gap:0},{default:i(()=>[d(a(ut)),d(a(X),{level:5},{default:i(()=>[k(" Logs ")]),_:1}),d(zs,{logs:T},null,8,["logs"])]),_:2},1024)):P("",!0)]),_:2},1024)):(l(),y(a(Ce),{key:1,description:"No logs"}))]),_:2},[p.stageRunRepository&&R?{name:"extra",fn:i(()=>[w("span",{onClick:N=>u(N,x.id)},[d(a(j),{gap:"small"},{default:i(()=>[d(a(ua),{size:"22"}),d(a(ct),null,{default:i(()=>[k("Fork")]),_:1})]),_:1})],8,Us)]),key:"0"}:void 0]),1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})):P("",!0)]}),_:1}))}});const Bs=Q(qs,[["__scopeId","data-v-b7151dd7"]]),ye="_thread_title",Hs=V({__name:"Card",props:{stage:{},card:{}},emits:["inspect","action"],setup(o){const t=o,n=O(()=>{const u=t.card.content.find(_=>_.key===ye);return u?u.value:new Date(String(t.card.updated_at)).toLocaleString()}),s=O(()=>t.card.content.filter(u=>u.key!==ye)),r=O(()=>pe({status:t.card.status}).text),m=O(()=>Ke(new Date(String(t.card.updated_at))));return(u,p)=>{var _,A;return l(),y(a(mt),{size:"small",style:{cursor:"pointer"},"head-style":{"border-bottom":((_=u.card.content)==null?void 0:_.length)>0?"":"none"},"body-style":{display:((A=u.card.content)==null?void 0:A.length)>0?"block":"none"},onClick:p[1]||(p[1]=c=>u.$emit("inspect"))},ve({title:i(()=>[d(a(ne),{title:n.value.length>24?n.value:void 0},{default:i(()=>[k(D(n.value),1)]),_:1},8,["title"])]),default:i(()=>[d(a(U),{direction:"vertical",style:{"max-height":"300px",width:"100%",overflow:"hidden"}},{default:i(()=>[d(oe,{data:s.value,disabled:!0},null,8,["data"]),u.card.assignee?(l(),y(a(G),{key:0},{default:i(()=>[k(D(u.card.assignee),1)]),_:1})):P("",!0)]),_:1}),d(a(j),{gap:"10",style:{"margin-top":"8px"}},{default:i(()=>[d(a(ne),null,{title:i(()=>[k(D(u.card.updated_at),1)]),default:i(()=>[d(a(B),{type:"secondary",style:{"font-size":"12px",display:"flex","align-items":"center",gap:"4px"}},{default:i(()=>[d(a(Nt),{size:14}),k(" Updated at: "+D(m.value),1)]),_:1})]),_:1})]),_:1})]),extra:i(()=>[d(a(G),null,{default:i(()=>[k(D(r.value)+" ",1),r.value==="Running"?(l(),y(a(Ee),{key:0,spin:!0,style:{"margin-left":"4px"}})):P("",!0)]),_:1})]),_:2},[u.card.status==="waiting"?{name:"actions",fn:i(()=>[d(a(W),{onClick:p[0]||(p[0]=c=>u.$emit("action"))},{default:i(()=>[d(a(Da)),k(" Continue this thread ")]),_:1})]),key:"0"}:void 0]),1032,["head-style","body-style"])}}});class Ks{constructor(t,n,s){this.router=t,this.column=n,this.kanbanRepository=s}get stage(){return this.column.selected_stage}get canStart(){return this.stage.can_be_started}get launchLink(){return!this.stage.can_be_started||this.stage.type!=="form"||!this.stage.path?null:this.router.resolve({path:`/${this.stage.path}`}).href}click(){if(this.launchLink)return window.open(this.launchLink,"_blank");if(this.stage.type==="job")return this.kanbanRepository.startJob(this.stage.id).catch(console.error)}}const Ws=V({__name:"Column",props:{router:{},hasPagination:{type:Boolean},column:{},kanbanRepository:{}},emits:["increasePagination","cardAction","stageUpdate","cardInspection"],setup(o,{emit:t}){const n=o,s=O(()=>new Ks(n.router,n.column,n.kanbanRepository));return(r,m)=>(l(),y(a(U),{direction:"vertical",class:"stage-column"},{default:i(()=>[d(a(U),{direction:"horizontal",style:{width:"100%","justify-content":"space-between"}},{default:i(()=>[d(a(j),{gap:"8",style:{"max-width":"200px","padding-left":"10px"}},{default:i(()=>[d(a(j),null,{default:i(()=>[(l(),y(ee(a(te)(r.column.selected_stage.type)),{size:"20"}))]),_:1}),d(a(B),{ellipsis:"",content:r.column.selected_stage.title},null,8,["content"])]),_:1}),d(a(U),null,{default:i(()=>[r.column.loading?P("",!0):(l(),y(a(B),{key:0,type:"secondary",style:{"font-size":"small","margin-right":"2px"}},{default:i(()=>[k(D(r.column.total_count),1)]),_:1})),r.column.loading?(l(),y(a(Pe),{key:1})):P("",!0),d(a(W),{type:"text",style:{padding:"4px"},onClick:m[0]||(m[0]=u=>t("stageUpdate",null))},{default:i(()=>[d(a(B),{type:"secondary",style:{"font-size":"small","margin-right":"2px"}},{default:i(()=>[d(a(Ma))]),_:1})]),_:1})]),_:1})]),_:1}),d(a(U),{direction:"vertical",style:{width:"100%"}},{default:i(()=>[d(a(j),{justify:"center",align:"center"},{default:i(()=>[r.column.loading?(l(),y(a(pt),{key:0,active:"",block:"",size:"large",class:"skeleton"})):P("",!0)]),_:1}),!r.column.loading&&r.column.stage_run_cards.length===0?(l(),y(a(Ce),{key:0})):P("",!0),(l(!0),v(K,null,H(r.column.stage_run_cards,u=>(l(),y(Hs,{key:u.id,stage:r.column.selected_stage,card:u,onInspect:p=>t("cardInspection",u),onAction:p=>t("cardAction",u)},null,8,["stage","card","onInspect","onAction"]))),128)),r.hasPagination?(l(),y(a(W),{key:1,style:{width:"100%"},onClick:m[1]||(m[1]=u=>t("increasePagination"))},{default:i(()=>[k("See more")]),_:1})):P("",!0),s.value.canStart?(l(),y(a(W),{key:2,style:{width:"100%"},onClick:m[2]||(m[2]=()=>s.value.click())},{default:i(()=>[k(" Start new thread ")]),_:1})):P("",!0)]),_:1})]),_:1}))}});const Js=Q(Ws,[["__scopeId","data-v-0fd81111"]]),Gs=V({__name:"EmptyColumn",props:{stages:{}},emits:["stageUpdate"],setup(o,{emit:t}){const n=s=>{t("stageUpdate",s)};return(s,r)=>(l(),y(a(U),{direction:"vertical"},{default:i(()=>[(l(!0),v(K,null,H(s.stages,m=>(l(),y(a(G),{key:m.id,class:"tag",onClick:u=>n(m)},{default:i(()=>[d(a(j),{gap:"8",style:{"max-width":"200px","justify-content":"center","align-items":"center"}},{default:i(()=>[d(a(j),null,{default:i(()=>[(l(),y(ee(a(te)(m.type)),{size:"20"}))]),_:2},1024),d(a(B),{ellipsis:"",content:m.title},null,8,["content"])]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1}))}});const Qs=Q(Gs,[["__scopeId","data-v-08e39e62"]]);function Xs(){const o=M({state:"closed"});function t(){o.value={state:"closed"}}function n(){o.value={state:"visualizations"}}function s(m,u){o.value={state:"stage-run",stageRun:u}}const r=O(()=>"stageRun"in o.value?o.value.stageRun:null);return{closeDrawer:t,openVisualizationEditor:n,inspectStageRun:s,drawerState:o,selectedStageRunForDrawer:r}}const Ys={style:{"padding-top":"20px","flex-grow":"1"}},er={class:"stages-container"},tr={class:"stages-content"},ar=V({__name:"Kanban",props:{storage:{},kanbanRepository:{},stageRunRepository:{}},setup(o){const t=o,n=We(),{closeDrawer:s,inspectStageRun:r,drawerState:m,selectedStageRunForDrawer:u}=Xs(),p=g=>{S.value=g},{kanbanState:_,setStage:A,addStage:c,setup:f,tearDown:R,cardActionHandler:x,increasePagination:T,hasPagination:N,reorderStages:Z,filterController:{filterStatus:S,labelOption:C}}=Ms({kanbanRepository:t.kanbanRepository,storage:t.storage,router:n}),b=M([]);return Je(()=>{var g;return(g=_.value)==null?void 0:g.columns},g=>{g!==void 0&&(b.value=g)}),_e(f),Re(R),(g,L)=>(l(),v("div",Ys,[d(a(j),{vertical:"",style:{height:"100%"}},{default:i(()=>[d(a(ke),{ghost:""},{default:i(()=>[d(a(Le),{header:"Filters"},{default:i(()=>[d(a(gt),null,{default:i(()=>[d(a(ht),{label:"Status"},{default:i(()=>[d(a(Ge),{value:a(S),style:{width:"325px"},mode:"multiple","onUpdate:value":L[0]||(L[0]=h=>p(h))},{default:i(()=>[(l(!0),v(K,null,H(a(Os),h=>(l(),y(a(Qe),{key:h,value:h},{default:i(()=>[k(D(a(C)(h)),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1})]),_:1})]),_:1})]),_:1}),w("div",er,[w("div",tr,[d(a(U),{align:"start"},{default:i(()=>[d(a(at),{modelValue:b.value,"onUpdate:modelValue":L[1]||(L[1]=h=>b.value=h),class:"draggable","item-key":h=>h.selected_stage.id,"ghost-class":"ghost",onStart:a(R),onEnd:a(f),onChange:a(Z)},{item:i(({element:h,index:E})=>[(l(),y(a(Js),{key:h.selected_stage.id,column:h,router:a(n),"has-pagination":a(N)(h),"kanban-repository":t.kanbanRepository,class:"stages-content-column",onIncreasePagination:I=>a(T)(h),onCardInspection:I=>a(r)(h,I),onCardAction:I=>a(x)(h,I),onStageUpdate:I=>a(A)(I,E)},null,8,["column","router","has-pagination","kanban-repository","onIncreasePagination","onCardInspection","onCardAction","onStageUpdate"]))]),_:1},8,["modelValue","item-key","onStart","onEnd","onChange"]),d(a(Qs),{stages:a(_).next_stage_options||[],onStageUpdate:L[2]||(L[2]=h=>a(c)(h))},null,8,["stages"])]),_:1})])])]),_:1}),a(m).state==="stage-run"&&a(u)?(l(),y(a(Bs),{key:0,"kanban-repository":t.kanbanRepository,"stage-run":a(u),"stage-run-repository":t.stageRunRepository,onClose:a(s)},null,8,["kanban-repository","stage-run","stage-run-repository","onClose"])):P("",!0)]))}});const Zr=Q(ar,[["__scopeId","data-v-06379119"]]),nr=2e3,fe=[{title:"Thread",dataIndex:"thread"},{title:"Stage",dataIndex:"stage"},{title:"Status",dataIndex:"status"},{title:"Updated at",dataIndex:"updated_at"}],or=({kanbanRepository:o})=>{const t=Fe(),n=M(0),s=M(1),r=M(10),m=async()=>{var C,b;const c=await o.getStages(),f=await o.getData({filter:{},limit:1e3,offset:0}),R=(C=f.stage_run_cards)==null?void 0:C.map(g=>g.content.map(L=>L.key)).flat(),x=Array.from(new Set(R)),N=[...fe.map(g=>g.title),...x],Z=(b=f.stage_run_cards)==null?void 0:b.map(g=>{var h,E;const L=c.find(I=>I.id===g.stage);return[g.id,(h=L==null?void 0:L.title)!=null?h:"",g.status,(E=g.updated_at)!=null?E:"",...x.map(I=>{const $=g.content.find(z=>z.key===I);return $?JSON.stringify($.value):""})]}),S=new Date;return{columns:N,rows:Z!=null?Z:[],fileName:`therads-${S.toISOString()}`}},u=we(async()=>{var c,f,R,x;try{const T=await o.getStages();t.limit.value=r.value*s.value,t.offset.value=(s.value-1)*r.value;const N=t.requestDataFactory(),Z=await o.getData(N);n.value=Z.total_count;const S=(f=(c=Z.stage_run_cards)==null?void 0:c.map(h=>h.content.map(E=>E.key)).flat())!=null?f:[],C=Array.from(new Set(S)),b=(x=(R=Z.stage_run_cards)==null?void 0:R.reduce((h,E)=>{const I=T.find(z=>z.id===E.stage);let $={};for(const z of C){const q=E.content.find(Ve=>Ve.key===z);$={...$,[z]:q?q.value:null,status:E.status,thread:E.id,updated_at:E.updated_at,stage:I==null?void 0:I.title}}return h==null||h.push({type:I==null?void 0:I.type,...$}),h},[]))!=null?x:[],g=[];for(const h of fe)g.push({title:h.title,dataIndex:h.dataIndex});const L=[];for(const h of C)L.push({title:h,dataIndex:h.toLowerCase()});return g.push({title:"Data",children:L}),{tableColumns:g,tableRows:b}}catch{return{tableColumns:[],tableRows:[]}}});let p=null;return{setup:async()=>{u.refetch(),p=setInterval(()=>{u.refetch()},nr)},tearDown:()=>{p&&clearInterval(p)},tableAsyncComputed:u,totalCount:n,current:s,pageSize:r,filterController:t,getDataAsCsv:m}},sr=o=>{let t=o.columns.join(",")+`
`;o.rows.forEach(s=>{t+=s.join(","),t+=`
`});const n=document.createElement("a");n.href="data:text/csv;charset=utf-8,"+encodeURIComponent(t),n.target="_blank",n.download=`${o.fileName}.csv`,n.click()},rr={style:{padding:"20px"}},ir={style:{"text-align":"center",margin:"0"}},Fr=V({__name:"TableView",props:{kanbanRepository:{}},setup(o){const t=o,n=M(""),s=M(!1),r=M(!1),m=()=>{s.value=!0,x.filterSearch.value=n.value,u()},u=Xe.exports.debounce(()=>{A.refetch(),s.value=!1},500),{setup:p,tearDown:_,tableAsyncComputed:A,totalCount:c,current:f,pageSize:R,filterController:x,getDataAsCsv:T}=or({kanbanRepository:t.kanbanRepository}),N=O(()=>({total:c.value,current:f.value,pageSize:R.value,totalBoundaryShowSizeChanger:10,showSizeChanger:!0,pageSizeOptions:["10","25","50","100"],onChange:async(S,C)=>{f.value=S,R.value=C,await A.refetch()}})),Z=async()=>{if(r.value=!0,!A.result.value)return;const S=await T();sr(S),r.value=!1};return _e(p),Re(_),(S,C)=>(l(),v("div",rr,[d(a(j),{justify:"space-between",style:{"margin-bottom":"12px"}},{default:i(()=>[d(a(Ye),{value:n.value,"onUpdate:value":[C[0]||(C[0]=b=>n.value=b),m],placeholder:"Search data or status",style:{width:"400px"},"allow-clear":""},{prefix:i(()=>[d(a(et))]),suffix:i(()=>[s.value?(l(),y(a(Pe),{key:0})):P("",!0)]),_:1},8,["value"]),d(a(W),{loading:r.value,onClick:Z},{default:i(()=>[k("Export to CSV")]),_:1},8,["loading"])]),_:1}),a(A).result.value?(l(),y(a(tt),{key:0,columns:a(A).result.value.tableColumns,"data-source":a(A).result.value.tableRows,loading:s.value,pagination:N.value,scroll:{x:2400,y:700},bordered:"",size:"middle"},{headerCell:i(({column:b})=>[w("p",ir,D(b.title),1)]),bodyCell:i(({column:b,text:g,record:L})=>[b.dataIndex==="stage"?(l(),y(a(j),{key:0,gap:"small"},{default:i(()=>[(l(),y(ee(a(te)(L.type)),{size:"20"})),k(" "+D(g),1)]),_:2},1024)):P("",!0),b.dataIndex==="status"?(l(),y(a(j),{key:1,gap:"small"},{default:i(()=>[d(a(G),null,{default:i(()=>[k(D(a(St)(String(g)))+" ",1),g==="running"?(l(),y(a(Ee),{key:0,spin:!0,style:{"margin-left":"4px"}})):P("",!0)]),_:2},1024)]),_:2},1024)):P("",!0)]),_:1},8,["columns","data-source","loading","pagination"])):P("",!0)]))}});export{Dr as E,Zr as K,zr as L,Tr as P,Fr as _};
//# sourceMappingURL=TableView.vue_vue_type_script_setup_true_lang.e8e8f78c.js.map
