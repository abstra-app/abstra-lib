var F=Object.defineProperty;var B=(s,t,e)=>t in s?F(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var l=(s,t,e)=>(B(s,typeof t!="symbol"?t+"":t,e),e);import{R as z,ao as q,q as E,b as p,c as b,O as V,Q as J,x as C,d as M,K as y,r as W,a as K,F as Q,L as X,A as I,e as P,z as m,D as $,t as S,am as Y,an as Z,a8 as tt,G as A,y as et,w as x,B as G,ap as st,aq as it}from"./registerWidgets.60bba559.js";import{w as H,k as w}from"./runnerData.178be36e.js";import{e as at,R as ot}from"./executeJs.263d8eb0.js";import{p as nt}from"./passwordlessManager.e1b568b1.js";import{P as rt}from"./pubsub.6df2423b.js";import{P as lt}from"./Passwordless.4a584300.js";import{W as ht}from"./WidgetsFrame.c566de3c.js";import{e as dt}from"./icons.86798a2e.js";(function(){try{var s=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},t=new Error().stack;t&&(s._sentryDebugIds=s._sentryDebugIds||{},s._sentryDebugIds[t]="4082fece-3e7f-49de-a319-088f1aefecb8",s._sentryDebugIdIdentifier="sentry-dbid-4082fece-3e7f-49de-a319-088f1aefecb8")}catch{}})();function ee(s,t){return{dx:t.x-s.x,dy:t.y-s.y,referential:s.referential}}function ct(s,t){return s.rowEnd<t.rowStart||s.colEnd<t.colStart&&s.rowStart<t.rowEnd?-1:1}function se(s,t){const e=t.margin+s.colStart*(t.gap+t.cellWidth),i=t.margin+t.navbarLength+s.rowStart*(t.gap+t.cellHeight),a=t.margin-t.gap+(t.gap+t.cellWidth)*(s.colEnd+1),o=t.margin+t.navbarLength-t.gap+(t.gap+t.cellHeight)*(s.rowEnd+1);return{x:e,y:i,width:a-e,height:o-i,referential:"world"}}function ut(s,t){return{...s,position:{colStart:s.position.colStart+t.deltaI,colEnd:s.position.colEnd+t.deltaI,rowStart:s.position.rowStart+t.deltaJ,rowEnd:s.position.rowEnd+t.deltaJ}}}function ie(s,t,e=!1){return e?t.x<=s.x&&t.x+t.width>=s.x&&t.y<=s.y&&t.y+t.height>=s.y:t.x<s.x&&t.x+t.width>s.x&&t.y<s.y&&t.y+t.height>s.y}function ae(s,t){return!(s.x>t.x+t.width||t.x>s.x+s.width||s.y>t.y+t.height||t.y>s.y+s.height)}function oe(s,t){return!(s.colStart>t.colEnd||t.colStart>s.colEnd||s.rowStart>t.rowEnd||t.rowStart>s.rowEnd)}function ne(s,t,e){const i=s.y===t.y,a=s.x===t.x,o=s.x+s.width===t.x+t.width,n=s.y+s.height===t.y+t.height;switch(e){case"left":return a;case"right":return o;case"top":return i;case"bottom":return n;case"top-left":return i&&a;case"top-right":return i&&o;case"bottom-left":return n&&a;case"bottom-right":return n&&o}}const re=s=>s.reduce((t,e)=>{const i=t?Math.min(t.x,e.x):e.x,a=t?Math.min(t.y,e.y):e.y,o=t?Math.max(t.x+t.width,e.x+e.width):e.x+e.width,n=t?Math.max(t.y+t.height,e.y+e.height):e.y+e.height;return{x:i,y:a,width:o-i,height:n-a,referential:e.referential}},null);function le(s,t){return Math.sqrt((s.x-t.x)**2+(s.y-t.y)**2)}function gt(s){const t=[];let e=0;for(const i in s){const[a,o]=s[i];e+=s.filter(([d,c,f],r)=>!(o.position.colStart>c.position.colEnd||c.position.colStart>o.position.colEnd)&&c.position.rowEnd+f>o.position.rowStart&&r<+i).reduce((d,c)=>d+Math.max(c[2],0),0);const n=ut(o,{deltaJ:e,deltaI:0});t.push([a,n])}return t}function pt(s,t){const e=Object.entries(s).sort((o,n)=>ct(o[1].position,n[1].position)),i=o=>document.querySelector(`[widget-id='${o}']`);return gt(e.map(([o,n])=>[o,n,i(o)?t.height2rows(i(o).offsetHeight)-(n.position.rowEnd-n.position.rowStart):0])).reduce((o,[n,d])=>({...o,[n]:{...d,position:{...d.position,rowEnd:H[d.type].autoHeight&&i(n)?d.position.rowStart+t.height2rows(i(n).offsetHeight):d.position.rowEnd}}}),{})}const wt=(s,t,e)=>t&&!t.condition?{computedElement:{...s,position:{...s.position,row:s.position.row+e,height:0}},updateOffset:0,addOffset:0,slot:{}}:{computedElement:{...s,position:{...s.position,row:s.position.row+e}},updateOffset:s.position.height,addOffset:s.position.row,slot:s.slot},yt={"if-block":wt},mt=(s,t,e)=>ft(O(Object.values(s),{widgets:[],slottables:[]},0,t),e),ft=(s,t)=>({widgets:pt(s.widgets.reduce((e,i)=>({...e,[i.id]:i}),{}),t),slottables:s.slottables.reduce((e,i)=>({...e,[i.id]:i}),{})}),vt=(s,t)=>{if(w(s)&&w(t))return t.position.rowStart-s.position.rowStart;if(w(s)&&!w(t))return t.position.row-s.position.rowStart===0?-1:t.position.row-s.position.rowStart;if(!w(s)&&w(t))return t.position.rowStart-s.position.row===0?1:t.position.rowStart-s.position.row;if(!w(s)&&!w(t)){if(t.position.row-s.position.row===0){if(t.position.order===s.position.order)throw new Error("Two slottables with the same order in the same row");return t.position.order-s.position.order}return t.position.row-s.position.row}return 0},O=(s,t,e,i)=>s.sort(vt).reduce((a,o)=>bt(o,e,a,i),t),bt=(s,t,e,i)=>w(s)?St(s,t,e):Ct(s,t,e,i),St=(s,t,e)=>(e.widgets.push({...s,position:T(s.position,t)}),e),Ct=(s,t,e,i)=>{const{computedElement:a,slot:o,updateOffset:n,addOffset:d}=yt[s.type](s,i[s.id],t),c=Pt(e,n);return c.slottables.push(a),O(Object.values(o),c,t+d,i)},Pt=(s,t)=>({widgets:xt(s.widgets,t),slottables:kt(s.slottables,t)}),xt=(s,t)=>s.map(e=>({...e,position:T(e.position,t)})),kt=(s,t)=>s.map(e=>({...e,position:{...e.position,row:e.position.row+t}})),T=(s,t)=>({...s,rowStart:s.rowStart+t,rowEnd:s.rowEnd+t}),Et=960,L=12,Nt=0,Rt=24,Wt=32,It=8;class _{constructor(t,e){l(this,"width");l(this,"columns");l(this,"gap");l(this,"margin");l(this,"padding");l(this,"calculatePositions");l(this,"_cellHeight");l(this,"dashPlayerService");this.dashPlayerService=t,this.width=Et,this.columns=L,this.gap=Nt,this.margin=Rt,this.padding=It,this._cellHeight=Wt,this.calculatePositions=e}static create(t,e){return new _(t,e)}static get columns(){return L}get cellHeight(){return this._cellHeight}get navbarLength(){return this.dashPlayerService.navbarVisible?48:0}get cellWidth(){const t=this.columns-1;return(this.width-2*this.margin-t*this.gap)/this.columns}get rows(){const{widgets:t,slottables:e}=this.calculatePositions();return Math.max(Object.values(t!=null?t:{}).map(i=>i.position.rowEnd).reduce((i,a)=>Math.max(i,a),0)+4,Object.values(e!=null?e:{}).map(i=>i.position.row+i.position.height).reduce((i,a)=>Math.max(i,a),0)+4,20)}get sidebarWidth(){return this.dashPlayerService.hasSidebar?240:0}getCell(t,e){return{x:this.margin+t*(this.cellWidth+(t>0?this.gap:0)),y:this.margin+this.navbarLength+e*(this._cellHeight+(e>0?this.gap:0)),width:this.cellWidth,height:this._cellHeight,referential:"world"}}getCellFrom(t,e){const i=this.getCell(t.i,t.j);return this.cellAt(i.x+e.dx,i.y+e.dy)}areaFromRect(t){const e=this.cellAt(t.x,t.y),i={dx:t.width-1,dy:t.height-1,referential:"world"},a=this.getCellFrom(e,i);return{colStart:e.i,rowStart:e.j,colEnd:a.i,rowEnd:a.j}}rectFromArea(t){const e=this.getCell(t.colStart,t.rowStart),i=this.getCell(t.colEnd,t.rowEnd);return{x:e.x,y:e.y,width:i.x+i.width-e.x,height:i.y+i.height-e.y,referential:"world"}}get height(){return this.rows*(this._cellHeight+this.gap)-this.gap+2*this.margin}cellAt(t,e){return{i:Math.floor((t-this.margin)/(this.cellWidth+this.gap)),j:Math.floor((e-this.margin-this.navbarLength)/(this._cellHeight+this.gap))}}snap(t,e){const i=e==="bottom-right"||e==="top-right"?1:0,a=e==="bottom-left"||e==="bottom-right"?1:0,o=this.cellWidth+this.gap,n=this._cellHeight+this.gap,d=this.margin+this.cellWidth*i,c=this.margin+this.navbarLength+this.cellHeight*a,f=t.x-d,r=t.y-c;return{x:d+o*Math.round(f/o),y:c+n*Math.round(r/n),referential:"world"}}snapDelta(t){const e=this.cellWidth+this.gap,i=this._cellHeight+this.gap;return{dx:e*Math.round(t.dx/e),dy:i*Math.round(t.dy/i),referential:"world"}}height2rows(t){return Math.ceil((t+this.gap)/(this.cellHeight+this.gap))}}class D{constructor(t,e,i){l(this,"_stateTimestamp",Date.now());l(this,"_state");l(this,"runnerData");l(this,"passwordlessManager");l(this,"websocketClient");l(this,"_autocompleteState");l(this,"layoutGrid");l(this,"stateChangeCallbacks",[]);l(this,"updateUserCallbacks",[]);l(this,"onCloseCallbacks",[]);l(this,"onNoCreditsMessageCallbacks",[]);l(this,"onRedirectCallback",null);this._state=z({type:"IDLE"}),this._autocompleteState={suggestionsFor:null,suggestions:[]},this.runnerData=t,this.passwordlessManager=e,this.websocketClient=i,this.layoutGrid=_.create(this,()=>this.calculatePositions()),window.__playerService=()=>this,this.passwordlessManager.pubsub.subscribe("authenticated",a=>{a?this.endAuth():this.badAuth()})}notifyStateChange(t){this.stateChangeCallbacks.forEach(e=>e(t))}onStateChange(t){this.stateChangeCallbacks.push(t)}setState(t){this._state.value=t,this.notifyStateChange(t)}get state(){return this._state.value}static create(t,e,i){return new D(t,e,i)}updateRunnerData(t){this.runnerData=t}get brokerIsClosed(){var t;return(t=this.websocketClient.isClosed)!=null?t:!0}calculatePositions(t,e){const i=t||(this.state.type==="RUNNING"?this.state.props:{}),a=e!=null?e:this.runnerData.layout.slot;return mt(a,i,this.layoutGrid)}updateDashData(t){if(!t)throw new Error("dash is null");if(!t.layout)throw new Error("dash.layout is null");switch(this.state.type){case"RUNNING":{this.runnerData=t;const{widgets:e}=this.calculatePositions();this.setState({...this.state,widgets:e});break}default:throw new Error(`Invalid state ${this.state.type} for updateDashData`)}}async start(t={}){this.clearSuggestions(),this.websocketClient.isClosed||this.websocketClient.reset(),this.websocketClient.onClose(e=>{this.closeCallback(e)}),this.websocketClient.on("program-start-failed",e=>{this.setState({...e,type:"ERROR",cause:"PROGRAM_START_FAILED"})}),this.websocketClient.on("execution-id",()=>{this.websocketClient.send({type:"client-start",state:this.apiPageState,params:t})}),this.websocketClient.on("widgets-computed",e=>{const{widgets:i,slottables:a}=this.calculatePositions(e.props),o=this.state.type==="RUNNING"?{...this.state.responses}:{};if(e.variables)for(const n in e.variables)o[n]=new q(e.props[n]),o[n].setValue(e.variables[n]);this.setState({...e,type:"RUNNING",eventProcessing:!1,alerts:this.state.type==="RUNNING"?this.state.alerts:[],widgets:i,responses:o,slottables:a,authenticatedUser:this.passwordlessManager.getUser()})}),this.websocketClient.on("not-enough-credits",()=>{this.noCreditsMessage()}),this.websocketClient.on("redirect",e=>{this.redirect(e)}),this.websocketClient.on("auth:require-info",()=>{this.passwordlessManager.getUser()?this.endAuth():this.startAuth()}),this.websocketClient.on("autocomplete:suggestions",({suggestionsFor:e,suggestions:i})=>{this._autocompleteState={suggestionsFor:e,suggestions:i}}),this.websocketClient.on("alert",e=>{this.state.type==="RUNNING"&&this.setState({...this.state,alerts:[...this.state.alerts,{message:e.message,severity:e.severity,id:this.state.alerts.length}]})}),this.websocketClient.on("execute-js:request",async e=>{this.websocketClient.send({type:"execute-js:response",value:await at(e)})}),this.websocketClient.connect()}sendWidgetsChanged(t){this.websocketClient.send({type:"widgets-changed",state:this.apiPageState,dashDefinition:{slot:t}})}sendEvalRequest(t){this.websocketClient.send({type:"eval",expression:t,state:this.apiPageState})}sendVariableCreated(t){this.websocketClient.send({name:t,value:null,type:"variable-created",state:this.apiPageState})}makeWidgetsError(t){return{widgets:Object.keys(this.runnerData.layout.slot).reduce((i,a)=>(i[a]={repr:t},i),{}),props:{},variables:{}}}onUpdateUser(t){this.updateUserCallbacks.push(t)}onClose(t){this.onCloseCallbacks.push(t)}closeCallback(t){this.onCloseCallbacks.forEach(e=>e(t))}onNoCreditsMessage(t){this.onNoCreditsMessageCallbacks.push(t)}noCreditsMessage(){this.onNoCreditsMessageCallbacks.forEach(t=>t())}onRedirect(t){this.onRedirectCallback=t}redirect(t){!this.onRedirectCallback||this.onRedirectCallback(t)}wait(t){return this.websocketClient.wait(t)}on(t,e){this.websocketClient.on(t,e)}onMany(t,e){t.forEach(i=>this.on(i,e))}get apiPageState(){const t=this.state.type==="RUNNING"?this.state.responses:{},e=Object.keys(this.runnerData.layout.slot).reduce((i,a)=>{var o,n;return{...i,[a]:{value:(n=(o=t[a])==null?void 0:o.value)!=null?n:null}}},{});return{timestamp:this._stateTimestamp,widgets:e}}getUserEmail(){var t,e;switch(this.state.type){case"RUNNING":return(e=(t=this.state.authenticatedUser)==null?void 0:t.claims.email)!=null?e:null;default:return null}}startAuth(){switch(this.state.type){case"RUNNING":case"IDLE":this.setState({type:"AUTHENTICATING",previousState:this.state});break;default:throw new Error(`Invalid state ${this.state.type} for startAuth`)}}async endAuth(){this.websocketClient.send({type:"auth:saved-jwt",jwt:this.passwordlessManager.getUser().jwt}),await new Promise((t,e)=>{this.websocketClient.on("auth:valid-jwt",t),this.websocketClient.on("auth:invalid-jwt",e)})}badAuth(){if(this.state.type!=="AUTHENTICATING")throw new Error(`Invalid state ${this.state.type} for badAuth`);this.state.previousState.type==="RUNNING"?this.setState({...this.state.previousState,authenticatedUser:null}):this.state.previousState.type==="IDLE"&&this.setState({...this.state.previousState})}logout(){this.passwordlessManager.removeUser(),this.start()}isAuthenticating(){return this.state.type==="AUTHENTICATING"}get suggestionsFor(){return this._autocompleteState.suggestionsFor}get suggestions(){return this._autocompleteState.suggestions}clearSuggestions(){this._autocompleteState={suggestionsFor:null,suggestions:[]}}getAutocompleteSuggestions(t,e){t!==this.suggestionsFor&&this.clearSuggestions(),this.websocketClient.send({type:"autocomplete:load",suggestionsFor:t,code:e})}get navbarVisible(){const{logoUrl:t,brandName:e}=this.runnerData,i=this.getUserEmail();return!!(this.hasSidebar||t||e||i)}get hasSidebar(){const t=this.runnerData.sidebar;return!t||t.length==0?!1:t.some(e=>e.visible)}getWidgetsListeners(){switch(this.state.type){case"RUNNING":return Object.entries(this.state.widgets).reduce((t,[e,i])=>({...t,[e]:this.listenersFromWidget(e,i.type)}),{});default:return{}}}listenersFromWidget(t,e){return H[e].events.reduce((i,a)=>({...i,[a.key]:o=>{this.sendWidgetInputMessage(t),this.sendWidgetEventMessage(t,a.key,o)}}),{})}sendWidgetInputMessage(t){!this.websocketClient||this.websocketClient.send({type:"widget-input",widgetId:t,state:this.apiPageState})}sendWidgetEventMessage(t,e,i){if(!this.websocketClient||this.state.type!=="RUNNING")return;const a=this.apiPageState;this.websocketClient.send({type:"widget-event",event:{type:e,payload:i},widgetId:t,state:a}),this.setState({...this.state,eventProcessing:!0})}}class U{constructor(t){l(this,"ws");l(this,"pubsub");l(this,"dash");this.pubsub=new rt,this.ws=null,this.dash=t,this.pubsub.wait("close")}static create(t){return new U(t)}get url(){return`${location.protocol==="https:"?"wss:":"ws:"}//${location.host}/_socket?dashPath=${encodeURIComponent(this.dash.path)}`}get isClosed(){return this.ws?this.ws.readyState!==WebSocket.OPEN:!0}on(t,e){this.pubsub.subscribe(t,e)}wait(t){return this.pubsub.wait(t)}reset(){if(!this.ws)throw new Error("no websocket to clear");this.pubsub.reset(),this.ws.close()}async connect(t=1){t>3||await new Promise((e,i)=>{this.ws=new WebSocket(this.url),this.ws.onopen=()=>{e()},this.ws.onerror=a=>{i(a)},this.ws.onclose=()=>{this.pubsub.publish("close")},this.ws.onmessage=a=>{const o=JSON.parse(a.data);this.pubsub.publish(o.type,o)}}).catch(e=>{console.error(e),this.connect(t+1)})}onClose(t){this.pubsub.subscribe("close",t)}close(){if(!this.ws)throw new Error("no websocket to close");this.ws.close()}async send(t){if(!this.ws)throw new Error("no websocket to send");if(this.isClosed)throw new Error("websocket is closed");this.ws.send(JSON.stringify(t))}}function he(s){const t=U.create(s);return D.create(s,nt,t)}const Mt={},_t=s=>(V("data-v-5d7ea65b"),s=s(),J(),s),Dt={class:"dash-loading"},Ut=_t(()=>C("div",{class:"dash-loading-container"},[C("div",{class:"loading-bar-background"}),C("div",{class:"loading-bar"})],-1)),Gt=[Ut];function Lt(s,t){return p(),b("div",Dt,Gt)}const $t=E(Mt,[["render",Lt],["__scopeId","data-v-5d7ea65b"]]);function k(){return window.matchMedia("(min-width: 1200px)").matches}const At={key:0,class:"error-widget"},Ht={key:0},Ot={key:2,class:"loading"},Tt=M({__name:"WidgetsGrid",props:{camera:null,isPreview:{type:Boolean},widgetsWithErrors:null,grid:null,widgetsListeners:null,widgetsProps:null,widgetsResponses:null,widgets:null,forceResponsivity:null},setup(s){const t=s,e=y(()=>({...i.value,padding:`${t.grid.margin}px`,gap:`${t.grid.gap}px`,maxWidth:`${t.grid.width}px`,height:`${t.grid.height}px`,gridTemplateColumns:`repeat(${t.grid.columns}, ${t.grid.cellWidth}px)`,gridTemplateRows:`repeat(auto-fill, ${t.grid.cellHeight}px)`})),i=y(()=>{const r=k()?t.grid.sidebarWidth+(a.value-t.grid.sidebarWidth-960)/2:(a.value-960)/2;return{"--dash-right-margin":`${k()?(a.value-t.grid.sidebarWidth-960)/2:(a.value-960)/2}px`,"--dash-left-margin":`${r}px`}}),a=W(window.innerWidth);window.addEventListener("resize",()=>{a.value=window.innerWidth});const o=r=>{const u=r.target;u.scrollHeight>u.clientHeight&&r.stopPropagation()};function n(r){return{gridColumnStart:`${r.position.colStart+1}`,gridColumnEnd:`${r.position.colEnd+2}`,gridRowStart:`${r.position.rowStart+1}`,gridRowEnd:`${r.position.rowEnd+2}`,padding:`${t.grid.padding}px`}}const d=r=>{const u=r.position.rowEnd-r.position.rowStart+1;return u*t.grid.cellHeight+(u-1)*t.grid.gap-2*t.grid.padding},c=r=>{const u=r.position.colEnd-r.position.colStart+1;return u*t.grid.cellWidth+(u-1)*t.grid.gap-2*t.grid.padding},f=r=>{var u;return r in((u=t.widgetsProps)!=null?u:{})};return(r,u)=>{const N=K("icon");return p(),b("div",{class:A(["dash",s.forceResponsivity]),style:I(m(e))},[(p(!0),b(Q,null,X(s.widgets,(h,g)=>{var v,R;return p(),b("div",{key:g,class:"widget",style:I(n(h)),onWheel:o},[((v=s.widgetsWithErrors)==null?void 0:v.find(j=>j==g))&&s.isPreview?(p(),b("div",At,[P(N,{width:"20",height:"20",path:m(dt),fill:"#D35249"},null,8,["path"]),c(h)>=160&&d(h)>=120?(p(),b("p",Ht," Ops! There is an error in this widget's properties ")):$("",!0)])):f(g)?(p(),S(tt(h.type),Y({key:1,data:s.widgetsProps[g],response:s.widgetsResponses[g],runtime:"dash","container-width":c(h),"container-height":d(h),zoom:(R=s.camera)==null?void 0:R.zoom,"widget-id":g},Z(s.widgetsListeners[g])),null,16,["data","response","container-width","container-height","zoom","widget-id"])):(p(),b("div",Ot))],36)}),128))],6)}}});const jt=E(Tt,[["__scopeId","data-v-4d2eaf45"]]),Ft=M({__name:"LayoutPresenter",props:{widgets:null,props:null,responses:null,widgetsListeners:null,camera:null,forceResponsivity:null,grid:null,widgetsWithErrors:null,runnerData:null,isPreview:{type:Boolean}},setup(s){const t=et();return(e,i)=>(p(),S(ht,{class:"dash-player","main-color":s.runnerData.mainColor,"font-family":s.runnerData.fontFamily,theme:s.runnerData.theme,runtime:"dash"},{default:x(()=>[G(e.$slots,"header",{},void 0,!0),m(t).overrideMain?G(e.$slots,"overrideMain",{key:1},void 0,!0):(p(),S(jt,{key:0,camera:s.camera,"is-preview":s.isPreview,"widgets-with-errors":s.widgetsWithErrors,grid:s.grid,"widgets-listeners":s.widgetsListeners,"widgets-props":s.props,"widgets-responses":s.responses,widgets:s.widgets,"force-responsivity":s.forceResponsivity},null,8,["camera","is-preview","widgets-with-errors","grid","widgets-listeners","widgets-props","widgets-responses","widgets","force-responsivity"]))]),_:3},8,["main-color","font-family","theme"]))}});const Bt=E(Ft,[["__scopeId","data-v-4c9ad021"]]),zt=M({__name:"DashPlayer",props:{isPreview:{type:Boolean},dashPlayerService:null,forceResponsivity:null,camera:null,widgetsWithErrors:null,editingMode:{type:Boolean},params:null},emits:["navigate","logout"],setup(s,{emit:t}){const e=s,i=W(null),a=W(window.innerWidth);window.addEventListener("resize",()=>{a.value=window.innerWidth});const o=h=>t("navigate",h),n=y(()=>{var h;return(h=e.dashPlayerService.getUserEmail())!=null?h:void 0}),d=y(()=>e.dashPlayerService.state.type==="RUNNING"?e.dashPlayerService.state.widgets:Object.entries(e.dashPlayerService.runnerData.layout.slot).reduce((h,[g,v])=>Object.assign(h,{[g]:v}),{})),c=y(()=>e.dashPlayerService.state.type==="RUNNING"?e.dashPlayerService.state.responses:{}),f=y(()=>e.dashPlayerService.state.type==="RUNNING"?e.dashPlayerService.state.alerts:[]),r=y(()=>e.dashPlayerService.state.type==="RUNNING"?e.dashPlayerService.state.props:{}),u=y(()=>{const h=k()?e.dashPlayerService.layoutGrid.sidebarWidth+(a.value-e.dashPlayerService.layoutGrid.sidebarWidth-960)/2:(a.value-960)/2;return{"--dash-right-margin":`${k()?(a.value-e.dashPlayerService.layoutGrid.sidebarWidth-960)/2:(a.value-960)/2}px`,"--dash-left-margin":`${h}px`}}),N=y(()=>({...u.value,padding:`${e.dashPlayerService.layoutGrid.margin}px`,width:`${e.dashPlayerService.layoutGrid.width}px`,gap:`${e.dashPlayerService.layoutGrid.gap}px`,height:"100%",boxSizing:"border-box"}));return e.dashPlayerService.start(e.params),e.dashPlayerService.onNoCreditsMessage(()=>{var h;(h=i.value)==null||h.open()}),(h,g)=>{var v;return p(),S(Bt,{widgets:m(d),props:m(r),responses:m(c),"widgets-listeners":s.dashPlayerService.getWidgetsListeners(),camera:s.camera,"force-responsivity":s.forceResponsivity,grid:s.dashPlayerService.layoutGrid,"widgets-with-errors":(v=s.widgetsWithErrors)!=null?v:[],"runner-data":s.dashPlayerService.runnerData,"is-preview":s.isPreview},st({header:x(()=>[P(ot,{ref_key:"runtimeCommonsRef",ref:i,type:"dashes",runtime:s.dashPlayerService.runnerData,"full-width":!0,"is-preview":s.isPreview,"user-email":m(n),"force-responsivity":s.forceResponsivity,alerts:m(f),onNavigate:o,onLogout:g[0]||(g[0]=R=>s.dashPlayerService.logout())},null,8,["runtime","is-preview","user-email","force-responsivity","alerts"]),P(it,null,{default:x(()=>[s.dashPlayerService.state.type==="RUNNING"&&s.dashPlayerService.state.eventProcessing?(p(),S($t,{key:0})):$("",!0)]),_:1})]),_:2},[s.dashPlayerService.isAuthenticating()?{name:"overrideMain",fn:x(()=>[C("div",{class:A(["auth-form",s.forceResponsivity]),style:I(m(N))},[P(lt,{class:"form-auth"})],6)]),key:"0"}:void 0]),1032,["widgets","props","responses","widgets-listeners","camera","force-responsivity","grid","widgets-with-errors","runner-data","is-preview"])}}});const de=E(zt,[["__scopeId","data-v-541764d8"]]);export{de as D,ne as a,oe as b,ae as c,ee as d,ie as i,he as m,le as p,re as r,ct as v,se as w};
//# sourceMappingURL=DashPlayer.f85774c5.js.map
