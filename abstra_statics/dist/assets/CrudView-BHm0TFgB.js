import{c as E,d as $,B,r as O}from"./router-Bh5EUIsF.js";import{_ as j}from"./DocsButton.vue_vue_type_script_setup_true_lang-BsvmoIqd.js";import{i as L}from"./url-BBU-X0C9.js";import{G}from"./PhDotsThreeVertical.vue-DlsrKbnK.js";import{a as z,i as A,V as Q,r as N,b as u,f as s,u as n,ab as X,w as a,h as i,ba as Z,k as _,Q as V,Z as T,b5 as q,e as b,b3 as H,bc as J,b6 as W,b8 as Y,g as p,t as y,bd as K,c as ee,a7 as te,l as w,E as D,ak as le,aN as M,B as ae,be as ne,P as se,b4 as oe,T as h,bf as P,bg as U,bh as ue,bi as re,bj as ie,X as F,m as ce,aK as de}from"./jwt-decode.esm-BRRA-bKi.js";import{S as R}from"./index-87ABxo4B.js";(function(){try{var o=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},m=new Error().stack;m&&(o._sentryDebugIds=o._sentryDebugIds||{},o._sentryDebugIds[m]="24bf1693-eba2-4197-9f2b-a71a2567835a",o._sentryDebugIdIdentifier="sentry-dbid-24bf1693-eba2-4197-9f2b-a71a2567835a")}catch{}})();const pe=z({__name:"CreationModal",props:{entityName:{},fields:{},create:{type:Function}},setup(o,{expose:m}){const v=o,I=A.translate("i18n_creationmodal_title",null,{entityName:v.entityName}),c=Q({inputValue:{}}),x=N(!1),g=()=>x.value=!0,C=()=>{x.value=!1,c.inputValue={}},S=async()=>{try{await v.create(c.inputValue),C()}catch(d){d instanceof Error&&K.error({message:A.translate("i18n_creationmodal_failed_to_create"),description:d.message})}},r=(d,l)=>{const e=d.target.value,t=v.fields.find(k=>k.key===l);t?.format?c.inputValue[l]=t.format(e):c.inputValue[l]=e},f=(d,l)=>{const e=d.target.value,t=v.fields.find(k=>k.key===l);t?.blur?c.inputValue[l]=t.blur(e):c.inputValue[l]=e};return m({open:g,close:C}),(d,l)=>(s(),u(n(X),{open:x.value,title:n(I),onCancel:C,onOk:S},{default:a(()=>[i(n(Z),{layout:"vertical"},{default:a(()=>[(s(!0),_(V,null,T(o.fields,e=>(s(),u(n(q),{key:e.key,label:e.label,help:e.hint?.(c.inputValue[e.key]),tooltip:e.tooltip},{default:a(()=>[!e.type||e.type==="text"||e.type==="password"?(s(),u(n(H),{key:0,value:c.inputValue[e.key],"onUpdate:value":t=>c.inputValue[e.key]=t,placeholder:e.placeholder??"",type:e.type??"text",onInput:t=>r(t,e.key),onBlur:t=>f(t,e.key)},null,8,["value","onUpdate:value","placeholder","type","onInput","onBlur"])):e.type==="multiline-text"?(s(),u(n(J),{key:1,value:c.inputValue[e.key],"onUpdate:value":t=>c.inputValue[e.key]=t,placeholder:e.placeholder??"",onInput:t=>r(t,e.key),onBlur:t=>f(t,e.key)},null,8,["value","onUpdate:value","placeholder","onInput","onBlur"])):e.type==="select"?(s(),u(n(W),{key:2,value:c.inputValue[e.key],"onUpdate:value":t=>c.inputValue[e.key]=t,mode:e.mode,"show-search":!0,"option-filter-prop":"label",placeholder:e.placeholder??"Select options..."},{default:a(()=>[(s(!0),_(V,null,T(e.options,t=>(s(),u(n(Y),{key:typeof t=="string"?t:t.value,value:typeof t=="string"?t:t.value,label:typeof t=="string"?t:t.label},{default:a(()=>[p(y(typeof t=="string"?t:t.label),1)]),_:2},1032,["value","label"]))),128))]),_:2},1032,["value","onUpdate:value","mode","placeholder"])):b("",!0)]),_:2},1032,["label","help","tooltip"]))),128))]),_:1})]),_:1},8,["open","title"]))}}),ye={class:"action-warning"},fe=z({__name:"CrudView",props:{table:{},loading:{type:Boolean},title:{},emptyTitle:{},entityName:{},description:{},create:{type:Function},createButtonText:{},docsPath:{},live:{type:Boolean},fields:{}},setup(o){const m=o,v=N(null),I=(r,f)=>{const d=m.table.rows[0]?.cells[f].type;if(!(d==="actions"||d==="slot"))return(l,e)=>c(l,e,f)},c=(r,f,d)=>{const l=r.cells[d],e=f.cells[d];return l.type==="text"&&e.type==="text"||l.type==="tag"&&e.type==="tag"?l.text.localeCompare(e.text):l.type==="tags"&&e.type==="tags"?l.tags[0].text.localeCompare(e.tags[0].text):l.type==="secret"&&e.type==="secret"||l.type==="link"&&e.type==="link"?l.text.localeCompare(e.text):(l.type==="actions"&&e.type==="actions",0)},x=async()=>{m.fields?v.value?.open():m.create&&await m.create({})},g=N(!1);async function C(r,f){if(!g.value){g.value=!0;try{"onClick"in r?await r.onClick({key:f.key}):"link"in r&&(typeof r.link=="string"&&L(r.link)?open(r.link,"_blank"):O.push(r.link))}finally{g.value=!1}}}const S=ee(()=>({"--columnCount":`${m.table.columns.length}`}));return(r,f)=>{const d=te("RouterLink");return s(),_(V,null,[i(n(R),{direction:"vertical",class:"crud-view"},{default:a(()=>[i(n(D),{align:"center",justify:"space-between"},{default:a(()=>[o.title?(s(),u(n(le),{key:0},{default:a(()=>[p(y(o.title),1)]),_:1})):b("",!0),w(r.$slots,"more",{},void 0,!0)]),_:3}),o.description?(s(),u(n(M),{key:0},{default:a(()=>[p(y(o.description)+" ",1),w(r.$slots,"description",{},void 0,!0),o.docsPath?(s(),u(j,{key:0,path:o.docsPath},null,8,["path"])):b("",!0)]),_:3})):b("",!0),i(n(D),{gap:"middle"},{default:a(()=>[o.createButtonText?(s(),u(n(ae),{key:0,type:"primary",onClick:x},{default:a(()=>[p(y(o.createButtonText),1)]),_:1})):b("",!0),w(r.$slots,"secondary",{},void 0,!0)]),_:3}),w(r.$slots,"extra",{},void 0,!0),i(n(ne),{"filter-dropdown":!0,size:"small",style:se(S.value),"data-source":o.table.rows,loading:g.value||o.loading&&!o.live,height:400,columns:o.table.columns?.map((l,e)=>({...l,key:e,filtered:!0,align:l.align??"center",sorter:I(l,e)}))},{emptyText:a(()=>[p(y(o.emptyTitle),1)]),headerCell:a(l=>[p(y(l.title),1)]),bodyCell:a(({column:{key:l},record:e})=>[e.cells[l].type==="slot"?w(r.$slots,e.cells[l].key,{key:0,payload:e.cells[l].payload},void 0,!0):(s(),u(n(P),{key:1,open:e.cells[l].hover?void 0:!1},{content:a(()=>[i(n(M),{style:{width:"300px",overflow:"auto","font-family":"monospace"},copyable:"",content:e.cells[l].hover},null,8,["content"])]),default:a(()=>[e.cells[l].type==="text"?(s(),u(n(h),{key:0,secondary:e.cells[l].secondary,code:e.cells[l].code},{default:a(()=>[i(n(B),{dot:e.cells[l].contentType==="warning",color:"#faad14"},{default:a(()=>[p(y(e.cells[l].text),1)]),_:2},1032,["dot"])]),_:2},1032,["secondary","code"])):e.cells[l].type==="secret"?(s(),u(n(h),{key:1,copyable:{text:e.cells[l].text}},{default:a(()=>[...f[0]||(f[0]=[p(" ******** ",-1)])]),_:1},8,["copyable"])):e.cells[l].type==="tag"?(s(),u(n(U),{key:2,color:e.cells[l].tagColor},{default:a(()=>[p(y(e.cells[l].text),1)]),_:2},1032,["color"])):e.cells[l].type==="tags"?(s(),u(n(R),{key:3},{default:a(()=>[(s(!0),_(V,null,T(e.cells[l].tags,(t,k)=>(s(),u(n(U),{key:k,color:t.color},{default:a(()=>[p(y(t.text),1)]),_:2},1032,["color"]))),128))]),_:2},1024)):e.cells[l].type==="link"?(s(),u(d,{key:4,to:e.cells[l].to},{default:a(()=>[p(y(e.cells[l].text),1)]),_:2},1032,["to"])):e.cells[l].type==="actions"?(s(),u(n(ue),{key:5},{overlay:a(()=>[i(n(re),{disabled:g.value},{default:a(()=>[(s(!0),_(V,null,T(e.cells[l].actions.filter(t=>!t.hide),(t,k)=>(s(),u(n(ie),{key:k,danger:t.dangerous,onClick:me=>C(t,e)},{default:a(()=>[t.popoverMessage?(s(),u(n(P),{key:0,placement:"left"},{content:a(()=>[ce("div",ye,[i(n(h),null,{default:a(()=>[p(y(t.popoverMessage),1)]),_:2},1024)])]),default:a(()=>[i(n(h),{disabled:t.disabled,class:"action-item"},{default:a(()=>[i(n(B),{dot:t.badge,offset:[-2,2]},{default:a(()=>[t.icon?(s(),u(F(t.icon),{key:0})):b("",!0)]),_:2},1032,["dot"]),p(" "+y(t.label),1)]),_:2},1032,["disabled"])]),_:2},1024)):(s(),u(n(h),{key:1,disabled:t.disabled,class:"action-item"},{default:a(()=>[i(n(B),{dot:t.badge,offset:[-2,2]},{default:a(()=>[t.icon?(s(),u(F(t.icon),{key:0})):b("",!0)]),_:2},1032,["dot"]),p(" "+y(t.label),1)]),_:2},1032,["disabled"]))]),_:2},1032,["danger","onClick"]))),128))]),_:2},1032,["disabled"])]),default:a(()=>[i(n(B),{dot:e.cells[l].actions.some(t=>!t.hide&&t.badge),offset:[-2,2]},{default:a(()=>[i(n(G),{style:{cursor:"pointer"},size:"25px"})]),_:1},8,["dot"])]),_:2},1024)):b("",!0)]),_:2},1032,["open"]))]),footer:a(()=>[o.live?(s(),u(n(E),{key:0,justify:"end",gutter:10},{default:a(()=>[i(n($),{style:{display:"flex","align-items":"center"}},{default:a(()=>[i(n(oe),{size:"small",style:{display:"flex","align-items":"center"}})]),_:1}),i(n($),null,{default:a(()=>[i(n(h),null,{default:a(()=>[p(y(n(A).translate("i18n_crudview_auto_updating")),1)]),_:1})]),_:1})]),_:1})):b("",!0)]),_:3},8,["style","data-source","loading","columns"])]),_:3}),o.fields&&o.create?(s(),u(pe,{key:0,ref_key:"modalRef",ref:v,fields:o.fields,"entity-name":o.entityName,create:o.create},null,8,["fields","entity-name","create"])):b("",!0)],64)}}}),Ce=de(fe,[["__scopeId","data-v-0bbbc2f5"]]);export{Ce as C};
//# sourceMappingURL=CrudView-BHm0TFgB.js.map
