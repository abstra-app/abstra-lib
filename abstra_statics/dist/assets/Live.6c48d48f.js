import{d as C,X as k,H,b as l,eu as c,dj as $,ew as Z,ez as L,e as _,o as T,a0 as D,u as t,aC as E,eB as P,c as A,w as s,f as i,aq as n,eD as V,cz as N,bf as z,v as M,eA as R,cD as U,ct as q}from"./outputWidgets.1c4947c7.js";import{a as B}from"./asyncComputed.ab9c45d0.js";import{r as S}from"./router.f814fb07.js";import{B as F,a as G}from"./build.9b999d5f.js";import"./index.bf745b17.js";import{P as W}from"./project.e270a0d3.js";import{C as X}from"./CrudView.54cbe4c4.js";import{G as J}from"./PhArrowCounterClockwise.vue.f2de5a36.js";import{_ as K,E as O}from"./ExecutionStatusIcon.vue_vue_type_script_setup_true_lang.1e941e48.js";import{A as I}from"./Paragraph.110c4a21.js";import{A as w}from"./Text.4ed32514.js";import{A as j}from"./Link.1d840e4c.js";import{A as Q}from"./index.83f629a7.js";import"./Form.cba5cdce.js";import"./hasIn.58acd238.js";import"./popupNotifcation.bd532d77.js";import"./index.cf4c23b9.js";import"./record.438e3693.js";import"./pubsub.87f1efb9.js";import"./Modal.5c7e6d3c.js";import"./DocsButton.vue_vue_type_script_setup_true_lang.f7859d2d.js";import"./url.ca3e5e32.js";import"./index.a9af7b0b.js";import"./Title.6f4ab7f6.js";import"./LoadingOutlined.8f90842b.js";(function(){try{var f=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},d=new Error().stack;d&&(f._sentryDebugIds=f._sentryDebugIds||{},f._sentryDebugIds[d]="d40225b0-64ce-4d14-8f6a-6dcd932a0f6c",f._sentryDebugIdIdentifier="sentry-dbid-d40225b0-64ce-4d14-8f6a-6dcd932a0f6c")}catch{}})();const Y=["width","height","fill","transform"],ee={key:0},te=_("path",{d:"M180,64H40A12,12,0,0,0,28,76V216a12,12,0,0,0,12,12H180a12,12,0,0,0,12-12V76A12,12,0,0,0,180,64ZM168,204H52V88H168ZM228,40V180a12,12,0,0,1-24,0V52H76a12,12,0,0,1,0-24H216A12,12,0,0,1,228,40Z"},null,-1),ae=[te],oe={key:1},re=_("path",{d:"M184,72V216H40V72Z",opacity:"0.2"},null,-1),se=_("path",{d:"M184,64H40a8,8,0,0,0-8,8V216a8,8,0,0,0,8,8H184a8,8,0,0,0,8-8V72A8,8,0,0,0,184,64Zm-8,144H48V80H176ZM224,40V184a8,8,0,0,1-16,0V48H72a8,8,0,0,1,0-16H216A8,8,0,0,1,224,40Z"},null,-1),le=[re,se],ie={key:2},ne=_("path",{d:"M192,72V216a8,8,0,0,1-8,8H40a8,8,0,0,1-8-8V72a8,8,0,0,1,8-8H184A8,8,0,0,1,192,72Zm24-40H72a8,8,0,0,0,0,16H208V184a8,8,0,0,0,16,0V40A8,8,0,0,0,216,32Z"},null,-1),ce=[ne],de={key:3},pe=_("path",{d:"M184,66H40a6,6,0,0,0-6,6V216a6,6,0,0,0,6,6H184a6,6,0,0,0,6-6V72A6,6,0,0,0,184,66Zm-6,144H46V78H178ZM222,40V184a6,6,0,0,1-12,0V46H72a6,6,0,0,1,0-12H216A6,6,0,0,1,222,40Z"},null,-1),ue=[pe],me={key:4},fe=_("path",{d:"M184,64H40a8,8,0,0,0-8,8V216a8,8,0,0,0,8,8H184a8,8,0,0,0,8-8V72A8,8,0,0,0,184,64Zm-8,144H48V80H176ZM224,40V184a8,8,0,0,1-16,0V48H72a8,8,0,0,1,0-16H216A8,8,0,0,1,224,40Z"},null,-1),ge=[fe],_e={key:5},ye=_("path",{d:"M184,68H40a4,4,0,0,0-4,4V216a4,4,0,0,0,4,4H184a4,4,0,0,0,4-4V72A4,4,0,0,0,184,68Zm-4,144H44V76H180ZM220,40V184a4,4,0,0,1-8,0V44H72a4,4,0,0,1,0-8H216A4,4,0,0,1,220,40Z"},null,-1),he=[ye],ve={name:"PhCopySimple"},we=C({...ve,props:{weight:{type:String},size:{type:[String,Number]},color:{type:String},mirrored:{type:Boolean}},setup(f){const d=f,p=k("weight","regular"),b=k("size","1em"),y=k("color","currentColor"),g=k("mirrored",!1),m=H(()=>{var a;return(a=d.weight)!=null?a:p}),v=H(()=>{var a;return(a=d.size)!=null?a:b}),h=H(()=>{var a;return(a=d.color)!=null?a:y}),e=H(()=>d.mirrored!==void 0?d.mirrored?"scale(-1, 1)":void 0:g?"scale(-1, 1)":void 0);return(a,o)=>(l(),c("svg",L({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256",width:v.value,height:v.value,fill:h.value,transform:e.value},a.$attrs),[$(a.$slots,"default"),m.value==="bold"?(l(),c("g",ee,ae)):m.value==="duotone"?(l(),c("g",oe,le)):m.value==="fill"?(l(),c("g",ie,ce)):m.value==="light"?(l(),c("g",de,ue)):m.value==="regular"?(l(),c("g",me,ge)):m.value==="thin"?(l(),c("g",_e,he)):Z("",!0)],16,Y))}}),Ve={key:0,class:"flex-row"},be={key:1,class:"flex-row"},He={key:2,class:"flex-row"},ke=C({__name:"ExecutionsShort",props:{stageId:{},projectId:{}},emits:["select"],setup(f,{emit:d}){const p=f,b=new O,{result:y,refetch:g,loading:m}=B(async()=>{const{executions:e}=await b.list({projectId:p.projectId,stageId:p.stageId,limit:6});return e}),v=e=>{d("select",e)};let h=null;return T(()=>{h=setInterval(()=>g(),15e3)}),D(()=>{h&&clearInterval(h)}),(e,a)=>t(y)?(l(),c("div",Ve,[(l(!0),c(E,null,P(t(y),o=>(l(),A(t(N),{key:o.id,title:o.createdAt.toLocaleString(),onClick:r=>v(o)},{content:s(()=>[i(t(I),null,{default:s(()=>[n("Status: "+V(o.status),1)]),_:2},1024),i(t(I),null,{default:s(()=>[n("Duration: "+V(o.duration_seconds)+" s",1)]),_:2},1024),i(t(I),null,{default:s(()=>[n("Build: "+V(o.buildId.slice(0,6)),1)]),_:2},1024)]),default:s(()=>[i(K,{status:o.status},null,8,["status"])]),_:2},1032,["title","onClick"]))),128))])):t(m)?(l(),c("div",be,[i(t(z))])):(l(),c("div",He,"None"))}});const Ae=M(ke,[["__scopeId","data-v-dc7e11a2"]]),Ie={style:{"max-width":"250px",overflow:"hidden","text-overflow":"ellipsis ellipsis","white-space":"nowrap"}},Ce={key:1},xe=C({__name:"Live",setup(f){const p=R().params.projectId,b=e=>{S.push({name:"logs",params:{projectId:p},query:{runtimeId:e.stageId,executionId:e.id}})},{loading:y,result:g}=B(async()=>{const a=(await F.list(p)).find(u=>u.latest);if(!a)return null;const[o,r]=await Promise.all([G.get(a.id),W.get(p)]);return{buildSpec:o,project:r}}),m=e=>{var r;if(!("path"in e)||!e.path)return;const a=e.type==="form"?`/${e.path}`:`/_hooks/${e.path}`,o=(r=g.value)==null?void 0:r.project.getUrl(a);!o||(navigator.clipboard.writeText(o),q.success("Copied URL to clipboard"))},v=e=>e.type=="form"?`/${e.path}`.slice(0,30):e.type=="hook"?`/_hooks/${e.path}`.slice(0,30):e.type=="job"?`${e.schedule}`:"",h=H(()=>{var o;const e=[{name:"Type",align:"left"},{name:"Title",align:"left"},{name:"Trigger",align:"left"},{name:"Last Runs"},{name:"",align:"right"}],a=(o=g.value)==null?void 0:o.buildSpec;return a?{columns:e,rows:a.runtimes.map(r=>({key:r.id,cells:[{type:"tag",text:r.type.charAt(0).toUpperCase()+r.type.slice(1),tagColor:"default"},{type:"slot",key:"title",payload:{runtime:r}},{type:"slot",key:"trigger",payload:{runtime:r}},{type:"slot",key:"last-runs",payload:{runtime:r}},{type:"actions",actions:[{icon:J,label:"View script logs",onClick:()=>S.push({name:"logs",params:{projectId:p},query:{runtimeId:r.id}})},{icon:we,label:"Copy URL",onClick:()=>m(r),hide:!["form","hook"].includes(r.type)}]}]}))}:{columns:e,rows:[]}});return(e,a)=>{var o,r;return t(y)||((r=(o=t(g))==null?void 0:o.buildSpec.runtimes.length)!=null?r:0)>0?(l(),A(X,{key:0,"empty-title":"","entity-name":"build",description:"Access and monitor your project's current scripts here.",table:h.value,loading:t(y),title:"Live View"},{title:s(({payload:u})=>{var x;return[_("div",Ie,[u.runtime.type!="form"?(l(),A(t(w),{key:0},{default:s(()=>[n(V(u.runtime.title),1)]),_:2},1024)):u.runtime.type=="form"?(l(),A(t(j),{key:1,href:(x=t(g))==null?void 0:x.project.getUrl(u.runtime.path),target:"_blank"},{default:s(()=>[n(V(u.runtime.title),1)]),_:2},1032,["href"])):Z("",!0)])]}),"last-runs":s(({payload:u})=>[i(Ae,{"stage-id":u.runtime.id,"project-id":t(p),onSelect:b},null,8,["stage-id","project-id"])]),trigger:s(({payload:u})=>[i(t(Q),{color:"default"},{default:s(()=>[n(V(v(u.runtime)),1)]),_:2},1024)]),_:1},8,["table","loading"])):(l(),c("div",Ce,[i(t(U),{direction:"vertical"},{default:s(()=>[i(t(w),null,{default:s(()=>[n("Install abstra using pip:")]),_:1}),i(t(w),{code:"",copyable:""},{default:s(()=>[n("pip install abstra")]),_:1}),i(t(w),null,{default:s(()=>[n("Start a new project using our CLI")]),_:1}),i(t(w),{code:"",copyable:""},{default:s(()=>[n("abstra serve my-new-project")]),_:1}),i(t(w),null,{default:s(()=>[n(" If you have any questions, please reach out to our "),i(t(j),{href:"https://discord.gg/abstra",target:"_blank"},{default:s(()=>[n(" discord channel ")]),_:1})]),_:1})]),_:1})]))}}});const et=M(xe,[["__scopeId","data-v-0d5613c5"]]);export{et as default};
//# sourceMappingURL=Live.6c48d48f.js.map
