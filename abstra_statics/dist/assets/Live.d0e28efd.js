import{d as C,o as S,a0 as L,u as t,b as c,ev as y,bq as T,eC as B,c as h,w as s,f as a,aq as l,eD as _,cy as $,bg as D,v as A,eB as E,G as R,e as V,ex as U,cC as N,cs as P}from"./outputWidgets.6ccbc4ef.js";import{a as j}from"./asyncComputed.4b57594c.js";import{r as q}from"./router.1efc6d10.js";import{B as M,a as F}from"./build.268feec5.js";import"./index.b83ae962.js";import{P as G}from"./project.b3cb56cc.js";import{C as Q}from"./CrudView.791a6f16.js";import{Q as z,R as H}from"./icons.82dddcb2.js";import{_ as J,E as K}from"./ExecutionStatusIcon.vue_vue_type_script_setup_true_lang.6ff4a484.js";import{A as k}from"./Title.7c8ca050.js";import{A as O}from"./index.0434f529.js";import{A as f}from"./Text.5a73e528.js";import{A as x}from"./Link.0ab07bac.js";import{A as W}from"./index.14599eac.js";import"./FormItem.2f8cfa6a.js";import"./hasIn.34c78820.js";import"./index.45a4cb57.js";import"./index.cf4c23b9.js";import"./record.dad62399.js";import"./pubsub.35ef2c28.js";import"./Form.c40f5619.js";import"./Modal.c85746a4.js";import"./DocsButton.vue_vue_type_script_setup_true_lang.0f473479.js";import"./url.eb3faf3c.js";import"./CheckCircleFilled.b340c2e0.js";(function(){try{var d=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},m=new Error().stack;m&&(d._sentryDebugIds=d._sentryDebugIds||{},d._sentryDebugIds[m]="c04fb122-68ff-4ad0-911f-e9de7906380f",d._sentryDebugIdIdentifier="sentry-dbid-c04fb122-68ff-4ad0-911f-e9de7906380f")}catch{}})();const X={key:0,class:"flex-row"},Y={key:1,class:"flex-row"},Z={key:2,class:"flex-row"},ee=C({__name:"ExecutionsShort",props:{stageId:{},projectId:{}},emits:["select"],setup(d,{emit:m}){const p=d,g=new K,{result:u,refetch:b,loading:v}=j(async()=>{const{executions:r}=await g.list({projectId:p.projectId,stageId:p.stageId,limit:6});return r}),w=r=>{m("select",r)};let o=null;return S(()=>{o=setInterval(()=>b(),15e3)}),L(()=>{o&&clearInterval(o)}),(r,n)=>t(u)?(c(),y("div",X,[(c(!0),y(T,null,B(t(u),e=>(c(),h(t($),{key:e.id,title:e.createdAt.toLocaleString(),onClick:i=>w(e)},{content:s(()=>[a(t(k),null,{default:s(()=>[l("Status: "+_(e.status),1)]),_:2},1024),a(t(k),null,{default:s(()=>[l("Duration: "+_(e.duration_seconds)+" s",1)]),_:2},1024),a(t(k),null,{default:s(()=>[l("Build: "+_(e.buildId.slice(0,6)),1)]),_:2},1024)]),default:s(()=>[a(J,{status:e.status},null,8,["status"])]),_:2},1032,["title","onClick"]))),128))])):t(v)?(c(),y("div",Y,[a(t(D))])):(c(),y("div",Z,"None"))}});const te=A(ee,[["__scopeId","data-v-dc7e11a2"]]),oe={style:{"max-width":"250px",overflow:"hidden","text-overflow":"ellipsis ellipsis","white-space":"nowrap"}},se={key:1},ae=C({__name:"Live",setup(d){const p=E().params.projectId,{loading:g,result:u}=j(async()=>{const r=(await M.list(p)).find(i=>i.latest);if(!r)return null;const[n,e]=await Promise.all([F.get(r.id),G.get(p)]);return{buildSpec:n,project:e}}),b=o=>{var e;if(!("path"in o)||!o.path)return;const r=o.type==="form"?`/${o.path}`:`/_hooks/${o.path}`,n=(e=u.value)==null?void 0:e.project.getUrl(r);!n||(navigator.clipboard.writeText(n),P.success("Copied URL to clipboard"))},v=o=>o.type=="form"?`/${o.path}`.slice(0,30):o.type=="hook"?`/_hooks/${o.path}`.slice(0,30):o.type=="job"?`${o.schedule}`:"",w=R(()=>{var n;const o=[{name:"Type",align:"left"},{name:"Title",align:"left"},{name:"Trigger",align:"left"},{name:"Last Runs"},{name:"",align:"right"}],r=(n=u.value)==null?void 0:n.buildSpec;return r?{columns:o,rows:r.runtimes.map(e=>({key:e.id,cells:[{type:"tag",text:e.type.charAt(0).toUpperCase()+e.type.slice(1),tagColor:"default"},{type:"slot",key:"title",payload:{runtime:e}},{type:"slot",key:"trigger",payload:{runtime:e}},{type:"slot",key:"last-runs",payload:{runtime:e}},{type:"actions",actions:[{icon:z,label:"View script logs",onClick:()=>q.push({name:"logs",params:{projectId:p},query:{runtimeId:e.id}})},{icon:H,label:"Copy URL",onClick:()=>b(e),hide:!["form","hook"].includes(e.type)}]}]}))}:{columns:o,rows:[]}});return(o,r)=>{var n,e;return t(g)||((e=(n=t(u))==null?void 0:n.buildSpec.runtimes.length)!=null?e:0)>0?(c(),h(Q,{key:0,"empty-title":"","entity-name":"build",description:"Access and monitor your project's current scripts here.",table:w.value,loading:t(g),title:"Live View"},{extra:s(()=>[a(t(O),{message:"Last runs will only be shown for deploys with abstra version >= 1.27.0",type:"info","show-icon":""})]),title:s(({payload:i})=>{var I;return[V("div",oe,[i.runtime.type!="form"?(c(),h(t(f),{key:0},{default:s(()=>[l(_(i.runtime.title),1)]),_:2},1024)):i.runtime.type=="form"?(c(),h(t(x),{key:1,href:(I=t(u))==null?void 0:I.project.getUrl(i.runtime.path)},{default:s(()=>[l(_(i.runtime.title),1)]),_:2},1032,["href"])):U("",!0)])]}),"last-runs":s(({payload:i})=>[a(te,{"stage-id":i.runtime.id,"project-id":t(p)},null,8,["stage-id","project-id"])]),trigger:s(({payload:i})=>[a(t(W),{color:"default"},{default:s(()=>[l(_(v(i.runtime)),1)]),_:2},1024)]),_:1},8,["table","loading"])):(c(),y("div",se,[a(t(N),{direction:"vertical"},{default:s(()=>[a(t(f),null,{default:s(()=>[l("Install abstra using pip:")]),_:1}),a(t(f),{code:"",copyable:""},{default:s(()=>[l("pip install abstra")]),_:1}),a(t(f),null,{default:s(()=>[l("Start a new project using our CLI")]),_:1}),a(t(f),{code:"",copyable:""},{default:s(()=>[l("abstra serve my-new-project")]),_:1}),a(t(f),null,{default:s(()=>[l(" If you have any questions, please reach out to our "),a(t(x),{href:"https://discord.gg/abstra",target:"_blank"},{default:s(()=>[l(" discord channel ")]),_:1})]),_:1})]),_:1})]))}}});const Te=A(ae,[["__scopeId","data-v-cb25cce1"]]);export{Te as default};
//# sourceMappingURL=Live.d0e28efd.js.map
