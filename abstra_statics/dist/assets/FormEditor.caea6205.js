import{F as D,a as se,b as ie,c as ue,d as de,r as me}from"./FormRunner.17c9fedb.js";import{d as R,D as T,f as $,o as d,Y as _,$ as K,S as Z,e8 as Y,a as w,e as C,b as a,w as t,u as e,dd as U,aG as y,cX as pe,d9 as V,cz as A,bL as M,cy as X,aS as B,em as ce,en as fe,a0 as O,c as H,by as ve,aW as W,cB as ge,bT as P,dh as N,e9 as z,N as J,O as E,da as he,cO as ye,eN as be,bO as j,eb as _e,cL as Se,eo as we,ea as ke,g as G,z as Ae,cM as Me}from"./index.dc88667e.js";import{a as Ce}from"./asyncComputed.a7dbdd76.js";import{F as $e}from"./scripts.16092801.js";import"./linters.c98c6d53.js";import{W as He}from"./workspaces.7e54abb0.js";import{I as Fe,R as Ze,_ as Te}from"./RuntimeCommonSettings.b908839f.js";import{A as Pe}from"./index.d6710f2c.js";import{b as Re,u as Le}from"./workspaceStore.d9e3c30c.js";import{P as Ee}from"./PlayerNavbar.d1e9fa4b.js";import{W as Ue}from"./PlayerConfigProvider.c475d57d.js";import{F as Ve}from"./PhArrowSquareOut.vue.e5d0b99d.js";import{C as Ie}from"./Card.bc9db42d.js";import{A as De}from"./index.bec01af1.js";import"./url.5ed3520f.js";import"./Login.vue_vue_type_script_setup_true_lang.6e721ab8.js";import"./Logo.51e83a5a.js";import"./string.e754d5d0.js";import"./OTPInput.fc2e97ce.js";import"./Steps.a50c7ddd.js";import"./index.89bed9e6.js";import"./Watermark.a6d4d05b.js";import"./record.360cbd9f.js";import"./colorHelpers.8de24d2e.js";import"./BaseLayout.c7d4cb13.js";import"./SaveButton.65252b10.js";import"./UnsavedChangesHandler.fe0c5cec.js";import"./ExclamationCircleOutlined.2f5e763a.js";import"./uuid.2fd8adce.js";import"./NavbarControls.c7d64dae.js";import"./CloseCircleOutlined.ff09d9a4.js";import"./editor.c518505b.js";import"./popupNotifcation.07f02947.js";import"./DocsButton.vue_vue_type_script_setup_true_lang.b35a6b89.js";import"./BookOutlined.da0d7d4b.js";import"./PhChats.vue.d8ee2915.js";import"./polling.b8dd3a80.js";import"./AbstraLogo.vue_vue_type_script_setup_true_lang.e512f1d5.js";import"./ant-design.e2e6a292.js";import"./ai.5c59c497.js";import"./PhCheckCircle.vue.92eb2768.js";import"./PhCopySimple.vue.64c797b0.js";import"./Avatar.533b5f4a.js";import"./LoadingOutlined.0d711b36.js";import"./PhCaretRight.vue.84bc10d7.js";import"./Badge.a75be3a7.js";import"./PhFolder.vue.3fd0d683.js";import"./PhPencil.vue.2fb660a0.js";import"./validations.c6bf328a.js";import"./toggleHighContrast.c172540e.js";import"./TasksManager.32835c5c.js";import"./tasksController.ed09d419.js";import"./gateway.bfbb9203.js";import"./AbstraButton.vue_vue_type_script_setup_true_lang.52a79043.js";import"./index.c08afab6.js";import"./CollapsePanel.d231cb2c.js";import"./index.2fce01dd.js";import"./TabPane.51585bae.js";import"./index.b74f86cc.js";import"./index.04a5bd8d.js";import"./metadata.839477e7.js";import"./PhRobot.vue.807dd4b4.js";import"./PhWebhooksLogo.vue.7bd328f8.js";import"./PhSignOut.vue.c195bd65.js";import"./index.d7c0c8c1.js";(function(){try{var b=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},m=new Error().stack;m&&(b._sentryDebugIds=b._sentryDebugIds||{},b._sentryDebugIds[m]="2f49d784-7a9f-407b-8a45-8947679756cb",b._sentryDebugIdIdentifier="sentry-dbid-2f49d784-7a9f-407b-8a45-8947679756cb")}catch{}})();const We=["width","height","fill","transform"],Be={key:0},qe=w("path",{d:"M228,48V96a12,12,0,0,1-12,12H168a12,12,0,0,1,0-24h19l-7.8-7.8a75.55,75.55,0,0,0-53.32-22.26h-.43A75.49,75.49,0,0,0,72.39,75.57,12,12,0,1,1,55.61,58.41a99.38,99.38,0,0,1,69.87-28.47H126A99.42,99.42,0,0,1,196.2,59.23L204,67V48a12,12,0,0,1,24,0ZM183.61,180.43a75.49,75.49,0,0,1-53.09,21.63h-.43A75.55,75.55,0,0,1,76.77,179.8L69,172H88a12,12,0,0,0,0-24H40a12,12,0,0,0-12,12v48a12,12,0,0,0,24,0V189l7.8,7.8A99.42,99.42,0,0,0,130,226.06h.56a99.38,99.38,0,0,0,69.87-28.47,12,12,0,0,0-16.78-17.16Z"},null,-1),Ne=[qe],ze={key:1},Oe=w("path",{d:"M216,128a88,88,0,1,1-88-88A88,88,0,0,1,216,128Z",opacity:"0.2"},null,-1),Qe=w("path",{d:"M224,48V96a8,8,0,0,1-8,8H168a8,8,0,0,1,0-16h28.69L182.06,73.37a79.56,79.56,0,0,0-56.13-23.43h-.45A79.52,79.52,0,0,0,69.59,72.71,8,8,0,0,1,58.41,61.27a96,96,0,0,1,135,.79L208,76.69V48a8,8,0,0,1,16,0ZM186.41,183.29a80,80,0,0,1-112.47-.66L59.31,168H88a8,8,0,0,0,0-16H40a8,8,0,0,0-8,8v48a8,8,0,0,0,16,0V179.31l14.63,14.63A95.43,95.43,0,0,0,130,222.06h.53a95.36,95.36,0,0,0,67.07-27.33,8,8,0,0,0-11.18-11.44Z"},null,-1),xe=[Oe,Qe],je={key:2},Ge=w("path",{d:"M224,48V96a8,8,0,0,1-8,8H168a8,8,0,0,1-5.66-13.66L180.65,72a79.48,79.48,0,0,0-54.72-22.09h-.45A79.52,79.52,0,0,0,69.59,72.71,8,8,0,0,1,58.41,61.27,96,96,0,0,1,192,60.7l18.36-18.36A8,8,0,0,1,224,48ZM186.41,183.29A80,80,0,0,1,75.35,184l18.31-18.31A8,8,0,0,0,88,152H40a8,8,0,0,0-8,8v48a8,8,0,0,0,13.66,5.66L64,195.3a95.42,95.42,0,0,0,66,26.76h.53a95.36,95.36,0,0,0,67.07-27.33,8,8,0,0,0-11.18-11.44Z"},null,-1),Ke=[Ge],Ye={key:3},Xe=w("path",{d:"M222,48V96a6,6,0,0,1-6,6H168a6,6,0,0,1,0-12h33.52L183.47,72a81.51,81.51,0,0,0-57.53-24h-.46A81.5,81.5,0,0,0,68.19,71.28a6,6,0,1,1-8.38-8.58,93.38,93.38,0,0,1,65.67-26.76H126a93.45,93.45,0,0,1,66,27.53l18,18V48a6,6,0,0,1,12,0ZM187.81,184.72a81.5,81.5,0,0,1-57.29,23.34h-.46a81.51,81.51,0,0,1-57.53-24L54.48,166H88a6,6,0,0,0,0-12H40a6,6,0,0,0-6,6v48a6,6,0,0,0,12,0V174.48l18,18.05a93.45,93.45,0,0,0,66,27.53h.52a93.38,93.38,0,0,0,65.67-26.76,6,6,0,1,0-8.38-8.58Z"},null,-1),Je=[Xe],ea={key:4},aa=w("path",{d:"M224,48V96a8,8,0,0,1-8,8H168a8,8,0,0,1,0-16h28.69L182.06,73.37a79.56,79.56,0,0,0-56.13-23.43h-.45A79.52,79.52,0,0,0,69.59,72.71,8,8,0,0,1,58.41,61.27a96,96,0,0,1,135,.79L208,76.69V48a8,8,0,0,1,16,0ZM186.41,183.29a80,80,0,0,1-112.47-.66L59.31,168H88a8,8,0,0,0,0-16H40a8,8,0,0,0-8,8v48a8,8,0,0,0,16,0V179.31l14.63,14.63A95.43,95.43,0,0,0,130,222.06h.53a95.36,95.36,0,0,0,67.07-27.33,8,8,0,0,0-11.18-11.44Z"},null,-1),ta=[aa],ra={key:5},oa=w("path",{d:"M220,48V96a4,4,0,0,1-4,4H168a4,4,0,0,1,0-8h38.34L184.89,70.54A84,84,0,0,0,66.8,69.85a4,4,0,1,1-5.6-5.72,92,92,0,0,1,129.34.76L212,86.34V48a4,4,0,0,1,8,0ZM189.2,186.15a83.44,83.44,0,0,1-58.68,23.91h-.47a83.52,83.52,0,0,1-58.94-24.6L49.66,164H88a4,4,0,0,0,0-8H40a4,4,0,0,0-4,4v48a4,4,0,0,0,8,0V169.66l21.46,21.45A91.43,91.43,0,0,0,130,218.06h.51a91.45,91.45,0,0,0,64.28-26.19,4,4,0,1,0-5.6-5.72Z"},null,-1),la=[oa],na={name:"PhArrowsClockwise"},sa=R({...na,props:{weight:{type:String},size:{type:[String,Number]},color:{type:String},mirrored:{type:Boolean}},setup(b){const m=b,o=T("weight","regular"),h=T("size","1em"),l=T("color","currentColor"),s=T("mirrored",!1),u=$(()=>{var n;return(n=m.weight)!=null?n:o}),k=$(()=>{var n;return(n=m.size)!=null?n:h}),r=$(()=>{var n;return(n=m.color)!=null?n:l}),g=$(()=>m.mirrored!==void 0?m.mirrored?"scale(-1, 1)":void 0:s?"scale(-1, 1)":void 0);return(n,p)=>(d(),_("svg",Y({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256",width:k.value,height:k.value,fill:r.value,transform:g.value},n.$attrs),[K(n.$slots,"default"),u.value==="bold"?(d(),_("g",Be,Ne)):u.value==="duotone"?(d(),_("g",ze,xe)):u.value==="fill"?(d(),_("g",je,Ke)):u.value==="light"?(d(),_("g",Ye,Je)):u.value==="regular"?(d(),_("g",ea,ta)):u.value==="thin"?(d(),_("g",ra,la)):Z("",!0)],16,We))}}),ia=["width","height","fill","transform"],ua={key:0},da=w("path",{d:"M28,64A12,12,0,0,1,40,52H216a12,12,0,0,1,0,24H40A12,12,0,0,1,28,64Zm12,76h64a12,12,0,0,0,0-24H40a12,12,0,0,0,0,24Zm80,40H40a12,12,0,0,0,0,24h80a12,12,0,0,0,0-24Zm120.49,20.49a12,12,0,0,1-17,0l-18.08-18.08a44,44,0,1,1,17-17l18.08,18.07A12,12,0,0,1,240.49,200.49ZM184,164a20,20,0,1,0-20-20A20,20,0,0,0,184,164Z"},null,-1),ma=[da],pa={key:1},ca=w("path",{d:"M216,144a32,32,0,1,1-32-32A32,32,0,0,1,216,144Z",opacity:"0.2"},null,-1),fa=w("path",{d:"M32,64a8,8,0,0,1,8-8H216a8,8,0,0,1,0,16H40A8,8,0,0,1,32,64Zm8,72h72a8,8,0,0,0,0-16H40a8,8,0,0,0,0,16Zm88,48H40a8,8,0,0,0,0,16h88a8,8,0,0,0,0-16Zm109.66,13.66a8,8,0,0,1-11.32,0L206,177.36A40,40,0,1,1,217.36,166l20.3,20.3A8,8,0,0,1,237.66,197.66ZM184,168a24,24,0,1,0-24-24A24,24,0,0,0,184,168Z"},null,-1),va=[ca,fa],ga={key:2},ha=w("path",{d:"M32,64a8,8,0,0,1,8-8H216a8,8,0,0,1,0,16H40A8,8,0,0,1,32,64Zm8,72h72a8,8,0,0,0,0-16H40a8,8,0,0,0,0,16Zm88,48H40a8,8,0,0,0,0,16h88a8,8,0,0,0,0-16Zm109.66,2.34L217.36,166A40,40,0,1,0,206,177.36l20.3,20.3a8,8,0,0,0,11.32-11.32Z"},null,-1),ya=[ha],ba={key:3},_a=w("path",{d:"M34,64a6,6,0,0,1,6-6H216a6,6,0,0,1,0,12H40A6,6,0,0,1,34,64Zm6,70h72a6,6,0,0,0,0-12H40a6,6,0,0,0,0,12Zm88,52H40a6,6,0,0,0,0,12h88a6,6,0,0,0,0-12Zm108.24,10.24a6,6,0,0,1-8.48,0l-21.49-21.48a38.06,38.06,0,1,1,8.49-8.49l21.48,21.49A6,6,0,0,1,236.24,196.24ZM184,170a26,26,0,1,0-26-26A26,26,0,0,0,184,170Z"},null,-1),Sa=[_a],wa={key:4},ka=w("path",{d:"M32,64a8,8,0,0,1,8-8H216a8,8,0,0,1,0,16H40A8,8,0,0,1,32,64Zm8,72h72a8,8,0,0,0,0-16H40a8,8,0,0,0,0,16Zm88,48H40a8,8,0,0,0,0,16h88a8,8,0,0,0,0-16Zm109.66,13.66a8,8,0,0,1-11.32,0L206,177.36A40,40,0,1,1,217.36,166l20.3,20.3A8,8,0,0,1,237.66,197.66ZM184,168a24,24,0,1,0-24-24A24,24,0,0,0,184,168Z"},null,-1),Aa=[ka],Ma={key:5},Ca=w("path",{d:"M36,64a4,4,0,0,1,4-4H216a4,4,0,0,1,0,8H40A4,4,0,0,1,36,64Zm4,68h72a4,4,0,0,0,0-8H40a4,4,0,0,0,0,8Zm88,56H40a4,4,0,0,0,0,8h88a4,4,0,0,0,0-8Zm106.83,6.83a4,4,0,0,1-5.66,0l-22.72-22.72a36.06,36.06,0,1,1,5.66-5.66l22.72,22.72A4,4,0,0,1,234.83,194.83ZM184,172a28,28,0,1,0-28-28A28,28,0,0,0,184,172Z"},null,-1),$a=[Ca],Ha={name:"PhListMagnifyingGlass"},Fa=R({...Ha,props:{weight:{type:String},size:{type:[String,Number]},color:{type:String},mirrored:{type:Boolean}},setup(b){const m=b,o=T("weight","regular"),h=T("size","1em"),l=T("color","currentColor"),s=T("mirrored",!1),u=$(()=>{var n;return(n=m.weight)!=null?n:o}),k=$(()=>{var n;return(n=m.size)!=null?n:h}),r=$(()=>{var n;return(n=m.color)!=null?n:l}),g=$(()=>m.mirrored!==void 0?m.mirrored?"scale(-1, 1)":void 0:s?"scale(-1, 1)":void 0);return(n,p)=>(d(),_("svg",Y({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256",width:k.value,height:k.value,fill:r.value,transform:g.value},n.$attrs),[K(n.$slots,"default"),u.value==="bold"?(d(),_("g",ua,ma)):u.value==="duotone"?(d(),_("g",pa,va)):u.value==="fill"?(d(),_("g",ga,ya)):u.value==="light"?(d(),_("g",ba,Sa)):u.value==="regular"?(d(),_("g",wa,Aa)):u.value==="thin"?(d(),_("g",Ma,$a)):Z("",!0)],16,ia))}}),ee=b=>(ce("data-v-c86b3d07"),b=b(),fe(),b),Za=ee(()=>w("i",null,"string",-1)),Ta=ee(()=>w("i",null,"string list",-1)),Pa=R({__name:"FormNotificationSettings",props:{form:{}},setup(b){const o=C(b.form);return(h,l)=>(d(),_(B,null,[a(e(X),{layout:"vertical"},{default:t(()=>[a(e(U),{level:4,width:"100%",height:"30px",style:{display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"0px"}},{default:t(()=>[y(" Task waiting "),a(e(pe),{checked:o.value.notificationTrigger.enabled,"onUpdate:checked":l[0]||(l[0]=s=>o.value.notificationTrigger.enabled=s)},{default:t(()=>[y(" Enabled ")]),_:1},8,["checked"])]),_:1}),a(e(V),{class:"description",style:{fontStyle:"italic",marginBottom:"20px"}},{default:t(()=>[y(" Send emails when new tasks are received ")]),_:1}),a(e(A),{label:"Variable name"},{default:t(()=>[a(e(M),{value:o.value.notificationTrigger.variable_name,"onUpdate:value":l[1]||(l[1]=s=>o.value.notificationTrigger.variable_name=s),disabled:!o.value.notificationTrigger.enabled,type:"text",placeholder:"variable_name"},null,8,["value","disabled"])]),_:1})]),_:1}),a(e(Pe),{type:"info"},{message:t(()=>[a(e(V),null,{default:t(()=>[y(" Notifications are sent to the emails specified in the task payload variables set here. The variables should contain a "),Za,y(" or a "),Ta,y(". ")]),_:1})]),_:1})],64))}});const Ra=O(Pa,[["__scopeId","data-v-c86b3d07"]]),La={class:"form-preview"},Ea={class:"form-preview-container"},Ua=R({__name:"FormPreview",props:{formState:{},formRunnerData:{},isLoading:{type:Boolean},queryParams:{},disabledWarning:{},controller:{},currentPath:{}},emits:["open-query-params-modal"],setup(b,{emit:m}){const o=b,h=Re(),l=Le(),s=$(()=>{if(!o.formRunnerData)return"";const r=Object.entries(o.queryParams),g="?"+r.map(([p,c])=>`${p}=${c}`).join("&"),n=r.length?g:"";return`/${o.formRunnerData.path}${n}`}),u=()=>m("open-query-params-modal"),k=()=>{let r=`/${o.currentPath}`;const g=new URLSearchParams(o.queryParams);window.open(`${r}?${g.toString()}`,"_blank")};return(r,g)=>(d(),_("div",La,[r.isLoading||!r.formRunnerData||!r.formState?(d(),H(e(ve),{key:0})):Z("",!0),r.formState&&r.formRunnerData?(d(),H(e(N),{key:1,vertical:"",gap:"10",style:{height:"100%",overflow:"hidden"}},{default:t(()=>[a(e(N),{gap:"small"},{default:t(()=>[a(e(W),{title:"Edit query params",placement:"bottom"},{default:t(()=>[a(e(ge),{compact:"",style:{display:"flex"},onClick:u},{default:t(()=>{var n,p;return[a(e(M),{disabled:!!r.formState&&e(D).includes((n=r.formState)==null?void 0:n.type),value:s.value,onKeyup:u},null,8,["disabled","value"]),a(e(P),{disabled:!!r.formState&&e(D).includes((p=r.formState)==null?void 0:p.type),onClick:u},{default:t(()=>[a(e(Fa),{size:"20"})]),_:1},8,["disabled"])]}),_:1})]),_:1}),a(e(W),{placement:"bottom"},{title:t(()=>[y("Open in Full Screen")]),default:t(()=>[a(e(P),{target:"_blank","aria-label":"Open in Full Screen","aria-describedby":"sss",onClick:k},{default:t(()=>[a(e(Ve),{size:"20"})]),_:1})]),_:1})]),_:1}),w("div",Ea,[r.disabledWarning?(d(),H(e(Ie),{key:0,class:"unsaved-changes"},{default:t(()=>[a(e(V),{style:{"font-size":"18px","font-weight":"500"}},{default:t(()=>[y(z(r.disabledWarning.title),1)]),_:1}),a(e(V),{style:{"margin-bottom":"6px"}},{default:t(()=>[y(z(r.disabledWarning.message),1)]),_:1})]),_:1})):Z("",!0),a(Ue,{class:"center","main-color":r.formRunnerData.mainColor,background:r.formRunnerData.theme,"font-family":r.formRunnerData.fontFamily,locale:r.formRunnerData.language},{default:t(()=>{var n,p,c,F,I;return[e(l).state.workspace?(d(),H(Ee,{key:0,"current-path":r.currentPath,"hide-login":!0,"runner-data":e(l).state.workspace},null,8,["current-path","runner-data"])):Z("",!0),a(se,{"is-preview":"",class:"runner","form-runner-data":r.formRunnerData,"form-state":r.formState,disabled:!!r.disabledWarning,"user-email":e(h).email,onUpdateWidgetErrors:(n=r.controller)==null?void 0:n.updateWidgetFrontendErrors,onUpdateWidgetValue:(p=r.controller)==null?void 0:p.updateWidgetValue,onActionClicked:(c=r.controller)==null?void 0:c.handleActionClick,onAutoFillClicked:(F=r.controller)==null?void 0:F.handleAutofillClick,onAuthComplete:(I=r.controller)==null?void 0:I.handleAuthComplete},null,8,["form-runner-data","form-state","disabled","user-email","onUpdateWidgetErrors","onUpdateWidgetValue","onActionClicked","onAutoFillClicked","onAuthComplete"])]}),_:1},8,["main-color","background","font-family","locale"])])]),_:1})):Z("",!0)]))}});const Va=O(Ua,[["__scopeId","data-v-9c597cc0"]]),Ia={key:0},Da={key:1},Wa=w("br",null,null,-1),Ba="Start form",qa=R({__name:"FormRunButton",props:{formStateType:{},disabledWarning:{},startMessage:{}},emits:["start","reset"],setup(b,{emit:m}){var k;const o=new J(E.boolean(),"dontShowReloadHelper"),h=C((k=o.get())!=null?k:!1),l=()=>{h.value=!0,o.set(!0)},s=()=>m("reset"),u=()=>m("start");return(r,g)=>(d(),_(B,null,[r.formStateType&&e(ie).includes(r.formStateType)?(d(),H(e(ye),{key:0,placement:"bottom",open:h.value?void 0:!0},{content:t(()=>[h.value?(d(),_("span",Ia,"Reload form")):(d(),_("span",Da,[y(" You can reload the form here"),Wa,a(e(he),{onClick:l},{default:t(()=>[y("Don't show this again")]),_:1})]))]),default:t(()=>[a(e(P),{disabled:!!r.disabledWarning,onClick:s},{default:t(()=>[a(e(sa),{size:"20"})]),_:1},8,["disabled"])]),_:1},8,["open"])):Z("",!0),e(D).includes(r.formStateType)?(d(),H(e(W),{key:1,placement:"bottom"},{title:t(()=>[y("Stop form")]),default:t(()=>[a(e(P),{onClick:s},{default:t(()=>[a(e(Fe),{size:"20"})]),_:1})]),_:1})):Z("",!0),r.formStateType==="waiting"?(d(),H(e(W),{key:2,placement:"bottom"},{title:t(()=>{var n;return[y(z((n=r.startMessage)!=null?n:Ba),1)]}),default:t(()=>[a(e(P),{disabled:!!r.disabledWarning,onClick:u},{default:t(()=>[a(e(be),{size:"20"})]),_:1},8,["disabled"])]),_:1})):Z("",!0)],64))}}),Na=R({__name:"FormSettings",props:{form:{}},setup(b){const o=C(b.form);return(h,l)=>(d(),H(e(X),{layout:"vertical",class:"form-settings"},{default:t(()=>[a(Ze,{runtime:o.value},null,8,["runtime"]),a(e(A),{label:"Form name"},{default:t(()=>[a(e(M),{value:o.value.title,"onUpdate:value":l[0]||(l[0]=s=>o.value.title=s),type:"text",onChange:l[1]||(l[1]=s=>{var u;return o.value.title=(u=s.target.value)!=null?u:""})},null,8,["value"])]),_:1}),a(e(U),{level:3},{default:t(()=>[y(" Texts ")]),_:1}),a(e(U),{level:4},{default:t(()=>[y(" Welcome Screen ")]),_:1}),a(e(A),{label:"Title"},{default:t(()=>[a(e(M),{value:o.value.welcomeTitle,"onUpdate:value":l[2]||(l[2]=s=>o.value.welcomeTitle=s),type:"text",placeholder:o.value.title,disabled:o.value.autoStart},null,8,["value","placeholder","disabled"])]),_:1}),a(e(A),{label:"Description"},{default:t(()=>[a(e(M),{value:o.value.startMessage,"onUpdate:value":l[3]||(l[3]=s=>o.value.startMessage=s),type:"text",disabled:o.value.autoStart},null,8,["value","disabled"])]),_:1}),a(e(A),{label:"Start button label"},{default:t(()=>[a(e(M),{value:o.value.startButtonText,"onUpdate:value":l[4]||(l[4]=s=>o.value.startButtonText=s),type:"text",placeholder:"Start",disabled:o.value.autoStart},null,8,["value","disabled"])]),_:1}),a(e(A),null,{default:t(()=>[a(e(j),{checked:o.value.autoStart,"onUpdate:checked":l[5]||(l[5]=s=>o.value.autoStart=s)},{default:t(()=>[y("Skip welcome screen")]),_:1},8,["checked"])]),_:1}),a(e(U),{level:4},{default:t(()=>[y(" End Screen ")]),_:1}),a(e(A),{label:"End text"},{default:t(()=>[a(e(M),{value:o.value.endMessage,"onUpdate:value":l[6]||(l[6]=s=>o.value.endMessage=s),type:"text",placeholder:"Thank you"},null,8,["value"])]),_:1}),a(e(A),{label:"Restart button label"},{default:t(()=>[a(e(M),{value:o.value.restartButtonText,"onUpdate:value":l[7]||(l[7]=s=>o.value.restartButtonText=s),placeholder:"Restart",type:"text",disabled:!o.value.allowRestart},null,8,["value","disabled"])]),_:1}),a(e(A),{help:!o.value.isInitial&&"Only initial forms can be restarted"},{default:t(()=>[a(e(j),{checked:o.value.allowRestart,"onUpdate:checked":l[8]||(l[8]=s=>o.value.allowRestart=s),disabled:!o.value.isInitial},{default:t(()=>[y("Show restart button at the end")]),_:1},8,["checked","disabled"])]),_:1},8,["help"]),a(e(U),{level:4},{default:t(()=>[y(" Alert Messages ")]),_:1}),a(e(A),{label:"Error message"},{default:t(()=>[a(e(M),{value:o.value.errorMessage,"onUpdate:value":l[9]||(l[9]=s=>o.value.errorMessage=s),type:"text",placeholder:"Something went wrong"},null,8,["value"])]),_:1})]),_:1}))}});const za=O(Na,[["__scopeId","data-v-aff64cb2"]]),Oa=R({__name:"QueryParamsModal",props:{open:{type:Boolean},queryParams:{}},emits:["update:query-params","close"],setup(b,{emit:m}){const h=C(l(b.queryParams));function l(g){return Object.entries(g).map(([n,p])=>({key:n,value:p,id:Math.random().toString()}))}function s(){const g={};return h.value.forEach(({key:n,value:p})=>{g[n]=p}),g}const u=(g,n,p)=>{h.value[g]={key:n,value:p},m("update:query-params",s())},k=()=>{const g=h.value.length;h.value.push({key:`param-${g}`,value:"value"}),m("update:query-params",s())},r=g=>{h.value.splice(g,1),m("update:query-params",s())};return(g,n)=>(d(),H(e(Se),{open:g.open,onCancel:n[1]||(n[1]=p=>m("close"))},{footer:t(()=>[a(e(P),{type:"primary",onClick:n[0]||(n[0]=p=>m("close"))},{default:t(()=>[y("OK")]),_:1})]),default:t(()=>[a(e(N),{vertical:"",gap:"20"},{default:t(()=>[a(e(V),null,{default:t(()=>[y("Query params")]),_:1}),(d(!0),_(B,null,_e(h.value,(p,c)=>(d(),H(e(A),{key:c},{default:t(()=>[a(e(De),null,{default:t(()=>[a(e(M),{value:p.key,"onUpdate:value":F=>p.key=F,type:"text",placeholder:"name",onChange:()=>u(c,p.key,p.value)},null,8,["value","onUpdate:value","onChange"]),a(e(M),{value:p.value,"onUpdate:value":F=>p.value=F,type:"text",placeholder:"value",onChange:()=>u(c,p.key,p.value)},null,8,["value","onUpdate:value","onChange"]),a(e(P),{danger:"",onClick:F=>r(c)},{default:t(()=>[y("remove")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128)),a(e(A),null,{default:t(()=>[a(e(P),{type:"dashed",style:{width:"100%"},onClick:k},{default:t(()=>[y(" Add Query Param ")]),_:1})]),_:1})]),_:1})]),_:1},8,["open"]))}}),rr=R({__name:"FormEditor",setup(b){const m=we(),o=ke(),h=new J(E.array(E.object({formId:E.string(),queryParams:E.record(E.string())})),"abstra:queryParams"),l=C(null),s=C(null),u=C(null),k=C(null),r=C({}),g=$(()=>{var i;return(i=c.value)!=null&&i.form.hasChanges()?{title:"Unsaved changes",message:"Save the form before running the workflow"}:null}),n=(i,f)=>{var v,S;(S=(v=l.value)==null?void 0:v.code)==null||S.setHighlight(i,f)},p=()=>{var i,f,v,S;(f=(i=l.value)==null?void 0:i.code)==null||f.restartEditor(),(S=(v=l.value)==null?void 0:v.code)==null||S.startPreviewMode()},{result:c,loading:F,refetch:I}=Ce(async()=>{const[i,f]=await Promise.all([$e.get(o.params.id),He.get()]),v=h.get();return v==null||v.map(S=>{S.formId===i.id&&(r.value=S.queryParams)}),Ae({form:i,workspace:f})});G([()=>r,c],()=>{x()});const ae=()=>{var v;if(q.value=!1,!c.value)return;const i=h.get()||[];if(!i.some(S=>{var L;return S.formId===((L=c.value)==null?void 0:L.form.id)})){h.set([...i,{formId:(v=c.value)==null?void 0:v.form.id,queryParams:r.value}]);return}h.set(i.map(S=>{var L;return S.formId===((L=c.value)==null?void 0:L.form.id)?{formId:S.formId,queryParams:r.value}:S}))};function Q(){var f,v;if(!c.value)return;const i=c.value.form.codeContent;(v=(f=l.value)==null?void 0:f.code)==null||v.updateLocalEditorCode(i),x()}function x(){var f,v;if(!c.value)return;k.value=c.value.form.makeRunnerData(c.value.workspace),s.value=new ue({formRunnerData:k.value,logService:(v=(f=l.value)==null?void 0:f.logService)!=null?v:null,connectionManager:new de(c.value.form.id,"editor",r.value),onFormStart:p,onFormEnd:te,onRedirect:le,onStateUpdate:S=>u.value=S,onStackTraceUpdate:n});const i=s.value.getState();u.value=i.formState}const te=()=>{var i,f;(f=(i=l.value)==null?void 0:i.code)==null||f.restartEditor()};async function re(){var i,f,v,S;(i=l.value)==null||i.closeSmartConsole();try{await((f=c.value)==null?void 0:f.form.save()),Q(),(v=l.value)==null||v.goToTestTab(),(S=s.value)==null||S.start()}catch{Me.error({message:"Error saving"})}}function oe(){var i,f,v;(f=(i=l.value)==null?void 0:i.code)==null||f.restartEditor(),(v=s.value)==null||v.resetForm()}function le(i,f){me("editor",m,i,f)}const q=C(!1),ne=()=>{var i;!!u.value&&D.includes((i=u.value)==null?void 0:i.type)||(q.value=!0)};return G(()=>o.params.id,()=>{I()}),(i,f)=>(d(),_(B,null,[a(Te,{ref_key:"editor",ref:l,stage:e(c).form,workspace:e(c).workspace,"stage-type":"forms","test-tab-name":"Preview","extra-tab":{key:"notifications",name:"Notifications"},"docs-path":"concepts/forms",onOnSave:Q},{settings:t(()=>[a(za,{form:e(c).form},null,8,["form"])]),test:t(()=>[a(Va,{"form-state":u.value,"form-runner-data":k.value,"is-loading":e(F),"disabled-warning":g.value,"current-path":e(c).form.path,"query-params":r.value,controller:s.value,onOpenQueryParamsModal:ne},null,8,["form-state","form-runner-data","is-loading","disabled-warning","current-path","query-params","controller"])]),"action-button":t(()=>[a(qa,{"form-state-type":u.value.type,"disabled-warning":null,"start-message":"Save & Start form",onStart:re,onReset:oe},null,8,["form-state-type"])]),notifications:t(()=>[a(Ra,{form:e(c).form},null,8,["form"])]),_:1},8,["stage","workspace"]),a(Oa,{"query-params":r.value,"onUpdate:queryParams":f[0]||(f[0]=v=>r.value=v),open:q.value,onClose:ae},null,8,["query-params","open"])],64))}});export{rr as default};
//# sourceMappingURL=FormEditor.caea6205.js.map
