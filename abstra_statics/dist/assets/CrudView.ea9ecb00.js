import{B as L,a as U,g as Y,r as Q}from"./router.2fd242d8.js";import{_ as G}from"./DocsButton.vue_vue_type_script_setup_true_lang.86b0bfda.js";import{i as J}from"./url.77e7b0e0.js";import{G as W}from"./PhDotsThreeVertical.vue.ac30d7c1.js";import{d as O,i as $,al as q,r as N,a as c,b as l,u as a,cQ as H,o as n,f as y,ac as B,eB as T,cE as X,bQ as Z,cJ as K,aI as ee,aY as A,cY as te,g as f,t as m,h as g,cD as le,M as ae,c as ne,j as se,dj as F,A as oe,ae as V,de as E,bY as ue,d0 as re,ad as ce,df as _,d9 as P,bW as ie,bE as de,bD as pe,cS as R,e as ye,eD as j,S as fe,_ as me}from"./jwt-decode.esm.5418d57c.js";import{b as z}from"./index.74ea4823.js";(function(){try{var s=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},b=new Error().stack;b&&(s._sentryDebugIds=s._sentryDebugIds||{},s._sentryDebugIds[b]="b9d02da6-9a61-4951-b7db-cc477ba3fe03",s._sentryDebugIdIdentifier="sentry-dbid-b9d02da6-9a61-4951-b7db-cc477ba3fe03")}catch{}})();const ve=O({__name:"CreationModal",props:{entityName:{},fields:{},create:{type:Function}},setup(s,{expose:b}){const k=s,I=$.translate("i18n_creationmodal_title",null,{entityName:k.entityName}),d=q({inputValue:{}}),C=N(!1),x=()=>C.value=!0,w=()=>{C.value=!1,d.inputValue={}},S=async()=>{try{await k.create(d.inputValue),w()}catch(p){p instanceof Error&&H.error({message:$.translate("i18n_creationmodal_failed_to_create"),description:p.message})}},i=(p,u)=>{const e=p.target.value,t=k.fields.find(o=>o.key===u);t!=null&&t.format?d.inputValue[u]=t.format(e):d.inputValue[u]=e},v=(p,u)=>{const e=p.target.value,t=k.fields.find(o=>o.key===u);t!=null&&t.blur?d.inputValue[u]=t.blur(e):d.inputValue[u]=e};return b({open:x,close:w}),(p,u)=>(n(),c(a(ae),{open:C.value,title:a(I),onCancel:w,onOk:S},{default:l(()=>[y(a(le),{layout:"vertical"},{default:l(()=>[(n(!0),B(A,null,T(s.fields,e=>{var t;return n(),c(a(X),{key:e.key,label:e.label,help:(t=e.hint)==null?void 0:t.call(e,d.inputValue[e.key]),tooltip:e.tooltip},{default:l(()=>{var o,h,D,M;return[!e.type||e.type==="text"||e.type==="password"?(n(),c(a(Z),{key:0,value:d.inputValue[e.key],"onUpdate:value":r=>d.inputValue[e.key]=r,placeholder:(o=e.placeholder)!=null?o:"",type:(h=e.type)!=null?h:"text",onInput:r=>i(r,e.key),onBlur:r=>v(r,e.key)},null,8,["value","onUpdate:value","placeholder","type","onInput","onBlur"])):e.type==="multiline-text"?(n(),c(a(K),{key:1,value:d.inputValue[e.key],"onUpdate:value":r=>d.inputValue[e.key]=r,placeholder:(D=e.placeholder)!=null?D:"",onInput:r=>i(r,e.key),onBlur:r=>v(r,e.key)},null,8,["value","onUpdate:value","placeholder","onInput","onBlur"])):e.type==="select"?(n(),c(a(ee),{key:2,value:d.inputValue[e.key],"onUpdate:value":r=>d.inputValue[e.key]=r,mode:e.mode,"show-search":!0,"option-filter-prop":"label",placeholder:(M=e.placeholder)!=null?M:"Select options..."},{default:l(()=>[(n(!0),B(A,null,T(e.options,r=>(n(),c(a(te),{key:typeof r=="string"?r:r.value,value:typeof r=="string"?r:r.value,label:typeof r=="string"?r:r.label},{default:l(()=>[f(m(typeof r=="string"?r:r.label),1)]),_:2},1032,["value","label"]))),128))]),_:2},1032,["value","onUpdate:value","mode","placeholder"])):g("",!0)]}),_:2},1032,["label","help","tooltip"])}),128))]),_:1})]),_:1},8,["open","title"]))}}),be={class:"action-warning"},ge=O({__name:"CrudView",props:{table:{},loading:{type:Boolean},title:{},emptyTitle:{},entityName:{},description:{},create:{type:Function},createButtonText:{},docsPath:{},live:{type:Boolean},fields:{}},setup(s){const b=s,k=N(null),I=(i,v)=>{var u;const p=(u=b.table.rows[0])==null?void 0:u.cells[v].type;if(!(p==="actions"||p==="slot"))return(e,t)=>d(e,t,v)},d=(i,v,p)=>{const u=i.cells[p],e=v.cells[p];return u.type==="text"&&e.type==="text"||u.type==="tag"&&e.type==="tag"?u.text.localeCompare(e.text):u.type==="tags"&&e.type==="tags"?u.tags[0].text.localeCompare(e.tags[0].text):u.type==="secret"&&e.type==="secret"||u.type==="link"&&e.type==="link"?u.text.localeCompare(e.text):(u.type==="actions"&&e.type==="actions",0)},C=async()=>{var i;b.fields?(i=k.value)==null||i.open():b.create&&await b.create({})},x=N(!1);async function w(i,v){if(!x.value){x.value=!0;try{"onClick"in i?await i.onClick({key:v.key}):"link"in i&&(typeof i.link=="string"&&J(i.link)?open(i.link,"_blank"):Q.push(i.link))}finally{x.value=!1}}}const S=ne(()=>({"--columnCount":`${b.table.columns.length}`}));return(i,v)=>{const p=se("RouterLink");return n(),B(A,null,[y(a(z),{direction:"vertical",class:"crud-view"},{default:l(()=>{var u;return[y(a(F),{align:"center",justify:"space-between"},{default:l(()=>[s.title?(n(),c(a(oe),{key:0},{default:l(()=>[f(m(s.title),1)]),_:1})):g("",!0),V(i.$slots,"more",{},void 0,!0)]),_:3}),s.description?(n(),c(a(E),{key:0},{default:l(()=>[f(m(s.description)+" ",1),V(i.$slots,"description",{},void 0,!0),s.docsPath?(n(),c(G,{key:0,path:s.docsPath},null,8,["path"])):g("",!0)]),_:3})):g("",!0),y(a(F),{gap:"middle"},{default:l(()=>[s.createButtonText?(n(),c(a(ue),{key:0,type:"primary",onClick:C},{default:l(()=>[f(m(s.createButtonText),1)]),_:1})):g("",!0),V(i.$slots,"secondary",{},void 0,!0)]),_:3}),V(i.$slots,"extra",{},void 0,!0),y(a(re),{"filter-dropdown":!0,size:"small",style:ce(S.value),"data-source":s.table.rows,loading:x.value||s.loading&&!s.live,height:400,columns:(u=s.table.columns)==null?void 0:u.map((e,t)=>{var o;return{...e,key:t,filtered:!0,align:(o=e.align)!=null?o:"center",sorter:I(e,t)}})},{emptyText:l(()=>[f(m(s.emptyTitle),1)]),headerCell:l(e=>[f(m(e.title),1)]),bodyCell:l(({column:{key:e},record:t})=>[t.cells[e].type==="slot"?V(i.$slots,t.cells[e].key,{key:0,payload:t.cells[e].payload},void 0,!0):(n(),c(a(R),{key:1,open:t.cells[e].hover?void 0:!1},{content:l(()=>[y(a(E),{style:{width:"300px",overflow:"auto","font-family":"monospace"},copyable:"",content:t.cells[e].hover},null,8,["content"])]),default:l(()=>[t.cells[e].type==="text"?(n(),c(a(_),{key:0,secondary:t.cells[e].secondary,code:t.cells[e].code},{default:l(()=>[y(a(L),{dot:t.cells[e].contentType==="warning",color:"#faad14"},{default:l(()=>[f(m(t.cells[e].text),1)]),_:2},1032,["dot"])]),_:2},1032,["secondary","code"])):t.cells[e].type==="secret"?(n(),c(a(_),{key:1,copyable:{text:t.cells[e].text}},{default:l(()=>[...v[0]||(v[0]=[f(" ******** ",-1)])]),_:1},8,["copyable"])):t.cells[e].type==="tag"?(n(),c(a(P),{key:2,color:t.cells[e].tagColor},{default:l(()=>[f(m(t.cells[e].text),1)]),_:2},1032,["color"])):t.cells[e].type==="tags"?(n(),c(a(z),{key:3},{default:l(()=>[(n(!0),B(A,null,T(t.cells[e].tags,(o,h)=>(n(),c(a(P),{key:h,color:o.color},{default:l(()=>[f(m(o.text),1)]),_:2},1032,["color"]))),128))]),_:2},1024)):t.cells[e].type==="link"?(n(),c(p,{key:4,to:t.cells[e].to},{default:l(()=>[f(m(t.cells[e].text),1)]),_:2},1032,["to"])):t.cells[e].type==="actions"?(n(),c(a(ie),{key:5},{overlay:l(()=>[y(a(de),{disabled:x.value},{default:l(()=>[(n(!0),B(A,null,T(t.cells[e].actions.filter(o=>!o.hide),(o,h)=>(n(),c(a(pe),{key:h,danger:o.dangerous,onClick:D=>w(o,t)},{default:l(()=>[o.popoverMessage?(n(),c(a(R),{key:0,placement:"left"},{content:l(()=>[ye("div",be,[y(a(_),null,{default:l(()=>[f(m(o.popoverMessage),1)]),_:2},1024)])]),default:l(()=>[y(a(_),{disabled:o.disabled,class:"action-item"},{default:l(()=>[o.icon?(n(),c(j(o.icon),{key:0})):g("",!0),f(" "+m(o.label),1)]),_:2},1032,["disabled"])]),_:2},1024)):(n(),c(a(_),{key:1,disabled:o.disabled,class:"action-item"},{default:l(()=>[o.icon?(n(),c(j(o.icon),{key:0})):g("",!0),f(" "+m(o.label),1)]),_:2},1032,["disabled"]))]),_:2},1032,["danger","onClick"]))),128))]),_:2},1032,["disabled"])]),default:l(()=>[y(a(W),{style:{cursor:"pointer"},size:"25px"})]),_:2},1024)):g("",!0)]),_:2},1032,["open"]))]),footer:l(()=>[s.live?(n(),c(a(Y),{key:0,justify:"end",gutter:10},{default:l(()=>[y(a(U),{style:{display:"flex","align-items":"center"}},{default:l(()=>[y(a(fe),{size:"small",style:{display:"flex","align-items":"center"}})]),_:1}),y(a(U),null,{default:l(()=>[y(a(_),null,{default:l(()=>[f(m(a($).translate("i18n_crudview_auto_updating")),1)]),_:1})]),_:1})]),_:1})):g("",!0)]),_:3},8,["style","data-source","loading","columns"])]}),_:3}),s.fields&&s.create?(n(),c(ve,{key:0,ref_key:"modalRef",ref:k,fields:s.fields,"entity-name":s.entityName,create:s.create},null,8,["fields","entity-name","create"])):g("",!0)],64)}}});const Ve=me(ge,[["__scopeId","data-v-21fb039e"]]);export{Ve as C};
//# sourceMappingURL=CrudView.ea9ecb00.js.map
