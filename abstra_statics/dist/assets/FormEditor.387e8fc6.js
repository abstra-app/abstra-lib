import{d as U,r as w,E as z,b as n,c as p,er as r,bw as C,ez as V,eA as N,aS as $,eL as A,e as l,eB as Z,eC as ee,t as G,ex as te,ey as oe,F as re,bu as o,u as k,eq as y,eu as W,eD as ae}from"./registerWidgets.751c4cc6.js";import{L as se}from"./CircularLoading.7ae0ffc2.js";import{E as le}from"./Error.199d7b3e.js";import{R as ne,F as ie}from"./broker.8bfd44f6.js";import{R as ce,T as ue,S as me,_ as de,L as pe,a as q}from"./UnsavedChangesHandler.vue_vue_type_script_setup_true_lang.faa47006.js";import{a as fe}from"./asyncComputed.4ba8b2d8.js";import{F as _e}from"./forms.bb29688a.js";import{W as ve}from"./workspaces.8821a1e7.js";import{B as ye}from"./BackButton.004bf5b7.js";import{S as ge}from"./SaveButton.1d3c2d15.js";import{D as he}from"./DocsButton.5df8476f.js";import{P as be}from"./PreviewButton.c0eaf15f.js";import{r as H}from"./index.35c304ed.js";import"./lottie.2da9cd67.js";import"./passwordlessManager.8b22003c.js";import"./pubsub.87f27d54.js";import"./storage.fbef8aee.js";import"./Passwordless.5d103398.js";import"./icons.839289ff.js";import"./executeJs.264e8788.js";import"./PlayerNavbar.5bbcffdf.js";import"./Steps.2317232c.js";import"./Modal.2619bb1d.js";import"./WidgetsFrame.5ca14e96.js";import"./ActionButton.vue_vue_type_script_setup_true_lang.f5e4856d.js";import"./dashes.29413617.js";import"./activeRecord.91f4e05e.js";import"./hooks.a3b74c2f.js";import"./jobs.346ead8e.js";import"./uuid.e6796fb6.js";(function(){try{var s=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},u=new Error().stack;u&&(s._sentryDebugIds=s._sentryDebugIds||{},s._sentryDebugIds[u]="10a1f28c-8a57-479a-8c56-7e4a5f582d8e",s._sentryDebugIdIdentifier="sentry-dbid-10a1f28c-8a57-479a-8c56-7e4a5f582d8e")}catch{}})();const ke="forms_workspace_id_path_key",j=s=>(Z("data-v-7f776cc2"),s=s(),ee(),s),we={class:"form-settings"},Se={class:"content"},xe={class:"subsection-label"},Ce={class:"property-label"},Re=["value","onChange"],Ee={class:"content"},Fe={class:"property"},Be=j(()=>r("div",{class:"property-label"},"Start smart form automatically",-1)),De={class:"property"},Ie=j(()=>r("div",{class:"property-label"},"Allow the user to restart the smart form after it is over",-1)),Ke="This path is already being used by another form or dash on your workspace",Pe=U({__name:"FormSettings",props:{form:{}},setup(s){const a=w(s.form),g=[{label:"General",props:[{label:"Form name",valueKey:"title"}]},{label:"Welcome Screen",props:[{label:"Title",valueKey:"welcomeTitle"},{label:"Subtitle",valueKey:"startMessage"},{label:"Start button text",valueKey:"startButtonText"}]},{label:"Ending Screen",props:[{label:"Title",valueKey:"endMessage"},{label:"Restart button text",valueKey:"restartButtonText"}]},{label:"Alert Messages",props:[{label:"Error message",valueKey:"errorMessage"}]}],S=z({pathError:null,sectionsShown:[!0,!1,!1]}),h=f=>{f.detail.includes(ke)&&(S.pathError=Ke)};return addEventListener("hasura-error",h),(f,m)=>(n(),p("div",we,[r("div",Se,[(n(),p(C,null,V(g,t=>r("div",{key:t.label,class:"subsection"},[r("div",xe,N(t.label),1),(n(!0),p(C,null,V(t.props,c=>(n(),p("div",{key:c.label,class:"property column"},[r("div",Ce,N(c.label),1),r("input",{class:"property-input",type:"text",value:a.value[c.valueKey],onChange:x=>a.value[c.valueKey]=x.target.value},null,40,Re)]))),128))])),64))]),r("div",Ee,[r("div",Fe,[$(r("input",{"onUpdate:modelValue":m[0]||(m[0]=t=>a.value.autoStart=t),class:"checkbox-input",type:"checkbox"},null,512),[[A,a.value.autoStart]]),Be]),r("div",De,[$(r("input",{"onUpdate:modelValue":m[1]||(m[1]=t=>a.value.allowRestart=t),class:"checkbox-input",type:"checkbox"},null,512),[[A,a.value.allowRestart]]),Ie])]),l(ce,{runtime:a.value},null,8,["runtime"])]))}});const Te=G(Pe,[["__scopeId","data-v-7f776cc2"]]),Le={class:"page"},Me={key:1,class:"error"},Ve=U({__name:"FormEditor",setup(s){var F,B,D,I;const u=te(),a=oe(),g=z({fullscreen:!1,rightPanelCollapsed:!1,hasChanges:!1,started:!1});function S(e,b){H("editor",u,e,b)}addEventListener("keydown",e=>{(e.ctrlKey||e.metaKey)&&e.key==="s"&&(e.preventDefault(),J())});const h=w(null),f=w(null),{loading:m,result:t,error:c,refetch:x}=fe(()=>Promise.all([ve.get(),_e.get(a.params.formPath)]).then(([e,b])=>ae({workspace:e,form:b}))),R=w(!1);async function J(){var e;R.value=!0;try{await((e=t.value)==null?void 0:e.form.save())}finally{R.value=!1}}const d=pe.create(),_=re(()=>ne.create({formPath:a.params.formPath}));(F=_.value)==null||F.on("stdout",e=>{d.log({type:"stdout",log:e.log})}),(B=_.value)==null||B.on("stderr",e=>{d.log({type:"stderr",log:e.log})}),(D=_.value)==null||D.onClose(()=>{d.log({type:"stderr",log:"Program closed"})}),(I=_.value)==null||I.on("files:changed",()=>{var e;(e=h.value)==null||e.filesChanged()});const O=()=>{d.clear()},E=async()=>{var e;return d.log({type:"restart"}),(e=f.value)==null?void 0:e.run()},Q=({path:e})=>{H("editor",u,e)},X=()=>{g.started=!0},Y=()=>{g.started=!1};return(e,b)=>{var K,P,T,L,M;return n(),p(C,null,[r("div",Le,[o(m)||!((K=o(t))!=null&&K.form)||!((P=o(t))!=null&&P.workspace)?(n(),k(se,{key:0})):o(c)?(n(),p("div",Me,[l(le,{error:o(c),onReload:o(x)},null,8,["error","onReload"])])):(n(),k(ue,{key:2},{left:y(()=>[l(ye,{link:"/_editor/forms"})]),right:y(()=>{var i,v;return[l(he),l(be,{model:(i=o(t))==null?void 0:i.form},null,8,["model"]),l(ge,{model:(v=o(t))==null?void 0:v.form},null,8,["model"])]}),default:y(()=>[l(q,{title:"Preview"},{default:y(()=>{var i,v;return[l(ie,{ref_key:"runner",ref:f,form:(v=o(t))==null?void 0:v.form.makeRunnerData((i=o(t))==null?void 0:i.workspace),params:o(a).query,"is-preview":!0,"enable-auto-focus":!1,broker:_.value,style:{height:"unset",flex:1,overflow:"hidden"},onNavigate:Q,onLogout:E,onExit:Y,onStart:X,onRedirect:S},null,8,["form","params","broker"])]}),_:1}),l(q,{title:"Settings"},{default:y(()=>{var i;return[(i=o(t))!=null&&i.form?(n(),k(Te,{key:0,form:o(t).form},null,8,["form"])):W("",!0)]}),_:1})]),_:1})),(T=o(t))!=null&&T.form?(n(),k(me,{key:3,ref_key:"smartConsole",ref:h,runtime:"forms","log-service":o(d),onRestart:E,onClearTerminal:O},null,8,["log-service"])):W("",!0)]),l(de,{"has-changes":(M=(L=o(t))==null?void 0:L.form)==null?void 0:M.hasChanges()},null,8,["has-changes"])],64)}}});const ft=G(Ve,[["__scopeId","data-v-3e0219a6"]]);export{ft as default};
//# sourceMappingURL=FormEditor.387e8fc6.js.map
