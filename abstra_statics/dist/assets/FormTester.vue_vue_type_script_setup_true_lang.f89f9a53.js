import{R as z}from"./SmartConsole.530c3b6c.js";import{d as E,r as P,b as y,c as w,w as t,f as a,u as e,bU as v,aA as d,bV as D,F as J,H as O,G as M,eA as X,eD as S,cG as Y,eu as I,eC as Z,cK as ee,b$ as Q,b8 as ae,bD as te,e as le}from"./outputWidgets.ba81a3ef.js";import{A as i}from"./FormItem.8d721992.js";import{A as _}from"./Title.ecf022a9.js";import{F as L}from"./Base.69cdcef5.js";import{W as re}from"./workspaces.8517f3da.js";import{R as oe,F as se}from"./FormRunner.1dadf560.js";import{a as ue}from"./asyncComputed.07af8e5d.js";import{r as ne}from"./executeJs.aa78fba7.js";import{_ as de}from"./StageRunSelector.vue_vue_type_script_setup_true_lang.c8130010.js";import{A as $}from"./index.e8f3809b.js";import{C as ie,A as me}from"./CollapsePanel.d91e7059.js";import{A}from"./Text.e1135566.js";import{A as pe}from"./index.a32f071e.js";import{A as fe}from"./index.f346daf7.js";(function(){try{var c=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},b=new Error().stack;b&&(c._sentryDebugIds=c._sentryDebugIds||{},c._sentryDebugIds[b]="225fa5a3-c342-4ae7-9a4f-9fbaef0ddb61",c._sentryDebugIdIdentifier="sentry-dbid-225fa5a3-c342-4ae7-9a4f-9fbaef0ddb61")}catch{}})();const qe=E({__name:"FormSettings",props:{form:{}},setup(c){const l=P(c.form);return(m,s)=>(y(),w(e(L),{layout:"vertical"},{default:t(()=>[a(z,{runtime:l.value},null,8,["runtime"]),a(e(i),{label:"Form name"},{default:t(()=>[a(e(v),{type:"text",onChange:s[0]||(s[0]=u=>{var n;return l.value.title=(n=u.target.value)!=null?n:""})})]),_:1}),a(e(_),{level:3},{default:t(()=>[d(" Texts ")]),_:1}),a(e(_),{level:4},{default:t(()=>[d(" Welcome Screen ")]),_:1}),a(e(i),{label:"Title"},{default:t(()=>[a(e(v),{value:l.value.welcomeTitle,"onUpdate:value":s[1]||(s[1]=u=>l.value.welcomeTitle=u),type:"text",placeholder:l.value.title,disabled:l.value.autoStart},null,8,["value","placeholder","disabled"])]),_:1}),a(e(i),{label:"Description"},{default:t(()=>[a(e(v),{value:l.value.startMessage,"onUpdate:value":s[2]||(s[2]=u=>l.value.startMessage=u),type:"text",disabled:l.value.autoStart},null,8,["value","disabled"])]),_:1}),a(e(i),{label:"Start button label"},{default:t(()=>[a(e(v),{value:l.value.startButtonText,"onUpdate:value":s[3]||(s[3]=u=>l.value.startButtonText=u),type:"text",placeholder:"Start",disabled:l.value.autoStart},null,8,["value","disabled"])]),_:1}),a(e(i),null,{default:t(()=>[a(e(D),{checked:l.value.autoStart,"onUpdate:checked":s[4]||(s[4]=u=>l.value.autoStart=u)},{default:t(()=>[d("Skip welcome screen")]),_:1},8,["checked"])]),_:1}),a(e(_),{level:4},{default:t(()=>[d(" End Screen ")]),_:1}),a(e(i),{label:"End text"},{default:t(()=>[a(e(v),{value:l.value.endMessage,"onUpdate:value":s[5]||(s[5]=u=>l.value.endMessage=u),type:"text",placeholder:"Thank you"},null,8,["value"])]),_:1}),a(e(i),{label:"Restart button label"},{default:t(()=>[a(e(v),{value:l.value.restartButtonText,"onUpdate:value":s[6]||(s[6]=u=>l.value.restartButtonText=u),placeholder:"Restart",type:"text",disabled:!l.value.allowRestart},null,8,["value","disabled"])]),_:1}),a(e(i),null,{default:t(()=>[a(e(D),{checked:l.value.allowRestart,"onUpdate:checked":s[7]||(s[7]=u=>l.value.allowRestart=u)},{default:t(()=>[d("Show restart button at the end")]),_:1},8,["checked"])]),_:1}),a(e(_),{level:4},{default:t(()=>[d(" Alert Messages ")]),_:1}),a(e(i),{label:"Error message"},{default:t(()=>[a(e(v),{value:l.value.errorMessage,"onUpdate:value":s[8]||(s[8]=u=>l.value.errorMessage=u),type:"text",placeholder:"Something went wrong"},null,8,["value"])]),_:1})]),_:1}))}}),ve=le("p",{style:{width:"200px"}}," Add query params to simulate someone using your forms with specific data in the URL. ",-1),ce={key:1,style:{height:"600px",margin:"20px","border-radius":"10px",overflow:"hidden"}},k="abstra-run-id",Fe=E({__name:"FormTester",props:{form:{},logService:{}},emits:["redirect"],setup(c,{expose:b,emit:l}){var C,q,F,B;const m=c,s=P(void 0);function u(){s.value=s.value?void 0:"query-params"}const n=J({queryParams:[],url:`${m.form.path}`,stageRunId:null}),N=r=>{n.stageRunId=r},{result:U,loading:V}=ue(()=>re.get()),W=()=>{n.queryParams.push({name:"",value:""})},G=r=>{n.queryParams=n.queryParams.filter((f,o)=>o!==r)};O([()=>n.stageRunId,()=>n.queryParams],([r,f])=>{const o=f.find(p=>p.name===k);if(console.log(r,o),r&&!o){n.queryParams.push({name:k,value:r});return}if(!r&&o){n.queryParams=n.queryParams.filter(p=>p.name!==k);return}r&&o&&r!==o.value&&(o.value=r)});const h=M(()=>oe.create({formPath:m.form.path}));(C=h.value)==null||C.on("stdout",r=>{m.logService.log({type:"stdout",log:r.log})}),(q=h.value)==null||q.on("stderr",r=>{m.logService.log({type:"stderr",log:r.log})}),(F=h.value)==null||F.onClose(()=>{m.logService.log({type:"stderr",log:"Program closed"})}),(B=h.value)==null||B.on("files:changed",()=>{m.logService.log({type:"files-changed",log:"Files changed"})});const K=X(),H=({path:r})=>{ne("editor",K,r)};function j(r,f){l("redirect",r,f)}const R=P(null);async function T(){var r;return m.logService.log({type:"restart"}),(r=R.value)==null?void 0:r.run()}const x=M(()=>{const r=new URLSearchParams(n.queryParams.filter(o=>o.name.trim()).reduce((o,p)=>({...o,[p.name]:p.value}),{})).toString();return{subdomain:"[your-subdomain]",path:m.form.path,query:r}});return b({restart:T}),(r,f)=>(y(),w(e(L),{layout:"vertical"},{default:t(()=>[a(e(i),{label:"Select a thread"},{default:t(()=>[a(de,{disabled:m.form.isInitial,path:m.form.path,optional:!0,onSelect:f[0]||(f[0]=o=>N(o))},null,8,["disabled","path"])]),_:1}),a(e(i),{label:"Testing URL"},{default:t(()=>[a(e($),{gap:0,style:{overflow:"hidden"}},{default:t(()=>[d(" https:// "),a(e(A),{style:{"margin-right":"0"}},{default:t(()=>[d(S(x.value.subdomain),1)]),_:1}),d(" .abstra.app/ "),a(e(A),{style:{"margin-right":"0","max-width":"100px",overflow:"hidden","text-overflow":"ellipsis"}},{default:t(()=>[d(S(x.value.path),1)]),_:1}),a(e($),null,{default:t(()=>[d(" ? "),a(e(Y),{title:"Query params"},{content:t(()=>[ve]),default:t(()=>[a(e(A),{style:{"max-width":"200px",overflow:"hidden","text-overflow":"ellipsis",cursor:"pointer"},onClick:u},{default:t(()=>[d(S(x.value.query||"[ ... ]"),1)]),_:1})]),_:1})]),_:1})]),_:1}),a(e(i),null,{default:t(()=>[a(e(ie),{ghost:"","active-key":s.value,"onUpdate:activeKey":f[1]||(f[1]=o=>s.value=o)},{default:t(()=>[a(e(me),{header:`Query Params (${n.queryParams.length})`,key:"query-params"},{default:t(()=>[(y(!0),I(ae,null,Z(n.queryParams,(o,p)=>(y(),w(e(i),{key:p},{default:t(()=>[a(e(ee),null,{default:t(()=>[a(e(v),{value:o.name,"onUpdate:value":g=>o.name=g,type:"text",placeholder:"name"},null,8,["value","onUpdate:value"]),a(e(v),{value:o.value,"onUpdate:value":g=>o.value=g,type:"text",placeholder:"value",disabled:o.name===k},null,8,["value","onUpdate:value","disabled"]),a(e(Q),{danger:"",onClick:g=>G(p)},{default:t(()=>[d("remove")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128)),a(e(i),null,{default:t(()=>[a(e(Q),{type:"dashed",style:{width:"100%"},onClick:W},{default:t(()=>[d("Add Query Param")]),_:1})]),_:1})]),_:1},8,["header"])]),_:1},8,["active-key"])]),_:1})]),_:1}),a(e(pe),{orientation:"left"},{default:t(()=>[d("Quick Preview")]),_:1}),e(V)||!e(U)?(y(),w(e(te),{key:0})):n.stageRunId||m.form.isInitial?(y(),I("div",ce,[a(se,{ref_key:"runner",ref:R,form:r.form.makeRunnerData(e(U)),params:{...n.queryParams.reduce((o,{name:p,value:g})=>({...o,[p]:g}),{})},"is-preview":"","enable-auto-focus":"",broker:h.value,onNavigate:H,onRedirect:j,onLogout:T},null,8,["form","params","broker"])])):(y(),w(e(fe),{key:2,message:"This form is an intermediate task within the workflow. Please select a task instance to initiate the form.",type:"warning","show-icon":""}))]),_:1}))}});export{Fe as _,qe as a};
//# sourceMappingURL=FormTester.vue_vue_type_script_setup_true_lang.f89f9a53.js.map
