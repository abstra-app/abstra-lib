import{d as M,r as S,v as q,b as c,c as p,x as o,F as x,L as B,N as D,V as I,a2 as P,e as s,O as U,Q as z,q as V,K as G,z as t,t as w,w as _,D as J,H as O,J as Q}from"./registerWidgets.0e006b6f.js";import{L as j}from"./CircularLoading.091208e5.js";import{E as X}from"./Error.a427bb84.js";import{R as Y,F as Z}from"./broker.a7e23963.js";import{R as ee,S as te,_ as ae,L as oe}from"./UnsavedChangesHandler.vue_vue_type_script_setup_true_lang.2401aa5b.js";import{T as re,a as T}from"./Tab.38de1d85.js";import{a as L}from"./asyncComputed.62aacf33.js";import{F as se}from"./forms.f2dd5726.js";import{W as le}from"./workspaces.48d692e9.js";import{B as ne}from"./BackButton.770f937f.js";import{S as ie}from"./SaveButton.cc963735.js";import{D as ce}from"./DocsButton.769c5e12.js";import{P as ue}from"./PreviewButton.7c3672bb.js";import"./lottie.b974d0b6.js";import"./passwordlessManager.4cf24a2b.js";import"./pubsub.13db2123.js";import"./icons.6bb7a228.js";import"./ActionButton.vue_vue_type_script_setup_true_lang.42c8d93f.js";import"./Passwordless.11ab8892.js";import"./executeJs.64987f61.js";import"./PlayerNavbar.a41a317c.js";import"./index.cad410b6.js";import"./WidgetsFrame.58e774c2.js";import"./colors.7dccb471.js";import"./Modal.d54926bb.js";import"./dashes.282c732f.js";import"./activeRecord.d399634f.js";import"./runnerData.dc6d3f24.js";import"./hooks.bbb36404.js";import"./jobs.2479c9ee.js";import"./uuid.9b3680ca.js";import"./login.f04cc77f.js";(function(){try{var r=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},m=new Error().stack;m&&(r._sentryDebugIds=r._sentryDebugIds||{},r._sentryDebugIds[m]="57e374c6-dff9-468c-af56-01ba305ba649",r._sentryDebugIdIdentifier="sentry-dbid-57e374c6-dff9-468c-af56-01ba305ba649")}catch{}})();const de="forms_workspace_id_path_key",N=r=>(U("data-v-6ccbe7b5"),r=r(),z(),r),me={class:"form-settings"},pe={class:"content"},fe={class:"subsection-label"},_e={class:"property-label"},ve=["value","placeholder","onChange"],ye={class:"content"},he={class:"property"},be=N(()=>o("div",{class:"property-label"},"Start smart form automatically",-1)),ge={class:"property"},ke=N(()=>o("div",{class:"property-label"}," Allow the user to restart the smart form after it is over ",-1)),we=M({__name:"FormSettings",props:{form:null},setup(r){const a=S(r.form),v=[{label:"General",props:[{label:"Form name",valueKey:"title"}]},{label:"Welcome Screen",props:[{label:"Title",fallbackKey:"title",valueKey:"welcomeTitle"},{label:"Subtitle",valueKey:"startMessage"},{label:"Start button text",valueKey:"startButtonText"}]},{label:"Ending Screen",props:[{label:"Title",valueKey:"endMessage"},{label:"Restart button text",valueKey:"restartButtonText"}]},{label:"Alert Messages",props:[{label:"Error message",valueKey:"errorMessage"}]}],y=q({pathError:null,sectionsShown:[!0,!1,!1]}),g=f=>{f.detail.includes(de)&&(y.pathError=l)},l="This path is already being used by another form or dash on your workspace";return addEventListener("hasura-error",g),(f,d)=>(c(),p("div",me,[o("div",pe,[(c(),p(x,null,B(v,n=>o("div",{key:n.label,class:"subsection"},[o("div",fe,D(n.label),1),(c(!0),p(x,null,B(n.props,i=>{var h;return c(),p("div",{key:i.label,class:"property column"},[o("div",_e,D(i.label),1),o("input",{class:"property-input",type:"text",value:a.value[i.valueKey],placeholder:(h=i.fallbackKey?a.value[i.fallbackKey]:null)!=null?h:"Enter message",onChange:u=>a.value[i.valueKey]=u.target.value},null,40,ve)])}),128))])),64))]),o("div",ye,[o("div",he,[I(o("input",{"onUpdate:modelValue":d[0]||(d[0]=n=>a.value.autoStart=n),class:"checkbox-input",type:"checkbox"},null,512),[[P,a.value.autoStart]]),be]),o("div",ge,[I(o("input",{"onUpdate:modelValue":d[1]||(d[1]=n=>a.value.allowRestart=n),class:"checkbox-input",type:"checkbox"},null,512),[[P,a.value.allowRestart]]),ke])]),s(ee,{runtime:a.value},null,8,["runtime"])]))}});const Se=V(we,[["__scopeId","data-v-6ccbe7b5"]]),xe={class:"page"},Ce={key:1,class:"error"},Ee=M({__name:"FormEditor",setup(r){var C,E,F;const m=O(),a=Q(),v=q({fullscreen:!1,rightPanelCollapsed:!1,hasChanges:!1,started:!1});addEventListener("keydown",e=>{(e.ctrlKey||e.metaKey)&&e.key==="s"&&(e.preventDefault(),h())});const y=S(null),{loading:g,result:l,error:f,refetch:d}=L(async()=>{const e=await se.get(a.params.formPath);return k(),e}),{result:n}=L(()=>le.get()),i=S(!1);async function h(){var e;i.value=!0;try{await((e=l.value)==null?void 0:e.save())}finally{i.value=!1}}const u=oe.create(),b=G(()=>Y.create({formPath:a.params.formPath}));(C=b.value)==null||C.on("stdout",e=>{u.log({type:"stdout",log:e.log})}),(E=b.value)==null||E.on("stderr",e=>{u.log({type:"stderr",log:e.log})}),(F=b.value)==null||F.onClose(()=>{u.log({type:"stderr",log:"Program closed"})});const $=()=>{u.clear()},k=async()=>{var e;return u.log({type:"restart"}),(e=y.value)==null?void 0:e.run()},H=({path:e,type:K})=>{K==="dash"?m.push({name:"dashEditor",params:{dashPath:e},query:a.query}):(m.push({name:"editor",params:{formPath:e},query:a.query}),d())},W=()=>{v.started=!0},A=()=>{v.started=!1};return(e,K)=>{var R;return c(),p(x,null,[o("div",xe,[t(g)||!t(l)||!t(n)?(c(),w(j,{key:0})):t(f)?(c(),p("div",Ce,[s(X,{error:t(f),onReload:t(d)},null,8,["error","onReload"])])):(c(),w(re,{key:2},{left:_(()=>[s(ne,{link:"/_editor/forms"})]),right:_(()=>[s(ce),s(ue,{model:t(l)},null,8,["model"]),s(ie,{model:t(l)},null,8,["model"])]),default:_(()=>[s(T,{title:"Preview"},{default:_(()=>[s(Z,{ref_key:"runner",ref:y,form:t(l).makeRunnerData(t(n)),params:t(a).query,"is-preview":!0,"enable-auto-focus":!1,broker:t(b),style:{height:"unset",flex:1,overflow:"hidden"},onNavigate:H,onLogout:k,onExit:A,onStart:W},null,8,["form","params","broker"])]),_:1}),s(T,{title:"Settings"},{default:_(()=>[s(Se,{form:t(l)},null,8,["form"])]),_:1})]),_:1})),t(l)?(c(),w(te,{key:3,runtime:"forms","log-service":t(u),onRestart:k,onClearTerminal:$},null,8,["log-service"])):J("",!0)]),s(ae,{"has-changes":(R=t(l))==null?void 0:R.hasChanges()},null,8,["has-changes"])],64)}}});const st=V(Ee,[["__scopeId","data-v-ffa68696"]]);export{st as default};
//# sourceMappingURL=FormEditor.cf754f77.js.map
