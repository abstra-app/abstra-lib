import{d as E,H as N,o as G,G as H,r as A,b as c,d2 as S,f as r,w as o,u as a,ad as $,b0 as y,cQ as I,bu as C,ez as j,c as p,eA as x,c4 as R,cD as D,eu as J,J as P}from"./registerWidgets.e46eca28.js";import{f as B,T as M}from"./dayjs.860058b8.js";import{A as F,a as W}from"./Title.6ee361e2.js";import{R as q}from"./SmartConsole.13554642.js";import{F as z}from"./Form.6fcc3ee8.js";(function(){try{var h=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},f=new Error().stack;f&&(h._sentryDebugIds=h._sentryDebugIds||{},h._sentryDebugIds[f]="3dcfa4d9-144b-44b4-9f64-feb63fe5f9f5",h._sentryDebugIdIdentifier="sentry-dbid-3dcfa4d9-144b-44b4-9f64-feb63fe5f9f5")}catch{}})();const L=()=>[...Array(31).keys()].map(h=>h+1),O={0:"Sunday",1:"Monday",2:"Tuesday",3:"Wednesday",4:"Thursday",5:"Friday",6:"Saturday"},Q=["hourly","daily","weekly","monthly"],K={hourly:{minute:"0",hour:"*",day:"*",month:"*",weekday:"*"},daily:{minute:"0",hour:"6",day:"*",month:"*",weekday:"*"},weekly:{minute:"0",hour:"6",day:"*",month:"*",weekday:"1"},monthly:{minute:"0",hour:"6",day:"1",month:"*",weekday:"*"}},X=E({__name:"CronEditor",props:{crontab:{}},emits:["changeCrontab","saveCrontab","showAdvancedSettings"],setup(h,{emit:f}){const m=h,i=N(()=>{const t=n.hour,l=n.minute;return B(`${t}:${l}:00`,"HH:mm:ss")});G(()=>{const{hour:t,day:l,weekday:d,month:v,minute:g}=m.crontab;v=="*"&&d==="*"&&l!=="*"&&!u([l,t,g])?s.value="monthly":v==="*"&&l==="*"&&d!=="*"&&!u([d,t,g])?s.value="weekly":l==="*"&&d==="*"&&v==="*"&&t!=="*"&&!u([t,g])?s.value="daily":t=="*"&&l==="*"&&d==="*"&&v==="*"&&!u([g])?s.value="hourly":s.value="custom"});const n=H({minute:m.crontab.minute,hour:m.crontab.hour,day:m.crontab.day,month:m.crontab.month,weekday:m.crontab.weekday}),s=A(""),k=A(1),u=t=>t.some(l=>l.includes("-")||l.includes(",")),b=t=>{n.minute=t.minute,n.hour=t.hour,n.day=t.day,n.month=t.month,n.weekday=t.weekday},w=t=>{k.value=0,s.value=t,b(K[s.value]),f("changeCrontab",n)},T=t=>{k.value=0,n.minute=t,f("changeCrontab",n)},e=t=>{const l=B(t);n.minute=l.minute().toString(),n.hour=l.hour().toString(),f("changeCrontab",n)},_=t=>{k.value=0;const l=t;n.weekday=l,f("changeCrontab",n)},U=t=>{k.value=0;const l=t;n.day=l,f("changeCrontab",n)};return(t,l)=>(c(),S(C,null,[r(a(F),{title:"Recurrence"},{default:o(()=>[r(a($),{placeholder:"Choose a periodicity",value:s.value,"onUpdate:value":w},{default:o(()=>[y(" > "),r(a(I),{value:"",disabled:"",hidden:""},{default:o(()=>[y("Custom")]),_:1}),(c(!0),S(C,null,j(a(Q),(d,v)=>(c(),p(a(I),{key:v,value:d},{default:o(()=>[y(x(d),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),r(a(F),null,{default:o(()=>[s.value==="hourly"?(c(),p(a(R),{key:0,value:n.minute,"onUpdate:value":T},{addonBefore:o(()=>[y(" at ")]),addonAfter:o(()=>[y(" minutes ")]),_:1},8,["value"])):s.value==="daily"?(c(),p(a(D),{key:1},{default:o(()=>[r(a(M),{value:i.value,"show-second":!1,"onUpdate:value":e},null,8,["value"])]),_:1})):s.value==="weekly"?(c(),p(a(D),{key:2},{default:o(()=>[y(" on "),r(a($),{style:{width:"200px"},value:Object.values(a(O))[parseInt(n.weekday)],"onUpdate:value":_},{default:o(()=>[(c(!0),S(C,null,j(a(O),(d,v)=>(c(),p(a(I),{key:v,value:v,selected:d===Object.values(a(O))[parseInt(n.weekday)]},{default:o(()=>[y(x(d),1)]),_:2},1032,["value","selected"]))),128))]),_:1},8,["value"]),y(" at "),r(a(M),{value:i.value,"show-second":!1,"onUpdate:value":e},null,8,["value"])]),_:1})):s.value==="monthly"?(c(),p(a(D),{key:3},{default:o(()=>[y(" on "),r(a($),{value:parseInt(n.day),"onUpdate:value":U},{default:o(()=>[(c(!0),S(C,null,j(a(L)(),(d,v)=>(c(),p(a(I),{key:v,value:d},{default:o(()=>[y(x(d),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"]),y(" at "),r(a(M),{value:i.value,"show-second":!1,"onUpdate:value":e},null,8,["value"])]),_:1})):J("",!0)]),_:1})],64))}}),ae=E({__name:"JobSettings",props:{job:{}},setup(h){const f=h,m=A(!1),i=A(f.job),n=()=>{m.value=!m.value},s=()=>{m.value=!1},k=e=>({weekday:e.split(" ")[4],month:e.split(" ")[3],day:e.split(" ")[2],hour:e.split(" ")[1],minute:e.split(" ")[0]}),u=H(k(i.value.schedule)),b=N(()=>`${u.minute} ${u.hour} ${u.day} ${u.month} ${u.weekday}`),w=e=>{u.minute==e.minute&&u.hour==e.hour&&u.day==e.day&&u.month==e.month&&u.weekday==e.weekday||(u.minute=e.minute,u.hour=e.hour,u.day=e.day,u.month=e.month,u.weekday=e.weekday,i.value.schedule=b.value)},T=e=>{e?(i.value.schedule=e,Object.assign(u,k(e))):i.value.schedule=b.value,s()};return P(()=>i.value.schedule,e=>{w({minute:e.split(" ")[0],hour:e.split(" ")[1],day:e.split(" ")[2],month:e.split(" ")[3],weekday:e.split(" ")[4]})}),(e,_)=>(c(),p(a(z),{class:"schedule-editor",layout:"vertical"},{default:o(()=>[r(a(F),{label:"Name",required:""},{default:o(()=>[r(a(R),{value:i.value.title,"onUpdate:value":_[0]||(_[0]=U=>i.value.title=U)},null,8,["value"])]),_:1}),r(q,{runtime:i.value},null,8,["runtime"]),r(a(W),{level:3},{default:o(()=>[y("Schedule")]),_:1}),r(X,{class:"recurrence-settings",crontab:u,onChangeCrontab:w,onSaveCrontab:T,onShowAdvancedSettings:n},null,8,["crontab"])]),_:1}))}});export{ae as _};
//# sourceMappingURL=JobSettings.vue_vue_type_script_setup_true_lang.f1dc0d1b.js.map
