import{d as F,D as $,f as H,o as i,Y as k,$ as J,S,e8 as X,a as w,e as C,b as a,w as t,u as e,df as P,aG as b,cZ as de,db as U,cB as A,bL as M,cA as ee,aS as I,em as me,en as pe,a0 as z,c as _,by as ce,aW as B,cD as fe,bT as R,dj as W,e9 as N,N as ve,O as ge,dc as he,cQ as ye,eM as be,bO as j,eb as ke,cN as we,eo as _e,ea as Se,g as G,eg as Ae,z as Ce,a_ as K,a$ as Y,cO as Me}from"./index.73a38d81.js";import{B as He}from"./BaseLayout.2eb77e5e.js";import{I as Ze,R as Te,S as $e,E as Fe,a as Re,b as Le,L as Ee}from"./SmartChat.12b60eb6.js";import{F as D,a as Pe,b as Ue,c as De,d as Ve,r as Be}from"./FormRunner.62d954b6.js";import{a as We}from"./asyncComputed.c6319089.js";import{F as Ne}from"./scripts.345756e7.js";import"./linters.19a229f9.js";import{W as Ie}from"./workspaces.d6292660.js";import{A as ze}from"./index.78e04c78.js";import{b as qe,u as xe}from"./workspaceStore.9a1cf89e.js";import{P as Oe}from"./PlayerNavbar.7b392e68.js";import{W as Qe}from"./PlayerConfigProvider.37c97964.js";import{C as je}from"./Card.f9ea02bd.js";import{A as Ge}from"./index.2d36535b.js";import{T as Ke}from"./TasksManager.1b0c87d8.js";import{N as Ye}from"./NavbarControls.f99c5e32.js";import{A as E,T as Je}from"./TabPane.5f6856ea.js";import{b as Xe}from"./index.1d99cd36.js";import"./validations.aa32a170.js";import"./string.ead22143.js";import"./editor.a961dd5c.js";import"./url.9bc6af1d.js";import"./colorHelpers.2f665bfc.js";import"./uuid.8c8c77c5.js";import"./PhCaretRight.vue.cd4f7433.js";import"./Badge.c734bd0c.js";import"./LoadingOutlined.70a572c4.js";import"./SaveButton.30165a8c.js";import"./UnsavedChangesHandler.186eda01.js";import"./ExclamationCircleOutlined.670eff0a.js";import"./polling.b4e09b79.js";import"./PhFolder.vue.f61e1a65.js";import"./PhPencil.vue.e94c1cbe.js";import"./toggleHighContrast.e2e5f044.js";import"./AbstraLogo.vue_vue_type_script_setup_true_lang.30c7ded0.js";import"./Logo.20f38e81.js";import"./ai.d3dc1da1.js";import"./PhCheckCircle.vue.40ecb9b7.js";import"./PhCopySimple.vue.ec2f2118.js";import"./Avatar.b56b94ed.js";import"./Login.vue_vue_type_script_setup_true_lang.2fcc1fa6.js";import"./CircularLoading.69bd11d0.js";import"./index.1fcf1ec5.js";import"./Steps.ee240675.js";import"./index.e4d35acb.js";import"./Watermark.d66acae1.js";import"./record.0e492bf3.js";import"./metadata.cc1c1c9b.js";import"./PhWebhooksLogo.vue.963bdc68.js";import"./PhSignOut.vue.ccc2174a.js";import"./index.6a44bd55.js";import"./tasksController.a7392939.js";import"./gateway.e9e7eb7d.js";import"./popupNotifcation.3e5ffef1.js";import"./ant-design.dfa6c76d.js";import"./PhArrowSquareOut.vue.86b1b3ba.js";import"./AbstraButton.vue_vue_type_script_setup_true_lang.aa101f2b.js";import"./index.c30ceca6.js";import"./CollapsePanel.5b52b88b.js";import"./index.904b936f.js";import"./CloseCircleOutlined.f621b712.js";import"./DocsButton.vue_vue_type_script_setup_true_lang.14bb05c7.js";import"./BookOutlined.0a5325b1.js";import"./PhChats.vue.0ddbb468.js";(function(){try{var h=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},c=new Error().stack;c&&(h._sentryDebugIds=h._sentryDebugIds||{},h._sentryDebugIds[c]="db5d20ba-b02d-48f7-a9bd-31700c6fbd3d",h._sentryDebugIdIdentifier="sentry-dbid-db5d20ba-b02d-48f7-a9bd-31700c6fbd3d")}catch{}})();const ea=["width","height","fill","transform"],aa={key:0},ta=w("path",{d:"M228,48V96a12,12,0,0,1-12,12H168a12,12,0,0,1,0-24h19l-7.8-7.8a75.55,75.55,0,0,0-53.32-22.26h-.43A75.49,75.49,0,0,0,72.39,75.57,12,12,0,1,1,55.61,58.41a99.38,99.38,0,0,1,69.87-28.47H126A99.42,99.42,0,0,1,196.2,59.23L204,67V48a12,12,0,0,1,24,0ZM183.61,180.43a75.49,75.49,0,0,1-53.09,21.63h-.43A75.55,75.55,0,0,1,76.77,179.8L69,172H88a12,12,0,0,0,0-24H40a12,12,0,0,0-12,12v48a12,12,0,0,0,24,0V189l7.8,7.8A99.42,99.42,0,0,0,130,226.06h.56a99.38,99.38,0,0,0,69.87-28.47,12,12,0,0,0-16.78-17.16Z"},null,-1),ra=[ta],oa={key:1},la=w("path",{d:"M216,128a88,88,0,1,1-88-88A88,88,0,0,1,216,128Z",opacity:"0.2"},null,-1),na=w("path",{d:"M224,48V96a8,8,0,0,1-8,8H168a8,8,0,0,1,0-16h28.69L182.06,73.37a79.56,79.56,0,0,0-56.13-23.43h-.45A79.52,79.52,0,0,0,69.59,72.71,8,8,0,0,1,58.41,61.27a96,96,0,0,1,135,.79L208,76.69V48a8,8,0,0,1,16,0ZM186.41,183.29a80,80,0,0,1-112.47-.66L59.31,168H88a8,8,0,0,0,0-16H40a8,8,0,0,0-8,8v48a8,8,0,0,0,16,0V179.31l14.63,14.63A95.43,95.43,0,0,0,130,222.06h.53a95.36,95.36,0,0,0,67.07-27.33,8,8,0,0,0-11.18-11.44Z"},null,-1),sa=[la,na],ia={key:2},ua=w("path",{d:"M224,48V96a8,8,0,0,1-8,8H168a8,8,0,0,1-5.66-13.66L180.65,72a79.48,79.48,0,0,0-54.72-22.09h-.45A79.52,79.52,0,0,0,69.59,72.71,8,8,0,0,1,58.41,61.27,96,96,0,0,1,192,60.7l18.36-18.36A8,8,0,0,1,224,48ZM186.41,183.29A80,80,0,0,1,75.35,184l18.31-18.31A8,8,0,0,0,88,152H40a8,8,0,0,0-8,8v48a8,8,0,0,0,13.66,5.66L64,195.3a95.42,95.42,0,0,0,66,26.76h.53a95.36,95.36,0,0,0,67.07-27.33,8,8,0,0,0-11.18-11.44Z"},null,-1),da=[ua],ma={key:3},pa=w("path",{d:"M222,48V96a6,6,0,0,1-6,6H168a6,6,0,0,1,0-12h33.52L183.47,72a81.51,81.51,0,0,0-57.53-24h-.46A81.5,81.5,0,0,0,68.19,71.28a6,6,0,1,1-8.38-8.58,93.38,93.38,0,0,1,65.67-26.76H126a93.45,93.45,0,0,1,66,27.53l18,18V48a6,6,0,0,1,12,0ZM187.81,184.72a81.5,81.5,0,0,1-57.29,23.34h-.46a81.51,81.51,0,0,1-57.53-24L54.48,166H88a6,6,0,0,0,0-12H40a6,6,0,0,0-6,6v48a6,6,0,0,0,12,0V174.48l18,18.05a93.45,93.45,0,0,0,66,27.53h.52a93.38,93.38,0,0,0,65.67-26.76,6,6,0,1,0-8.38-8.58Z"},null,-1),ca=[pa],fa={key:4},va=w("path",{d:"M224,48V96a8,8,0,0,1-8,8H168a8,8,0,0,1,0-16h28.69L182.06,73.37a79.56,79.56,0,0,0-56.13-23.43h-.45A79.52,79.52,0,0,0,69.59,72.71,8,8,0,0,1,58.41,61.27a96,96,0,0,1,135,.79L208,76.69V48a8,8,0,0,1,16,0ZM186.41,183.29a80,80,0,0,1-112.47-.66L59.31,168H88a8,8,0,0,0,0-16H40a8,8,0,0,0-8,8v48a8,8,0,0,0,16,0V179.31l14.63,14.63A95.43,95.43,0,0,0,130,222.06h.53a95.36,95.36,0,0,0,67.07-27.33,8,8,0,0,0-11.18-11.44Z"},null,-1),ga=[va],ha={key:5},ya=w("path",{d:"M220,48V96a4,4,0,0,1-4,4H168a4,4,0,0,1,0-8h38.34L184.89,70.54A84,84,0,0,0,66.8,69.85a4,4,0,1,1-5.6-5.72,92,92,0,0,1,129.34.76L212,86.34V48a4,4,0,0,1,8,0ZM189.2,186.15a83.44,83.44,0,0,1-58.68,23.91h-.47a83.52,83.52,0,0,1-58.94-24.6L49.66,164H88a4,4,0,0,0,0-8H40a4,4,0,0,0-4,4v48a4,4,0,0,0,8,0V169.66l21.46,21.45A91.43,91.43,0,0,0,130,218.06h.51a91.45,91.45,0,0,0,64.28-26.19,4,4,0,1,0-5.6-5.72Z"},null,-1),ba=[ya],ka={name:"PhArrowsClockwise"},wa=F({...ka,props:{weight:{type:String},size:{type:[String,Number]},color:{type:String},mirrored:{type:Boolean}},setup(h){const c=h,r=$("weight","regular"),v=$("size","1em"),o=$("color","currentColor"),s=$("mirrored",!1),d=H(()=>{var n;return(n=c.weight)!=null?n:r}),l=H(()=>{var n;return(n=c.size)!=null?n:v}),y=H(()=>{var n;return(n=c.color)!=null?n:o}),p=H(()=>c.mirrored!==void 0?c.mirrored?"scale(-1, 1)":void 0:s?"scale(-1, 1)":void 0);return(n,g)=>(i(),k("svg",X({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256",width:l.value,height:l.value,fill:y.value,transform:p.value},n.$attrs),[J(n.$slots,"default"),d.value==="bold"?(i(),k("g",aa,ra)):d.value==="duotone"?(i(),k("g",oa,sa)):d.value==="fill"?(i(),k("g",ia,da)):d.value==="light"?(i(),k("g",ma,ca)):d.value==="regular"?(i(),k("g",fa,ga)):d.value==="thin"?(i(),k("g",ha,ba)):S("",!0)],16,ea))}}),_a=["width","height","fill","transform"],Sa={key:0},Aa=w("path",{d:"M28,64A12,12,0,0,1,40,52H216a12,12,0,0,1,0,24H40A12,12,0,0,1,28,64Zm12,76h64a12,12,0,0,0,0-24H40a12,12,0,0,0,0,24Zm80,40H40a12,12,0,0,0,0,24h80a12,12,0,0,0,0-24Zm120.49,20.49a12,12,0,0,1-17,0l-18.08-18.08a44,44,0,1,1,17-17l18.08,18.07A12,12,0,0,1,240.49,200.49ZM184,164a20,20,0,1,0-20-20A20,20,0,0,0,184,164Z"},null,-1),Ca=[Aa],Ma={key:1},Ha=w("path",{d:"M216,144a32,32,0,1,1-32-32A32,32,0,0,1,216,144Z",opacity:"0.2"},null,-1),Za=w("path",{d:"M32,64a8,8,0,0,1,8-8H216a8,8,0,0,1,0,16H40A8,8,0,0,1,32,64Zm8,72h72a8,8,0,0,0,0-16H40a8,8,0,0,0,0,16Zm88,48H40a8,8,0,0,0,0,16h88a8,8,0,0,0,0-16Zm109.66,13.66a8,8,0,0,1-11.32,0L206,177.36A40,40,0,1,1,217.36,166l20.3,20.3A8,8,0,0,1,237.66,197.66ZM184,168a24,24,0,1,0-24-24A24,24,0,0,0,184,168Z"},null,-1),Ta=[Ha,Za],$a={key:2},Fa=w("path",{d:"M32,64a8,8,0,0,1,8-8H216a8,8,0,0,1,0,16H40A8,8,0,0,1,32,64Zm8,72h72a8,8,0,0,0,0-16H40a8,8,0,0,0,0,16Zm88,48H40a8,8,0,0,0,0,16h88a8,8,0,0,0,0-16Zm109.66,2.34L217.36,166A40,40,0,1,0,206,177.36l20.3,20.3a8,8,0,0,0,11.32-11.32Z"},null,-1),Ra=[Fa],La={key:3},Ea=w("path",{d:"M34,64a6,6,0,0,1,6-6H216a6,6,0,0,1,0,12H40A6,6,0,0,1,34,64Zm6,70h72a6,6,0,0,0,0-12H40a6,6,0,0,0,0,12Zm88,52H40a6,6,0,0,0,0,12h88a6,6,0,0,0,0-12Zm108.24,10.24a6,6,0,0,1-8.48,0l-21.49-21.48a38.06,38.06,0,1,1,8.49-8.49l21.48,21.49A6,6,0,0,1,236.24,196.24ZM184,170a26,26,0,1,0-26-26A26,26,0,0,0,184,170Z"},null,-1),Pa=[Ea],Ua={key:4},Da=w("path",{d:"M32,64a8,8,0,0,1,8-8H216a8,8,0,0,1,0,16H40A8,8,0,0,1,32,64Zm8,72h72a8,8,0,0,0,0-16H40a8,8,0,0,0,0,16Zm88,48H40a8,8,0,0,0,0,16h88a8,8,0,0,0,0-16Zm109.66,13.66a8,8,0,0,1-11.32,0L206,177.36A40,40,0,1,1,217.36,166l20.3,20.3A8,8,0,0,1,237.66,197.66ZM184,168a24,24,0,1,0-24-24A24,24,0,0,0,184,168Z"},null,-1),Va=[Da],Ba={key:5},Wa=w("path",{d:"M36,64a4,4,0,0,1,4-4H216a4,4,0,0,1,0,8H40A4,4,0,0,1,36,64Zm4,68h72a4,4,0,0,0,0-8H40a4,4,0,0,0,0,8Zm88,56H40a4,4,0,0,0,0,8h88a4,4,0,0,0,0-8Zm106.83,6.83a4,4,0,0,1-5.66,0l-22.72-22.72a36.06,36.06,0,1,1,5.66-5.66l22.72,22.72A4,4,0,0,1,234.83,194.83ZM184,172a28,28,0,1,0-28-28A28,28,0,0,0,184,172Z"},null,-1),Na=[Wa],Ia={name:"PhListMagnifyingGlass"},za=F({...Ia,props:{weight:{type:String},size:{type:[String,Number]},color:{type:String},mirrored:{type:Boolean}},setup(h){const c=h,r=$("weight","regular"),v=$("size","1em"),o=$("color","currentColor"),s=$("mirrored",!1),d=H(()=>{var n;return(n=c.weight)!=null?n:r}),l=H(()=>{var n;return(n=c.size)!=null?n:v}),y=H(()=>{var n;return(n=c.color)!=null?n:o}),p=H(()=>c.mirrored!==void 0?c.mirrored?"scale(-1, 1)":void 0:s?"scale(-1, 1)":void 0);return(n,g)=>(i(),k("svg",X({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256",width:l.value,height:l.value,fill:y.value,transform:p.value},n.$attrs),[J(n.$slots,"default"),d.value==="bold"?(i(),k("g",Sa,Ca)):d.value==="duotone"?(i(),k("g",Ma,Ta)):d.value==="fill"?(i(),k("g",$a,Ra)):d.value==="light"?(i(),k("g",La,Pa)):d.value==="regular"?(i(),k("g",Ua,Va)):d.value==="thin"?(i(),k("g",Ba,Na)):S("",!0)],16,_a))}}),ae=h=>(me("data-v-b2ed6a6d"),h=h(),pe(),h),qa=ae(()=>w("i",null,"string",-1)),xa=ae(()=>w("i",null,"string list",-1)),Oa=F({__name:"FormNotificationSettings",props:{form:{}},setup(h){const r=C(h.form);return(v,o)=>(i(),k(I,null,[a(e(ee),{layout:"vertical"},{default:t(()=>[a(e(P),{level:4,width:"100%",height:"30px",style:{display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"0px"}},{default:t(()=>[b(" Thread waiting "),a(e(de),{checked:r.value.notificationTrigger.enabled,"onUpdate:checked":o[0]||(o[0]=s=>r.value.notificationTrigger.enabled=s)},{default:t(()=>[b(" Enabled ")]),_:1},8,["checked"])]),_:1}),a(e(U),{class:"description",style:{fontStyle:"italic",marginBottom:"20px"}},{default:t(()=>[b(" Send emails when the thread is waiting for the form to be filled ")]),_:1}),a(e(A),{label:"Variable name"},{default:t(()=>[a(e(M),{value:r.value.notificationTrigger.variable_name,"onUpdate:value":o[1]||(o[1]=s=>r.value.notificationTrigger.variable_name=s),disabled:!r.value.notificationTrigger.enabled,type:"text",placeholder:"variable_name"},null,8,["value","disabled"])]),_:1})]),_:1}),a(e(ze),{type:"info"},{message:t(()=>[a(e(U),null,{default:t(()=>[b(" Notifications are sent to the emails specified in the thread variables set here. The variables should contain a "),qa,b(" or a "),xa,b(". ")]),_:1})]),_:1})],64))}});const Qa=z(Oa,[["__scopeId","data-v-b2ed6a6d"]]),ja={class:"form-preview"},Ga={class:"form-preview-container"},Ka=F({__name:"FormPreview",props:{formState:{},formRunnerData:{},isLoading:{type:Boolean},queryParams:{},disabledWarning:{},controller:{},currentPath:{}},emits:["open-query-params-modal"],setup(h,{emit:c}){const r=h,v=qe(),o=xe(),s=H(()=>{if(!r.formRunnerData)return"";const l=Object.entries(r.queryParams),y="?"+l.map(([n,g])=>`${n}=${g}`).join("&"),p=l.length?y:"";return`/${r.formRunnerData.path}${p}`}),d=()=>c("open-query-params-modal");return(l,y)=>(i(),k("div",ja,[l.isLoading||!l.formRunnerData||!l.formState?(i(),_(e(ce),{key:0})):S("",!0),l.formState&&l.formRunnerData?(i(),_(e(W),{key:1,vertical:"",gap:"10",style:{height:"100%",overflow:"hidden"}},{default:t(()=>[a(e(W),{gap:"small"},{default:t(()=>[a(e(B),{title:"Edit query params",placement:"bottom"},{default:t(()=>[a(e(fe),{compact:"",style:{display:"flex"},onClick:d},{default:t(()=>{var p,n;return[a(e(M),{disabled:!!l.formState&&e(D).includes((p=l.formState)==null?void 0:p.type),value:s.value,onKeyup:d},null,8,["disabled","value"]),a(e(R),{disabled:!!l.formState&&e(D).includes((n=l.formState)==null?void 0:n.type),onClick:d},{default:t(()=>[a(e(za),{size:"20"})]),_:1},8,["disabled"])]}),_:1})]),_:1})]),_:1}),w("div",Ga,[l.disabledWarning?(i(),_(e(je),{key:0,class:"unsaved-changes"},{default:t(()=>[a(e(U),{style:{"font-size":"18px","font-weight":"500"}},{default:t(()=>[b(N(l.disabledWarning.title),1)]),_:1}),a(e(U),{style:{"margin-bottom":"6px"}},{default:t(()=>[b(N(l.disabledWarning.message),1)]),_:1})]),_:1})):S("",!0),a(Qe,{class:"center","main-color":l.formRunnerData.mainColor,background:l.formRunnerData.theme,"font-family":l.formRunnerData.fontFamily,locale:l.formRunnerData.language},{default:t(()=>{var p,n,g,u,Z;return[e(o).state.workspace?(i(),_(Oe,{key:0,"current-path":l.currentPath,"hide-login":!0,"runner-data":e(o).state.workspace},null,8,["current-path","runner-data"])):S("",!0),a(Pe,{"is-preview":"",class:"runner","form-runner-data":l.formRunnerData,"form-state":l.formState,disabled:!!l.disabledWarning,"user-email":e(v).email,onUpdateWidgetErrors:(p=l.controller)==null?void 0:p.updateWidgetFrontendErrors,onUpdateWidgetValue:(n=l.controller)==null?void 0:n.updateWidgetValue,onActionClicked:(g=l.controller)==null?void 0:g.handleActionClick,onAutoFillClicked:(u=l.controller)==null?void 0:u.handleAutofillClick,onAuthComplete:(Z=l.controller)==null?void 0:Z.handleAuthComplete},null,8,["form-runner-data","form-state","disabled","user-email","onUpdateWidgetErrors","onUpdateWidgetValue","onActionClicked","onAutoFillClicked","onAuthComplete"])]}),_:1},8,["main-color","background","font-family","locale"])])]),_:1})):S("",!0)]))}});const Ya=z(Ka,[["__scopeId","data-v-1cb215a9"]]),Ja={key:0},Xa={key:1},et=w("br",null,null,-1),at="Start form",tt=F({__name:"FormRunButton",props:{formStateType:{},disabledWarning:{},startMessage:{}},emits:["start","reset"],setup(h,{emit:c}){var l;const r=new ve(ge.boolean(),"dontShowReloadHelper"),v=C((l=r.get())!=null?l:!1),o=()=>{v.value=!0,r.set(!0)},s=()=>c("reset"),d=()=>c("start");return(y,p)=>(i(),k(I,null,[y.formStateType&&e(Ue).includes(y.formStateType)?(i(),_(e(ye),{key:0,placement:"bottom",open:v.value?void 0:!0},{content:t(()=>[v.value?(i(),k("span",Ja,"Reload form")):(i(),k("span",Xa,[b(" You can reload the form here"),et,a(e(he),{onClick:o},{default:t(()=>[b("Don't show this again")]),_:1})]))]),default:t(()=>[a(e(R),{disabled:!!y.disabledWarning,onClick:s},{default:t(()=>[a(e(wa),{size:"20"})]),_:1},8,["disabled"])]),_:1},8,["open"])):S("",!0),e(D).includes(y.formStateType)?(i(),_(e(B),{key:1,placement:"bottom"},{title:t(()=>[b("Stop form")]),default:t(()=>[a(e(R),{onClick:s},{default:t(()=>[a(e(Ze),{size:"20"})]),_:1})]),_:1})):S("",!0),y.formStateType==="waiting"?(i(),_(e(B),{key:2,placement:"bottom"},{title:t(()=>{var n;return[b(N((n=y.startMessage)!=null?n:at),1)]}),default:t(()=>[a(e(R),{disabled:!!y.disabledWarning,onClick:d},{default:t(()=>[a(e(be),{size:"20"})]),_:1},8,["disabled"])]),_:1})):S("",!0)],64))}}),rt=F({__name:"FormSettings",props:{form:{}},setup(h){const r=C(h.form);return(v,o)=>(i(),_(e(ee),{layout:"vertical",class:"form-settings"},{default:t(()=>[a(Te,{runtime:r.value},null,8,["runtime"]),a(e(A),{label:"Form name"},{default:t(()=>[a(e(M),{value:r.value.title,"onUpdate:value":o[0]||(o[0]=s=>r.value.title=s),type:"text",onChange:o[1]||(o[1]=s=>{var d;return r.value.title=(d=s.target.value)!=null?d:""})},null,8,["value"])]),_:1}),a(e(P),{level:3},{default:t(()=>[b(" Texts ")]),_:1}),a(e(P),{level:4},{default:t(()=>[b(" Welcome Screen ")]),_:1}),a(e(A),{label:"Title"},{default:t(()=>[a(e(M),{value:r.value.welcomeTitle,"onUpdate:value":o[2]||(o[2]=s=>r.value.welcomeTitle=s),type:"text",placeholder:r.value.title,disabled:r.value.autoStart},null,8,["value","placeholder","disabled"])]),_:1}),a(e(A),{label:"Description"},{default:t(()=>[a(e(M),{value:r.value.startMessage,"onUpdate:value":o[3]||(o[3]=s=>r.value.startMessage=s),type:"text",disabled:r.value.autoStart},null,8,["value","disabled"])]),_:1}),a(e(A),{label:"Start button label"},{default:t(()=>[a(e(M),{value:r.value.startButtonText,"onUpdate:value":o[4]||(o[4]=s=>r.value.startButtonText=s),type:"text",placeholder:"Start",disabled:r.value.autoStart},null,8,["value","disabled"])]),_:1}),a(e(A),null,{default:t(()=>[a(e(j),{checked:r.value.autoStart,"onUpdate:checked":o[5]||(o[5]=s=>r.value.autoStart=s)},{default:t(()=>[b("Skip welcome screen")]),_:1},8,["checked"])]),_:1}),a(e(P),{level:4},{default:t(()=>[b(" End Screen ")]),_:1}),a(e(A),{label:"End text"},{default:t(()=>[a(e(M),{value:r.value.endMessage,"onUpdate:value":o[6]||(o[6]=s=>r.value.endMessage=s),type:"text",placeholder:"Thank you"},null,8,["value"])]),_:1}),a(e(A),{label:"Restart button label"},{default:t(()=>[a(e(M),{value:r.value.restartButtonText,"onUpdate:value":o[7]||(o[7]=s=>r.value.restartButtonText=s),placeholder:"Restart",type:"text",disabled:!r.value.allowRestart},null,8,["value","disabled"])]),_:1}),a(e(A),{help:!r.value.isInitial&&"Only initial forms can be restarted"},{default:t(()=>[a(e(j),{checked:r.value.allowRestart,"onUpdate:checked":o[8]||(o[8]=s=>r.value.allowRestart=s),disabled:!r.value.isInitial},{default:t(()=>[b("Show restart button at the end")]),_:1},8,["checked","disabled"])]),_:1},8,["help"]),a(e(P),{level:4},{default:t(()=>[b(" Alert Messages ")]),_:1}),a(e(A),{label:"Error message"},{default:t(()=>[a(e(M),{value:r.value.errorMessage,"onUpdate:value":o[9]||(o[9]=s=>r.value.errorMessage=s),type:"text",placeholder:"Something went wrong"},null,8,["value"])]),_:1})]),_:1}))}});const ot=z(rt,[["__scopeId","data-v-aff64cb2"]]),lt=F({__name:"QueryParamsModal",props:{open:{type:Boolean},close:{type:Function},queryParams:{}},emits:["update:query-params"],setup(h,{emit:c}){const v=C(o(h.queryParams));function o(p){return Object.entries(p).map(([n,g])=>({key:n,value:g,id:Math.random().toString()}))}function s(){const p={};return v.value.forEach(({key:n,value:g})=>{p[n]=g}),p}const d=(p,n,g)=>{v.value[p]={key:n,value:g},c("update:query-params",s())},l=()=>{const p=v.value.length;v.value.push({key:`param-${p}`,value:"value"}),c("update:query-params",s())},y=p=>{v.value.splice(p,1),c("update:query-params",s())};return(p,n)=>(i(),_(e(we),{open:p.open,onCancel:p.close},{footer:t(()=>[a(e(R),{type:"primary",onClick:p.close},{default:t(()=>[b("OK")]),_:1},8,["onClick"])]),default:t(()=>[a(e(W),{vertical:"",gap:"20"},{default:t(()=>[a(e(U),null,{default:t(()=>[b("Query params")]),_:1}),(i(!0),k(I,null,ke(v.value,(g,u)=>(i(),_(e(A),{key:u},{default:t(()=>[a(e(Ge),null,{default:t(()=>[a(e(M),{value:g.key,"onUpdate:value":Z=>g.key=Z,type:"text",placeholder:"name",onChange:()=>d(u,g.key,g.value)},null,8,["value","onUpdate:value","onChange"]),a(e(M),{value:g.value,"onUpdate:value":Z=>g.value=Z,type:"text",placeholder:"value",onChange:()=>d(u,g.key,g.value)},null,8,["value","onUpdate:value","onChange"]),a(e(R),{danger:"",onClick:Z=>y(u)},{default:t(()=>[b("remove")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128)),a(e(A),null,{default:t(()=>[a(e(R),{type:"dashed",style:{width:"100%"},onClick:l},{default:t(()=>[b(" Add Query Param ")]),_:1})]),_:1})]),_:1})]),_:1},8,["open","onCancel"]))}}),hr=F({__name:"FormEditor",setup(h){const c=_e(),r=Se(),v=C(null),o=C("source-code"),s=C(null),d=C(null),l=C(null),y=C({}),p=H(()=>{var m;return(m=u.value)!=null&&m.form.hasChanges()?{title:"Unsaved changes",message:"Save the form before running the workflow"}:null}),n=(m,f)=>{var T;(T=v.value)==null||T.setHighlight(m,f)},g=()=>{var m,f;(m=v.value)==null||m.restartEditor(),(f=v.value)==null||f.startPreviewMode()},{result:u,loading:Z,refetch:te}=We(async()=>{const[m,f]=await Promise.all([Ne.get(r.params.id),Ie.get()]);return Ce({form:m,workspace:f})});G([()=>y,u],()=>{x()});function q(){var f;if(!u.value)return;const m=u.value.form.codeContent;(f=v.value)==null||f.updateLocalEditorCode(m),x()}function x(){if(!u.value)return;l.value=u.value.form.makeRunnerData(u.value.workspace),s.value=new De({formRunnerData:l.value,logService:Q,connectionManager:new Ve(u.value.form.id,"editor",y.value),onFormStart:g,onFormEnd:re,onRedirect:ie,onStateUpdate:f=>d.value=f,onStackTraceUpdate:n});const m=s.value.getState();d.value=m.formState}const re=()=>{var m;(m=v.value)==null||m.restartEditor()};async function oe(){var m,f,T;(m=O.value)==null||m.closeConsole();try{await((f=u.value)==null?void 0:f.form.save()),q(),o.value="preview",(T=s.value)==null||T.start()}catch{Me.error({message:"Error saving"})}}function le(){var m,f;(m=v.value)==null||m.restartEditor(),(f=s.value)==null||f.resetForm()}function ne(){c.push({name:"stages"})}const O=C(null),se=m=>{!u.value||(u.value.form.file=m)},Q=Ee.create();function ie(m,f){Be("editor",c,m,f)}const V=C(!1),ue=()=>{var m;!!d.value&&D.includes((m=d.value)==null?void 0:m.type)||(V.value=!0)};G(()=>r.params.id,()=>{te()});const L=m=>{var f;return m!==o.value&&((f=u.value)==null?void 0:f.form.hasChanges())};return(m,f)=>(i(),_(He,null,Ae({navbar:t(()=>[e(u)?(i(),_(e(Xe),{key:0,title:e(u).form.title,style:{padding:"5px 25px",border:"1px solid #f6f6f6"},onBack:ne},{extra:t(()=>[a(Ye,{"docs-path":"concepts/forms","editing-model":e(u).form},null,8,["editing-model"])]),_:1},8,["title"])):S("",!0)]),content:t(()=>[e(u)?(i(),_(Fe,{key:0},{left:t(()=>[a(e(Je),{"active-key":o.value,"onUpdate:activeKey":f[0]||(f[0]=T=>o.value=T)},{rightExtra:t(()=>[a(tt,{"form-state-type":d.value.type,"disabled-warning":null,"start-message":"Save & Start form",onStart:oe,onReset:le},null,8,["form-state-type"])]),default:t(()=>[a(e(E),{key:"source-code",tab:"Source code",disabled:L("source-code")},null,8,["disabled"]),a(e(E),{key:"preview",tab:"Preview",disabled:L("preview")},null,8,["disabled"]),a(e(E),{key:"tasks",tab:"Tasks",disabled:L("tasks")},null,8,["disabled"]),a(e(E),{key:"settings",tab:"Settings",disabled:L("settings")},null,8,["disabled"]),a(e(E),{key:"notifications",tab:"Notifications",disabled:L("notifications")},null,8,["disabled"])]),_:1},8,["active-key"]),K(a(Re,{ref_key:"code",ref:v,script:e(u).form,workspace:e(u).workspace,onUpdateFile:se,onSave:q},null,8,["script","workspace"]),[[Y,o.value==="source-code"]]),K(a(Ya,{"form-state":d.value,"form-runner-data":l.value,"is-loading":e(Z),"disabled-warning":p.value,"current-path":e(u).form.path,"query-params":y.value,controller:s.value,onOpenQueryParamsModal:ue},null,8,["form-state","form-runner-data","is-loading","disabled-warning","current-path","query-params","controller"]),[[Y,o.value==="preview"]]),o.value==="settings"?(i(),_(ot,{key:0,form:e(u).form},null,8,["form"])):S("",!0),o.value==="notifications"?(i(),_(Qa,{key:1,form:e(u).form},null,8,["form"])):S("",!0),a(lt,{"query-params":y.value,"onUpdate:queryParams":f[1]||(f[1]=T=>y.value=T),open:V.value,close:()=>V.value=!1},null,8,["query-params","open","close"]),o.value==="tasks"?(i(),_(Ke,{key:2,"stage-id":e(u).form.id},null,8,["stage-id"])):S("",!0)]),right:t(()=>[a(Le,{"stage-type":"forms",workspace:e(u).workspace,stage:e(u).form,"log-service":e(Q)},null,8,["workspace","stage","log-service"])]),_:1})):S("",!0)]),_:2},[e(u)?{name:"footer",fn:t(()=>[a($e,{ref_key:"smartConsole",ref:O,"stage-type":"forms",stage:e(u).form,workspace:e(u).workspace},null,8,["stage","workspace"])]),key:"0"}:void 0]),1024))}});export{hr as default};
//# sourceMappingURL=FormEditor.0c3c8d19.js.map
