import{d as U,r as x,w as H,b as i,c as p,y as r,F as R,N as L,O as M,W as N,a5 as V,e as n,Q as X,R as Y,t as q,J as Z,K as ee,L as te,A as o,u as w,x as _,E as W,U as oe}from"./registerWidgets.a9b9c198.js";import{L as re}from"./CircularLoading.7f46cf05.js";import{E as ae}from"./Error.79824bcd.js";import{R as se,F as le}from"./broker.d38286f8.js";import{R as ne,T as ie,S as ce,_ as ue,L as me,a as $}from"./UnsavedChangesHandler.vue_vue_type_script_setup_true_lang.4a6c261f.js";import{a as de}from"./asyncComputed.380e0794.js";import{F as pe}from"./forms.17df1800.js";import{W as fe}from"./workspaces.3f458914.js";import{B as _e}from"./BackButton.1b50147b.js";import{S as ve}from"./SaveButton.d48dae5b.js";import{D as ye}from"./DocsButton.0c022cf3.js";import{P as ge}from"./PreviewButton.ad533b7b.js";import{r as A}from"./index.e0dbf129.js";import"./lottie.cb2a87b3.js";import"./passwordlessManager.18e9d509.js";import"./pubsub.d6cf90d7.js";import"./Passwordless.3e56a551.js";import"./icons.e4ff78f2.js";import"./executeJs.28eb4656.js";import"./PlayerNavbar.8c4f0639.js";import"./Steps.0d4f20d5.js";import"./Modal.0c783a31.js";import"./WidgetsFrame.761f181e.js";import"./ActionButton.vue_vue_type_script_setup_true_lang.d2040fb1.js";import"./dashes.7d3feda1.js";import"./activeRecord.ded96690.js";import"./hooks.f2f66997.js";import"./jobs.d4f50c55.js";import"./uuid.0c613193.js";(function(){try{var s=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},u=new Error().stack;u&&(s._sentryDebugIds=s._sentryDebugIds||{},s._sentryDebugIds[u]="21a7b8c4-6888-407a-82b8-1f5567b4cb30",s._sentryDebugIdIdentifier="sentry-dbid-21a7b8c4-6888-407a-82b8-1f5567b4cb30")}catch{}})();const be="forms_workspace_id_path_key",G=s=>(X("data-v-7f776cc2"),s=s(),Y(),s),he={class:"form-settings"},ke={class:"content"},we={class:"subsection-label"},Se={class:"property-label"},xe=["value","onChange"],Re={class:"content"},Ce={class:"property"},Ee=G(()=>r("div",{class:"property-label"},"Start smart form automatically",-1)),Fe={class:"property"},Be=G(()=>r("div",{class:"property-label"},"Allow the user to restart the smart form after it is over",-1)),Ke="This path is already being used by another form or dash on your workspace",Ie=U({__name:"FormSettings",props:{form:{}},setup(s){const a=x(s.form),v=[{label:"General",props:[{label:"Form name",valueKey:"title"}]},{label:"Welcome Screen",props:[{label:"Title",valueKey:"welcomeTitle"},{label:"Subtitle",valueKey:"startMessage"},{label:"Start button text",valueKey:"startButtonText"}]},{label:"Ending Screen",props:[{label:"Title",valueKey:"endMessage"},{label:"Restart button text",valueKey:"restartButtonText"}]},{label:"Alert Messages",props:[{label:"Error message",valueKey:"errorMessage"}]}],S=H({pathError:null,sectionsShown:[!0,!1,!1]}),y=g=>{g.detail.includes(be)&&(S.pathError=Ke)};return addEventListener("hasura-error",y),(g,t)=>(i(),p("div",he,[r("div",ke,[(i(),p(R,null,L(v,l=>r("div",{key:l.label,class:"subsection"},[r("div",we,M(l.label),1),(i(!0),p(R,null,L(l.props,m=>(i(),p("div",{key:m.label,class:"property column"},[r("div",Se,M(m.label),1),r("input",{class:"property-input",type:"text",value:a.value[m.valueKey],onChange:b=>a.value[m.valueKey]=b.target.value},null,40,xe)]))),128))])),64))]),r("div",Re,[r("div",Ce,[N(r("input",{"onUpdate:modelValue":t[0]||(t[0]=l=>a.value.autoStart=l),class:"checkbox-input",type:"checkbox"},null,512),[[V,a.value.autoStart]]),Ee]),r("div",Fe,[N(r("input",{"onUpdate:modelValue":t[1]||(t[1]=l=>a.value.allowRestart=l),class:"checkbox-input",type:"checkbox"},null,512),[[V,a.value.allowRestart]]),Be])]),n(ne,{runtime:a.value},null,8,["runtime"])]))}});const De=q(Ie,[["__scopeId","data-v-7f776cc2"]]),Pe={class:"page"},Te={key:1,class:"error"},Le=U({__name:"FormEditor",setup(s){var E,F,B;const u=Z(),a=ee(),v=H({fullscreen:!1,rightPanelCollapsed:!1,hasChanges:!1,started:!1});function S(e,k){A("editor",u,e,k)}addEventListener("keydown",e=>{(e.ctrlKey||e.metaKey)&&e.key==="s"&&(e.preventDefault(),J())});const y=x(null),{loading:g,result:t,error:l,refetch:m}=de(()=>Promise.all([fe.get(),pe.get(a.params.formPath)]).then(([e,k])=>oe({workspace:e,form:k}))),b=x(!1);async function J(){var e;b.value=!0;try{await((e=t.value)==null?void 0:e.form.save())}finally{b.value=!1}}const d=me.create(),h=te(()=>se.create({formPath:a.params.formPath}));(E=h.value)==null||E.on("stdout",e=>{d.log({type:"stdout",log:e.log})}),(F=h.value)==null||F.on("stderr",e=>{d.log({type:"stderr",log:e.log})}),(B=h.value)==null||B.onClose(()=>{d.log({type:"stderr",log:"Program closed"})});const O=()=>{d.clear()},C=async()=>{var e;return d.log({type:"restart"}),(e=y.value)==null?void 0:e.run()},Q=({path:e})=>{A("editor",u,e)},j=()=>{v.started=!0},z=()=>{v.started=!1};return(e,k)=>{var K,I,D,P,T;return i(),p(R,null,[r("div",Pe,[o(g)||!((K=o(t))!=null&&K.form)||!((I=o(t))!=null&&I.workspace)?(i(),w(re,{key:0})):o(l)?(i(),p("div",Te,[n(ae,{error:o(l),onReload:o(m)},null,8,["error","onReload"])])):(i(),w(ie,{key:2},{left:_(()=>[n(_e,{link:"/_editor/forms"})]),right:_(()=>{var c,f;return[n(ye),n(ge,{model:(c=o(t))==null?void 0:c.form},null,8,["model"]),n(ve,{model:(f=o(t))==null?void 0:f.form},null,8,["model"])]}),default:_(()=>[n($,{title:"Preview"},{default:_(()=>{var c,f;return[n(le,{ref_key:"runner",ref:y,form:(f=o(t))==null?void 0:f.form.makeRunnerData((c=o(t))==null?void 0:c.workspace),params:o(a).query,"is-preview":!0,"enable-auto-focus":!1,broker:h.value,style:{height:"unset",flex:1,overflow:"hidden"},onNavigate:Q,onLogout:C,onExit:z,onStart:j,onRedirect:S},null,8,["form","params","broker"])]}),_:1}),n($,{title:"Settings"},{default:_(()=>{var c;return[(c=o(t))!=null&&c.form?(i(),w(De,{key:0,form:o(t).form},null,8,["form"])):W("",!0)]}),_:1})]),_:1})),(D=o(t))!=null&&D.form?(i(),w(ce,{key:3,runtime:"forms","log-service":o(d),onRestart:C,onClearTerminal:O},null,8,["log-service"])):W("",!0)]),n(ue,{"has-changes":(T=(P=o(t))==null?void 0:P.form)==null?void 0:T.hasChanges()},null,8,["has-changes"])],64)}}});const mt=q(Le,[["__scopeId","data-v-3dcd3b97"]]);export{mt as default};
//# sourceMappingURL=FormEditor.28b02bbe.js.map
