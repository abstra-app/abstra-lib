import{d as j,at as S,c as D,o as d,ac as h,ae as q,h as H,ew as Q,e as A,R as K,a as _,b as n,u as e,eA as G,ec as W,eT as k,cM as B,i as r,f as o,g as v,t as c,A as Y,cD as F,cE as b,bQ as J,aI as L,S as T,eB as X,d9 as R,eK as ee,dj as te,aY as ae,bV as le,cC as oe}from"./jwt-decode.esm.a71c2b53.js";import{u as ne,E as se,L as re,R as ie}from"./ExecutionContext.76941819.js";import{_ as de}from"./ExecutionStatusIcon.vue_vue_type_script_setup_true_lang.87a5be3b.js";import{_ as ue}from"./AbstraButton.vue_vue_type_script_setup_true_lang.e61b10a3.js";import{g as pe}from"./datetime.5f2e5179.js";import{c as ge}from"./string.02a8158f.js";import{a as m,g as U,A as ce,C as fe}from"./router.1a302c1f.js";import{R as $}from"./dayjs.97296295.js";import{b as O}from"./index.aaccb0f9.js";import{b as _e}from"./build.9da8b5b9.js";import"./tables.6e54b3c6.js";import"./polling.4285408b.js";import"./ant-design.a851ece1.js";import"./PhCopy.vue.d88e6825.js";import"./LoadingOutlined.7c6feb8c.js";import"./index.922b04cc.js";import"./record.38533a9e.js";(function(){try{var g=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},u=new Error().stack;u&&(g._sentryDebugIds=g._sentryDebugIds||{},g._sentryDebugIds[u]="220d9bde-ec0d-403c-9284-8a6a1ae2d7b8",g._sentryDebugIdIdentifier="sentry-dbid-220d9bde-ec0d-403c-9284-8a6a1ae2d7b8")}catch{}})();const he=["width","height","fill","transform"],ye={key:0},be=A("path",{d:"M117.18,188.74a12,12,0,0,1,0,17l-5.12,5.12A58.26,58.26,0,0,1,70.6,228h0A58.62,58.62,0,0,1,29.14,127.92L63.89,93.17a58.64,58.64,0,0,1,98.56,28.11,12,12,0,1,1-23.37,5.44,34.65,34.65,0,0,0-58.22-16.58L46.11,144.89A34.62,34.62,0,0,0,70.57,204h0a34.41,34.41,0,0,0,24.49-10.14l5.11-5.12A12,12,0,0,1,117.18,188.74ZM226.83,45.17a58.65,58.65,0,0,0-82.93,0l-5.11,5.11a12,12,0,0,0,17,17l5.12-5.12a34.63,34.63,0,1,1,49,49L175.1,145.86A34.39,34.39,0,0,1,150.61,156h0a34.63,34.63,0,0,1-33.69-26.72,12,12,0,0,0-23.38,5.44A58.64,58.64,0,0,0,150.56,180h.05a58.28,58.28,0,0,0,41.47-17.17l34.75-34.75a58.62,58.62,0,0,0,0-82.91Z"},null,-1),me=[be],Ae={key:1},ve=A("path",{d:"M218.34,119.6,183.6,154.34a46.58,46.58,0,0,1-44.31,12.26c-.31.34-.62.67-.95,1L103.6,202.34A46.63,46.63,0,1,1,37.66,136.4L72.4,101.66A46.6,46.6,0,0,1,116.71,89.4c.31-.34.62-.67,1-1L152.4,53.66a46.63,46.63,0,0,1,65.94,65.94Z",opacity:"0.2"},null,-1),we=A("path",{d:"M240,88.23a54.43,54.43,0,0,1-16,37L189.25,160a54.27,54.27,0,0,1-38.63,16h-.05A54.63,54.63,0,0,1,96,119.84a8,8,0,0,1,16,.45A38.62,38.62,0,0,0,150.58,160h0a38.39,38.39,0,0,0,27.31-11.31l34.75-34.75a38.63,38.63,0,0,0-54.63-54.63l-11,11A8,8,0,0,1,135.7,59l11-11A54.65,54.65,0,0,1,224,48,54.86,54.86,0,0,1,240,88.23ZM109,185.66l-11,11A38.41,38.41,0,0,1,70.6,208h0a38.63,38.63,0,0,1-27.29-65.94L78,107.31A38.63,38.63,0,0,1,144,135.71a8,8,0,0,0,7.78,8.22H152a8,8,0,0,0,8-7.78A54.86,54.86,0,0,0,144,96a54.65,54.65,0,0,0-77.27,0L32,130.75A54.62,54.62,0,0,0,70.56,224h0a54.28,54.28,0,0,0,38.64-16l11-11A8,8,0,0,0,109,185.66Z"},null,-1),xe=[ve,we],Ie={key:2},ke=A("path",{d:"M208,32H48A16,16,0,0,0,32,48V208a16,16,0,0,0,16,16H208a16,16,0,0,0,16-16V48A16,16,0,0,0,208,32ZM115.7,192.49a43.31,43.31,0,0,1-55-66.43l25.37-25.37a43.35,43.35,0,0,1,61.25,0,42.9,42.9,0,0,1,9.95,15.43,8,8,0,1,1-15,5.6A27.33,27.33,0,0,0,97.37,112L72,137.37a27.32,27.32,0,0,0,34.68,41.91,8,8,0,1,1,9,13.21Zm79.61-62.55-25.37,25.37A43,43,0,0,1,139.32,168h0a43.35,43.35,0,0,1-40.53-28.12,8,8,0,1,1,15-5.6A27.35,27.35,0,0,0,139.28,152h0a27.14,27.14,0,0,0,19.32-8L184,118.63a27.32,27.32,0,0,0-34.68-41.91,8,8,0,1,1-9-13.21,43.32,43.32,0,0,1,55,66.43Z"},null,-1),Le=[ke],Re={key:3},Ce=A("path",{d:"M238,88.18a52.42,52.42,0,0,1-15.4,35.66l-34.75,34.75A52.28,52.28,0,0,1,150.62,174h-.05A52.63,52.63,0,0,1,98,119.9a6,6,0,0,1,6-5.84h.17a6,6,0,0,1,5.83,6.16A40.62,40.62,0,0,0,150.58,162h0a40.4,40.4,0,0,0,28.73-11.9l34.75-34.74A40.63,40.63,0,0,0,156.63,57.9l-11,11a6,6,0,0,1-8.49-8.49l11-11a52.62,52.62,0,0,1,74.43,0A52.83,52.83,0,0,1,238,88.18Zm-127.62,98.9-11,11A40.36,40.36,0,0,1,70.6,210h0a40.63,40.63,0,0,1-28.7-69.36L76.62,105.9A40.63,40.63,0,0,1,146,135.77a6,6,0,0,0,5.83,6.16H152a6,6,0,0,0,6-5.84A52.63,52.63,0,0,0,68.14,97.42L33.38,132.16A52.63,52.63,0,0,0,70.56,222h0a52.26,52.26,0,0,0,37.22-15.42l11-11a6,6,0,1,0-8.49-8.48Z"},null,-1),Pe=[Ce],Se={key:4},De=A("path",{d:"M240,88.23a54.43,54.43,0,0,1-16,37L189.25,160a54.27,54.27,0,0,1-38.63,16h-.05A54.63,54.63,0,0,1,96,119.84a8,8,0,0,1,16,.45A38.62,38.62,0,0,0,150.58,160h0a38.39,38.39,0,0,0,27.31-11.31l34.75-34.75a38.63,38.63,0,0,0-54.63-54.63l-11,11A8,8,0,0,1,135.7,59l11-11A54.65,54.65,0,0,1,224,48,54.86,54.86,0,0,1,240,88.23ZM109,185.66l-11,11A38.41,38.41,0,0,1,70.6,208h0a38.63,38.63,0,0,1-27.29-65.94L78,107.31A38.63,38.63,0,0,1,144,135.71a8,8,0,0,0,16,.45A54.86,54.86,0,0,0,144,96a54.65,54.65,0,0,0-77.27,0L32,130.75A54.62,54.62,0,0,0,70.56,224h0a54.28,54.28,0,0,0,38.64-16l11-11A8,8,0,0,0,109,185.66Z"},null,-1),Ee=[De],Me={key:5},ze=A("path",{d:"M236,88.12a50.44,50.44,0,0,1-14.81,34.31l-34.75,34.74A50.33,50.33,0,0,1,150.62,172h-.05A50.63,50.63,0,0,1,100,120a4,4,0,0,1,4-3.89h.11a4,4,0,0,1,3.89,4.11A42.64,42.64,0,0,0,150.58,164h0a42.32,42.32,0,0,0,30.14-12.49l34.75-34.74a42.63,42.63,0,1,0-60.29-60.28l-11,11a4,4,0,0,1-5.66-5.65l11-11A50.64,50.64,0,0,1,236,88.12ZM111.78,188.49l-11,11A42.33,42.33,0,0,1,70.6,212h0a42.63,42.63,0,0,1-30.11-72.77l34.75-34.74A42.63,42.63,0,0,1,148,135.82a4,4,0,0,0,8,.23A50.64,50.64,0,0,0,69.55,98.83L34.8,133.57A50.63,50.63,0,0,0,70.56,220h0a50.33,50.33,0,0,0,35.81-14.83l11-11a4,4,0,1,0-5.65-5.66Z"},null,-1),Ze=[ze],Ue={name:"PhLink"},je=j({...Ue,props:{weight:{type:String},size:{type:[String,Number]},color:{type:String},mirrored:{type:Boolean}},setup(g){const u=g,f=S("weight","regular"),C=S("size","1em"),P=S("color","currentColor"),E=S("mirrored",!1),y=D(()=>{var p;return(p=u.weight)!=null?p:f}),x=D(()=>{var p;return(p=u.size)!=null?p:C}),M=D(()=>{var p;return(p=u.color)!=null?p:P}),z=D(()=>u.mirrored!==void 0?u.mirrored?"scale(-1, 1)":void 0:E?"scale(-1, 1)":void 0);return(p,w)=>(d(),h("svg",Q({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256",width:x.value,height:x.value,fill:M.value,transform:z.value},p.$attrs),[q(p.$slots,"default"),y.value==="bold"?(d(),h("g",ye,me)):y.value==="duotone"?(d(),h("g",Ae,xe)):y.value==="fill"?(d(),h("g",Ie,Le)):y.value==="light"?(d(),h("g",Re,Pe)):y.value==="regular"?(d(),h("g",Se,Ee)):y.value==="thin"?(d(),h("g",Me,Ze)):H("",!0)],16,he))}}),Be={style:{width:"100px",height:"100%",display:"flex","align-items":"center","justify-content":"right",gap:"10px"}},Fe={key:0,style:{display:"flex",width:"100%","justify-content":"center"}},Te=j({__name:"Logs",props:{executionRepository:{},buildRepository:{},showAllFilters:{type:Boolean}},setup(g){const u=g,f=G(),C=W(),P=f.params.projectId,E=f.query.executionId;function y(){const{stageId:s,buildId:a,status:t,startDate:i,endDate:I,executionId:Z}=f.query;return i&&I?{stageId:s,buildId:a,status:t,dateRange:[k(i),k(I)]}:{stageId:s,buildId:a,status:t,search:Z}}function x(s){const a={};N(),Object.entries(s).forEach(([t,i])=>{typeof i=="string"&&t==="search"&&i?a.executionId=i:typeof i=="string"&&i?a[t]=i:t==="dateRange"&&i&&k.isDayjs(i[0])&&k.isDayjs(i[1])&&(a.startDate=i[0].toISOString().slice(0,10),a.endDate=i[1].toISOString().slice(0,10))}),C.replace({query:a})}function M(){const{page:s,pageSize:a}=f.query;return{currentIndex:s?parseInt(s,10):1,pageSize:a?parseInt(a,10):10}}function z(s){s=s.slice(0,6);const a=`${window.location.origin}${window.location.pathname}?executionId=${s}`;navigator.clipboard.writeText(a),B.success({content:r.translate("i18n_logs_copied_to_clipboard")})}function p(s,a){let t={...s};return t.sentTasks=a.sentTasks,delete t.mockExecution,a.triggerTask&&(t.triggerTask=a.triggerTask,delete t.taskId),t}const w=ne();w.init({executionRepository:u.executionRepository,buildRepository:u.buildRepository,projectId:P,filters:y(),pagination:M(),pool:!0,openedExecutionId:E,onFilterChange:x});const{state:l}=w;function V(s,a){w.fetchExecutionLogsPage(s,a)}K(()=>w.teardown());function N(){const s=l.filters.dateRange,a=k();!s||!s[1]?l.filters.dateRange=[a.subtract(90,"day"),a]:s[1].diff(s[0],"day")>90&&(l.filters.dateRange=[s[1].subtract(90,"day"),s[1]],B.warning({content:r.translate("i18n_logs_date_range_limit_warning",null,90)}))}return x(l.filters),(s,a)=>(d(),_(e(O),{direction:"vertical",style:{width:"100%",padding:"0px 0px 20px 0px"}},{default:n(()=>[o(e(Y),null,{default:n(()=>[v(c(e(r).translate("i18n_logs_title")),1)]),_:1}),g.showAllFilters?(d(),_(e(F),{key:0,layout:"vertical"},{default:n(()=>[o(e(U),{gutter:10},{default:n(()=>[o(e(m),{span:12},{default:n(()=>[o(e(b),{label:e(r).translate("i18n_logs_execution_id_label")},{default:n(()=>[o(e(J),{value:e(l).filters.search,"onUpdate:value":a[0]||(a[0]=t=>e(l).filters.search=t),placeholder:e(r).translate("i18n_logs_search_by_execution_id_placeholder"),style:{width:"100%"}},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1}),o(e(m),{span:12},{default:n(()=>[o(e(b),{label:e(r).translate("i18n_logs_stage_label")},{default:n(()=>[o(e(L),{value:e(l).filters.stageId,"onUpdate:value":a[1]||(a[1]=t=>e(l).filters.stageId=t),options:e(l).filterOptions.stages,placeholder:e(r).translate("i18n_logs_all_placeholder"),"allow-clear":""},null,8,["value","options","placeholder"])]),_:1},8,["label"])]),_:1})]),_:1}),o(e(U),{gutter:10},{default:n(()=>[o(e(m),{span:8},{default:n(()=>[o(e(b),{label:e(r).translate("i18n_logs_date_label")},{default:n(()=>[o(e($),{value:e(l).filters.dateRange,"onUpdate:value":a[2]||(a[2]=t=>e(l).filters.dateRange=t),style:{width:"100%"}},null,8,["value"])]),_:1},8,["label"])]),_:1}),o(e(m),{span:10},{default:n(()=>[o(e(b),{label:e(r).translate("i18n_logs_version_label")},{default:n(()=>[o(e(L),{value:e(l).filters.buildId,"onUpdate:value":a[3]||(a[3]=t=>e(l).filters.buildId=t),options:e(l).filterOptions.builds,"option-label":"label","option-value":"value",filter:!1,placeholder:e(r).translate("i18n_logs_all_placeholder"),"allow-clear":""},null,8,["value","options","placeholder"])]),_:1},8,["label"])]),_:1}),o(e(m),{span:6},{default:n(()=>[o(e(b),{label:e(r).translate("i18n_logs_status_label")},{default:n(()=>[o(e(L),{value:e(l).filters.status,"onUpdate:value":a[4]||(a[4]=t=>e(l).filters.status=t),options:e(l).filterOptions.statuses,"option-label":"label","option-value":"value",filter:!1,placeholder:e(r).translate("i18n_logs_all_placeholder"),"allow-clear":""},null,8,["value","options","placeholder"])]),_:1},8,["label"])]),_:1})]),_:1})]),_:1})):(d(),_(e(F),{key:1,layout:"vertical"},{default:n(()=>[o(e(U),{gutter:10},{default:n(()=>[o(e(m),{span:8},{default:n(()=>[o(e(b),{label:e(r).translate("i18n_logs_date_label")},{default:n(()=>[o(e($),{value:e(l).filters.dateRange,"onUpdate:value":a[5]||(a[5]=t=>e(l).filters.dateRange=t),style:{width:"100%"}},null,8,["value"])]),_:1},8,["label"])]),_:1}),o(e(m),{span:10},{default:n(()=>[o(e(b),{label:e(r).translate("i18n_logs_script_label")},{default:n(()=>[o(e(L),{value:e(l).filters.stageId,"onUpdate:value":a[6]||(a[6]=t=>e(l).filters.stageId=t),options:e(l).filterOptions.stages,placeholder:e(r).translate("i18n_logs_all_placeholder"),"allow-clear":""},null,8,["value","options","placeholder"])]),_:1},8,["label"])]),_:1}),o(e(m),{span:6},{default:n(()=>[o(e(b),{label:e(r).translate("i18n_logs_status_label")},{default:n(()=>[o(e(L),{value:e(l).filters.status,"onUpdate:value":a[7]||(a[7]=t=>e(l).filters.status=t),options:e(l).filterOptions.statuses,"option-label":"label","option-value":"value",filter:!1,placeholder:e(r).translate("i18n_logs_all_placeholder"),"allow-clear":""},null,8,["value","options","placeholder"])]),_:1},8,["label"])]),_:1})]),_:1})]),_:1})),e(l).currentPage.loadingExecutions||e(l).currentPage.waitingDebounce?(d(),_(e(T),{key:2,style:{width:"100%"}})):e(l).currentPage.executions&&e(l).currentPage.executions.length>0?(d(),_(e(O),{key:3,direction:"vertical",style:{width:"100%"}},{default:n(()=>[o(e(fe),{"active-key":e(l).currentPage.openedExecutionIds,"onUpdate:activeKey":a[8]||(a[8]=t=>e(l).currentPage.openedExecutionIds=t),bordered:!1,style:{"background-color":"transparent"},onChange:e(w).fetchEmptyLogs},{default:n(()=>[(d(!0),h(ae,null,X(e(l).currentPage.executions,t=>(d(),_(e(ce),{key:t.id,style:{"border-radius":"4px","margin-bottom":"10px",border:"0",overflow:"hidden","background-color":"#fff"}},{header:n(()=>[o(e(R),{color:"default",style:{"margin-right":"10px"},bordered:!1},{default:n(()=>[v(c(e(pe)(t.createdAt)),1)]),_:2},1024),o(e(R),{color:"default",style:{"margin-right":"10px"},bordered:!1},{default:n(()=>[v(c(e(r).translate("i18n_logs_execution_id_label"))+": "+c(t.id.slice(0,8)),1)]),_:2},1024),o(e(R),{color:"default",style:{"margin-right":"10px"},bordered:!1},{default:n(()=>[v(c(e(r).translate("i18n_logs_version_label"))+": "+c(t.buildId.slice(0,8)),1)]),_:2},1024),o(e(R),{color:"default",style:{"margin-right":"10px"},bordered:!1},{default:n(()=>[v(c(e(r).translate("i18n_logs_duration_prefix"))+" "+c(t.duration_seconds),1)]),_:2},1024),o(e(R),{color:"default",style:{"margin-right":"10px"},bordered:!1},{default:n(()=>{var i,I;return[v(c((I=(i=e(l).filterOptions.stages.find(Z=>Z.value===t.stageId))==null?void 0:i.label)!=null?I:t.stageId.slice(0,8)),1)]}),_:2},1024)]),extra:n(()=>[A("div",Be,[o(ue,{type:"text",size:"small",tooltip:e(r).translate("i18n_logs_copy_url_tooltip"),onClick:ee(i=>z(t.id),["stop"])},{default:n(()=>[o(e(je))]),_:1},8,["tooltip","onClick"]),v(" "+c(e(ge)(t.status))+" ",1),o(de,{status:t.status},null,8,["status"])])]),default:n(()=>[e(l).currentPage.executionData[t.id]?(d(),_(e(te),{key:1,vertical:"",gap:"middle"},{default:n(()=>[o(se,{data:p(t.context,e(l).currentPage.executionData[t.id].tasks),"show-fix-with-ai":!1},null,8,["data"]),o(re,{logs:e(l).currentPage.executionData[t.id].logs,pagination:e(l).currentPage.executionData[t.id].logsPagination,onPageChange:i=>V(t.id,i)},null,8,["logs","pagination","onPageChange"])]),_:2},1024)):(d(),h("div",Fe,[o(e(T))]))]),_:2},1024))),128))]),_:1},8,["active-key","onChange"]),o(e(le),{current:e(l).pagination.currentIndex,"onUpdate:current":a[9]||(a[9]=t=>e(l).pagination.currentIndex=t),"page-size":e(l).pagination.pageSize,"onUpdate:pageSize":a[10]||(a[10]=t=>e(l).pagination.pageSize=t),total:e(l).pagination.totalCount,"show-total":t=>e(r).translate("i18n_logs_found_runs",null,t),"show-size-changer":""},null,8,["current","page-size","total","show-total"])]),_:1})):(d(),_(e(oe),{key:4}))]),_:1}))}}),ot=j({__name:"Logs",setup(g){const u=new ie,f=new _e;return(C,P)=>(d(),_(Te,{"execution-repository":e(u),"build-repository":e(f),"show-all-filters":""},null,8,["execution-repository","build-repository"]))}});export{ot as default};
//# sourceMappingURL=Logs.852a2b44.js.map
