import{d as x,b as o,c as s,e as n,q as S,r as $,S as k,N as v,x as t,F as H,L as P,v as U,a as D,t as R,z as u,V as b,W as T,a0 as I,D as w,O as q,Q as O,w as f,J}from"./registerWidgets.802bba2f.js";import{T as N,B as A,a as V}from"./BackButton.f84b7a41.js";import{L as B}from"./CircularLoading.5c7f2ad7.js";import{R as G,S as M}from"./SmartConsole.bca998f9.js";import{a as L}from"./asyncComputed.1364aaa9.js";import{H as Q}from"./hooks.911e43af.js";import{D as F,E as j,f as z}from"./icons.97625e56.js";import{l as E}from"./log.8028a717.js";import{S as W}from"./SaveButton.fd27cfe9.js";import"./forms.91463966.js";import"./utils.95f0e9e8.js";import"./pubsub.a0411919.js";import"./dashes.ca1ade9b.js";import"./runnerData.37fb2c95.js";import"./jobs.cb7d0efd.js";import"./workspaces.4c177a35.js";import"./login.29b4c1f1.js";import"./sentry.2692e5c6.js";const K={class:"hook-settings"},X=x({__name:"HookSettings",props:{hook:null},setup(i){return(_,p)=>(o(),s("div",K,[n(G,{runtime:i.hook},null,8,["runtime"])]))}});const Y=S(X,[["__scopeId","data-v-6e8accf0"]]),Z={class:"options-wrapper"},ee=["onClick"],oe=x({__name:"ADropdown",props:{options:null,value:null},emits:["select"],setup(i,{emit:_}){const p=$(null),e=m=>{var r;_("select",m),(r=p.value)==null||r.blur()};return(m,r)=>(o(),s("div",{ref_key:"dropdown",ref:p,class:"dropdown",tabindex:"1"},[k(v(i.value)+" ",1),t("div",Z,[(o(!0),s(H,null,P(i.options,h=>(o(),s("div",{key:h.value,class:"option",onClick:y=>e(h.value)},v(h.label),9,ee))),128))])],512))}});const te=S(oe,[["__scopeId","data-v-cac46a2e"]]),C=i=>(q("data-v-55f3fd4a"),i=i(),O(),i),se={class:"hook-runner"},ae={class:"title"},ne={class:"section"},le=C(()=>t("div",{class:"section-header"},"Request configuration",-1)),ie=C(()=>t("div",{class:"subsection-label"},"Method",-1)),re={class:"subsection-label"},de=["onUpdate:modelValue"],ce=["onUpdate:modelValue"],ue={key:0,class:"subsection-label"},pe={class:"property"},_e=C(()=>t("div",{class:"property-label"},"Body is JSON",-1)),me={class:"section"},he=C(()=>t("div",{class:"section-header"},"Response",-1)),ve={key:0,class:"section"},ye={class:"no-execution-message"},fe={key:1,class:"section"},ke=x({__name:"HookRunner",props:{hook:null},setup(i){const _=i,p=[{label:"GET",value:"GET"},{label:"POST",value:"POST"},{label:"PUT",value:"PUT"},{label:"PATCH",value:"PATCH"}],e=U({queryParams:[{name:"",value:""}],method:"GET",body:"",loading:!1,isBodyJson:!0}),m=async()=>{const y={"Content-Type":e.isBodyJson?"application/json":"text/plain"},l=await _.hook.test({method:e.method,query:e.queryParams.reduce((d,{name:a,value:c})=>(a&&c&&(d[a]=c),d),{}),body:e.body,headers:{...y}});e.response=l,l.stderr&&E.log({type:"stderr",log:l.stderr}),l.stdout&&E.log({type:"stdout",log:l.stdout})},r=()=>{e.queryParams.push({name:"",value:""})},h=y=>{e.queryParams=e.queryParams.filter((l,d)=>d!==y)};return(y,l)=>{const d=D("icon");return o(),s("div",se,[t("div",ae,[k(" Test your hook here "),e.loading?(o(),R(B,{key:0})):(o(),s("button",{key:1,class:"execution-button",onClick:m},[n(d,{path:u(F),width:"14",height:"14",fill:"#ffffff"},null,8,["path"]),k(" Run ")]))]),t("div",ne,[le,ie,n(te,{value:e.method,options:p,onSelect:l[0]||(l[0]=a=>e.method=a)},null,8,["value"]),t("div",re,[k(" Query Params "),n(d,{class:"action-icon",path:u(j),width:"16",height:"16","fill-hover":"#777777",onClick:r},null,8,["path"])]),(o(!0),s(H,null,P(e.queryParams,(a,c)=>(o(),s("div",{key:c,class:"params-input"},[b(t("input",{"onUpdate:modelValue":g=>a.name=g,type:"text",placeholder:"name"},null,8,de),[[T,a.name]]),b(t("input",{"onUpdate:modelValue":g=>a.value=g,type:"text",placeholder:"value"},null,8,ce),[[T,a.value]]),n(d,{class:"delete-icon",path:u(z),"fill-hover":"#777777",onClick:g=>h(c)},null,8,["path","onClick"])]))),128)),e.method!=="GET"?(o(),s("div",ue,[k(" Request Body "),t("div",pe,[b(t("input",{"onUpdate:modelValue":l[1]||(l[1]=a=>e.isBodyJson=a),class:"checkbox-input",type:"checkbox"},null,512),[[I,e.isBodyJson]]),_e])])):w("",!0),e.method!=="GET"?b((o(),s("textarea",{key:1,"onUpdate:modelValue":l[2]||(l[2]=a=>e.body=a)},null,512)),[[T,e.body]]):w("",!0)]),t("div",me,[he,e.loading?(o(),s("div",ve,[t("div",ye,[n(B)])])):e.response?(o(),s("div",fe,[t("pre",null,"Status: "+v(e.response.status),1),(o(!0),s(H,null,P(e.response.headers,(a,c)=>(o(),s("pre",{key:c},v(c)+": "+v(a),1))),128)),t("pre",null,v(e.response.body),1)])):w("",!0)])])}}});const ge=S(ke,[["__scopeId","data-v-55f3fd4a"]]),be={class:"page"},xe={key:0,class:"loading"},Se=x({__name:"HookEditor",setup(i){const _=J(),{loading:p,result:e}=L(async()=>await Q.get(_.params.hookPath)),m=async r=>{e.value&&(e.value.path=r,await e.value.save())};return(r,h)=>(o(),s("div",be,[u(p)||!u(e)?(o(),s("div",xe,[n(B)])):(o(),R(N,{key:1,class:"editor"},{left:f(()=>[n(A,{link:"/_editor/hooks"})]),right:f(()=>[n(W,{model:u(e)},null,8,["model"])]),default:f(()=>[n(V,{title:"Debug"},{default:f(()=>[n(ge,{hook:u(e)},null,8,["hook"])]),_:1}),n(V,{title:"Settings"},{default:f(()=>[n(Y,{hook:u(e),onUpdatePath:m},null,8,["hook"])]),_:1})]),_:1})),n(M,{runtime:"hooks"})]))}});const Ge=S(Se,[["__scopeId","data-v-1887332f"]]);export{Ge as default};
//# sourceMappingURL=HookEditor.025b6014.js.map
