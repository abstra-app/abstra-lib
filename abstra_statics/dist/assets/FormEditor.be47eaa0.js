import{u as He}from"./index.4eebfe3f.js";import{d as U,X as F,H as x,b as s,eu as h,dj as q,ew as M,ez as O,e as v,o as Te,G as Ze,c as S,w as t,f as a,u as e,v as Q,r as C,aq as g,bx as T,aC as de,eE as pe,eF as ce,by as re,bE as Z,eB as Ie,cA as Ue,eI as Re,eA as Ee,av as Be,I as ne,S as ie,a as Le,eK as Ne,eD as De,bf as Pe,cw as ze,aG as B}from"./outputWidgets.67d01534.js";import{B as We}from"./BaseLayout.3a6322cd.js";import{F as L,a as je,b as qe,c as Oe,d as Qe,r as se}from"./FormRunner.4d31e5ef.js";import{R as Ge,S as Je,a as Ke,L as Xe}from"./SourceCode.4bf5e767.js";import{A as me}from"./api.c51328fc.js";import{a as Ye}from"./asyncComputed.9c2e7c90.js";import{F as ea}from"./PhArrowSquareOut.vue.e9645c16.js";import{G as aa}from"./PhFlowArrow.vue.39e30929.js";import{F as ta}from"./metadata.1b2faa6d.js";import{F as la}from"./forms.060f6bdd.js";import{W as j}from"./workspaces.e9b90016.js";import"./envVars.5aa8e6b1.js";import{_ as oa}from"./SaveButton.vue_vue_type_script_setup_true_lang.e12cebc6.js";import{T as ra}from"./ThreadSelector.186ff52c.js";import{M as ve}from"./Modal.e44b2640.js";import{A as fe}from"./index.cce1e5ca.js";import{A as E}from"./Title.3431c309.js";import{a as N}from"./Text.fce07a64.js";import{A as V,F as G}from"./Form.18143f38.js";import{A as ue}from"./index.12d5bc2c.js";import{A as D}from"./index.3dca3a8f.js";import{N as na}from"./NavbarControls.e27c8b5b.js";import{b as ia}from"./index.3b9e39e4.js";import{A as W,T as sa}from"./TabPane.3015bf00.js";import{B as ua}from"./Badge.28d9f89a.js";import{A as da}from"./index.527f7466.js";import{A as pa}from"./Link.1ec60047.js";import"./pubsub.ce0b10ac.js";import"./fetch.03065101.js";import"./url.df413b89.js";import"./Passwordless.aeea0a55.js";import"./PhArrowClockwise.vue.44900a24.js";import"./CircularLoading.730f9e72.js";import"./PlayerNavbar.39918cc6.js";import"./PhKanban.vue.01a8c7a1.js";import"./PhSignOut.vue.09fa917c.js";import"./index.a9d2fb7a.js";import"./Paragraph.5d6efe5b.js";import"./index.cf78c4e6.js";import"./WidgetsFrame.da1bb74c.js";import"./Steps.286b5e8b.js";import"./PhInfo.vue.d5a630c4.js";import"./Card.e0b50de4.js";import"./index.e94f56d7.js";import"./uuid.18021da8.js";import"./PhCaretRight.vue.ee58fa17.js";import"./login.661074de.js";import"./jobs.e43c7e93.js";import"./record.97ce606c.js";import"./scripts.522fb6bc.js";import"./validations.85451c48.js";import"./string.73a83215.js";import"./toggleHighContrast.7bb37e6e.js";import"./PhPencil.vue.fd512d1d.js";import"./index.cf4c23b9.js";import"./PhCheckCircle.vue.95f5c263.js";import"./PhScroll.vue.14ed3ebd.js";import"./PhWebhooksLogo.vue.5ddfc31f.js";import"./runnerData.0c424852.js";import"./UnsavedChangesHandler.8505e2c4.js";import"./ExclamationCircleOutlined.af61b8f4.js";import"./index.b7b3af9c.js";import"./hasIn.18867aca.js";import"./popupNotifcation.48a418fa.js";import"./CloseCircleOutlined.ac91c9af.js";import"./DocsButton.vue_vue_type_script_setup_true_lang.00cfbae2.js";import"./BookOutlined.93eb4c42.js";import"./isNumeric.75337b1e.js";(function(){try{var f=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},d=new Error().stack;d&&(f._sentryDebugIds=f._sentryDebugIds||{},f._sentryDebugIds[d]="7f1da18e-9004-4765-bb1b-6597a091625c",f._sentryDebugIdIdentifier="sentry-dbid-7f1da18e-9004-4765-bb1b-6597a091625c")}catch{}})();const ca=["width","height","fill","transform"],ma={key:0},va=v("path",{d:"M200.49,183.51a12,12,0,0,1,0,17c-1.13,1.12-28,27.51-72.49,27.51-33.71,0-59.35-17.46-76-33.86V208a12,12,0,0,1-24,0V160a12,12,0,0,1,12-12H88a12,12,0,0,1,0,24H64.12c13.1,14.32,35.08,32,63.88,32,34.63,0,55.31-20.28,55.51-20.49A12,12,0,0,1,200.49,183.51ZM216,36a12,12,0,0,0-12,12V61.86C187.35,45.46,161.71,28,128,28,83.54,28,56.64,54.39,55.51,55.51a12,12,0,0,0,17,17C72.69,72.28,93.37,52,128,52c28.8,0,50.78,17.68,63.88,32H168a12,12,0,0,0,0,24h48a12,12,0,0,0,12-12V48A12,12,0,0,0,216,36Z"},null,-1),fa=[va],ga={key:1},ha=v("path",{d:"M216,48V96H168ZM40,208l48-48H40Z",opacity:"0.2"},null,-1),ya=v("path",{d:"M219.06,40.61a8,8,0,0,0-8.72,1.73L194.28,58.41C174.13,41.1,151.36,32,128,32,85.18,32,59.42,57.27,58.34,58.34A8,8,0,0,0,69.66,69.66C69.87,69.44,91.73,48,128,48c23.17,0,41.92,10.85,54.92,21.76L162.34,90.34A8,8,0,0,0,168,104h48a8,8,0,0,0,8-8V48A8,8,0,0,0,219.06,40.61ZM208,88H187.31L208,67.31Zm-21.66,98.34c-.21.22-22.07,21.66-58.34,21.66-23.17,0-41.92-10.85-54.92-21.76l20.58-20.58A8,8,0,0,0,88,152H40a8,8,0,0,0-8,8v48a8,8,0,0,0,13.66,5.66l16.06-16.07C81.87,214.9,104.64,224,128,224c42.82,0,68.58-25.27,69.66-26.34a8,8,0,0,0-11.32-11.32ZM48,168H68.69L48,188.69Z"},null,-1),wa=[ha,ya],_a={key:2},ba=v("path",{d:"M197.66,186.34a8,8,0,0,1,0,11.32C196.58,198.73,170.82,224,128,224c-23.36,0-46.13-9.1-66.28-26.41L45.66,213.66A8,8,0,0,1,32,208V160a8,8,0,0,1,8-8H88a8,8,0,0,1,5.66,13.66L73.08,186.24C86.08,197.15,104.83,208,128,208c36.27,0,58.13-21.44,58.34-21.66A8,8,0,0,1,197.66,186.34Zm21.4-145.73a8,8,0,0,0-8.72,1.73L194.28,58.41C174.13,41.1,151.36,32,128,32,85.18,32,59.42,57.27,58.34,58.34A8,8,0,0,0,69.66,69.66C69.87,69.44,91.73,48,128,48c23.17,0,41.92,10.85,54.92,21.76L162.34,90.34A8,8,0,0,0,168,104h48a8,8,0,0,0,8-8V48A8,8,0,0,0,219.06,40.61Z"},null,-1),ka=[ba],Aa={key:3},Sa=v("path",{d:"M196.24,187.76a6,6,0,0,1,0,8.48C195.19,197.29,170,222,128,222c-39.66,0-67.59-25.75-82-43.26V208a6,6,0,0,1-12,0V160a6,6,0,0,1,6-6H88a6,6,0,0,1,0,12H51.35c11.41,15.11,38.23,44,76.65,44,37.09,0,59.54-22,59.76-22.24A6,6,0,0,1,196.24,187.76ZM216,42a6,6,0,0,0-6,6V77.26C195.59,59.75,167.66,34,128,34,86,34,60.81,58.71,59.76,59.76a6,6,0,0,0,8.48,8.48C68.46,68,90.91,46,128,46c38.42,0,65.24,28.89,76.65,44H168a6,6,0,0,0,0,12h48a6,6,0,0,0,6-6V48A6,6,0,0,0,216,42Z"},null,-1),Ca=[Sa],xa={key:4},Ma=v("path",{d:"M197.67,186.37a8,8,0,0,1,0,11.29C196.58,198.73,170.82,224,128,224c-37.39,0-64.53-22.4-80-39.85V208a8,8,0,0,1-16,0V160a8,8,0,0,1,8-8H88a8,8,0,0,1,0,16H55.44C67.76,183.35,93,208,128,208c36,0,58.14-21.46,58.36-21.68A8,8,0,0,1,197.67,186.37ZM216,40a8,8,0,0,0-8,8V71.85C192.53,54.4,165.39,32,128,32,85.18,32,59.42,57.27,58.34,58.34a8,8,0,0,0,11.3,11.34C69.86,69.46,92,48,128,48c35,0,60.24,24.65,72.56,40H168a8,8,0,0,0,0,16h48a8,8,0,0,0,8-8V48A8,8,0,0,0,216,40Z"},null,-1),$a=[Ma],Va={key:5},Fa=v("path",{d:"M194.83,189.18a4,4,0,0,1,0,5.65c-1,1-25.65,25.17-66.83,25.17-23.93,0-47.35-10.05-67.73-29.08a146.39,146.39,0,0,1-16.27-18V208a4,4,0,0,1-8,0V160a4,4,0,0,1,4-4H88a4,4,0,0,1,0,8H47.41c10,14.06,38.39,48,80.59,48,37.75,0,60.95-22.6,61.18-22.83A4,4,0,0,1,194.83,189.18ZM216,44a4,4,0,0,0-4,4V83.07a146.39,146.39,0,0,0-16.27-18C175.35,46.05,151.93,36,128,36,86.82,36,62.2,60.14,61.17,61.17a4,4,0,0,0,5.65,5.66C67.05,66.6,90.25,44,128,44c42.2,0,70.63,33.94,80.59,48H168a4,4,0,0,0,0,8h48a4,4,0,0,0,4-4V48A4,4,0,0,0,216,44Z"},null,-1),Ha=[Fa],Ta={name:"PhArrowsClockwise"},Za=U({...Ta,props:{weight:{type:String},size:{type:[String,Number]},color:{type:String},mirrored:{type:Boolean}},setup(f){const d=f,r=F("weight","regular"),y=F("size","1em"),i=F("color","currentColor"),l=F("mirrored",!1),o=x(()=>{var n;return(n=d.weight)!=null?n:r}),k=x(()=>{var n;return(n=d.size)!=null?n:y}),H=x(()=>{var n;return(n=d.color)!=null?n:i}),m=x(()=>d.mirrored!==void 0?d.mirrored?"scale(-1, 1)":void 0:l?"scale(-1, 1)":void 0);return(n,b)=>(s(),h("svg",O({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256",width:k.value,height:k.value,fill:H.value,transform:m.value},n.$attrs),[q(n.$slots,"default"),o.value==="bold"?(s(),h("g",ma,fa)):o.value==="duotone"?(s(),h("g",ga,wa)):o.value==="fill"?(s(),h("g",_a,ka)):o.value==="light"?(s(),h("g",Aa,Ca)):o.value==="regular"?(s(),h("g",xa,$a)):o.value==="thin"?(s(),h("g",Va,Ha)):M("",!0)],16,ca))}}),Ia=["width","height","fill","transform"],Ua={key:0},Ra=v("path",{d:"M234.49,111.07,90.41,22.94A20,20,0,0,0,60,39.87V216.13a20,20,0,0,0,30.41,16.93l144.08-88.13a19.82,19.82,0,0,0,0-33.86ZM84,208.85V47.15L216.16,128Z"},null,-1),Ea=[Ra],Ba={key:1},La=v("path",{d:"M228.23,134.69,84.15,222.81A8,8,0,0,1,72,216.12V39.88a8,8,0,0,1,12.15-6.69l144.08,88.12A7.82,7.82,0,0,1,228.23,134.69Z",opacity:"0.2"},null,-1),Na=v("path",{d:"M232.4,114.49,88.32,26.35a16,16,0,0,0-16.2-.3A15.86,15.86,0,0,0,64,39.87V216.13A15.94,15.94,0,0,0,80,232a16.07,16.07,0,0,0,8.36-2.35L232.4,141.51a15.81,15.81,0,0,0,0-27ZM80,215.94V40l143.83,88Z"},null,-1),Da=[La,Na],Pa={key:2},za=v("path",{d:"M240,128a15.74,15.74,0,0,1-7.6,13.51L88.32,229.65a16,16,0,0,1-16.2.3A15.86,15.86,0,0,1,64,216.13V39.87a15.86,15.86,0,0,1,8.12-13.82,16,16,0,0,1,16.2.3L232.4,114.49A15.74,15.74,0,0,1,240,128Z"},null,-1),Wa=[za],ja={key:3},qa=v("path",{d:"M231.36,116.19,87.28,28.06a14,14,0,0,0-14.18-.27A13.69,13.69,0,0,0,66,39.87V216.13a13.69,13.69,0,0,0,7.1,12.08,14,14,0,0,0,14.18-.27l144.08-88.13a13.82,13.82,0,0,0,0-23.62Zm-6.26,13.38L81,217.7a2,2,0,0,1-2.06,0,1.78,1.78,0,0,1-1-1.61V39.87a1.78,1.78,0,0,1,1-1.61A2.06,2.06,0,0,1,80,38a2,2,0,0,1,1,.31L225.1,126.43a1.82,1.82,0,0,1,0,3.14Z"},null,-1),Oa=[qa],Qa={key:4},Ga=v("path",{d:"M232.4,114.49,88.32,26.35a16,16,0,0,0-16.2-.3A15.86,15.86,0,0,0,64,39.87V216.13A15.94,15.94,0,0,0,80,232a16.07,16.07,0,0,0,8.36-2.35L232.4,141.51a15.81,15.81,0,0,0,0-27ZM80,215.94V40l143.83,88Z"},null,-1),Ja=[Ga],Ka={key:5},Xa=v("path",{d:"M230.32,117.9,86.24,29.79a11.91,11.91,0,0,0-12.17-.23A11.71,11.71,0,0,0,68,39.89V216.11a11.71,11.71,0,0,0,6.07,10.33,11.91,11.91,0,0,0,12.17-.23L230.32,138.1a11.82,11.82,0,0,0,0-20.2Zm-4.18,13.37L82.06,219.39a4,4,0,0,1-4.07.07,3.77,3.77,0,0,1-2-3.35V39.89a3.77,3.77,0,0,1,2-3.35,4,4,0,0,1,4.07.07l144.08,88.12a3.8,3.8,0,0,1,0,6.54Z"},null,-1),Ya=[Xa],et={name:"PhPlay"},at=U({...et,props:{weight:{type:String},size:{type:[String,Number]},color:{type:String},mirrored:{type:Boolean}},setup(f){const d=f,r=F("weight","regular"),y=F("size","1em"),i=F("color","currentColor"),l=F("mirrored",!1),o=x(()=>{var n;return(n=d.weight)!=null?n:r}),k=x(()=>{var n;return(n=d.size)!=null?n:y}),H=x(()=>{var n;return(n=d.color)!=null?n:i}),m=x(()=>d.mirrored!==void 0?d.mirrored?"scale(-1, 1)":void 0:l?"scale(-1, 1)":void 0);return(n,b)=>(s(),h("svg",O({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256",width:k.value,height:k.value,fill:H.value,transform:m.value},n.$attrs),[q(n.$slots,"default"),o.value==="bold"?(s(),h("g",Ua,Ea)):o.value==="duotone"?(s(),h("g",Ba,Da)):o.value==="fill"?(s(),h("g",Pa,Wa)):o.value==="light"?(s(),h("g",ja,Oa)):o.value==="regular"?(s(),h("g",Qa,Ja)):o.value==="thin"?(s(),h("g",Ka,Ya)):M("",!0)],16,Ia))}}),tt=["width","height","fill","transform"],lt={key:0},ot=v("path",{d:"M200.73,36H55.27A19.3,19.3,0,0,0,36,55.27V200.73A19.3,19.3,0,0,0,55.27,220H200.73A19.3,19.3,0,0,0,220,200.73V55.27A19.3,19.3,0,0,0,200.73,36ZM196,196H60V60H196Z"},null,-1),rt=[ot],nt={key:1},it=v("path",{d:"M208,55.27V200.73a7.28,7.28,0,0,1-7.27,7.27H55.27A7.28,7.28,0,0,1,48,200.73V55.27A7.28,7.28,0,0,1,55.27,48H200.73A7.28,7.28,0,0,1,208,55.27Z",opacity:"0.2"},null,-1),st=v("path",{d:"M200.73,40H55.27A15.29,15.29,0,0,0,40,55.27V200.73A15.29,15.29,0,0,0,55.27,216H200.73A15.29,15.29,0,0,0,216,200.73V55.27A15.29,15.29,0,0,0,200.73,40ZM200,200H56V56H200Z"},null,-1),ut=[it,st],dt={key:2},pt=v("path",{d:"M216,55.27V200.73A15.29,15.29,0,0,1,200.73,216H55.27A15.29,15.29,0,0,1,40,200.73V55.27A15.29,15.29,0,0,1,55.27,40H200.73A15.29,15.29,0,0,1,216,55.27Z"},null,-1),ct=[pt],mt={key:3},vt=v("path",{d:"M200.73,42H55.27A13.28,13.28,0,0,0,42,55.27V200.73A13.28,13.28,0,0,0,55.27,214H200.73A13.28,13.28,0,0,0,214,200.73V55.27A13.28,13.28,0,0,0,200.73,42ZM202,200.73a1.27,1.27,0,0,1-1.27,1.27H55.27A1.27,1.27,0,0,1,54,200.73V55.27A1.27,1.27,0,0,1,55.27,54H200.73A1.27,1.27,0,0,1,202,55.27Z"},null,-1),ft=[vt],gt={key:4},ht=v("path",{d:"M200.73,40H55.27A15.29,15.29,0,0,0,40,55.27V200.73A15.29,15.29,0,0,0,55.27,216H200.73A15.29,15.29,0,0,0,216,200.73V55.27A15.29,15.29,0,0,0,200.73,40ZM200,200H56V56H200Z"},null,-1),yt=[ht],wt={key:5},_t=v("path",{d:"M200.73,44H55.27A11.29,11.29,0,0,0,44,55.27V200.73A11.29,11.29,0,0,0,55.27,212H200.73A11.29,11.29,0,0,0,212,200.73V55.27A11.29,11.29,0,0,0,200.73,44ZM204,200.73a3.28,3.28,0,0,1-3.27,3.27H55.27A3.28,3.28,0,0,1,52,200.73V55.27A3.28,3.28,0,0,1,55.27,52H200.73A3.28,3.28,0,0,1,204,55.27Z"},null,-1),bt=[_t],kt={name:"PhStop"},At=U({...kt,props:{weight:{type:String},size:{type:[String,Number]},color:{type:String},mirrored:{type:Boolean}},setup(f){const d=f,r=F("weight","regular"),y=F("size","1em"),i=F("color","currentColor"),l=F("mirrored",!1),o=x(()=>{var n;return(n=d.weight)!=null?n:r}),k=x(()=>{var n;return(n=d.size)!=null?n:y}),H=x(()=>{var n;return(n=d.color)!=null?n:i}),m=x(()=>d.mirrored!==void 0?d.mirrored?"scale(-1, 1)":void 0:l?"scale(-1, 1)":void 0);return(n,b)=>(s(),h("svg",O({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256",width:k.value,height:k.value,fill:H.value,transform:m.value},n.$attrs),[q(n.$slots,"default"),o.value==="bold"?(s(),h("g",lt,rt)):o.value==="duotone"?(s(),h("g",nt,ut)):o.value==="fill"?(s(),h("g",dt,ct)):o.value==="light"?(s(),h("g",mt,ft)):o.value==="regular"?(s(),h("g",gt,yt)):o.value==="thin"?(s(),h("g",wt,bt)):M("",!0)],16,tt))}}),St=U({__name:"ThreadSelectorModal",props:{showThreadModal:{type:Boolean},stage:{},executionConfig:{}},emits:["fix-invalid-json","update:execution-config","update:show-thread-modal"],setup(f,{emit:d}){const r=()=>{d("update:show-thread-modal",!1),j.writeTestData(y.threadData)};Te(async()=>y.threadData=await j.readTestData());const y=Ze({threadData:"{}"});return(i,l)=>(s(),S(e(ve),{open:i.showThreadModal,footer:null,onCancel:r},{default:t(()=>[a(ra,{stage:i.stage,"execution-config":i.executionConfig,"onUpdate:executionConfig":l[0]||(l[0]=o=>d("update:execution-config",o)),"onUpdate:showThreadModal":l[1]||(l[1]=o=>d("update:show-thread-modal",o)),onFixInvalidJson:l[2]||(l[2]=o=>d("fix-invalid-json",o,o))},null,8,["stage","execution-config"])]),_:1},8,["open"]))}});const Ct=Q(St,[["__scopeId","data-v-541d30a8"]]),ge=f=>(pe("data-v-a8ca44f6"),f=f(),ce(),f),xt=ge(()=>v("i",null,"string",-1)),Mt=ge(()=>v("i",null,"string list",-1)),$t=U({__name:"FormNotificationSettings",props:{form:{}},setup(f){const r=C(f.form);return(y,i)=>(s(),h(de,null,[a(e(G),{layout:"vertical"},{default:t(()=>[a(e(E),{level:4,width:"100%",height:"30px",style:{display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"0px"}},{default:t(()=>[g(" Thread waiting "),a(e(fe),{checked:r.value.notificationTrigger.enabled,"onUpdate:checked":i[0]||(i[0]=l=>r.value.notificationTrigger.enabled=l)},{default:t(()=>[g(" Enabled ")]),_:1},8,["checked"])]),_:1}),a(e(N),{class:"description",style:{fontStyle:"italic",marginBottom:"20px"}},{default:t(()=>[g(" Send emails when the thread is waiting for the form to be filled ")]),_:1}),a(e(V),{label:"Variable name"},{default:t(()=>[a(e(T),{value:r.value.notificationTrigger.variable_name,"onUpdate:value":i[1]||(i[1]=l=>r.value.notificationTrigger.variable_name=l),disabled:!r.value.notificationTrigger.enabled,type:"text",placeholder:"variable_name"},null,8,["value","disabled"])]),_:1})]),_:1}),a(e(ue),{type:"info"},{message:t(()=>[a(e(N),null,{default:t(()=>[g(" Notifications are sent to the emails specified in the thread variables set here. The variables should contain a "),xt,g(" or a "),Mt,g(". ")]),_:1})]),_:1}),a(e(ue),{style:{"margin-top":"20px"}},{message:t(()=>[a(e(N),null,{default:t(()=>[g(" Notifications are a paid feature. Talk to your account manager to enable them. ")]),_:1})]),_:1})],64))}});const Vt=Q($t,[["__scopeId","data-v-a8ca44f6"]]),Ft=U({__name:"FormSettings",props:{form:{}},setup(f){const r=C(f.form);return(y,i)=>(s(),S(e(G),{layout:"vertical",style:{"padding-bottom":"50px"}},{default:t(()=>[a(Ge,{runtime:r.value},null,8,["runtime"]),a(e(V),{label:"Form name"},{default:t(()=>[a(e(T),{value:r.value.title,"onUpdate:value":i[0]||(i[0]=l=>r.value.title=l),type:"text",onChange:i[1]||(i[1]=l=>{var o;return r.value.title=(o=l.target.value)!=null?o:""})},null,8,["value"])]),_:1}),a(e(E),{level:3},{default:t(()=>[g(" Texts ")]),_:1}),a(e(E),{level:4},{default:t(()=>[g(" Welcome Screen ")]),_:1}),a(e(V),{label:"Title"},{default:t(()=>[a(e(T),{value:r.value.welcomeTitle,"onUpdate:value":i[2]||(i[2]=l=>r.value.welcomeTitle=l),type:"text",placeholder:r.value.title,disabled:r.value.autoStart},null,8,["value","placeholder","disabled"])]),_:1}),a(e(V),{label:"Description"},{default:t(()=>[a(e(T),{value:r.value.startMessage,"onUpdate:value":i[3]||(i[3]=l=>r.value.startMessage=l),type:"text",disabled:r.value.autoStart},null,8,["value","disabled"])]),_:1}),a(e(V),{label:"Start button label"},{default:t(()=>[a(e(T),{value:r.value.startButtonText,"onUpdate:value":i[4]||(i[4]=l=>r.value.startButtonText=l),type:"text",placeholder:"Start",disabled:r.value.autoStart},null,8,["value","disabled"])]),_:1}),a(e(V),null,{default:t(()=>[a(e(re),{checked:r.value.autoStart,"onUpdate:checked":i[5]||(i[5]=l=>r.value.autoStart=l)},{default:t(()=>[g("Skip welcome screen")]),_:1},8,["checked"])]),_:1}),a(e(E),{level:4},{default:t(()=>[g(" End Screen ")]),_:1}),a(e(V),{label:"End text"},{default:t(()=>[a(e(T),{value:r.value.endMessage,"onUpdate:value":i[6]||(i[6]=l=>r.value.endMessage=l),type:"text",placeholder:"Thank you"},null,8,["value"])]),_:1}),a(e(V),{label:"Restart button label"},{default:t(()=>[a(e(T),{value:r.value.restartButtonText,"onUpdate:value":i[7]||(i[7]=l=>r.value.restartButtonText=l),placeholder:"Restart",type:"text",disabled:!r.value.allowRestart},null,8,["value","disabled"])]),_:1}),a(e(V),{help:!r.value.isInitial&&"Only initial forms can be restarted"},{default:t(()=>[a(e(re),{checked:r.value.allowRestart,"onUpdate:checked":i[8]||(i[8]=l=>r.value.allowRestart=l),disabled:!r.value.isInitial},{default:t(()=>[g("Show restart button at the end")]),_:1},8,["checked","disabled"])]),_:1},8,["help"]),a(e(E),{level:4},{default:t(()=>[g(" Alert Messages ")]),_:1}),a(e(V),{label:"Error message"},{default:t(()=>[a(e(T),{value:r.value.errorMessage,"onUpdate:value":i[9]||(i[9]=l=>r.value.errorMessage=l),type:"text",placeholder:"Something went wrong"},null,8,["value"])]),_:1})]),_:1}))}}),Ht=U({__name:"QueryParamsModal",props:{open:{type:Boolean},close:{type:Function},queryParams:{}},emits:["update:query-params"],setup(f,{emit:d}){const y=C(i(f.queryParams));function i(m){return Object.entries(m).map(([n,b])=>({key:n,value:b,id:Math.random().toString()}))}function l(){const m={};return y.value.forEach(({key:n,value:b})=>{m[n]=b}),m}const o=(m,n,b)=>{y.value[m]={key:n,value:b},d("update:query-params",l())},k=()=>{const m=y.value.length;y.value.push({key:`param-${m}`,value:"value"}),d("update:query-params",l())},H=m=>{y.value.splice(m,1),d("update:query-params",l())};return(m,n)=>(s(),S(e(ve),{open:m.open,onCancel:m.close},{footer:t(()=>[a(e(Z),{type:"primary",onClick:m.close},{default:t(()=>[g("OK")]),_:1},8,["onClick"])]),default:t(()=>[a(e(D),{vertical:"",gap:"20"},{default:t(()=>[a(e(N),null,{default:t(()=>[g("Query params")]),_:1}),(s(!0),h(de,null,Ie(y.value,(b,c)=>(s(),S(e(V),{key:c},{default:t(()=>[a(e(Ue),null,{default:t(()=>[a(e(T),{value:b.key,"onUpdate:value":I=>b.key=I,type:"text",placeholder:"name",onChange:()=>o(c,b.key,b.value)},null,8,["value","onUpdate:value","onChange"]),a(e(T),{value:b.value,"onUpdate:value":I=>b.value=I,type:"text",placeholder:"value",disabled:b.key===e(me),onChange:()=>o(c,b.key,b.value)},null,8,["value","onUpdate:value","disabled","onChange"]),a(e(Z),{danger:"",onClick:I=>H(c)},{default:t(()=>[g("remove")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128)),a(e(V),null,{default:t(()=>[a(e(Z),{type:"dashed",style:{width:"100%"},onClick:k},{default:t(()=>[g(" Add Query Param ")]),_:1})]),_:1})]),_:1})]),_:1},8,["open","onCancel"]))}}),Tt=f=>(pe("data-v-8258bd46"),f=f(),ce(),f),Zt={style:{width:"50%"}},It={style:{width:"50%"}},Ut={key:0},Rt={key:1},Et=Tt(()=>v("br",null,null,-1)),Bt={class:"form-preview-container"},Lt=U({__name:"FormEditor",setup(f){var ee;const d=Re(),r=Ee(),y=C(null),i=C("source-code"),l=C(null),o=C(null),k=C(null),H=C(null),m=C({}),n=C(!1),b=p=>c.value={...c.value,attached:!!p},c=C({attached:!1,stageRunId:null,pendingFork:!1,isInitial:!1}),I=x(()=>{var p;return(p=w.value)!=null&&p.form.hasChanges()?{title:"Unsaved changes",message:"Save the form before running the workflow"}:c.value.attached&&c.value.pendingFork?{title:"Past thread selected",message:"Fork the selected thread to run the workflow"}:!c.value.isInitial&&c.value.attached&&!c.value.stageRunId?{title:"No thread selected",message:"Select a thread to run the workflow"}:null}),he=(p,u)=>{var A;(A=y.value)==null||A.setHighlight(p,u)},ye=()=>{var p,u;(p=y.value)==null||p.restartEditor(),(u=y.value)==null||u.startPreviewMode()},we=x(()=>!c.value.isInitial&&c.value.attached&&!!(c.value.pendingFork||!c.value.stageRunId));Be(()=>c.value.stageRunId?m.value={...m.value,[me]:c.value.stageRunId}:null);const{result:w,loading:_e,refetch:be}=Ye(async()=>{const[p,u]=await Promise.all([la.get(r.params.id),j.get()]);return c.value.isInitial=p.isInitial,Ne({form:p,workspace:u})});ne([()=>c.value.attached,m,w],()=>{J()});function J(){if(!w.value)return;const p=!c.value.attached;k.value=w.value.form.makeRunnerData(w.value.workspace),l.value&&l.value.clearListeners(),l.value=new Oe({formRunnerData:k.value,queryParams:m.value,userManager:He,logService:Y,connectionManager:new Qe(w.value.form.id,p),onFormStart:ye,onFormEnd:ke,onRedirect:Me,onAuthUpdate:A=>H.value=A,onStateUpdate:A=>o.value=A,onStackTraceUpdate:he});const u=l.value.getState();o.value=u.formState,H.value=u.passwordlessUser}const ke=()=>{var p,u,A;c.value={attached:!1,stageRunId:null,pendingFork:!1,isInitial:(u=(p=w.value)==null?void 0:p.form.isInitial)!=null?u:!1},(A=y.value)==null||A.restartEditor()};function Ae(){var p;(p=l.value)==null||p.start()}function K(){var p,u;(p=y.value)==null||p.restartEditor(),(u=l.value)==null||u.reset()}const Se=p=>{se("editor",d,p.path)};function Ce(){d.push({name:"stages"})}const X=C(null),xe=p=>{!w.value||(w.value.form.file=p)},Y=Xe.create();function Me(p,u){se("editor",d,p,u)}const $e=()=>{var u,A;if(c.value.attached){let _=`/${(u=w.value)==null?void 0:u.form.path}`;c.value.attached&&c.value.stageRunId&&(_+=`?abstra-run-id=${c.value.stageRunId}`),window.open(_,"_blank")}const p=d.resolve({name:"formPreview",query:r.query,params:{id:(A=w.value)==null?void 0:A.form.id}});window.open(p.href,"_blank")},P=C(!1),Ve=x(()=>{if(!k.value)return"";const p=Object.entries(m.value),u="?"+p.map(([_,$])=>`${_}=${$}`).join("&"),A=p.length?u:"";return`/${k.value.path}${A}`}),z=C((ee=ie.get("dontShowReloadHelper"))!=null?ee:!1),Fe=()=>{ie.set("dontShowReloadHelper",!0),z.value=!0};return ne(()=>r.params.id,()=>{be()}),(p,u)=>{const A=Le("ant-text");return s(),S(We,{"no-margins":""},{navbar:t(()=>[e(w)?(s(),S(e(ia),{key:0,title:e(w).form.title,style:{padding:"5px 25px","margin-bottom":"15px"},onBack:Ce},{extra:t(()=>[a(na,{"docs-path":"forms/overview","show-save-button":!1,"editing-model":e(w).form},null,8,["editing-model"])]),_:1},8,["title"])):M("",!0)]),content:t(()=>[e(w)?(s(),S(e(D),{key:0,gap:"40",style:{width:"calc(100% - 80px)"}},{default:t(()=>[v("div",Zt,[a(e(sa),{"active-key":i.value,"onUpdate:activeKey":u[0]||(u[0]=_=>i.value=_)},{rightExtra:t(()=>[a(oa,{model:e(w).form,onSave:J},null,8,["model"])]),default:t(()=>[a(e(W),{key:"source-code",tab:"Source code"}),a(e(W),{key:"settings",tab:"Settings"}),a(e(W),{key:"notifications",tab:"Notifications"})]),_:1},8,["active-key"]),i.value==="source-code"?(s(),S(Je,{key:0,ref_key:"code",ref:y,script:e(w).form,workspace:e(w).workspace,onUpdateFile:xe},null,8,["script","workspace"])):M("",!0),i.value==="settings"?(s(),S(Ft,{key:1,form:e(w).form},null,8,["form"])):M("",!0),i.value==="notifications"?(s(),S(Vt,{key:2,form:e(w).form},null,8,["form"])):M("",!0),n.value?(s(),S(Ct,{key:3,"execution-config":c.value,"onUpdate:executionConfig":u[1]||(u[1]=_=>c.value=_),"show-thread-modal":n.value,"onUpdate:showThreadModal":u[2]||(u[2]=_=>n.value=_),stage:e(w).form,onFixInvalidJson:u[3]||(u[3]=(_,$)=>{var R;return(R=X.value)==null?void 0:R.fixJson(_,$)})},null,8,["execution-config","show-thread-modal","stage"])):M("",!0)]),v("div",It,[a(e(D),{gap:"10",align:"center",justify:"right",style:{"margin-top":"5px"}},{default:t(()=>{var _;return[a(A,null,{default:t(()=>[g(De(c.value.attached?"Workflow ON":"Workflow OFF"),1)]),_:1}),a(e(fe),{disabled:!!o.value&&e(L).includes((_=o.value)==null?void 0:_.type),checked:c.value.attached,"onUpdate:checked":b},null,8,["disabled","checked"]),a(e(ua),{dot:we.value},{default:t(()=>{var $;return[a(e(Z),{disabled:!!o.value&&e(L).includes(($=o.value)==null?void 0:$.type),style:{display:"flex",gap:"5px"},onClick:u[4]||(u[4]=R=>n.value=!0)},{icon:t(()=>[a(e(aa),{size:"20"})]),default:t(()=>[g("Thread")]),_:1},8,["disabled"])]}),_:1},8,["dot"])]}),_:1}),a(e(da),{style:{margin:"8px 0px 20px"}}),e(_e)||!k.value||!o.value?(s(),S(e(Pe),{key:0})):M("",!0),o.value&&k.value?(s(),S(e(G),{key:1,layout:"vertical"},{default:t(()=>{var _,$,R,ae,te,le;return[a(e(D),{gap:"small"},{default:t(()=>[o.value.type&&e(je).includes(o.value.type)?(s(),S(e(ze),{key:0,placement:"bottom",open:z.value?void 0:!0},{content:t(()=>[z.value?(s(),h("span",Ut,"Reload form")):(s(),h("span",Rt,[g(" You can reload the form here"),Et,a(e(pa),{onClick:Fe},{default:t(()=>[g("Don't show this again")]),_:1})]))]),default:t(()=>[a(e(Z),{disabled:!!I.value,onClick:K},{default:t(()=>[a(e(Za),{size:"20"})]),_:1},8,["disabled"])]),_:1},8,["open"])):M("",!0),e(L).includes(o.value.type)?(s(),S(e(B),{key:1,placement:"bottom"},{title:t(()=>[g("Stop form")]),default:t(()=>[a(e(Z),{onClick:K},{default:t(()=>[a(e(At),{size:"20"})]),_:1})]),_:1})):M("",!0),o.value.type==="waiting"?(s(),S(e(B),{key:2,placement:"bottom"},{title:t(()=>[g("Start form")]),default:t(()=>[a(e(Z),{disabled:!!I.value,onClick:Ae},{default:t(()=>[a(e(at),{size:"20"})]),_:1},8,["disabled"])]),_:1})):M("",!0),a(e(T),{disabled:"",value:Ve.value},null,8,["value"]),a(e(B),{placement:"bottom"},{title:t(()=>[g("Edit query params")]),default:t(()=>{var oe;return[a(e(Z),{disabled:!!o.value&&e(L).includes((oe=o.value)==null?void 0:oe.type),onClick:u[5]||(u[5]=Nt=>P.value=!0)},{default:t(()=>[a(e(ta),{size:"20"})]),_:1},8,["disabled"])]}),_:1}),a(e(B),{placement:"bottom"},{title:t(()=>[g("Open in Full Screen")]),default:t(()=>[a(e(Z),{target:"_blank","aria-label":"Open in Full Screen","aria-describedby":"sss",onClick:$e},{default:t(()=>[a(e(ea),{size:"20"})]),_:1})]),_:1})]),_:1}),v("div",Bt,[a(qe,{"is-preview":"","form-runner-data":k.value,disabled:I.value,"form-state":o.value,"user-email":(_=H.value)==null?void 0:_.claims.email,onUpdateWidgetErrors:($=l.value)==null?void 0:$.updateWidgetFrontendErrors,onUpdateWidgetValue:(R=l.value)==null?void 0:R.updateWidgetValue,onActionClicked:(ae=l.value)==null?void 0:ae.handleActionClick,onNavigate:Se,onLogout:(te=l.value)==null?void 0:te.logout,onAutoFillClicked:(le=l.value)==null?void 0:le.handleAutofillClick},null,8,["form-runner-data","disabled","form-state","user-email","onUpdateWidgetErrors","onUpdateWidgetValue","onActionClicked","onLogout","onAutoFillClicked"])])]}),_:1})):M("",!0),a(Ht,{"query-params":m.value,"onUpdate:queryParams":u[6]||(u[6]=_=>m.value=_),open:P.value,close:()=>P.value=!1},null,8,["query-params","open","close"])])]),_:1})):M("",!0)]),footer:t(()=>{var _,$;return[a(Ke,{ref_key:"smartConsole",ref:X,runtime:"forms","log-service":e(Y),stage:(_=e(w))==null?void 0:_.form,workspace:($=e(w))==null?void 0:$.workspace},null,8,["log-service","stage","workspace"])]}),_:1})}}});const to=Q(Lt,[["__scopeId","data-v-8258bd46"]]);export{to as default};
//# sourceMappingURL=FormEditor.be47eaa0.js.map
