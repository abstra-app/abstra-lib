import{f as l,eG as we,fb as Te,d as re,eB as de,H as N,r as A,J as De,eM as X,a as ce,b as p,c as b,w as a,u as e,bG as B,ar as I,cE as pe,bz as K,bg as Se,ex as O,o as Ne,e as q,ae as je,v as Oe,G as ze,ev as J,fc as Be,eD as ee,bE as qe,bh as Pe,bf as ke,aD as ie,cz as Re,aH as Fe,cG as Me,eC as Ae,eJ as Ve,bA as He,eA as Ke,eL as Ge,I as Je}from"./outputWidgets.cd9a7023.js";import{p as Ie,T as Q,d as Qe}from"./tables.041147b0.js";import{B as Ye}from"./BaseLayout.a1f9bd3c.js";import{a as fe}from"./asyncComputed.d485b66f.js";import{p as ue}from"./popupNotifcation.d4f20194.js";import{Y as $e,Z as Le,_ as Ze,H as We}from"./icons.0bc7085f.js";import"./router.3892c6ef.js";import{P as me}from"./project.dc739fc9.js";import"./index.9161dd13.js";import{A as xe}from"./index.225aa651.js";import{A as $,F as ve}from"./Form.6eabd32b.js";import{A as te}from"./index.8705fa9f.js";import{A as ge}from"./index.147fbeb3.js";import{a as Xe}from"./ant-design.b8fb837f.js";import{E as et}from"./Base.db9f67df.js";import{L as tt}from"./LoadingOutlined.0fd53bda.js";import{A as oe}from"./index.ad4a79ec.js";import{D as at}from"./DeleteOutlined.1b22160c.js";import{A as lt}from"./index.ffc83573.js";import{O as nt}from"./organization.d3464626.js";import{B as ut,a as ot,c as rt}from"./index.9bbb791e.js";import"./record.4940789d.js";import"./pubsub.56df9c23.js";import"./string.5aa1bf4c.js";import"./index.cf4c23b9.js";import"./index.457148fc.js";import"./hasIn.5fdc0bbb.js";import"./isNumeric.75337b1e.js";import"./index.1cb62237.js";import"./Modal.45b0cd08.js";import"./Typography.686aa668.js";import"./DeleteOutlined.f8ba9770.js";import"./ArrowRightOutlined.08fa31dd.js";(function(){try{var c=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},s=new Error().stack;s&&(c._sentryDebugIds=c._sentryDebugIds||{},c._sentryDebugIds[s]="cbe1439d-4a3f-4a11-b97c-e77c624ca954",c._sentryDebugIdIdentifier="sentry-dbid-cbe1439d-4a3f-4a11-b97c-e77c624ca954")}catch{}})();function _e(c){for(var s=1;s<arguments.length;s++){var t=arguments[s]!=null?Object(arguments[s]):{},w=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(w=w.concat(Object.getOwnPropertySymbols(t).filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable}))),w.forEach(function(g){st(c,g,t[g])})}return c}function st(c,s,t){return s in c?Object.defineProperty(c,s,{value:t,enumerable:!0,configurable:!0,writable:!0}):c[s]=t,c}var ye=function(s,t){var w=_e({},s,t.attrs);return l(we,_e({},w,{icon:Te}),null)};ye.displayName="DownOutlined";ye.inheritAttrs=!1;const it=ye;function Ce(c){for(var s=1;s<arguments.length;s++){var t=arguments[s]!=null?Object(arguments[s]):{},w=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(w=w.concat(Object.getOwnPropertySymbols(t).filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable}))),w.forEach(function(g){dt(c,g,t[g])})}return c}function dt(c,s,t){return s in c?Object.defineProperty(c,s,{value:t,enumerable:!0,configurable:!0,writable:!0}):c[s]=t,c}var be=function(s,t){var w=Ce({},s,t.attrs);return l(we,Ce({},w,{icon:et}),null)};be.displayName="EditOutlined";be.inheritAttrs=!1;const ct=be,Ee=(c,s)=>s.includes(c)?{status:"error",help:"There already is a column with this name in the table"}:{status:""},pt=re({__name:"NewColumn",props:{open:{type:Boolean},table:{}},emits:["created","cancel"],setup(c,{emit:s}){const t=c,g=de().params.projectId,L=N(()=>{var v;return((v=t.table)==null?void 0:v.getColumns().map(d=>d.name))||[]}),j=N(()=>Ee(i.value.name,L.value)),_={name:"",type:"varchar",default:"",nullable:!0,unique:!1},i=A(_),M=()=>{i.value={..._}},P=A([{value:"reference",label:"reference",isLeaf:!1},...Ie.map(v=>({value:v,label:v,isLeaf:!0}))]),z=v=>{if(!v)return;const d=v[v.length-1];switch(v.length){case 0:return;case 1:d.loading=!0,Q.list(g).then(x=>{d.children=x.map(h=>({value:h.id,label:h.name,isLeaf:!1})),d.loading=!1});return;case 2:d.loading=!0,Q.get(g,d.value).then(x=>{d.children=x.getColumns().map(h=>({type:h.type,value:h.id,label:h.name,isLeaf:!0})),d.loading=!1});return}},m=(v,d)=>{if(!!v){if(v.length===1){i.value.type=v[0],i.value.foreignKey=void 0;return}if(v.length===3){const x=d[d.length-1];i.value.type=x.type,i.value.foreignKey={columnId:x.value}}}},S=v=>{const d=v.selectedOptions;return d?d.length===1?d[0].label:d.length===3?`reference to ${d[1].label}(${d[2].label})`:"":"Select type"},y=A({...{status:"success",message:"",fakeLoading:!1}}),R=()=>{y.value.fakeLoading=!0,F()};De(()=>i.value.type,()=>{i.value.default=Qe[i.value.type]||"",R()});const F=X.exports.debounce(async()=>{if(!i.value.default){y.value.status="success",y.value.message="",y.value.fakeLoading=!1;return}const v=`select (${i.value.default})::${i.value.type} `;me.executeQuery(g,v,[]).then(d=>{y.value.status=d.errors.length>0?"error":"success",y.value.message=d.errors[0]||"",y.value.fakeLoading=!1})},500);function H(){s("cancel")}async function D(){if(!!t.table&&!(!i.value.name||!i.value.type))try{await t.table.addColumn(i.value),M(),s("created")}catch(v){v instanceof Error&&ue("Database error",v.message)}}return(v,d)=>{const x=ce("icon");return p(),b(e(ge),{title:"New column",width:720,open:t.open,"body-style":{paddingBottom:"80px"},"footer-style":{textAlign:"right"},onClose:H},{extra:a(()=>[l(e(pe),null,{default:a(()=>[l(e(B),{onClick:H},{default:a(()=>[I("Cancel")]),_:1}),l(e(B),{type:"primary",onClick:D},{default:a(()=>[I("Submit")]),_:1})]),_:1})]),default:a(()=>[l(e(ve),{model:i.value,layout:"vertical"},{default:a(()=>[l(e($),{key:"name",label:"Name",required:"","validate-status":j.value.status,help:j.value.help},{default:a(()=>[l(e(K),{value:i.value.name,"onUpdate:value":d[0]||(d[0]=h=>i.value.name=h)},null,8,["value"])]),_:1},8,["validate-status","help"]),l(e($),{key:"type",label:"Type",required:""},{default:a(()=>[l(e(xe),{options:P.value,"load-data":z,"display-render":S,"allow-clear":!1,onChange:m},null,8,["options"])]),_:1}),l(e($),{key:"default-value",label:"Default value","validate-status":y.value.status,help:y.value.message},{default:a(()=>[l(e(K),{value:i.value.default,"onUpdate:value":d[1]||(d[1]=h=>i.value.default=h),onInput:R},{suffix:a(()=>[y.value.fakeLoading?(p(),b(e(Se),{key:0})):O("",!0),!y.value.fakeLoading&&y.value.status==="success"?(p(),b(x,{key:1,path:e($e),width:"18",height:"18"},null,8,["path"])):O("",!0),!y.value.fakeLoading&&y.value.status==="error"?(p(),b(x,{key:2,path:e(Le),width:"18",height:"18"},null,8,["path"])):O("",!0)]),_:1},8,["value"])]),_:1},8,["validate-status","help"]),l(e($),{key:"nullable",label:"Nullable"},{default:a(()=>[l(e(te),{checked:i.value.nullable,"onUpdate:checked":d[2]||(d[2]=h=>i.value.nullable=h)},null,8,["checked"])]),_:1}),l(e($),{key:"unique",label:"Unique"},{default:a(()=>[l(e(te),{checked:i.value.unique,"onUpdate:checked":d[3]||(d[3]=h=>i.value.unique=h)},null,8,["checked"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open"])}}}),ft={class:"twin-container"},mt={class:"fullwidth-input"},vt={class:"fullwidth-input"},gt={class:"using-container"},yt={class:"fullwidth-input"},bt=re({__name:"UpdateColumn",props:{open:{type:Boolean},table:{},column:{}},emits:["updated","cancel"],setup(c,{emit:s}){const t=c,g=de().params.projectId,L=A(t.column.record.initialState.type);Ne(async()=>{if(!t.column.foreignKey)return;L.value="loading...";const n=await Q.fromColumnId(g,t.column.foreignKey.columnId),u=n.getColumn(t.column.foreignKey.columnId);L.value=`reference to ${n.name}(${u.name})`});const j=N(()=>{var n;return((n=t.table)==null?void 0:n.getColumns().map(u=>u.record.initialState.name))||[]}),_=N(()=>t.column.name===t.column.record.initialState.name?{status:"",help:""}:Ee(t.column.name,j.value)),{result:i,loading:M}=fe(async()=>t.table.select({},10,0).then(({total:n})=>n));function P(){t.column.record.resetChanges(),s("cancel")}const m=A({status:"success",message:"",fakeLoading:!1}),S=()=>{m.value.fakeLoading=!0,V()},V=X.exports.debounce(async()=>{if(!t.column.default){m.value.status="success",m.value.message="",m.value.fakeLoading=!1;return}const n=`select (${t.column.default})::${t.column.type} `,u=await me.executeQuery(g,n,[]);m.value.status=u.errors.length>0?"error":"success",m.value.message=u.errors[0]||"",m.value.fakeLoading=!1},500),y=A([{value:"reference",label:"reference",isLeaf:!1},...Ie.map(n=>({value:n,label:n,isLeaf:!0}))]),R=n=>{if(!n)return;const u=n[n.length-1];switch(n.length){case 0:return;case 1:u.loading=!0,Q.list(g).then(E=>{u.children=E.map(C=>({value:C.id,label:C.name,isLeaf:!1})),u.loading=!1});return;case 2:u.loading=!0,Q.get(g,u.value).then(E=>{u.children=E.getColumns().map(C=>({type:C.type,value:C.id,label:C.name,isLeaf:!0})),u.loading=!1});return}},ae=n=>{const u=n.selectedOptions;return u?u.length===1?u[0].label:u.length===3?`reference to ${u[1].label}(${u[2].label})`:"":"Select type"},F=(n,u)=>{if(!!n){if(n.length===1){t.column.type=n[0],t.column.foreignKey=null;return}if(n.length===3){if(t.column.foreignKey&&t.column.foreignKey.columnId===n[2])return;const E=u[u.length-1];t.column.type=E.type,t.column.foreignKey={columnId:E.value}}}},H=()=>i.value===0||M.value?!1:t.column.record.hasChangesDeep("type"),D=A({type:"default"}),v=()=>{t.column.type=t.column.record.initialState.type,D.value={type:"default"}};function d(n,u){return u==="varchar"||n==="int"&&u==="boolean"||n==="boolean"&&u==="int"}De(()=>t.column.type,()=>{S(),h.value||(D.value={type:"user-defined",using:k.value,mandatory:!0})});const h=N(()=>D.value.type==="default"&&d(t.column.record.initialState.type,t.column.type)),Y=N(()=>!d(t.column.record.initialState.type,t.column.type));function se(n){n?D.value={type:"default"}:D.value={type:"user-defined",using:k.value,mandatory:!1}}function le(n){if(D.value.type==="default")throw new Error("Can't change using when using default casting");D.value.using=n!=null?n:""}const Z=()=>Y.value?!0:H()&&D.value.type==="user-defined",k=N(()=>`${t.column.record.initialState.name}::${t.column.type}`);async function W(){if(!t.column)return;let n=D.value.type==="default"?k.value:D.value.using;i.value===0&&(n=`${t.column.name}::text::${t.column.type}`);try{await t.column.update(n),s("updated")}catch(u){u instanceof Error&&ue("Database error",u.message)}}return(n,u)=>{const E=ce("icon");return p(),b(e(ge),{title:"Edit column",width:720,open:n.open,"body-style":{paddingBottom:"80px"},"footer-style":{textAlign:"right"},onClose:P},{extra:a(()=>[l(e(pe),null,{default:a(()=>[l(e(B),{onClick:P},{default:a(()=>[I("Cancel")]),_:1}),l(e(B),{type:"primary",onClick:W},{default:a(()=>[I("Submit")]),_:1})]),_:1})]),default:a(()=>[l(e(ve),{model:n.column,layout:"vertical"},{default:a(()=>[l(e($),{key:"name",label:"Name","validate-status":_.value.status,help:_.value.help},{default:a(()=>[l(e(K),{value:n.column.name,"onUpdate:value":u[0]||(u[0]=C=>n.column.name=C)},null,8,["value"])]),_:1},8,["validate-status","help"]),q("div",ft,[q("span",mt,[l(e($),{key:"type",label:"Current Type"},{default:a(()=>[l(e(je),{value:L.value,"onUpdate:value":u[1]||(u[1]=C=>L.value=C),"default-active-first-option":"",disabled:""},null,8,["value"])]),_:1})]),l(E,{class:"right-arrow",path:e(Ze)},null,8,["path"]),q("span",vt,[l(e($),{key:"new-type",label:"New Type"},{default:a(()=>[l(e(xe),{options:y.value,"load-data":R,"display-render":ae,"allow-clear":!0,onClear:v,onChange:F},null,8,["options"])]),_:1})])]),l(e($),{key:"default-value",label:"Default value","validate-status":m.value.status,help:m.value.message},{default:a(()=>[l(e(K),{value:n.column.default,"onUpdate:value":u[2]||(u[2]=C=>n.column.default=C),onInput:S},{suffix:a(()=>[m.value.fakeLoading?(p(),b(e(Se),{key:0,size:"small"})):O("",!0),!m.value.fakeLoading&&m.value.status==="success"?(p(),b(E,{key:1,path:e($e),width:"18",height:"18"},null,8,["path"])):O("",!0),!m.value.fakeLoading&&m.value.status==="error"?(p(),b(E,{key:2,path:e(Le),width:"18",height:"18"},null,8,["path"])):O("",!0)]),_:1},8,["value"])]),_:1},8,["validate-status","help"]),q("div",gt,[H()?(p(),b(e($),{key:"default-casting",label:"Use default casting"},{default:a(()=>[l(e(te),{checked:h.value,disabled:Y.value,"onUpdate:checked":u[3]||(u[3]=C=>se(!!C))},null,8,["checked","disabled"])]),_:1})):O("",!0),q("span",yt,[H()?(p(),b(e($),{key:"using",label:"Using"},{default:a(()=>[l(e(K),{value:D.value.type==="user-defined"?D.value.using:k.value,disabled:!Z(),onInput:u[4]||(u[4]=C=>le(C.target.value))},null,8,["value","disabled"])]),_:1})):O("",!0)])]),l(e($),{key:"nullable",label:"Nullable"},{default:a(()=>[l(e(te),{checked:n.column.nullable,"onUpdate:checked":u[5]||(u[5]=C=>n.column.nullable=C)},null,8,["checked"])]),_:1}),l(e($),{key:"unique",label:"Unique"},{default:a(()=>[l(e(te),{checked:n.column.unique,"onUpdate:checked":u[6]||(u[6]=C=>n.column.unique=C)},null,8,["checked"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open"])}}});const ht=Oe(bt,[["__scopeId","data-v-d14cbe65"]]),kt={class:"table-data",style:{width:"calc(100% - 120px)"}},_t={style:{overflow:"hidden","white-space":"wrap"}},Ct={key:1},wt={key:1},Dt=["onClick"],St=q("a",null,"Delete",-1),Ot=re({__name:"TableData",props:{table:{},loading:{type:Boolean}},emits:["refresh"],setup(c,{emit:s}){var he;const t=c,w=A(1),g=A(10),L=N(()=>{var r,f;return{total:(f=(r=F.value)==null?void 0:r.total)!=null?f:0,current:w.value,pageSize:g.value,totalBoundaryShowSizeChanger:10,showSizeChanger:!0,pageSizeOptions:["10","25","50","100"],onChange:async(o,U)=>{w.value=o,g.value=U,await D()}}}),j=A(""),_=A(!1),i=A({type:"idle"}),M=()=>{_.value=!0,P()},P=X.exports.debounce(()=>{D(),_.value=!1},500);function z(){i.value={type:"idle"}}async function m(){z(),s("refresh"),await D(),Y()}function S(){i.value={type:"creating"}}const V=r=>{if(!t.table)throw new Error("Table not found");i.value={type:"editing",column:t.table.getColumn(r)}};async function y(r){await Xe("Are you sure you want to delete this column?")&&await R(r)}async function R(r){var f,o;await((o=(f=t.table)==null?void 0:f.getColumn(r))==null?void 0:o.delete()),s("refresh"),await D(),Y()}const ae=N(()=>{var r;return((r=F.value)==null?void 0:r.rows.length)===1}),{result:F,loading:H,refetch:D}=fe(()=>t.table.select({},(w.value-1)*g.value,g.value,j.value)),v=(r,f)=>o=>{if(r==="json"&&o==""){k.value[f]="null";return}k.value[f]=o},d=()=>[...t.table.getColumns().map(r=>{var f;return{key:(f=r.id)!=null?f:"",title:r.name,dataIndex:r.name,width:220,resizable:!0,ellipsis:!1}}),{key:"action",title:"",fixed:"right",width:100,align:"center",resizable:!1,ellipsis:!1}],x=d(),h=A(x),Y=()=>h.value=d();function se(r,f){h.value=h.value.map(o=>o.key===f.key?{...o,width:r}:o)}const le=N(()=>{var r;return((r=F.value)==null?void 0:r.rows.map(f=>({key:f.id,...f})))||[]}),Z=A(!1),k=A({}),W=()=>{Z.value=!0},n=()=>{k.value={},Z.value=!1};let u=ze((he=t.table)==null?void 0:he.getUnprotectedColumns().reduce((r,f)=>({...r,[f.name]:""}),{}));async function E(){if(!(!t.table||!u))try{k.value.id?await t.table.updateRow(k.value.id,k.value):await t.table.insertRow(k.value),k.value={},D(),n()}catch(r){r instanceof Error&&ue("Database error",r.message)}}const C=async r=>{if(!(!F.value||!F.value.rows.find(f=>f.id===r)))try{await t.table.deleteRow(r),ae.value&&(w.value=Math.max(1,w.value-1)),D()}catch(f){f instanceof Error&&ue("Database error",f.message)}},Ue=r=>{var G;const f=(G=le.value)==null?void 0:G.filter(T=>r===T.key)[0],o=t.table.getColumns(),U=o.map(T=>T.name),ne=o.filter(T=>T.type==="json").map(T=>T.name);k.value=X.exports.pick(X.exports.cloneDeep(f),U),ne.forEach(T=>{k.value[T]&&(k.value[T]=JSON.stringify(k.value[T]))}),W()};return(r,f)=>(p(),J("div",kt,[l(e(oe),{justify:"space-between",style:{"margin-bottom":"16px"},gap:"middle"},{default:a(()=>[l(e(K),{value:j.value,"onUpdate:value":[f[0]||(f[0]=o=>j.value=o),M],placeholder:"Search",style:{width:"400px"},"allow-clear":""},{prefix:a(()=>[l(e(Be))]),suffix:a(()=>[_.value?(p(),b(e(tt),{key:0})):O("",!0)]),_:1},8,["value"]),l(e(B),{type:"primary",onClick:S},{default:a(()=>[I("+ Add new column")]),_:1})]),_:1}),l(e(Me),{columns:h.value,"data-source":le.value,pagination:L.value,bordered:"",loading:e(H)||r.loading,scroll:{x:1e3,y:720},size:"small",onResizeColumn:se},{headerCell:a(({column:o})=>[o.title!=="id"&&o.title!=="created_at"&&o.key!=="action"?(p(),b(e(oe),{key:0,align:"center",justify:"space-between",gap:"small"},{default:a(()=>[q("span",_t,ee(o.title),1),l(e(qe),{placement:"bottomRight",trigger:"click"},{overlay:a(()=>[l(e(Pe),null,{default:a(()=>[l(e(ke),{onClick:U=>V(String(o.key))},{icon:a(()=>[l(e(ct))]),default:a(()=>[I(" Edit ")]),_:2},1032,["onClick"]),l(e(ke),{danger:"",onClick:U=>y(String(o.key))},{icon:a(()=>[l(e(at))]),default:a(()=>[I(" Delete ")]),_:2},1032,["onClick"])]),_:2},1024)]),default:a(()=>[l(e(it))]),_:2},1024)]),_:2},1024)):(p(),J("span",Ct,ee(o.title),1))]),bodyCell:a(({column:o,text:U,record:ne})=>[h.value.map(G=>G.title).includes(o.dataIndex)?(p(),J(ie,{key:0},[I(ee(U),1)],64)):O("",!0),o.key==="action"?(p(),J("div",wt,[q("span",null,[q("a",{onClick:G=>Ue(ne.id)},"Edit",8,Dt)]),l(e(lt),{type:"vertical"}),l(e(Re),{title:"Sure to delete?",onConfirm:G=>C(ne.id)},{default:a(()=>[St]),_:2},1032,["onConfirm"])])):O("",!0)]),footer:a(()=>[h.value.length===3?(p(),b(e(Fe),{key:0,title:"Add a first column prior to data entry",placement:"right"},{default:a(()=>[l(e(B),{type:"primary",disabled:!0,onClick:W},{default:a(()=>[I(" + Add New Data ")]),_:1})]),_:1})):(p(),b(e(B),{key:1,type:"primary",onClick:W},{default:a(()=>[I("+ Add New Data")]),_:1}))]),_:1},8,["columns","data-source","pagination","loading"]),l(e(ge),{title:"Data",width:720,open:Z.value,"body-style":{paddingBottom:"80px"},"footer-style":{textAlign:"right"},onClose:n},{extra:a(()=>[l(e(pe),null,{default:a(()=>[l(e(B),{onClick:n},{default:a(()=>[I("Cancel")]),_:1}),l(e(B),{type:"primary",onClick:E},{default:a(()=>[I("Submit")]),_:1})]),_:1})]),default:a(()=>[l(e(ve),{model:k.value,layout:"vertical"},{default:a(()=>[(p(!0),J(ie,null,Ae(r.table.getUnprotectedColumns(),o=>(p(),b(e($),{key:o.id,label:o.name,required:!o.nullable},{default:a(()=>[k.value?(p(),b(e(K),{key:0,placeholder:o.type,value:k.value[o.name],disabled:k.value[o.name]===null,"onUpdate:value":U=>v(o.type,o.name)(U)},Ve({_:2},[o.nullable?{name:"addonAfter",fn:a(()=>[l(e(He),{checked:k.value[o.name]===null,"onUpdate:checked":U=>k.value[o.name]=U?null:""},{default:a(()=>[I(" NULL ")]),_:2},1032,["checked","onUpdate:checked"])]),key:"0"}:void 0]),1032,["placeholder","value","disabled","onUpdate:value"])):O("",!0)]),_:2},1032,["label","required"]))),128))]),_:1},8,["model"])]),_:1},8,["open"]),r.table&&i.value.type==="creating"?(p(),b(pt,{key:0,open:"",table:t.table,onClose:z,onCancel:z,onCreated:m},null,8,["table"])):O("",!0),r.table&&i.value.type==="editing"?(p(),b(ht,{key:1,column:i.value.column,open:"",table:r.table,onUpdated:m,onClose:z,onCancel:z},null,8,["column","table"])):O("",!0)]))}});const At={style:{"font-size":"20px"}},It=re({__name:"TableEditor",setup(c){const s=Ke(),t=de(),w=t.params.tableId,g=t.params.projectId,L=A(!1),j=()=>{var m;L.value=!1,(m=_.value)==null||m.table.save(),M()},{result:_,loading:i,refetch:M}=fe(()=>Promise.all([me.get(g).then(async m=>{const S=await nt.get(m.organizationId);return{project:m,organization:S}}),Q.get(g,w)]).then(([{project:m,organization:S},V])=>Ge({project:m,organization:S,table:V}))),P=N(()=>!i.value&&_.value?[{label:"My organizations",path:"/organizations"},{label:_.value.organization.name,path:`/organizations/${_.value.organization.id}`},{label:_.value.project.name,path:`/projects/${_.value.project.id}/tables`}]:void 0);function z(){s.push({name:"tables",params:{projectId:g}})}return(m,S)=>{const V=ce("router-link");return p(),b(Ye,null,{navbar:a(()=>[l(e(rt),{style:{padding:"5px 25px"},onBack:z},{title:a(()=>[L.value?(p(),b(e(oe),{key:1,align:"center",gap:"large"},{default:a(()=>[e(_)?(p(),b(e(K),{key:0,value:e(_).table.name,"onUpdate:value":S[1]||(S[1]=y=>e(_).table.name=y),class:"borderless-input"},null,8,["value"])):O("",!0),l(e(B),{onClick:j},{default:a(()=>[I("Save")]),_:1})]),_:1})):(p(),b(e(oe),{key:0,align:"center",gap:"small"},{default:a(()=>{var y;return[q("span",At,ee((y=e(_))==null?void 0:y.table.name),1),l(Je,{path:e(We),width:"22",style:{cursor:"pointer"},onClick:S[0]||(S[0]=R=>L.value=!0)},null,8,["path"])]}),_:1}))]),breadcrumb:a(()=>[P.value?(p(),b(e(ut),{key:0},{default:a(()=>[(p(!0),J(ie,null,Ae(P.value,(y,R)=>(p(),b(e(ot),{key:R},{default:a(()=>[l(V,{to:y.path},{default:a(()=>[I(ee(y.label),1)]),_:2},1032,["to"])]),_:2},1024))),128))]),_:1})):O("",!0)]),_:1})]),content:a(()=>[e(_)?(p(),b(Ot,{key:0,loading:e(i),table:e(_).table,onRefresh:S[2]||(S[2]=y=>e(M)())},null,8,["loading","table"])):O("",!0)]),_:1})}}});const sa=Oe(It,[["__scopeId","data-v-594196a3"]]);export{sa as default};
//# sourceMappingURL=TableEditor.acf44a9c.js.map
