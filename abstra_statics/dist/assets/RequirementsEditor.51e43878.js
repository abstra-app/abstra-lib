var ae=Object.defineProperty;var le=(n,e,i)=>e in n?ae(n,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):n[e]=i;var B=(n,e,i)=>(le(n,typeof e!="symbol"?e+"":e,i),i);import{C as ne}from"./ContentLayout.4af755ee.js";import{C as re}from"./CrudView.2cdf26a9.js";import{a as oe}from"./asyncComputed.2585e0f1.js";import{d as X,af as z,g as M,o as l,K as g,O as de,F as C,e5 as ce,a as A,J as ue,a8 as me,a6 as H,f as I,c as f,w as a,b as d,u as s,da as k,eU as O,d5 as x,az as m,eb as Z,bM as D,d6 as pe,d4 as ge,aL as U,ea as G,br as J,eV as W,ee as K,cE as ye,ep as q}from"./index.cb4b8516.js";import{u as fe}from"./polling.fd581ab8.js";import"./linters.3d1bd1e1.js";import{E as he}from"./record.9220bd89.js";import{W as be}from"./workspaces.cc1e23c0.js";import"./router.9423905d.js";import"./Badge.473ae333.js";import"./gateway.450be966.js";import"./popupNotifcation.e1b0a50d.js";import"./DocsButton.vue_vue_type_script_setup_true_lang.de8b1d83.js";import"./url.c2a2f7ae.js";import"./PhDotsThreeVertical.vue.b8ad476a.js";import"./index.d99cc2f3.js";import"./index.2fda36cd.js";import"./workspaceStore.7862a06b.js";import"./userStore.b52332de.js";import"./colorHelpers.70a8d3f5.js";(function(){try{var n=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},e=new Error().stack;e&&(n._sentryDebugIds=n._sentryDebugIds||{},n._sentryDebugIds[e]="cc76d943-2a5b-4ab1-bb87-e3d699630844",n._sentryDebugIdIdentifier="sentry-dbid-cc76d943-2a5b-4ab1-bb87-e3d699630844")}catch{}})();const _e=["width","height","fill","transform"],we={key:0},ve=A("path",{d:"M120,137,48,201A12,12,0,1,1,32,183l61.91-55L32,73A12,12,0,1,1,48,55l72,64A12,12,0,0,1,120,137Zm96,43H120a12,12,0,0,0,0,24h96a12,12,0,0,0,0-24Z"},null,-1),ke=[ve],xe={key:1},Re=A("path",{d:"M216,80V192H40V64H200A16,16,0,0,1,216,80Z",opacity:"0.2"},null,-1),Ce=A("path",{d:"M117.31,134l-72,64a8,8,0,1,1-10.63-12L100,128,34.69,70A8,8,0,1,1,45.32,58l72,64a8,8,0,0,1,0,12ZM216,184H120a8,8,0,0,0,0,16h96a8,8,0,0,0,0-16Z"},null,-1),Ae=[Re,Ce],Te={key:2},Ee=A("path",{d:"M216,40H40A16,16,0,0,0,24,56V200a16,16,0,0,0,16,16H216a16,16,0,0,0,16-16V56A16,16,0,0,0,216,40ZM77.66,173.66a8,8,0,0,1-11.32-11.32L100.69,128,66.34,93.66A8,8,0,0,1,77.66,82.34l40,40a8,8,0,0,1,0,11.32ZM192,176H128a8,8,0,0,1,0-16h64a8,8,0,0,1,0,16Z"},null,-1),Se=[Ee],Ve={key:3},Me=A("path",{d:"M116,132.48l-72,64a6,6,0,0,1-8-9L103,128,36,68.49a6,6,0,0,1,8-9l72,64a6,6,0,0,1,0,9ZM216,186H120a6,6,0,0,0,0,12h96a6,6,0,0,0,0-12Z"},null,-1),Le=[Me],ze={key:4},Ze=A("path",{d:"M117.31,134l-72,64a8,8,0,1,1-10.63-12L100,128,34.69,70A8,8,0,1,1,45.32,58l72,64a8,8,0,0,1,0,12ZM216,184H120a8,8,0,0,0,0,16h96a8,8,0,0,0,0-16Z"},null,-1),je=[Ze],qe={key:5},Ne=A("path",{d:"M116,128a4,4,0,0,1-1.34,3l-72,64a4,4,0,1,1-5.32-6L106,128,37.34,67a4,4,0,0,1,5.32-6l72,64A4,4,0,0,1,116,128Zm100,60H120a4,4,0,0,0,0,8h96a4,4,0,0,0,0-8Z"},null,-1),Pe=[Ne],Fe={name:"PhTerminal"},$e=X({...Fe,props:{weight:{type:String},size:{type:[String,Number]},color:{type:String},mirrored:{type:Boolean}},setup(n){const e=n,i=z("weight","regular"),r=z("size","1em"),_=z("color","currentColor"),w=z("mirrored",!1),h=M(()=>{var u;return(u=e.weight)!=null?u:i}),b=M(()=>{var u;return(u=e.size)!=null?u:r}),v=M(()=>{var u;return(u=e.color)!=null?u:_}),L=M(()=>e.mirrored!==void 0?e.mirrored?"scale(-1, 1)":void 0:w?"scale(-1, 1)":void 0);return(u,N)=>(l(),g("svg",ce({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256",width:b.value,height:b.value,fill:v.value,transform:L.value},u.$attrs),[de(u.$slots,"default"),h.value==="bold"?(l(),g("g",we,ke)):h.value==="duotone"?(l(),g("g",xe,Ae)):h.value==="fill"?(l(),g("g",Te,Se)):h.value==="light"?(l(),g("g",Ve,Le)):h.value==="regular"?(l(),g("g",ze,je)):h.value==="thin"?(l(),g("g",qe,Pe)):C("",!0)],16,_e))}}),Q="__ABSTRA_STREAM_ERROR__";class Be{async list(){return(await fetch("/_editor/api/requirements")).json()}async recommendations(){return(await fetch("/_editor/api/requirements/recommendations")).json()}async update(e,i){if(!(await fetch(`/_editor/api/requirements/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)})).ok)throw new Error("Failed to update requirements")}async create(e){const i=await fetch("/_editor/api/requirements",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!i.ok)throw new Error("Failed to create requirements");return i.json()}async delete(e){if(!(await fetch(`/_editor/api/requirements/${e}`,{method:"DELETE"})).ok)throw new Error("Failed to delete requirements")}async*install(){var r;const i=(r=(await fetch("/_editor/api/requirements/install",{method:"POST",headers:{"Content-Type":"application/json"}})).body)==null?void 0:r.getReader();if(!i)throw new Error("No response body");for(;;){const _=await i.read();if(_.done)break;const w=new TextDecoder().decode(_.value);if(w===Q)throw new Error("Failed to install requirements");yield w}}async*uninstall(e){var _;const r=(_=(await fetch(`/_editor/api/requirements/${e}/uninstall`,{method:"POST",headers:{"Content-Type":"application/json"}})).body)==null?void 0:_.getReader();if(!r)throw new Error("No response body");for(;;){const w=await r.read();if(w.done)break;const h=new TextDecoder().decode(w.value);if(h===Q)throw new Error("Failed to uninstall requirements");yield h}}}const T=new Be;class R{constructor(e){B(this,"record");this.record=he.from(e)}static async list(){return(await T.list()).map(i=>new R(i))}static async create(e,i){const r=await T.create({name:e,version:i||null});return new R(r)}get name(){return this.record.get("name")}set name(e){this.record.set("name",e)}get version(){var e;return(e=this.record.get("version"))!=null?e:null}set version(e){this.record.set("version",e)}get installedVersion(){var e;return(e=this.record.get("installed_version"))!=null?e:null}async delete(){await T.delete(this.name)}async uninstall(e){for await(const i of T.uninstall(this.name))e(i)}static async recommendations(){return T.recommendations()}static async install(e){for await(const i of T.install())e(i)}}const He=n=>["__future__","__main__","_thread","abc","aifc","argparse","array","ast","asynchat","asyncio","asyncore","atexit","audioop","base64","bdb","binascii","binhex","bisect","builtins","bz2","calendar","cgi","cgitb","chunk","cmath","cmd","code","codecs","codeop","collections","collections.abc","colorsys","compileall","concurrent","concurrent.futures","configparser","contextlib","contextvars","copy","copyreg","cProfile","crypt","csv","ctypes","curses","curses.ascii","curses.panel","curses.textpad","dataclasses","datetime","dbm","dbm.dumb","dbm.gnu","dbm.ndbm","decimal","difflib","dis","distutils","distutils.archive_util","distutils.bcppcompiler","distutils.ccompiler","distutils.cmd","distutils.command","distutils.command.bdist","distutils.command.bdist_dumb","distutils.command.bdist_msi","distutils.command.bdist_packager","distutils.command.bdist_rpm","distutils.command.build","distutils.command.build_clib","distutils.command.build_ext","distutils.command.build_py","distutils.command.build_scripts","distutils.command.check","distutils.command.clean","distutils.command.config","distutils.command.install","distutils.command.install_data","distutils.command.install_headers","distutils.command.install_lib","distutils.command.install_scripts","distutils.command.register","distutils.command.sdist","distutils.core","distutils.cygwinccompiler","distutils.debug","distutils.dep_util","distutils.dir_util","distutils.dist","distutils.errors","distutils.extension","distutils.fancy_getopt","distutils.file_util","distutils.filelist","distutils.log","distutils.msvccompiler","distutils.spawn","distutils.sysconfig","distutils.text_file","distutils.unixccompiler","distutils.util","distutils.version","doctest","email","email.charset","email.contentmanager","email.encoders","email.errors","email.generator","email.header","email.headerregistry","email.iterators","email.message","email.mime","email.parser","email.policy","email.utils","encodings","encodings.idna","encodings.mbcs","encodings.utf_8_sig","ensurepip","enum","errno","faulthandler","fcntl","filecmp","fileinput","fnmatch","fractions","ftplib","functools","gc","getopt","getpass","gettext","glob","graphlib","grp","gzip","hashlib","heapq","hmac","html","html.entities","html.parser","http","http.client","http.cookiejar","http.cookies","http.server","idlelib","imaplib","imghdr","imp","importlib","importlib.abc","importlib.machinery","importlib.metadata","importlib.resources","importlib.util","inspect","io","ipaddress","itertools","json","json.tool","keyword","lib2to3","linecache","locale","logging","logging.config","logging.handlers","lzma","mailbox","mailcap","marshal","math","mimetypes","mmap","modulefinder","msilib","msvcrt","multiprocessing","multiprocessing.connection","multiprocessing.dummy","multiprocessing.managers","multiprocessing.pool","multiprocessing.shared_memory","multiprocessing.sharedctypes","netrc","nis","nntplib","numbers","operator","optparse","os","os.path","ossaudiodev","pathlib","pdb","pickle","pickletools","pipes","pkgutil","platform","plistlib","poplib","posix","pprint","profile","pstats","pty","pwd","py_compile","pyclbr","pydoc","queue","quopri","random","re","readline","reprlib","resource","rlcompleter","runpy","sched","secrets","select","selectors","shelve","shlex","shutil","signal","site","smtpd","smtplib","sndhdr","socket","socketserver","spwd","sqlite3","ssl","stat","statistics","string","stringprep","struct","subprocess","sunau","symtable","sys","sysconfig","syslog","tabnanny","tarfile","telnetlib","tempfile","termios","test","test.support","test.support.bytecode_helper","test.support.import_helper","test.support.os_helper","test.support.script_helper","test.support.socket_helper","test.support.threading_helper","test.support.warnings_helper","textwrap","threading","time","timeit","tkinter","tkinter.colorchooser","tkinter.commondialog","tkinter.dnd","tkinter.filedialog","tkinter.font","tkinter.messagebox","tkinter.scrolledtext","tkinter.simpledialog","tkinter.tix","tkinter.ttk","token","tokenize","trace","traceback","tracemalloc","tty","turtle","turtledemo","types","typing","unicodedata","unittest","unittest.mock","urllib","urllib.error","urllib.parse","urllib.request","urllib.response","urllib.robotparser","uu","uuid","venv","warnings","wave","weakref","webbrowser","winreg","winsound","wsgiref","wsgiref.handlers","wsgiref.headers","wsgiref.simple_server","wsgiref.util","wsgiref.validate","xdrlib","xml","xml.dom","xml.dom.minidom","xml.dom.pulldom","xml.etree.ElementTree","xml.parsers.expat","xml.parsers.expat.errors","xml.parsers.expat.model","xml.sax","xml.sax.handler","xml.sax.saxutils","xml.sax.xmlreader","xmlrpc","xmlrpc.client","xmlrpc.server","zipapp","zipfile","zipimport","zlib","zoneinfo"].includes(n),Ie=n=>/^(\d+!)?(\d+)(\.\d+)+([\\.\-\\_])?((a(lpha)?|b(eta)?|c|r(c|ev)?|pre(view)?)\d*)?(\.?(post|dev)\d*)?$/.test(n),Oe={key:2},De={key:0,class:"logs-output"},Ue=["textContent"],gt=X({__name:"RequirementsEditor",setup(n){const{loading:e,result:i,refetch:r}=oe(()=>Promise.all([R.list(),R.recommendations()]).then(([t,o])=>({requirements:t,recommendations:o}))),{startPolling:_,endPolling:w}=fe({task:r,interval:2e3});ue(()=>_()),me(()=>w());function h(){be.openFile("requirements.txt")}const b=H({}),v=H(new Set);function L(t){return o=>{b[t.name]?b[t.name]=[...b[t.name],o]:b[t.name]=[o]}}function u(t){b[t.name]=[]}async function N(t){u(t),y.value="installing",j(t),v.add(t.name);try{await R.install(L(t)),y.value="install-success"}catch{y.value="install-error"}finally{v.delete(t.name),await r()}}const y=I("idle"),E=I(null);function j(t){E.value=t.name}async function P(t){v.add(t.name);try{await t.delete()}finally{v.delete(t.name),await r()}}async function Y(t){u(t),y.value="uninstalling",j(t),v.add(t.name);try{await t.uninstall(L(t)),y.value="uninstall-success"}catch{y.value="uninstall-error"}finally{v.delete(t.name),await r()}}async function ee(t,o){await R.create(t,o).then(r),r()}const te=[{label:"Name",key:"name",hint:t=>He(t)?"This requirement is built-in should not be installed":void 0},{label:"Required version",key:"version",placeholder:"latest",hint:t=>!t||Ie(t)?void 0:"Invalid version"}];async function se({name:t,version:o}){await R.create(t,o),r()}const ie=M(()=>{var t,o;return{columns:[{title:"Name"},{title:"Version"},{title:"Installed"},{title:"",align:"right"}],rows:(o=(t=i.value)==null?void 0:t.requirements.map(c=>{var S,V;return{key:c.name,cells:[{type:"text",text:c.name},{type:"text",text:(S=c.version)!=null?S:" - "},{type:"slot",key:"status",payload:c},{type:"actions",actions:[{icon:$e,label:"Logs",onClick:()=>j(c),hide:!((V=b[c.name])!=null&&V.length)},c.installedVersion?{icon:q,label:"Remove",onClick:()=>P(c),dangerous:!0}:{icon:O,label:"Install",onClick:()=>N(c)},c.installedVersion?{icon:q,label:"Remove and uninstall",onClick:()=>Y(c),dangerous:!0}:{icon:q,label:"Remove",onClick:()=>P(c),dangerous:!0}]}]}}))!=null?o:[]}});return(t,o)=>(l(),f(ne,null,{default:a(()=>{var c,S,V;return[d(re,{"entity-name":"Requirements",loading:s(e),title:"Requirements",description:"Specify pip requirements for your project. This will create and update your requirements.txt file.","empty-title":"No python requirements set",table:ie.value,"create-button-text":"Add requirement",fields:te,live:"",create:se},{status:a(({payload:p})=>[d(s(k),{gap:"small",align:"center",justify:"center"},{default:a(()=>[p.installedVersion?(l(),f(s(O),{key:0})):C("",!0),p.installedVersion?(l(),f(s(x),{key:1,type:"secondary"},{default:a(()=>[m(Z(p.installedVersion),1)]),_:2},1024)):(l(),f(s(x),{key:2,type:"secondary"},{default:a(()=>[m(" Not installed ")]),_:1}))]),_:2},1024)]),secondary:a(()=>[d(s(D),{onClick:o[0]||(o[0]=p=>h())},{default:a(()=>[m("Open requirements.txt")]),_:1})]),_:1},8,["loading","table"]),(c=s(i))!=null&&c.recommendations.length?(l(),f(s(pe),{key:0},{default:a(()=>[m(" Suggested requirements ")]),_:1})):C("",!0),(S=s(i))!=null&&S.recommendations.length?(l(),f(s(ge),{key:1},{default:a(()=>[m(" The following requirements are being utilized by your code but are not listed in your requirements.txt. ")]),_:1})):C("",!0),(V=s(i))!=null&&V.recommendations.length?(l(),g("ul",Oe,[(l(!0),g(U,null,G(s(i).recommendations,p=>(l(),g("li",{key:p.name},[m(Z(p.name)+" ("+Z(p.version)+") ",1),d(s(D),{onClick:F=>{var $;return ee(p.name,($=p.version)!=null?$:void 0)}},{default:a(()=>[m(" Add to requirements ")]),_:2},1032,["onClick"])]))),128))])):C("",!0),d(s(ye),{open:!!E.value,onCancel:o[1]||(o[1]=p=>E.value=null)},{footer:a(()=>[]),title:a(()=>[m("Logs")]),default:a(()=>[d(s(k),{vertical:"",gap:"small"},{default:a(()=>[E.value?(l(),g("div",De,[(l(!0),g(U,null,G(b[E.value],(p,F)=>(l(),g("pre",{key:F,textContent:Z(p)},null,8,Ue))),128))])):C("",!0),y.value==="installing"?(l(),f(s(k),{key:1,gap:"small",align:"center"},{default:a(()=>[d(s(J)),d(s(x),{type:"secondary"},{default:a(()=>[m("Installing requirement...")]),_:1})]),_:1})):y.value==="uninstalling"?(l(),f(s(k),{key:2,gap:"small",align:"center"},{default:a(()=>[d(s(J)),d(s(x),{type:"secondary"},{default:a(()=>[m("Uninstalling requirement...")]),_:1})]),_:1})):y.value==="install-success"?(l(),f(s(k),{key:3,gap:"small",align:"center"},{default:a(()=>[d(s(W)),d(s(x),{type:"success"},{default:a(()=>[m("Requirement installed successfully")]),_:1})]),_:1})):y.value==="install-error"?(l(),f(s(k),{key:4,gap:"small",align:"center"},{default:a(()=>[d(s(K)),d(s(x),{type:"danger"},{default:a(()=>[m("Requirement installation failed")]),_:1})]),_:1})):y.value==="uninstall-success"?(l(),f(s(k),{key:5,gap:"small",align:"center"},{default:a(()=>[d(s(W)),d(s(x),{type:"success"},{default:a(()=>[m("Requirement uninstalled successfully")]),_:1})]),_:1})):y.value==="uninstall-error"?(l(),f(s(k),{key:6,gap:"small",align:"center"},{default:a(()=>[d(s(K)),d(s(x),{type:"danger"},{default:a(()=>[m("Requirement uninstallation failed")]),_:1})]),_:1})):C("",!0)]),_:1})]),_:1},8,["open"])]}),_:1}))}});export{gt as default};
//# sourceMappingURL=RequirementsEditor.51e43878.js.map
