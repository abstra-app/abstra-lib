import{d as $,r as x,v as H,b as i,c as f,x as a,F as C,L,N as M,W as q,a5 as N,e as n,O as Q,Q as j,q as A,H as X,J as Y,K as Z,z as t,t as k,w as v,D as V,S as ee}from"./registerWidgets.2f45149c.js";import{L as te}from"./CircularLoading.6a1de8f8.js";import{E as oe}from"./Error.7881d1dd.js";import{R as re,F as ae}from"./broker.706dadca.js";import{R as se,T as le,S as ne,_ as ie,L as ue,a as W}from"./UnsavedChangesHandler.vue_vue_type_script_setup_true_lang.1a853ce0.js";import{a as ce}from"./asyncComputed.d996f175.js";import{F as me}from"./forms.13cabe76.js";import{W as de}from"./workspaces.a1826430.js";import{B as pe}from"./BackButton.7bc6932d.js";import{S as fe}from"./SaveButton.8bb4c288.js";import{D as _e}from"./DocsButton.69af8c43.js";import{P as ve}from"./PreviewButton.a519beeb.js";import"./lottie.c1075e8a.js";import"./passwordlessManager.65b55f3a.js";import"./pubsub.6eb95bc1.js";import"./Passwordless.2c960938.js";import"./icons.4f168bb8.js";import"./executeJs.23ccafe1.js";import"./PlayerNavbar.c2469537.js";import"./index.44c0d54d.js";import"./Steps.272280dd.js";import"./Modal.1aac9028.js";import"./WidgetsFrame.b0bff436.js";import"./ActionButton.vue_vue_type_script_setup_true_lang.92f10061.js";import"./dashes.bb42eb5e.js";import"./activeRecord.9dd5fa85.js";import"./runnerData.c017261b.js";import"./hooks.4d1f0ffb.js";import"./jobs.8e96daf3.js";import"./uuid.53eefaf3.js";(function(){try{var s=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},d=new Error().stack;d&&(s._sentryDebugIds=s._sentryDebugIds||{},s._sentryDebugIds[d]="614e91b4-ad02-404d-bed8-ba79b867bf3f",s._sentryDebugIdIdentifier="sentry-dbid-614e91b4-ad02-404d-bed8-ba79b867bf3f")}catch{}})();const ye="forms_workspace_id_path_key",U=s=>(Q("data-v-7f776cc2"),s=s(),j(),s),he={class:"form-settings"},be={class:"content"},ge={class:"subsection-label"},ke={class:"property-label"},we=["value","onChange"],Se={class:"content"},xe={class:"property"},Ce=U(()=>a("div",{class:"property-label"},"Start smart form automatically",-1)),Ee={class:"property"},Fe=U(()=>a("div",{class:"property-label"},"Allow the user to restart the smart form after it is over",-1)),Re="This path is already being used by another form or dash on your workspace",Be=$({__name:"FormSettings",props:{form:{}},setup(s){const o=x(s.form),y=[{label:"General",props:[{label:"Form name",valueKey:"title"}]},{label:"Welcome Screen",props:[{label:"Title",valueKey:"welcomeTitle"},{label:"Subtitle",valueKey:"startMessage"},{label:"Start button text",valueKey:"startButtonText"}]},{label:"Ending Screen",props:[{label:"Title",valueKey:"endMessage"},{label:"Restart button text",valueKey:"restartButtonText"}]},{label:"Alert Messages",props:[{label:"Error message",valueKey:"errorMessage"}]}],h=H({pathError:null,sectionsShown:[!0,!1,!1]}),w=r=>{r.detail.includes(ye)&&(h.pathError=Re)};return addEventListener("hasura-error",w),(r,c)=>(i(),f("div",he,[a("div",be,[(i(),f(C,null,L(y,l=>a("div",{key:l.label,class:"subsection"},[a("div",ge,M(l.label),1),(i(!0),f(C,null,L(l.props,m=>(i(),f("div",{key:m.label,class:"property column"},[a("div",ke,M(m.label),1),a("input",{class:"property-input",type:"text",value:o.value[m.valueKey],onChange:S=>o.value[m.valueKey]=S.target.value},null,40,we)]))),128))])),64))]),a("div",Se,[a("div",xe,[q(a("input",{"onUpdate:modelValue":c[0]||(c[0]=l=>o.value.autoStart=l),class:"checkbox-input",type:"checkbox"},null,512),[[N,o.value.autoStart]]),Ce]),a("div",Ee,[q(a("input",{"onUpdate:modelValue":c[1]||(c[1]=l=>o.value.allowRestart=l),class:"checkbox-input",type:"checkbox"},null,512),[[N,o.value.allowRestart]]),Fe])]),n(se,{runtime:o.value},null,8,["runtime"])]))}});const Ke=A(Be,[["__scopeId","data-v-7f776cc2"]]),Pe={class:"page"},De={key:1,class:"error"},Ie=$({__name:"FormEditor",setup(s){var F,R,B;const d=X(),o=Y(),y=H({fullscreen:!1,rightPanelCollapsed:!1,hasChanges:!1,started:!1});addEventListener("keydown",e=>{(e.ctrlKey||e.metaKey)&&e.key==="s"&&(e.preventDefault(),S())});const h=x(null),{loading:w,result:r,error:c,refetch:l}=ce(()=>Promise.all([de.get(),me.get(o.params.formPath)]).then(([e,g])=>ee({workspace:e,form:g}))),m=x(!1);async function S(){var e;m.value=!0;try{await((e=r.value)==null?void 0:e.form.save())}finally{m.value=!1}}const p=ue.create(),b=Z(()=>re.create({formPath:o.params.formPath}));(F=b.value)==null||F.on("stdout",e=>{p.log({type:"stdout",log:e.log})}),(R=b.value)==null||R.on("stderr",e=>{p.log({type:"stderr",log:e.log})}),(B=b.value)==null||B.onClose(()=>{p.log({type:"stderr",log:"Program closed"})});const z=()=>{p.clear()},E=async()=>{var e;return p.log({type:"restart"}),(e=h.value)==null?void 0:e.run()},G=({path:e,type:g})=>{g==="dash"?d.push({name:"dashEditor",params:{dashPath:e},query:o.query}):(d.push({name:"editor",params:{formPath:e},query:o.query}),l())},J=()=>{y.started=!0},O=()=>{y.started=!1};return(e,g)=>{var K,P,D,I,T;return i(),f(C,null,[a("div",Pe,[t(w)||!((K=t(r))!=null&&K.form)||!((P=t(r))!=null&&P.workspace)?(i(),k(te,{key:0})):t(c)?(i(),f("div",De,[n(oe,{error:t(c),onReload:t(l)},null,8,["error","onReload"])])):(i(),k(le,{key:2},{left:v(()=>[n(pe,{link:"/_editor/forms"})]),right:v(()=>{var u,_;return[n(_e),n(ve,{model:(u=t(r))==null?void 0:u.form},null,8,["model"]),n(fe,{model:(_=t(r))==null?void 0:_.form},null,8,["model"])]}),default:v(()=>[n(W,{title:"Preview"},{default:v(()=>{var u,_;return[n(ae,{ref_key:"runner",ref:h,form:(_=t(r))==null?void 0:_.form.makeRunnerData((u=t(r))==null?void 0:u.workspace),params:t(o).query,"is-preview":!0,"enable-auto-focus":!1,broker:b.value,style:{height:"unset",flex:1,overflow:"hidden"},onNavigate:G,onLogout:E,onExit:O,onStart:J},null,8,["form","params","broker"])]}),_:1}),n(W,{title:"Settings"},{default:v(()=>{var u;return[(u=t(r))!=null&&u.form?(i(),k(Ke,{key:0,form:t(r).form},null,8,["form"])):V("",!0)]}),_:1})]),_:1})),(D=t(r))!=null&&D.form?(i(),k(ne,{key:3,runtime:"forms","log-service":t(p),onRestart:E,onClearTerminal:z},null,8,["log-service"])):V("",!0)]),n(ie,{"has-changes":(T=(I=t(r))==null?void 0:I.form)==null?void 0:T.hasChanges()},null,8,["has-changes"])],64)}}});const ct=A(Ie,[["__scopeId","data-v-8b7849de"]]);export{ct as default};
//# sourceMappingURL=FormEditor.97042ea7.js.map
