import{_ as Y}from"./DocsButton.vue_vue_type_script_setup_true_lang.6164294d.js";import{C as J}from"./ContentLayout.6c60812b.js";import{p as Q}from"./popupNotifcation.cee72ce4.js";import{a as X}from"./ant-design.1f542312.js";import{a as K}from"./asyncComputed.b796d4e5.js";import{d as G,D as I,f as O,o as c,Y as h,$ as q,S as w,e8 as ee,a as f,b as s,ee as S,f0 as te,f1 as ne,ea as ae,e as re,c as _,w as u,aG as b,u as l,df as le,dd as N,bT as D,e9 as P,d6 as oe,bR as ie,bz as se,bx as E,de as V,cz as ue,em as ce,en as de,a0 as pe}from"./index.aaa5ea50.js";import{C as j}from"./gateway.ca8f9e95.js";import"./tables.d7f10cb2.js";import{C as fe}from"./Card.d6c0f7be.js";import"./BookOutlined.716b021c.js";import"./record.3b51fd54.js";import"./string.2dfb3834.js";import"./TabPane.30644632.js";(function(){try{var t=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},e=new Error().stack;e&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[e]="05fe9608-5249-4ec4-a3b3-0ec93a4951db",t._sentryDebugIdIdentifier="sentry-dbid-05fe9608-5249-4ec4-a3b3-0ec93a4951db")}catch{}})();var me={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M400 317.7h73.9V656c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V317.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 163a8 8 0 00-12.6 0l-112 141.7c-4.1 5.3-.4 13 6.3 13zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z"}}]},name:"upload",theme:"outlined"};const ye=me,ge=["width","height","fill","transform"],he={key:0},ve=f("path",{d:"M144,128a16,16,0,1,1-16-16A16,16,0,0,1,144,128ZM60,112a16,16,0,1,0,16,16A16,16,0,0,0,60,112Zm136,0a16,16,0,1,0,16,16A16,16,0,0,0,196,112Z"},null,-1),be=[ve],_e={key:1},we=f("path",{d:"M240,96v64a16,16,0,0,1-16,16H32a16,16,0,0,1-16-16V96A16,16,0,0,1,32,80H224A16,16,0,0,1,240,96Z",opacity:"0.2"},null,-1),Oe=f("path",{d:"M140,128a12,12,0,1,1-12-12A12,12,0,0,1,140,128Zm56-12a12,12,0,1,0,12,12A12,12,0,0,0,196,116ZM60,116a12,12,0,1,0,12,12A12,12,0,0,0,60,116Z"},null,-1),Ae=[we,Oe],je={key:2},Ce=f("path",{d:"M224,80H32A16,16,0,0,0,16,96v64a16,16,0,0,0,16,16H224a16,16,0,0,0,16-16V96A16,16,0,0,0,224,80ZM60,140a12,12,0,1,1,12-12A12,12,0,0,1,60,140Zm68,0a12,12,0,1,1,12-12A12,12,0,0,1,128,140Zm68,0a12,12,0,1,1,12-12A12,12,0,0,1,196,140Z"},null,-1),ke=[Ce],Ie={key:3},$e=f("path",{d:"M138,128a10,10,0,1,1-10-10A10,10,0,0,1,138,128ZM60,118a10,10,0,1,0,10,10A10,10,0,0,0,60,118Zm136,0a10,10,0,1,0,10,10A10,10,0,0,0,196,118Z"},null,-1),De=[$e],Pe={key:4},Se=f("path",{d:"M140,128a12,12,0,1,1-12-12A12,12,0,0,1,140,128Zm56-12a12,12,0,1,0,12,12A12,12,0,0,0,196,116ZM60,116a12,12,0,1,0,12,12A12,12,0,0,0,60,116Z"},null,-1),Ze=[Se],Me={key:5},Ue=f("path",{d:"M136,128a8,8,0,1,1-8-8A8,8,0,0,1,136,128Zm-76-8a8,8,0,1,0,8,8A8,8,0,0,0,60,120Zm136,0a8,8,0,1,0,8,8A8,8,0,0,0,196,120Z"},null,-1),xe=[Ue],Fe={name:"PhDotsThree"},ze=G({...Fe,props:{weight:{type:String},size:{type:[String,Number]},color:{type:String},mirrored:{type:Boolean}},setup(t){const e=t,n=I("weight","regular"),r=I("size","1em"),o=I("color","currentColor"),$=I("mirrored",!1),m=O(()=>{var d;return(d=e.weight)!=null?d:n}),A=O(()=>{var d;return(d=e.size)!=null?d:r}),y=O(()=>{var d;return(d=e.color)!=null?d:o}),C=O(()=>e.mirrored!==void 0?e.mirrored?"scale(-1, 1)":void 0:$?"scale(-1, 1)":void 0);return(d,k)=>(c(),h("svg",ee({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256",width:A.value,height:A.value,fill:y.value,transform:C.value},d.$attrs),[q(d.$slots,"default"),m.value==="bold"?(c(),h("g",he,be)):m.value==="duotone"?(c(),h("g",_e,Ae)):m.value==="fill"?(c(),h("g",je,ke)):m.value==="light"?(c(),h("g",Ie,De)):m.value==="regular"?(c(),h("g",Pe,Ze)):m.value==="thin"?(c(),h("g",Me,xe)):w("",!0)],16,ge))}});function B(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?Object(arguments[e]):{},r=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(o){return Object.getOwnPropertyDescriptor(n,o).enumerable}))),r.forEach(function(o){Ne(t,o,n[o])})}return t}function Ne(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Z=function(e,n){var r=B({},e,n.attrs);return s(S,B({},r,{icon:te}),null)};Z.displayName="DeleteOutlined";Z.inheritAttrs=!1;const T=Z;function H(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?Object(arguments[e]):{},r=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(o){return Object.getOwnPropertyDescriptor(n,o).enumerable}))),r.forEach(function(o){Ee(t,o,n[o])})}return t}function Ee(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var M=function(e,n){var r=H({},e,n.attrs);return s(S,H({},r,{icon:ne}),null)};M.displayName="DownloadOutlined";M.inheritAttrs=!1;const Ve=M;function R(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?Object(arguments[e]):{},r=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(o){return Object.getOwnPropertyDescriptor(n,o).enumerable}))),r.forEach(function(o){Be(t,o,n[o])})}return t}function Be(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var U=function(e,n){var r=R({},e,n.attrs);return s(S,R({},r,{icon:ye}),null)};U.displayName="UploadOutlined";U.inheritAttrs=!1;const L=U;class x{constructor(e){this.projectId=e}static fromProjectId(e){return new x(e)}async list(){return j.get(`projects/${this.projectId}/files`)}async upload(e,n=""){const r={"Content-Type":"multipart/form-data"};return j.post(`projects/${this.projectId}/files/upload?path=${encodeURIComponent(n+"/"+e.name)}`,e,r)}async download(e){return j.getBlob(`projects/${this.projectId}/files/download?path=${encodeURIComponent(e)}`)}async delete(e){return j.delete(`projects/${this.projectId}/files?path=${encodeURIComponent(e)}`)}async move(e,n){return j.patch(`projects/${this.projectId}/files?path=${encodeURIComponent(e)}&newPath=${encodeURIComponent(n)}`,{})}}const Te=t=>(ce("data-v-048030b3"),t=t(),de(),t),He=Te(()=>f("br",null,null,-1)),Re={key:0},Le={key:0,class:"file-size"},Ge={class:"action-item"},qe={class:"action-item"},We=G({__name:"Files",setup(t){const n=ae().params.projectId,r=x.fromProjectId(n),{loading:o,result:$,refetch:m}=K(()=>r.list());function A(a){var i,p;return{key:a.path,title:a.name,isLeaf:a.type==="file",file:a,children:a.type==="file"?[]:(p=(i=a.children)==null?void 0:i.map(A))!=null?p:[]}}const y=O(()=>{var a;return(a=$.value)==null?void 0:a.map(A)}),C=a=>{var i,p;return a.isLeaf?1:(p=(i=a.children)==null?void 0:i.reduce((g,v)=>g+C(v),0))!=null?p:0},d=O(()=>y.value?y==null?void 0:y.value.reduce((a,i)=>a+C(i),0):0),k=re(!1);function F(a){if(a&&a.type==="file")return;const i=document.createElement("input");i.type="file",i.onchange=async()=>{var g;const p=(g=i.files)==null?void 0:g[0];if(!!p)try{k.value=!0,await r.upload(p,a==null?void 0:a.path),await m()}catch{Q("Failed to upload file","File already exists")}finally{k.value=!1}},i.click()}async function W(a){if(!a)return;const i=await r.download(a.path),p=document.createElement("a");p.href=URL.createObjectURL(i),p.download=a.name,p.click()}async function z(a){if(!a)return;const i="Are you sure you want to delete this "+(a.type==="file"?"file":"directory and all its contents")+"?";await X(i)&&(await r.delete(a.path),await m())}return(a,i)=>(c(),_(J,null,{default:u(()=>[s(l(le),null,{default:u(()=>[b("Files")]),_:1}),s(l(N),null,{default:u(()=>[b(" Here you can upload, download and delete files in your persistent dir."),He,b(" Files can be used in your scripts. "),s(Y,{path:"cloud/files"}),q(a.$slots,"description",{},void 0,!0)]),_:3}),s(l(D),{type:"primary",loading:k.value,onClick:i[0]||(i[0]=p=>F())},{default:u(()=>[s(l(L)),b(" Upload ")]),_:1},8,["loading"]),s(l(fe),{class:"files"},{default:u(()=>[d.value>0?(c(),_(l(N),{key:0},{default:u(()=>[f("b",null,[b(P(d.value)+" file",1),d.value!==1?(c(),h("span",Re,"s")):w("",!0)])]),_:1})):w("",!0),y.value&&y.value.length>0?(c(),_(l(oe),{key:1,"tree-data":y.value,selectable:!1},{title:u(({title:p,isLeaf:g,file:v})=>[f("span",null,[b(P(p)+" ",1),g?(c(),h("span",Le,"("+P(v.size)+")",1)):w("",!0)]),g?(c(),_(l(D),{key:0,type:"text",size:"small",style:{float:"inline-end"},onClick:()=>W(v)},{default:u(()=>[s(l(Ve))]),_:2},1032,["onClick"])):w("",!0),g?(c(),_(l(D),{key:1,type:"text",size:"small",style:{float:"inline-end"},onClick:()=>z(v)},{default:u(()=>[s(l(T))]),_:2},1032,["onClick"])):w("",!0),g?w("",!0):(c(),_(l(ie),{key:2},{overlay:u(()=>[s(l(se),{disabled:l(o)},{default:u(()=>[s(l(E),{danger:!1,onClick:()=>F(v)},{default:u(()=>[f("div",Ge,[s(l(L)),s(l(V),null,{default:u(()=>[b(" Upload ")]),_:1})])]),_:2},1032,["onClick"]),s(l(E),{danger:!1,onClick:()=>z(v)},{default:u(()=>[f("div",qe,[s(l(T)),s(l(V),null,{default:u(()=>[b(" Delete ")]),_:1})])]),_:2},1032,["onClick"])]),_:2},1032,["disabled"])]),default:u(()=>[s(l(ze),{style:{cursor:"pointer",float:"inline-end"},size:"25px"})]),_:2},1024))]),_:1},8,["tree-data"])):(c(),_(l(ue),{key:2,description:l(o)?"Loading...":"No files"},null,8,["description"]))]),_:1})]),_:3}))}});const st=pe(We,[["__scopeId","data-v-048030b3"]]);export{st as default};
//# sourceMappingURL=Files.a73c5ee6.js.map
