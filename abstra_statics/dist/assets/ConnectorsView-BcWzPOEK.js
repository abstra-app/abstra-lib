import{_ as ae}from"./DocsButton.vue_vue_type_script_setup_true_lang-A2DJMrgT.js";import{_ as Z}from"./AbstraButton.vue_vue_type_script_setup_true_lang-jrf6T-dj.js";import{a as B,i as P,c as E,b as k,e as c,f as oe,g as T,h as j,m as le,r as H,a8 as $,H as G,p as v,u as e,aJ as ie,w as l,M as U,W as z,aG as se,aH as ce,aK as ue,cg as O,bq as re,br as de,S as C,U as _,ch as pe,bo as he,b8 as ge,bj as me,bn as fe,j as i,af as h,ak as K,v as x,aQ as R,ci as ye,aL as Q,bm as J,E as ve,aN as X,ac as Ce,aj as M,be as _e,bf as ke,bg as W,bB as be,z as Y,bs as q}from"./jwt-decode.esm-DMEcPnlZ.js";import{G as we}from"./PhDotsThreeVertical.vue-C_MTL6JD.js";import{C as xe}from"./connectors-CpHEPqRS.js";import{a as Se}from"./router-CsFgRj65.js";import{U as Ie}from"./UploadOutlined-ZvD0IZm8.js";import{_ as Ue}from"./AbstraLogo.vue_vue_type_script_setup_true_lang-Cn2lZDwg.js";import{L as Te}from"./Logo-BOjh3fiH.js";import{A as ee}from"./index-DTMx69BL.js";import{C as ne}from"./index-NJmOvxLs.js";import{S as Ve}from"./index-2nzvy6dS.js";import"./constants-CbdtsnEO.js";import"./ts.worker-ue1Gmja7.js";(function(){try{var s=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},a=new Error().stack;a&&(s._sentryDebugIds=s._sentryDebugIds||{},s._sentryDebugIds[a]="21866a7d-178f-45a8-98dd-04ea938bee82",s._sentryDebugIdIdentifier="sentry-dbid-21866a7d-178f-45a8-98dd-04ea938bee82")}catch{}})();const Ae=["width","height","fill","transform"],Le={key:0},Ne=j("path",{d:"M216.49,184.49l-32,32a12,12,0,0,1-17-17L179,188H48a12,12,0,0,1,0-24H179l-11.52-11.51a12,12,0,0,1,17-17l32,32A12,12,0,0,1,216.49,184.49Zm-145-64a12,12,0,0,0,17-17L77,92H208a12,12,0,0,0,0-24H77L88.49,56.49a12,12,0,0,0-17-17l-32,32a12,12,0,0,0,0,17Z"},null,-1),Ke=[Ne],Ee={key:1},je=j("path",{d:"M208,80v96H48V80Z",opacity:"0.2"},null,-1),Fe=j("path",{d:"M213.66,181.66l-32,32a8,8,0,0,1-11.32-11.32L188.69,184H48a8,8,0,0,1,0-16H188.69l-18.35-18.34a8,8,0,0,1,11.32-11.32l32,32A8,8,0,0,1,213.66,181.66Zm-139.32-64a8,8,0,0,0,11.32-11.32L67.31,88H208a8,8,0,0,0,0-16H67.31L85.66,53.66A8,8,0,0,0,74.34,42.34l-32,32a8,8,0,0,0,0,11.32Z"},null,-1),He=[je,Fe],ze={key:2},Be=j("path",{d:"M42.34,85.66a8,8,0,0,1,0-11.32l32-32A8,8,0,0,1,88,48V72H208a8,8,0,0,1,0,16H88v24a8,8,0,0,1-13.66,5.66Zm171.32,84.68-32-32A8,8,0,0,0,168,144v24H48a8,8,0,0,0,0,16H168v24a8,8,0,0,0,13.66,5.66l32-32A8,8,0,0,0,213.66,170.34Z"},null,-1),Pe=[Be],Re={key:3},$e=j("path",{d:"M212.24,171.76a6,6,0,0,1,0,8.48l-32,32a6,6,0,0,1-8.48-8.48L193.51,182H48a6,6,0,0,1,0-12H193.51l-21.75-21.76a6,6,0,0,1,8.48-8.48ZM75.76,116.24a6,6,0,0,0,8.48-8.48L62.49,86H208a6,6,0,0,0,0-12H62.49L84.24,52.24a6,6,0,0,0-8.48-8.48l-32,32a6,6,0,0,0,0,8.48Z"},null,-1),Me=[$e],qe={key:4},De=j("path",{d:"M213.66,181.66l-32,32a8,8,0,0,1-11.32-11.32L188.69,184H48a8,8,0,0,1,0-16H188.69l-18.35-18.34a8,8,0,0,1,11.32-11.32l32,32A8,8,0,0,1,213.66,181.66Zm-139.32-64a8,8,0,0,0,11.32-11.32L67.31,88H208a8,8,0,0,0,0-16H67.31L85.66,53.66A8,8,0,0,0,74.34,42.34l-32,32a8,8,0,0,0,0,11.32Z"},null,-1),Ze=[De],Ge={key:5},Oe=j("path",{d:"M210.83,173.17a4,4,0,0,1,0,5.66l-32,32a4,4,0,0,1-5.66-5.66L198.34,180H48a4,4,0,0,1,0-8H198.34l-25.17-25.17a4,4,0,0,1,5.66-5.66ZM77.17,114.83a4,4,0,0,0,5.66-5.66L57.66,84H208a4,4,0,0,0,0-8H57.66L82.83,50.83a4,4,0,0,0-5.66-5.66l-32,32a4,4,0,0,0,0,5.66Z"},null,-1),Je=[Oe],We={name:"PhArrowsLeftRight"},Ye=B({...We,props:{weight:{type:String},size:{type:[String,Number]},color:{type:String},mirrored:{type:Boolean}},setup(s){const a=s,o=P("weight","regular"),n=P("size","1em"),r=P("color","currentColor"),b=P("mirrored",!1),S=E(()=>a.weight??o),V=E(()=>a.size??n),g=E(()=>a.color??r),w=E(()=>a.mirrored!==void 0?a.mirrored?"scale(-1, 1)":void 0:b?"scale(-1, 1)":void 0);return(L,N)=>(c(),k("svg",le({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256",width:V.value,height:V.value,fill:g.value,transform:w.value},L.$attrs),[oe(L.$slots,"default"),S.value==="bold"?(c(),k("g",Le,Ke)):S.value==="duotone"?(c(),k("g",Ee,He)):S.value==="fill"?(c(),k("g",ze,Pe)):S.value==="light"?(c(),k("g",Re,Me)):S.value==="regular"?(c(),k("g",qe,Ze)):S.value==="thin"?(c(),k("g",Ge,Je)):T("",!0)],16,Ae))}});class Qe{constructor(a,o){this.projectId=a,this.api=o,this.state=H({connectors:[],connections:[],addingConnection:null,editingConnection:null,betaStatus:{}})}state;hasChanges=E(()=>!!this.state.value.editingConnection&&this.state.value.editingConnection.name!==this.state.value.editingConnection.newName);async fetchConnectors(){this.state.value.connectors=await this.api.listConnectors(this.projectId)}async fetchBetaStatus(){this.state.value.betaStatus=await this.api.getConnectorsBetaStatus()}async fetchInitialState(){await this.fetchConnectors(),await Promise.all([this.fetchBetaStatus(),this.refetchConnections()])}async refetchConnections(){const a=await this.api.listConnections(this.projectId);this.state.value.connections=a.map(o=>{const n=this.state.value.connectors.find(r=>r.metadata.key===o.connectionType);return n?{name:o.name,connectorTitle:n.metadata.label,connectorType:o.connectionType,icon:n.metadata.logoUrl}:null}).filter(o=>o!==null)}handleDeletionClick=async a=>{$.confirm({title:"Delete connection",content:"Are you sure you want to delete this connection?",onOk:()=>this.handleDeleteConnection(a)})};handleDeleteConnection=async a=>{await this.api.deleteConnection({projectId:this.projectId,connectionName:a.name,connectorType:a.connectorType}),this.state.value.editingConnection=null,await this.refetchConnections()};handleEditConnectionClick(a){this.state.value.editingConnection={...a,newName:a.name}}async getLoginUrl(a,o,n,r){return this.api.getLoginUrl(this.projectId,o,a,n,r)}slugify(a){return a.toString().toLowerCase().replace(/\s+/g,"-").replace(/[^\w-]+/g,"").replace(/--+/g,"-")}getUniqueName(a){const o=new Set(this.state.value.connections.filter(r=>r.connectorType===a).map(r=>r.name));if(!o.has(a))return a;let n=1;for(;o.has(`${a}-${n}`);)n++;return`${a}-${n}`}handleAddConnectionSubmit=async()=>{const a=this.state.value.addingConnection?.connector.metadata.key,o=this.state.value.addingConnection?.selectedScopeIds,n=this.state.value.addingConnection?.tokenValues??{};if(!a||!o)throw new Error("No connector or scope selected");const{url:r}=await this.getLoginUrl(a,this.getUniqueName(a),o,n);window.location.href=r};handleAddTokenConnectionSubmit=async()=>{const a=this.state.value.addingConnection;if(!a)throw new Error("No connection is being added");const o=a.connector.metadata.key,n=this.getUniqueName(o);await this.api.createTokenConnection({projectId:this.projectId,connectionName:n,connectorType:o,tokens:a.tokenValues}),this.state.value.addingConnection=null,await this.refetchConnections()};async generateEcdsaKey(){const a=this.state.value.addingConnection;if(!a)throw new Error("No connection is being added");const o=a.connector.metadata.key,n=this.getUniqueName(o),b=o==="iugu"?await this.api.generateRsaKey({projectId:this.projectId,connectionName:n,connectorType:o}):await this.api.generateEcdsaKey({projectId:this.projectId,connectionName:n,connectorType:o});return this.state.value.addingConnection&&(this.state.value.addingConnection.connectionName=n,this.state.value.addingConnection.ecdsaKeys=b),b.publicKey}handleAddEcdsaConnectionSubmit=async(a,o)=>{const n=this.state.value.addingConnection;if(!n||!a)throw new Error("No connection is being added or public key is missing");if(!n.connectionName||!n.ecdsaKeys)throw new Error("Keys or connection name not found");const r=n.connector.metadata.key;if(r==="iugu"){if(!o)throw new Error("API Token is missing");await this.api.createRsaConnection({projectId:this.projectId,connectionName:n.connectionName,connectorType:r,publicKey:n.ecdsaKeys.publicKey,privateKey:n.ecdsaKeys.privateKey,apiToken:o})}else{if(!o)throw new Error("Project ID is missing");await this.api.createEcdsaConnection({projectId:this.projectId,connectionName:n.connectionName,connectorType:r,publicKey:n.ecdsaKeys.publicKey,privateKey:n.ecdsaKeys.privateKey,accessId:o})}this.state.value.addingConnection=null,await this.refetchConnections()};renameConnection=async()=>{const{editingConnection:a}=this.state.value;if(!a)throw new Error("No connection is being edited");const o=async()=>{await this.api.renameConnection({projectId:this.projectId,connectionName:a.name,connectorType:a.connectorType,newConnectionName:a.newName}),await this.refetchConnections(),this.state.value.editingConnection=null};$.confirm({title:"Rename connection",content:"Are you sure you want to rename this connection? This will break any existing references to the old name.",onOk:o})};showAddConfirmationModal=a=>{this.state.value.addingConnection={selectedScopeIds:a.auth.type==="oauth2"?a.auth.scopes.map(o=>o.key):[],connector:a,tokenValues:{}}};handleScopeToggle=(a,o)=>{o?this.state.value.addingConnection.selectedScopeIds.push(a):this.state.value.addingConnection.selectedScopeIds=this.state.value.addingConnection.selectedScopeIds.filter(n=>n!==a)}}function Xe(s){return new Promise((a,o)=>{const n=new FileReader;n.onload=()=>{const b=n.result.split(",")[1];a(b)},n.onerror=()=>o(n.error),n.readAsDataURL(s)})}const en={key:6,style:{"margin-top":"16px"}},D=B({__name:"AuthFormFields",props:{tokens:{},tokenValues:{},uploadedFiles:{default:()=>({})}},emits:["update:tokenValues","update:uploadedFiles","tokenChange"],setup(s,{emit:a}){const o=s,n=a,r=H(o.uploadedFiles||{});function b(u){const d=g.value[u];return d?d.split(",").map(t=>t.trim()):[]}function S(u){if(!u.condition)return!0;const d=Object.keys(u.condition);for(const t of d){const f=u.condition[t].equals;if(g.value[t]!==f)return!1}return!0}function V(u,d){Array.isArray(d)?w(u,d.join(",")):console.error("Expected array for checkbox/select value")}const g=H({...o.tokenValues});G(()=>o.tokenValues,u=>{g.value={...u}},{deep:!0}),G(()=>o.uploadedFiles,u=>{r.value=u||{}},{deep:!0});function w(u,d){g.value[u]=d;const t={...g.value};n("update:tokenValues",t),n("tokenChange")}function L(u){const d=[];return u.key&&d.push({required:!0,message:h.translate("i18n_auth_form_field_required",null,u.label||u.key)}),u.input?.minSize&&d.push({min:u.input.minSize,message:h.translate("i18n_auth_form_field_min_length",null,u.input.minSize)}),u.input?.maxSize&&d.push({max:u.input.maxSize,message:h.translate("i18n_auth_form_field_max_length",null,u.input.maxSize)}),d}async function N(u,d){try{const t=await Xe(u),f={...r.value,[d]:{file:u,base64:t}};r.value=f,n("update:uploadedFiles",f),g.value[d]=t;const m={...g.value};n("update:tokenValues",m),n("tokenChange")}catch(t){console.error("Error converting file to base64:",t)}return!1}function A(u){const d={...r.value};delete d[u],r.value=d,n("update:uploadedFiles",d),g.value[u]="";const t={...g.value};n("update:tokenValues",t),n("tokenChange")}function F(u){const d=r.value[u];return d?[{uid:u,name:d.file.name,status:"done",size:d.file.size}]:[]}return(u,d)=>(c(),v(e(ie),{model:g.value,layout:"vertical"},{default:l(()=>[(c(!0),k(U,null,z(s.tokens,t=>se((c(),v(e(ue),{key:t.key,required:S(t),label:t.label,name:t.key,rules:L(t)},{default:l(()=>[t.input?.type==="small-string"?(c(),v(e(O),{key:0,value:g.value[t.key],"onUpdate:value":f=>g.value[t.key]=f,placeholder:t.description,maxlength:t.input?.maxSize,minlength:t.input?.minSize,onInput:()=>w(t.key,g.value[t.key]||"")},null,8,["value","onUpdate:value","placeholder","maxlength","minlength","onInput"])):t.input?.type==="radiobox"?(c(),v(e(re),{key:1,value:g.value[t.key],"onUpdate:value":f=>g.value[t.key]=f,onChange:()=>w(t.key,g.value[t.key]||"")},{default:l(()=>[(c(!0),k(U,null,z(t.input.options,f=>(c(),v(e(de),{key:f.value,value:f.value},{default:l(()=>[C(_(f.label),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onUpdate:value","onChange"])):t.input?.type==="checkbox"?(c(),k(U,{key:2},[(t.input?.options?.length??0)<=10?(c(),v(e(pe),{key:0,value:b(t.key),onChange:f=>V(t.key,f)},{default:l(()=>[(c(!0),k(U,null,z(t.input.options,f=>(c(),v(e(he),{key:f.value,value:f.value},{default:l(()=>[C(_(f.label),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onChange"])):(c(),v(e(ge),{key:1,mode:"multiple",style:{width:"100%"},value:b(t.key),options:t.input.options??[],onChange:f=>V(t.key,f)},null,8,["value","options","onChange"]))],64)):t.input?.type==="large-text"?(c(),v(e(me),{key:3,value:g.value[t.key],"onUpdate:value":f=>g.value[t.key]=f,placeholder:t.description,maxlength:t.input?.maxSize,minlength:t.input?.minSize,rows:4,onInput:()=>w(t.key,g.value[t.key]||"")},null,8,["value","onUpdate:value","placeholder","maxlength","minlength","onInput"])):t.input?.type==="file"?(c(),v(e(fe),{key:4,"file-list":F(t.key),"before-upload":f=>N(f,t.key),"max-count":1,"show-upload-list":!0,onRemove:()=>A(t.key)},{default:l(()=>[i(Z,null,{default:l(()=>[i(e(Ie)),C(" "+_(e(h).translate("i18n_auth_form_upload_file",null)),1)]),_:1})]),_:1},8,["file-list","before-upload","onRemove"])):(c(),v(e(O),{key:5,value:g.value[t.key],"onUpdate:value":f=>g.value[t.key]=f,placeholder:t.description,onInput:()=>w(t.key,g.value[t.key]||"")},null,8,["value","onUpdate:value","placeholder","onInput"])),t.instructions?(c(),k("div",en,[i(e(K),{type:"secondary",style:{"white-space":"pre-line","font-size":"14px"}},{default:l(()=>[C(_(t.instructions),1)]),_:2},1024)])):T("",!0),t.description&&!t.instructions?(c(),v(e(K),{key:7,type:"secondary",style:{display:"block","font-size":"12px","margin-top":"8px"}},{default:l(()=>[C(_(t.description),1)]),_:2},1024)):T("",!0)]),_:2},1032,["required","label","name","rules"])),[[ce,S(t)]])),128))]),_:1},8,["model"]))}}),nn=B({__name:"ConnectionHeader",props:{connectorLogoUrl:{},connectorLabel:{}},setup(s){return(a,o)=>(c(),v(e(x),{justify:"center",align:"center",gap:20,style:{"margin-bottom":"24px",padding:"20px 0"}},{default:l(()=>[i(Ue,{"hide-text":"",size:"large"}),i(e(Ye),{size:24}),i(Te,{"image-url":s.connectorLogoUrl,"brand-name":s.connectorLabel,size:"medium","hide-text":""},null,8,["image-url","brand-name"])]),_:1}))}}),tn=B({__name:"ConnectionModal",props:{addingConnection:{},ecdsaPublicKey:{},ecdsaKeyLoading:{type:Boolean},uploadedFiles:{},loading:{type:Boolean}},emits:["cancel","submit","scope-toggle","generate-ecdsa-key","update:token-values","update:uploaded-files","token-change"],setup(s,{emit:a}){const o=s,n=a,r=E(()=>{switch(o.addingConnection?.connector.auth.type){case"oauth2":return h.translate("i18n_connection_modal_button_authorize",null);case"tokens":return h.translate("i18n_connection_modal_button_create",null);case"ecdsa":{if(!o.ecdsaPublicKey)return h.translate("i18n_connection_modal_button_ok",null);const F=o.addingConnection?.connector.auth.params||[],u=o.addingConnection?.tokenValues||{};return F.every(t=>u[t.key]&&u[t.key].trim().length>0)?h.translate("i18n_connection_modal_button_create",null):h.translate("i18n_connection_modal_button_create_missing_fields",null)}default:return h.translate("i18n_connection_modal_button_ok",null)}});function b(){n("cancel")}function S(){n("submit")}function V(A,F){n("scope-toggle",A,F)}function g(){n("generate-ecdsa-key")}function w(A){n("update:token-values",A)}function L(A){n("update:uploaded-files",A)}function N(){n("token-change")}return(A,F)=>(c(),v(e($),{open:!!s.addingConnection,title:s.addingConnection?e(h).translate("i18n_connection_modal_title_add",null,s.addingConnection.connector.metadata.label):"","ok-text":r.value,"ok-button-props":{disabled:r.value.includes("Required")},"confirm-loading":s.loading,"wrap-class-name":"full-modal",onCancel:b,onOk:S},{default:l(()=>[s.addingConnection?(c(),k(U,{key:0},[i(nn,{"connector-logo-url":s.addingConnection.connector.metadata.logoUrl,"connector-label":s.addingConnection.connector.metadata.label},null,8,["connector-logo-url","connector-label"]),s.addingConnection.connector.auth.type==="oauth2"?(c(),k(U,{key:0},[i(e(R),null,{default:l(()=>[C(_(e(h).translate("i18n_connection_modal_oauth2_scopes_instruction",null)),1)]),_:1}),i(e(x),{vertical:"",gap:"10",style:{margin:"30px 0px"}},{default:l(()=>[(c(!0),k(U,null,z(s.addingConnection.connector.auth.scopes,u=>(c(),v(e(x),{key:u.key,justify:"space-between",align:"center"},{default:l(()=>[i(e(x),{vertical:""},{default:l(()=>[i(e(K),null,{default:l(()=>[C(_(u.description),1)]),_:2},1024),i(e(K),{type:"secondary"},{default:l(()=>[C(_(u.key),1)]),_:2},1024)]),_:2},1024),i(e(ye),{checked:s.addingConnection.selectedScopeIds.includes(u.key),onChange:d=>V(u.key,d)},null,8,["checked","onChange"])]),_:2},1024))),128)),s.addingConnection.connector.auth.params?.length?(c(),v(D,{key:0,tokens:s.addingConnection.connector.auth.params,"token-values":s.addingConnection.tokenValues,"uploaded-files":s.uploadedFiles,"onUpdate:tokenValues":w,"onUpdate:uploadedFiles":L,onTokenChange:N},null,8,["tokens","token-values","uploaded-files"])):T("",!0)]),_:1})],64)):T("",!0),s.addingConnection.connector.auth.type==="tokens"?(c(),k(U,{key:1},[i(e(R),null,{default:l(()=>[C(_(e(h).translate("i18n_connection_modal_tokens_instruction",null)),1)]),_:1}),i(D,{tokens:s.addingConnection.connector.auth.tokens,"token-values":s.addingConnection.tokenValues,"uploaded-files":s.uploadedFiles,"onUpdate:tokenValues":w,"onUpdate:uploadedFiles":L,onTokenChange:N},null,8,["tokens","token-values","uploaded-files"])],64)):T("",!0),s.addingConnection.connector.auth.type==="ecdsa"?(c(),k(U,{key:2},[s.ecdsaPublicKey?(c(),v(e(x),{key:1,vertical:"",gap:"16"},{default:l(()=>[i(e(K),{strong:""},{default:l(()=>[C(_(e(h).translate("i18n_connection_modal_ecdsa_keys_generated",null)),1)]),_:1}),i(e(K),{strong:""},{default:l(()=>[C(_(e(h).translate("i18n_connection_modal_ecdsa_copy_public_key",null)),1)]),_:1}),i(e(Q),{value:s.ecdsaPublicKey,readonly:"",copyable:"",code:""},null,8,["value"]),i(D,{tokens:s.addingConnection.connector.auth.params,"token-values":s.addingConnection.tokenValues,"uploaded-files":s.uploadedFiles,"onUpdate:tokenValues":w,"onUpdate:uploadedFiles":L,onTokenChange:N},null,8,["tokens","token-values","uploaded-files"])]),_:1})):(c(),k(U,{key:0},[i(e(R),null,{default:l(()=>[C(_(e(h).translate("i18n_connection_modal_ecdsa_generate_instruction",null)),1)]),_:1}),i(e(x),{vertical:"",gap:"16"},{default:l(()=>[i(Z,{loading:s.ecdsaKeyLoading,onClick:g},{default:l(()=>[C(_(e(h).translate("i18n_connection_modal_ecdsa_generate_button",null)),1)]),_:1},8,["loading"])]),_:1})],64))],64)):T("",!0)],64)):T("",!0)]),_:1},8,["open","title","ok-text","ok-button-props","confirm-loading"]))}}),an=B({__name:"ConnectorCard",props:{title:{},logoUrl:{},description:{},unavailable:{type:Boolean},connector:{},isBeta:{type:Boolean}},setup(s){return(a,o)=>(c(),v(e(ne),{class:ve({"connector-card":!0,unavailable:s.unavailable})},{default:l(()=>[i(e(x),{style:{width:"100%"},vertical:"",gap:12},{default:l(()=>[i(e(x),{justify:"space-between"},{default:l(()=>[i(e(ee),{src:s.logoUrl,shape:"square",size:"large"},null,8,["src"]),i(e(x),{gap:8},{default:l(()=>[s.isBeta?(c(),v(e(J),{key:0,color:"orange",style:{height:"fit-content"}},{default:l(()=>[...o[0]||(o[0]=[C("BETA",-1)])]),_:1})):T("",!0),s.unavailable?(c(),v(e(J),{key:1,style:{height:"fit-content"}},{default:l(()=>[C(_(e(h).translate("i18n_connector_card_talk_to_us",null)),1)]),_:1})):T("",!0)]),_:1})]),_:1}),i(e(x),{vertical:""},{default:l(()=>[i(e(K),{strong:""},{default:l(()=>[C(_(s.title),1)]),_:1}),i(e(K),{type:"secondary"},{default:l(()=>[C(_(s.description),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["class"]))}}),on=X(an,[["__scopeId","data-v-86187920"]]),ln={class:"connectors-grid"},sn=B({__name:"ConnectorsView",setup(s){const o=Ce().params.projectId,n=new Qe(o,new xe),r=H(null),b=H(!1),S=H({}),V=H(!1),g=E(()=>[...n.state.value.connectors.filter(m=>m.auth.type==="oauth2"),...n.state.value.connectors.filter(m=>m.auth.type==="tokens"),...n.state.value.connectors.filter(m=>m.auth.type==="ecdsa"),...n.state.value.connectors.filter(m=>m.auth.type==="manual")]),w=H(""),L=E(()=>{if(!w.value.trim())return g.value;const m=w.value.trim().toLowerCase();return g.value.filter(y=>{const p=y.metadata.label?.toLowerCase()||"",I=y.metadata.key?.toLowerCase()||"";return p.includes(m)||I.includes(m)})}),N=E(()=>n.state.value.connections.filter(m=>m&&m.name&&m.connectorTitle&&m.connectorType));n.fetchInitialState();function A(m){n.state.value.addingConnection&&(n.state.value.addingConnection.tokenValues=m)}function F(m){S.value=m}function u(){r.value=null,b.value=!1,S.value={}}async function d(){b.value=!0;try{const y=(await n.generateEcdsaKey()).replace("-----BEGIN PUBLIC KEY-----","").replace("-----END PUBLIC KEY-----","").replace(/\s/g,"");r.value=y}finally{b.value=!1}}async function t(){const m=n.state.value.addingConnection?.connector.auth.type;V.value=!0;try{switch(m){case"oauth2":return await n.handleAddConnectionSubmit();case"tokens":return await n.handleAddTokenConnectionSubmit();case"ecdsa":{const y=n.state.value.addingConnection?.tokenValues||{},p=n.state.value.addingConnection?.connector.metadata.key;let I="";p==="starkbank"?I=y.projectId||"":p==="iugu"&&(I=y.apiToken||"");const te=await n.handleAddEcdsaConnectionSubmit(r.value,I);return u(),te}default:break}}catch(y){const p=I=>{try{return JSON.parse(I),!0}catch{return!1}};if(y instanceof Error&&p(y.message)){const I=Y.object({error:Y.string()}).safeParse(JSON.parse(y.message));if(I.success){q.error(I.data.error);return}else{q.error(h.translate("i18n_connectorsview_failed_to_create_with_message",void 0,{message:y instanceof Error?y.message:"Unknown error"}));return}}else q.error(h.translate("i18n_connectorsview_failed_to_create"))}finally{V.value=!1}}function f(m){m.auth.type==="manual"?Se.showNewMessage(h.translate("i18n_connectors_ask_for_access",null,m.metadata.label)):n.showAddConfirmationModal(m)}return(m,y)=>(c(),k(U,null,[i(e(Ve),{direction:"vertical",style:{width:"100%","margin-bottom":"30px"}},{default:l(()=>[i(e(x),{align:"center",justify:"space-between"},{default:l(()=>[i(e(M),null,{default:l(()=>[C(_(e(h).translate("i18n_connectorsview_title")),1)]),_:1})]),_:1}),i(e(R),null,{default:l(()=>[C(_(e(h).translate("i18n_connectorsview_description"))+" ",1),i(ae)]),_:1}),N.value.length?(c(),v(e(x),{key:0,vertical:""},{default:l(()=>[i(e(M),{level:2},{default:l(()=>[C(_(e(h).translate("i18n_connectorsview_installed")),1)]),_:1}),i(e(x),{vertical:"",gap:10},{default:l(()=>[(c(!0),k(U,null,z(N.value,p=>(c(),v(e(ne),{key:p.name},{default:l(()=>[i(e(x),{align:"center",gap:20},{default:l(()=>[i(e(ee),{src:p.icon,height:"40px",shape:"square"},null,8,["src"]),i(e(K),{strong:""},{default:l(()=>[C(_(p.connectorTitle),1)]),_:2},1024),y[6]||(y[6]=j("div",{style:{"flex-grow":"1"}},null,-1)),i(e(K),{content:p.name,copyable:"",code:""},null,8,["content"]),i(e(_e),null,{overlay:l(()=>[i(e(ke),null,{default:l(()=>[i(e(W),{onClick:I=>e(n).handleEditConnectionClick(p)},{default:l(()=>[C(_(e(h).translate("i18n_connectorsview_rename")),1)]),_:1},8,["onClick"]),i(e(W),{danger:"",onClick:I=>e(n).handleDeletionClick(p)},{default:l(()=>[C(_(e(h).translate("i18n_connectorsview_delete")),1)]),_:1},8,["onClick"])]),_:2},1024)]),default:l(()=>[i(e(we))]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})):T("",!0),i(e(x),{vertical:""},{default:l(()=>[N.value.length?(c(),v(e(M),{key:0,level:2},{default:l(()=>[C(_(e(h).translate("i18n_connectorsview_available")),1)]),_:1})):T("",!0),i(e(be),{value:w.value,"onUpdate:value":y[0]||(y[0]=p=>w.value=p),placeholder:e(h).translate("i18n_connectorsview_search_placeholder"),style:{width:"300px","margin-bottom":"40px"}},null,8,["value","placeholder"]),j("div",ln,[(c(!0),k(U,null,z(L.value,p=>(c(),v(on,{key:p.metadata.key,title:p.metadata.label,"logo-url":p.metadata.logoUrl,description:p.metadata.description,unavailable:p.auth.type==="manual",connector:p,"is-beta":e(n).state.value.betaStatus[p.metadata.key]??!1,onClick:I=>f(p)},null,8,["title","logo-url","description","unavailable","connector","is-beta","onClick"]))),128))])]),_:1})]),_:1}),i(e($),{open:!!e(n).state.value.editingConnection,title:e(n).state.value.editingConnection?e(h).translate("i18n_connectorsview_connection_modal_title",void 0,{connector:e(n).state.value.editingConnection.connectorTitle}):"",onCancel:y[3]||(y[3]=p=>e(n).state.value.editingConnection=null)},{footer:l(()=>[i(e(x),{justify:"end"},{default:l(()=>[i(Z,{disabled:!e(n).hasChanges.value,onClick:y[2]||(y[2]=p=>e(n).renameConnection())},{default:l(()=>[C(_(e(h).translate("i18n_connectorsview_save")),1)]),_:1},8,["disabled"])]),_:1})]),default:l(()=>[e(n).state.value.editingConnection?(c(),v(e(Q),{key:0,value:e(n).state.value.editingConnection.newName,"onUpdate:value":y[1]||(y[1]=p=>e(n).state.value.editingConnection.newName=p)},null,8,["value"])):T("",!0)]),_:1},8,["open","title"]),i(tn,{"adding-connection":e(n).state.value.addingConnection,"ecdsa-public-key":r.value,"ecdsa-key-loading":b.value,"uploaded-files":S.value,loading:V.value,onCancel:y[4]||(y[4]=()=>{e(n).state.value.addingConnection=null,u()}),onSubmit:t,onScopeToggle:y[5]||(y[5]=(p,I)=>e(n).handleScopeToggle(p,I)),onGenerateEcdsaKey:d,"onUpdate:tokenValues":A,"onUpdate:uploadedFiles":F},null,8,["adding-connection","ecdsa-public-key","ecdsa-key-loading","uploaded-files","loading"])],64))}}),bn=X(sn,[["__scopeId","data-v-21b5de4f"]]);export{bn as default};
//# sourceMappingURL=ConnectorsView-BcWzPOEK.js.map
