import{d as V,r as S,u as q,b as n,c as m,v as s,F,J as K,H as x,V as T,Y as B,e as l,N as j,O as z,q as A,G,y as t,t as w,w as v,B as J,K as O,L as Y,a as Q,R as P,E as X}from"./registerWidgets.fff064a1.js";import{a as L,L as Z}from"./CircularLoading.59d7fd3d.js";import{E as ee}from"./Error.de2ae46c.js";import{R as te,F as ae}from"./broker.6d8b5367.js";import{R as se,T as oe,B as re,a as M,S as le}from"./SmartConsole.2dca9a38.js";import{j as ne,i as ie}from"./icons.5214a3f5.js";import{l as I}from"./log.7bdc5c83.js";import{F as ce}from"./forms.7bc6baea.js";import{W as ue}from"./workspaces.32af92db.js";import"./WidgetsFrame.1013b5e8.js";import"./index.314cf40a.js";import"./Modal.2ceba592.js";import"./dashes.f5f65b41.js";import"./utils.3371dfe5.js";import"./runnerData.81f4c073.js";import"./hooks.944007d1.js";import"./jobs.987450d7.js";const de="forms_workspace_id_path_key",N=u=>(j("data-v-8f71f9c1"),u=u(),z(),u),pe={class:"form-settings"},me={class:"content"},fe={class:"subsection-label"},ve={class:"property-label"},_e=["value","placeholder","onChange"],he={class:"content"},ye={class:"property"},be=N(()=>s("div",{class:"property-label"},"Start smart form automatically",-1)),ge={class:"property"},ke=N(()=>s("div",{class:"property-label"}," Allow the user to restart the smart form after it is over ",-1)),we=V({__name:"FormSettings",props:{form:null},setup(u){const a=S(u.form),d=[{label:"Welcome Screen",props:[{label:"Title",fallbackKey:"title",valueKey:"welcomeTitle"},{label:"Subtitle",valueKey:"startMessage"},{label:"Start button text",valueKey:"startButtonText"}]},{label:"Ending Screen",props:[{label:"Title",valueKey:"endMessage"},{label:"Restart button text",valueKey:"restartButtonText"}]},{label:"Alert Messages",props:[{label:"Error message",valueKey:"errorMessage"}]}],h=q({pathError:null,sectionsShown:[!0,!1,!1]}),g=f=>{f.detail.includes(de)&&(h.pathError=o)},o="This path is already being used by another form or dash on your workspace";return addEventListener("hasura-error",g),(f,c)=>(n(),m("div",pe,[s("div",me,[(n(),m(F,null,K(d,r=>s("div",{key:r.label,class:"subsection"},[s("div",fe,x(r.label),1),(n(!0),m(F,null,K(r.props,i=>{var p;return n(),m("div",{key:i.label,class:"property column"},[s("div",ve,x(i.label),1),s("input",{class:"property-input",type:"text",value:a.value[i.valueKey],placeholder:(p=i.fallbackKey?a.value[i.fallbackKey]:null)!=null?p:"Enter message",onChange:y=>a.value[i.valueKey]=y.target.value},null,40,_e)])}),128))])),64))]),s("div",he,[s("div",ye,[T(s("input",{"onUpdate:modelValue":c[0]||(c[0]=r=>a.value.autoStart=r),class:"checkbox-input",type:"checkbox"},null,512),[[B,a.value.autoStart]]),be]),s("div",ge,[T(s("input",{"onUpdate:modelValue":c[1]||(c[1]=r=>a.value.allowRestart=r),class:"checkbox-input",type:"checkbox"},null,512),[[B,a.value.allowRestart]]),ke])]),l(se,{runtime:a.value},null,8,["runtime"])]))}});const Se=A(we,[["__scopeId","data-v-8f71f9c1"]]),xe={class:"page"},Ce={key:1,class:"error"},Ee=V({__name:"FormEditor",setup(u){const _=O(),a=Y(),d=q({fullscreen:!1,rightPanelCollapsed:!1,hasChanges:!1,started:!1});addEventListener("keydown",e=>{(e.ctrlKey||e.metaKey)&&e.key==="s"&&(e.preventDefault(),y())});const h=S(null),{loading:g,result:o,error:f,refetch:c}=L(async()=>{const e=await ce.get(a.params.formPath);return k(),e}),{result:r}=L(()=>ue.get()),i=()=>{o.value&&_.push(`/_editor/form/${encodeURIComponent(o.value.path)}/preview`)},p=S(!1);async function y(){var e;p.value=!0;try{await((e=o.value)==null?void 0:e.save())}finally{p.value=!1}}const $=G(()=>te.create({isLocal:!1,formPath:a.params.formPath,isPreview:!0})),D=()=>{I.clear()},k=async()=>{var e;if(!d.started){(e=h.value)==null||e.run();return}I.log({type:"restart"}),d.started=!1},H=({path:e,type:b})=>{b==="dash"?_.push({name:"dashEditor",params:{dashPath:e},query:a.query}):(_.push({name:"editor",params:{formPath:e},query:a.query}),c())},U=()=>{d.started=!0},W=()=>{d.started=!1};return(e,b)=>{const C=Q("icon");return n(),m("div",xe,[t(g)||!t(o)||!t(r)?(n(),w(Z,{key:0})):t(f)?(n(),m("div",Ce,[l(ee,{error:t(f),onReload:t(c)},null,8,["error","onReload"])])):(n(),w(oe,{key:2},{left:v(()=>[l(re,{link:"/_editor/forms"})]),right:v(()=>{var E,R;return[s("button",{class:"preview-button",onClick:i},[l(C,{class:"icon",path:t(ne),width:"20",height:"20",fill:"#5A677A"},null,8,["path"]),P(" Preview ")]),s("button",{class:X(["save-button",{changes:(E=t(o))==null?void 0:E.hasChanges()}]),onClick:b[0]||(b[0]=Re=>y())},[l(C,{class:"icon",path:t(ie),width:"20",height:"20",fill:"#5A677A"},null,8,["path"]),P(" "+x(p.value?"Saving ...":(R=t(o))!=null&&R.hasChanges()?"Save":"Saved"),1)],2)]}),default:v(()=>[l(M,{title:"Preview"},{default:v(()=>[l(ae,{ref_key:"runner",ref:h,form:t(o).makeRunnerData(t(r)),params:t(a).query,"is-preview":!0,"enable-auto-focus":!1,broker:t($),style:{height:"unset",flex:1,overflow:"hidden"},onNavigate:H,onLogout:k,onExit:W,onStart:U},null,8,["form","params","broker"])]),_:1}),l(M,{title:"Settings"},{default:v(()=>[l(Se,{form:t(o)},null,8,["form"])]),_:1})]),_:1})),t(o)?(n(),w(le,{key:3,runtime:"forms",onRestart:k,onClearTerminal:D})):J("",!0)])}}});const je=A(Ee,[["__scopeId","data-v-ab1b9fa2"]]);export{je as default};
//# sourceMappingURL=FormEditor.8a54b880.js.map
