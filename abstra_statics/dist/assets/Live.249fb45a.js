import{d as x,o as S,Z as L,u as t,b as c,et as y,bo as T,eA as B,c as h,w as s,f as a,ao as l,eB as _,cw as $,be as E,t as C,ez as R,F as V,e as D,ev as U,cA as N,cq as P}from"./outputWidgets.34c6efe4.js";import{a as j}from"./asyncComputed.c2993a02.js";import{r as q}from"./router.5e015991.js";import"./jwt-decode.esm.74bd4619.js";import{B as M,a as F}from"./build.a0928ec8.js";import"./index.56db27ff.js";import{P as z}from"./project.2bb36a1c.js";import{C as Q}from"./CrudView.4c8279a4.js";import{Q as Z,R as G}from"./icons.54b54949.js";import{_ as H,E as J}from"./ExecutionStatusIcon.vue_vue_type_script_setup_true_lang.e1330857.js";import{A as k}from"./Title.6b365a17.js";import{A as K}from"./index.134785d3.js";import{A as f}from"./Text.4d22598c.js";import{A}from"./Link.8b267d2f.js";import{A as O}from"./index.95a2f4e1.js";import"./FormItem.87557e8f.js";import"./hasIn.7f8c0878.js";import"./storage.f2a353cd.js";import"./index.b5389b8f.js";import"./index.cf4c23b9.js";import"./record.24a52f99.js";import"./pubsub.7392fe5a.js";import"./Form.3d80c841.js";import"./Modal.20b7a2a4.js";import"./DocsButton.vue_vue_type_script_setup_true_lang.d3e3a57a.js";import"./url.e9fe64cc.js";import"./CheckCircleFilled.c4b7df1e.js";(function(){try{var d=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},m=new Error().stack;m&&(d._sentryDebugIds=d._sentryDebugIds||{},d._sentryDebugIds[m]="c27e4186-55c1-40e8-80b7-ce3c6857189a",d._sentryDebugIdIdentifier="sentry-dbid-c27e4186-55c1-40e8-80b7-ce3c6857189a")}catch{}})();const W={key:0,class:"flex-row"},X={key:1,class:"flex-row"},Y={key:2,class:"flex-row"},ee=x({__name:"ExecutionsShort",props:{stageId:{},projectId:{}},emits:["select"],setup(d,{emit:m}){const p=d,g=new J,{result:u,refetch:b,loading:w}=j(async()=>{const{executions:r}=await g.list({projectId:p.projectId,stageId:p.stageId,limit:6});return r}),v=r=>{m("select",r)};let o=null;return S(()=>{o=setInterval(()=>b(),15e3)}),L(()=>{o&&clearInterval(o)}),(r,n)=>t(u)?(c(),y("div",W,[(c(!0),y(T,null,B(t(u),e=>(c(),h(t($),{key:e.id,title:e.createdAt.toLocaleString(),onClick:i=>v(e)},{content:s(()=>[a(t(k),null,{default:s(()=>[l("Status: "+_(e.status),1)]),_:2},1024),a(t(k),null,{default:s(()=>[l("Duration: "+_(e.duration_seconds)+" s",1)]),_:2},1024),a(t(k),null,{default:s(()=>[l("Build: "+_(e.buildId.slice(0,6)),1)]),_:2},1024)]),default:s(()=>[a(H,{status:e.status},null,8,["status"])]),_:2},1032,["title","onClick"]))),128))])):t(w)?(c(),y("div",X,[a(t(E))])):(c(),y("div",Y,"None"))}});const te=C(ee,[["__scopeId","data-v-dc7e11a2"]]),oe={style:{"max-width":"250px",overflow:"hidden","text-overflow":"ellipsis ellipsis","white-space":"nowrap"}},se={key:1},ae=x({__name:"Live",setup(d){const p=R().params.projectId,{loading:g,result:u}=j(async()=>{const r=(await M.list(p)).find(i=>i.latest);if(!r)return null;const[n,e]=await Promise.all([F.get(r.id),z.get(p)]);return{buildSpec:n,project:e}}),b=o=>{var e;if(!("path"in o)||!o.path)return;const r=o.type==="form"?`/${o.path}`:`/_hooks/${o.path}`,n=(e=u.value)==null?void 0:e.project.getUrl(r);!n||(navigator.clipboard.writeText(n),P.success("Copied URL to clipboard"))},w=o=>o.type=="form"?`/${o.path}`.slice(0,30):o.type=="hook"?`/_hooks/${o.path}`.slice(0,30):o.type=="job"?`${o.schedule}`:"",v=V(()=>{var n;const o=[{name:"Type",align:"left"},{name:"Title",align:"left"},{name:"Trigger",align:"left"},{name:"Last Runs"},{name:"",align:"right"}],r=(n=u.value)==null?void 0:n.buildSpec;return r?{columns:o,rows:r.runtimes.map(e=>({key:e.id,cells:[{type:"tag",text:e.type.charAt(0).toUpperCase()+e.type.slice(1),tagColor:"default"},{type:"slot",key:"title",payload:{runtime:e}},{type:"slot",key:"trigger",payload:{runtime:e}},{type:"slot",key:"last-runs",payload:{runtime:e}},{type:"actions",actions:[{icon:Z,label:"View script logs",onClick:()=>q.push({name:"logs",params:{projectId:p},query:{runtimeId:e.id}})},{icon:G,label:"Copy URL",onClick:()=>b(e),hide:!["form","hook"].includes(e.type)}]}]}))}:{columns:o,rows:[]}});return(o,r)=>{var n,e;return t(g)||((e=(n=t(u))==null?void 0:n.buildSpec.runtimes.length)!=null?e:0)>0?(c(),h(Q,{key:0,"empty-title":"","entity-name":"build",description:"Access and monitor your project's current scripts here.",table:v.value,loading:t(g),title:"Live View"},{extra:s(()=>[a(t(K),{message:"Last runs will only be shown for deploys with abstra version >= 1.27.0",type:"info","show-icon":""})]),title:s(({payload:i})=>{var I;return[D("div",oe,[i.runtime.type!="form"?(c(),h(t(f),{key:0},{default:s(()=>[l(_(i.runtime.title),1)]),_:2},1024)):i.runtime.type=="form"?(c(),h(t(A),{key:1,href:(I=t(u))==null?void 0:I.project.getUrl(i.runtime.path),target:"_blank"},{default:s(()=>[l(_(i.runtime.title),1)]),_:2},1032,["href"])):U("",!0)])]}),"last-runs":s(({payload:i})=>[a(te,{"stage-id":i.runtime.id,"project-id":t(p)},null,8,["stage-id","project-id"])]),trigger:s(({payload:i})=>[a(t(O),{color:"default"},{default:s(()=>[l(_(w(i.runtime)),1)]),_:2},1024)]),_:1},8,["table","loading"])):(c(),y("div",se,[a(t(N),{direction:"vertical"},{default:s(()=>[a(t(f),null,{default:s(()=>[l("Install abstra using pip:")]),_:1}),a(t(f),{code:"",copyable:""},{default:s(()=>[l("pip install abstra")]),_:1}),a(t(f),null,{default:s(()=>[l("Start a new project using our CLI")]),_:1}),a(t(f),{code:"",copyable:""},{default:s(()=>[l("abstra serve my-new-project")]),_:1}),a(t(f),null,{default:s(()=>[l(" If you have any questions, please reach out to our "),a(t(A),{href:"https://discord.gg/abstra",target:"_blank"},{default:s(()=>[l(" discord channel ")]),_:1})]),_:1})]),_:1})]))}}});const $e=C(ae,[["__scopeId","data-v-4a06ff35"]]);export{$e as default};
//# sourceMappingURL=Live.249fb45a.js.map
