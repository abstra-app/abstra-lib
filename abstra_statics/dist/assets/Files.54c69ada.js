import{_ as q}from"./DocsButton.vue_vue_type_script_setup_true_lang.bf268869.js";import{C as W}from"./ContentLayout.1036e4eb.js";import{p as Y}from"./popupNotifcation.dd76a56c.js";import{a as J}from"./ant-design.7d916c63.js";import{a as Q}from"./asyncComputed.2bec113c.js";import{d as H,D as I,f as A,o as d,Y as g,$ as R,S as w,e8 as X,a as f,b as i,ee as L,f5 as K,ea as ee,e as te,c as b,w as s,aG as _,u as o,dd as ae,db as F,bT as Z,e9 as D,d4 as ne,bR as oe,bz as re,bx as z,dc as N,cx as le,em as ie,en as se,a0 as de}from"./index.0f630b70.js";import{C as k}from"./gateway.50cd3949.js";import"./tables.78c50568.js";import{D as V}from"./DeleteOutlined.c6f4d5ac.js";import{C as ce}from"./Card.2564e781.js";import"./BookOutlined.89f2a8c6.js";import"./record.f729e500.js";import"./string.532e13bb.js";import"./TabPane.e38cb00d.js";(function(){try{var a=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},e=new Error().stack;e&&(a._sentryDebugIds=a._sentryDebugIds||{},a._sentryDebugIds[e]="a8aa9db0-c929-45a8-9d33-10fc3e889b8c",a._sentryDebugIdIdentifier="sentry-dbid-a8aa9db0-c929-45a8-9d33-10fc3e889b8c")}catch{}})();var ue={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M400 317.7h73.9V656c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V317.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 163a8 8 0 00-12.6 0l-112 141.7c-4.1 5.3-.4 13 6.3 13zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z"}}]},name:"upload",theme:"outlined"};const pe=ue,fe=["width","height","fill","transform"],me={key:0},ye=f("path",{d:"M144,128a16,16,0,1,1-16-16A16,16,0,0,1,144,128ZM60,112a16,16,0,1,0,16,16A16,16,0,0,0,60,112Zm136,0a16,16,0,1,0,16,16A16,16,0,0,0,196,112Z"},null,-1),he=[ye],ge={key:1},ve=f("path",{d:"M240,96v64a16,16,0,0,1-16,16H32a16,16,0,0,1-16-16V96A16,16,0,0,1,32,80H224A16,16,0,0,1,240,96Z",opacity:"0.2"},null,-1),_e=f("path",{d:"M140,128a12,12,0,1,1-12-12A12,12,0,0,1,140,128Zm56-12a12,12,0,1,0,12,12A12,12,0,0,0,196,116ZM60,116a12,12,0,1,0,12,12A12,12,0,0,0,60,116Z"},null,-1),be=[ve,_e],we={key:2},Ae=f("path",{d:"M224,80H32A16,16,0,0,0,16,96v64a16,16,0,0,0,16,16H224a16,16,0,0,0,16-16V96A16,16,0,0,0,224,80ZM60,140a12,12,0,1,1,12-12A12,12,0,0,1,60,140Zm68,0a12,12,0,1,1,12-12A12,12,0,0,1,128,140Zm68,0a12,12,0,1,1,12-12A12,12,0,0,1,196,140Z"},null,-1),Oe=[Ae],ke={key:3},Ce=f("path",{d:"M138,128a10,10,0,1,1-10-10A10,10,0,0,1,138,128ZM60,118a10,10,0,1,0,10,10A10,10,0,0,0,60,118Zm136,0a10,10,0,1,0,10,10A10,10,0,0,0,196,118Z"},null,-1),je=[Ce],Ie={key:4},$e=f("path",{d:"M140,128a12,12,0,1,1-12-12A12,12,0,0,1,140,128Zm56-12a12,12,0,1,0,12,12A12,12,0,0,0,196,116ZM60,116a12,12,0,1,0,12,12A12,12,0,0,0,60,116Z"},null,-1),Ze=[$e],De={key:5},Me=f("path",{d:"M136,128a8,8,0,1,1-8-8A8,8,0,0,1,136,128Zm-76-8a8,8,0,1,0,8,8A8,8,0,0,0,60,120Zm136,0a8,8,0,1,0,8,8A8,8,0,0,0,196,120Z"},null,-1),Se=[Me],Pe={name:"PhDotsThree"},xe=H({...Pe,props:{weight:{type:String},size:{type:[String,Number]},color:{type:String},mirrored:{type:Boolean}},setup(a){const e=a,n=I("weight","regular"),r=I("size","1em"),p=I("color","currentColor"),$=I("mirrored",!1),m=A(()=>{var c;return(c=e.weight)!=null?c:n}),O=A(()=>{var c;return(c=e.size)!=null?c:r}),y=A(()=>{var c;return(c=e.color)!=null?c:p}),C=A(()=>e.mirrored!==void 0?e.mirrored?"scale(-1, 1)":void 0:$?"scale(-1, 1)":void 0);return(c,j)=>(d(),g("svg",X({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256",width:O.value,height:O.value,fill:y.value,transform:C.value},c.$attrs),[R(c.$slots,"default"),m.value==="bold"?(d(),g("g",me,he)):m.value==="duotone"?(d(),g("g",ge,be)):m.value==="fill"?(d(),g("g",we,Oe)):m.value==="light"?(d(),g("g",ke,je)):m.value==="regular"?(d(),g("g",Ie,Ze)):m.value==="thin"?(d(),g("g",De,Se)):w("",!0)],16,fe))}});function B(a){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?Object(arguments[e]):{},r=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(p){return Object.getOwnPropertyDescriptor(n,p).enumerable}))),r.forEach(function(p){Ue(a,p,n[p])})}return a}function Ue(a,e,n){return e in a?Object.defineProperty(a,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):a[e]=n,a}var M=function(e,n){var r=B({},e,n.attrs);return i(L,B({},r,{icon:K}),null)};M.displayName="DownloadOutlined";M.inheritAttrs=!1;const Fe=M;function E(a){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?Object(arguments[e]):{},r=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(p){return Object.getOwnPropertyDescriptor(n,p).enumerable}))),r.forEach(function(p){ze(a,p,n[p])})}return a}function ze(a,e,n){return e in a?Object.defineProperty(a,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):a[e]=n,a}var S=function(e,n){var r=E({},e,n.attrs);return i(L,E({},r,{icon:pe}),null)};S.displayName="UploadOutlined";S.inheritAttrs=!1;const T=S;class P{constructor(e){this.projectId=e}static fromProjectId(e){return new P(e)}async list(){return k.get(`projects/${this.projectId}/files`)}async upload(e,n=""){const r={"Content-Type":"multipart/form-data"};return k.post(`projects/${this.projectId}/files/upload?path=${encodeURIComponent(n+"/"+e.name)}`,e,r)}async download(e){return k.getBlob(`projects/${this.projectId}/files/download?path=${encodeURIComponent(e)}`)}async delete(e){return k.delete(`projects/${this.projectId}/files?path=${encodeURIComponent(e)}`)}async move(e,n){return k.patch(`projects/${this.projectId}/files?path=${encodeURIComponent(e)}&newPath=${encodeURIComponent(n)}`,{})}}const Ne=a=>(ie("data-v-048030b3"),a=a(),se(),a),Ve=Ne(()=>f("br",null,null,-1)),Be={key:0},Ee={key:0,class:"file-size"},Te={class:"action-item"},He={class:"action-item"},Re=H({__name:"Files",setup(a){const n=ee().params.projectId,r=P.fromProjectId(n),{loading:p,result:$,refetch:m}=Q(()=>r.list());function O(t){var l,u;return{key:t.path,title:t.name,isLeaf:t.type==="file",file:t,children:t.type==="file"?[]:(u=(l=t.children)==null?void 0:l.map(O))!=null?u:[]}}const y=A(()=>{var t;return(t=$.value)==null?void 0:t.map(O)}),C=t=>{var l,u;return t.isLeaf?1:(u=(l=t.children)==null?void 0:l.reduce((h,v)=>h+C(v),0))!=null?u:0},c=A(()=>y.value?y==null?void 0:y.value.reduce((t,l)=>t+C(l),0):0),j=te(!1);function x(t){if(t&&t.type==="file")return;const l=document.createElement("input");l.type="file",l.onchange=async()=>{var h;const u=(h=l.files)==null?void 0:h[0];if(!!u)try{j.value=!0,await r.upload(u,t==null?void 0:t.path),await m()}catch{Y("Failed to upload file","File already exists")}finally{j.value=!1}},l.click()}async function G(t){if(!t)return;const l=await r.download(t.path),u=document.createElement("a");u.href=URL.createObjectURL(l),u.download=t.name,u.click()}async function U(t){if(!t)return;const l="Are you sure you want to delete this "+(t.type==="file"?"file":"directory and all its contents")+"?";await J(l)&&(await r.delete(t.path),await m())}return(t,l)=>(d(),b(W,null,{default:s(()=>[i(o(ae),null,{default:s(()=>[_("Files")]),_:1}),i(o(F),null,{default:s(()=>[_(" Here you can upload, download and delete files in your persistent dir."),Ve,_(" Files can be used in your scripts. "),i(q,{path:"cloud/files"}),R(t.$slots,"description",{},void 0,!0)]),_:3}),i(o(Z),{type:"primary",loading:j.value,onClick:l[0]||(l[0]=u=>x())},{default:s(()=>[i(o(T)),_(" Upload ")]),_:1},8,["loading"]),i(o(ce),{class:"files"},{default:s(()=>[c.value>0?(d(),b(o(F),{key:0},{default:s(()=>[f("b",null,[_(D(c.value)+" file",1),c.value!==1?(d(),g("span",Be,"s")):w("",!0)])]),_:1})):w("",!0),y.value&&y.value.length>0?(d(),b(o(ne),{key:1,"tree-data":y.value,selectable:!1},{title:s(({title:u,isLeaf:h,file:v})=>[f("span",null,[_(D(u)+" ",1),h?(d(),g("span",Ee,"("+D(v.size)+")",1)):w("",!0)]),h?(d(),b(o(Z),{key:0,type:"text",size:"small",style:{float:"inline-end"},onClick:()=>G(v)},{default:s(()=>[i(o(Fe))]),_:2},1032,["onClick"])):w("",!0),h?(d(),b(o(Z),{key:1,type:"text",size:"small",style:{float:"inline-end"},onClick:()=>U(v)},{default:s(()=>[i(o(V))]),_:2},1032,["onClick"])):w("",!0),h?w("",!0):(d(),b(o(oe),{key:2},{overlay:s(()=>[i(o(re),{disabled:o(p)},{default:s(()=>[i(o(z),{danger:!1,onClick:()=>x(v)},{default:s(()=>[f("div",Te,[i(o(T)),i(o(N),null,{default:s(()=>[_(" Upload ")]),_:1})])]),_:2},1032,["onClick"]),i(o(z),{danger:!1,onClick:()=>U(v)},{default:s(()=>[f("div",He,[i(o(V)),i(o(N),null,{default:s(()=>[_(" Delete ")]),_:1})])]),_:2},1032,["onClick"])]),_:2},1032,["disabled"])]),default:s(()=>[i(o(xe),{style:{cursor:"pointer",float:"inline-end"},size:"25px"})]),_:2},1024))]),_:1},8,["tree-data"])):(d(),b(o(le),{key:2,description:o(p)?"Loading...":"No files"},null,8,["description"]))]),_:1})]),_:3}))}});const rt=de(Re,[["__scopeId","data-v-048030b3"]]);export{rt as default};
//# sourceMappingURL=Files.54c69ada.js.map
