var x=Object.defineProperty;var F=(s,t,e)=>t in s?x(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var h=(s,t,e)=>(F(s,typeof t!="symbol"?t+"":t,e),e);import{v as _,b as p,et as m,eC as q,eD as B,e as S,d as I,H as y,r as W,a as z,bf as J,eA as X,eu as R,f as C,u as M,ev as L,c as f,eX as Y,eY as Z,eI as K,ex as H,es as Q,w as P,aC as $,eZ as tt,ao as et,F as st}from"./outputWidgets.9a4dffd5.js";import{P as it,R as rt,e as at}from"./executeJs.002cd519.js";import{W as ot}from"./WidgetsFrame.6bff1f4e.js";import{w as nt}from"./icons.d935dec9.js";import{v as lt,m as ht}from"./geometryUtils.48dd14b8.js";import{w as O,l as w}from"./runnerData.8cacc2f4.js";import{b as dt}from"./index.7e030f20.js";import{P as ct}from"./pubsub.25596209.js";(function(){try{var s=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},t=new Error().stack;t&&(s._sentryDebugIds=s._sentryDebugIds||{},s._sentryDebugIds[t]="14702261-e565-40a4-b29d-be36f68b38ea",s._sentryDebugIdIdentifier="sentry-dbid-14702261-e565-40a4-b29d-be36f68b38ea")}catch{}})();const ut={},pt=s=>(q("data-v-5d7ea65b"),s=s(),B(),s),gt={class:"dash-loading"},wt=pt(()=>S("div",{class:"dash-loading-container"},[S("div",{class:"loading-bar-background"}),S("div",{class:"loading-bar"})],-1)),yt=[wt];function vt(s,t){return p(),m("div",gt,yt)}const mt=_(ut,[["render",vt],["__scopeId","data-v-5d7ea65b"]]);function k(){return window.matchMedia("(min-width: 1200px)").matches}const bt={key:0,class:"error-widget"},ft={key:0},St={key:2,class:"loading"},Ct=I({__name:"WidgetsGrid",props:{camera:{},isPreview:{type:Boolean},widgetsWithErrors:{},grid:{},widgetsListeners:{},widgetsProps:{},inputValues:{},widgets:{},forceResponsivity:{}},setup(s){const t=s,e=y(()=>({...i.value,padding:`${t.grid.margin}px`,gap:`${t.grid.gap}px`,maxWidth:`${t.grid.width}px`,height:`${t.grid.height}px`,gridTemplateColumns:`repeat(${t.grid.columns}, ${t.grid.cellWidth}px)`,gridTemplateRows:`repeat(auto-fill, ${t.grid.cellHeight}px)`})),i=y(()=>{const n=k()?t.grid.sidebarWidth+(r.value-t.grid.sidebarWidth-960)/2:(r.value-960)/2;return{"--dash-right-margin":`${k()?(r.value-t.grid.sidebarWidth-960)/2:(r.value-960)/2}px`,"--dash-left-margin":`${n}px`}}),r=W(window.innerWidth);window.addEventListener("resize",()=>{r.value=window.innerWidth});const a=n=>{const c=n.target;c.scrollHeight>c.clientHeight&&n.stopPropagation()};function l(n){return{gridColumnStart:`${n.position.colStart+1}`,gridColumnEnd:`${n.position.colEnd+2}`,gridRowStart:`${n.position.rowStart+1}`,gridRowEnd:`${n.position.rowEnd+2}`,padding:`${t.grid.padding}px`}}const d=n=>{const c=n.position.rowEnd-n.position.rowStart+1;return c*t.grid.cellHeight+(c-1)*t.grid.gap-2*t.grid.padding},g=n=>{const c=n.position.colEnd-n.position.colStart+1;return c*t.grid.cellWidth+(c-1)*t.grid.gap-2*t.grid.padding},b=n=>{var c;return n in((c=t.widgetsProps)!=null?c:{})};return(n,c)=>{const N=z("icon");return p(),m("div",{class:H(["dash",n.forceResponsivity]),style:R(e.value)},[(p(!0),m(J,null,X(n.widgets,(o,u)=>{var v,E;return p(),m("div",{key:u,class:"widget",style:R(l(o)),onWheel:a},[((v=n.widgetsWithErrors)==null?void 0:v.find(V=>V==u))&&n.isPreview?(p(),m("div",bt,[C(N,{width:"20",height:"20",path:M(nt),fill:"#D35249"},null,8,["path"]),g(o)>=160&&d(o)>=120?(p(),m("p",ft," Ops! There is an error in this widget's properties ")):L("",!0)])):b(u)?(p(),f(K(o.type),Y({key:1,"user-props":n.widgetsProps[u],value:n.inputValues[u],errors:[],runtime:"dash","container-width":g(o),"container-height":d(o),zoom:(E=n.camera)==null?void 0:E.zoom,"widget-id":u},Z(n.widgetsListeners[u])),null,16,["user-props","value","container-width","container-height","zoom","widget-id"])):(p(),m("div",St))],36)}),128))],6)}}});const Pt=_(Ct,[["__scopeId","data-v-014f7759"]]),kt=I({__name:"LayoutPresenter",props:{widgets:{},props:{},inputValues:{},widgetsListeners:{},camera:{},forceResponsivity:{},grid:{},widgetsWithErrors:{},runnerData:{},isPreview:{type:Boolean}},setup(s){const t=Q();return(e,i)=>(p(),f(ot,{class:"dash-player","main-color":e.runnerData.mainColor,"font-family":e.runnerData.fontFamily,theme:e.runnerData.theme,runtime:"dash"},{default:P(()=>[$(e.$slots,"header",{},void 0,!0),M(t).overrideMain?$(e.$slots,"overrideMain",{key:1},void 0,!0):(p(),f(Pt,{key:0,camera:e.camera,"is-preview":e.isPreview,"input-values":e.inputValues,"widgets-with-errors":e.widgetsWithErrors,grid:e.grid,"widgets-listeners":e.widgetsListeners,"widgets-props":e.props,widgets:e.widgets,"force-responsivity":e.forceResponsivity},null,8,["camera","is-preview","input-values","widgets-with-errors","grid","widgets-listeners","widgets-props","widgets","force-responsivity"]))]),_:3},8,["main-color","font-family","theme"]))}});const _t=_(kt,[["__scopeId","data-v-16890a8a"]]),Nt=I({__name:"DashPlayer",props:{isPreview:{type:Boolean},dashPlayerService:{},forceResponsivity:{},camera:{},widgetsWithErrors:{},editingMode:{type:Boolean},params:{}},emits:["navigate","logout"],setup(s,{emit:t}){const e=s,i=W(null),r=W(window.innerWidth);window.addEventListener("resize",()=>{r.value=window.innerWidth});const a=o=>t("navigate",o),l=y(()=>{var o;return(o=e.dashPlayerService.getUserEmail())!=null?o:void 0}),d=y(()=>e.dashPlayerService.state.type==="RUNNING"?e.dashPlayerService.state.widgets:Object.entries(e.dashPlayerService.runnerData.layout.slot).reduce((o,[u,v])=>Object.assign(o,{[u]:v}),{})),g=y(()=>e.dashPlayerService.state.type==="RUNNING"?e.dashPlayerService.state.inputValues:{}),b=y(()=>e.dashPlayerService.state.type==="RUNNING"?e.dashPlayerService.state.alerts:[]),n=y(()=>e.dashPlayerService.state.type==="RUNNING"?e.dashPlayerService.state.props:{}),c=y(()=>{const o=k()?e.dashPlayerService.layoutGrid.sidebarWidth+(r.value-e.dashPlayerService.layoutGrid.sidebarWidth-960)/2:(r.value-960)/2;return{"--dash-right-margin":`${k()?(r.value-e.dashPlayerService.layoutGrid.sidebarWidth-960)/2:(r.value-960)/2}px`,"--dash-left-margin":`${o}px`}}),N=y(()=>({...c.value,padding:`${e.dashPlayerService.layoutGrid.margin}px`,width:`${e.dashPlayerService.layoutGrid.width}px`,gap:`${e.dashPlayerService.layoutGrid.gap}px`,height:"100%",boxSizing:"border-box"}));return e.dashPlayerService.start(e.params),(o,u)=>{var v;return p(),f(_t,{widgets:d.value,props:n.value,"input-values":g.value,"widgets-listeners":o.dashPlayerService.getWidgetsListeners(),camera:o.camera,"force-responsivity":o.forceResponsivity,grid:o.dashPlayerService.layoutGrid,"widgets-with-errors":(v=o.widgetsWithErrors)!=null?v:[],"runner-data":o.dashPlayerService.runnerData,"is-preview":o.isPreview},tt({header:P(()=>[C(rt,{ref_key:"runtimeCommonsRef",ref:i,type:"dashes",runtime:o.dashPlayerService.runnerData,"full-width":!0,"is-preview":o.isPreview,"user-email":l.value,"force-responsivity":o.forceResponsivity,alerts:b.value,onNavigate:a,onLogout:u[0]||(u[0]=E=>o.dashPlayerService.logout())},null,8,["runtime","is-preview","user-email","force-responsivity","alerts"]),C(et,null,{default:P(()=>[o.dashPlayerService.state.type==="RUNNING"&&o.dashPlayerService.state.eventProcessing?(p(),f(mt,{key:0})):L("",!0)]),_:1})]),_:2},[o.dashPlayerService.isAuthenticating()?{name:"overrideMain",fn:P(()=>[S("div",{class:H(["auth-form",o.forceResponsivity]),style:R(N.value)},[C(it,{class:"form-auth"})],6)]),key:"0"}:void 0]),1032,["widgets","props","input-values","widgets-listeners","camera","force-responsivity","grid","widgets-with-errors","runner-data","is-preview"])}}});const Qt=_(Nt,[["__scopeId","data-v-ed107463"]]);function Et(s,t){const e=Object.entries(s).sort((a,l)=>lt(a[1].position,l[1].position)),i=a=>document.querySelector(`[widget-id='${a}']`);return ht(e.map(([a,l])=>[a,l,i(a)?t.height2rows(i(a).offsetHeight)-(l.position.rowEnd-l.position.rowStart):0])).reduce((a,[l,d])=>({...a,[l]:{...d,position:{...d.position,rowEnd:O[d.type].autoHeight&&i(l)?d.position.rowStart+t.height2rows(i(l).offsetHeight):d.position.rowEnd}}}),{})}const Wt=(s,t,e)=>t&&!t.condition?{computedElement:{...s,position:{...s.position,row:s.position.row+e,height:0}},updateOffset:0,addOffset:0,slot:{}}:{computedElement:{...s,position:{...s.position,row:s.position.row+e}},updateOffset:s.position.height,addOffset:s.position.row,slot:s.slot},Rt={"if-block":Wt},It=(s,t,e)=>Dt(T(Object.values(s),{widgets:[],slottables:[]},0,t),e),Dt=(s,t)=>({widgets:Et(s.widgets.reduce((e,i)=>({...e,[i.id]:i}),{}),t),slottables:s.slottables.reduce((e,i)=>({...e,[i.id]:i}),{})}),Ut=(s,t)=>{if(w(s)&&w(t))return t.position.rowStart-s.position.rowStart;if(w(s)&&!w(t))return t.position.row-s.position.rowStart===0?-1:t.position.row-s.position.rowStart;if(!w(s)&&w(t))return t.position.rowStart-s.position.row===0?1:t.position.rowStart-s.position.row;if(!w(s)&&!w(t)){if(t.position.row-s.position.row===0){if(t.position.order===s.position.order)throw new Error("Two slottables with the same order in the same row");return t.position.order-s.position.order}return t.position.row-s.position.row}return 0},T=(s,t,e,i)=>s.sort(Ut).reduce((r,a)=>Gt(a,e,r,i),t),Gt=(s,t,e,i)=>w(s)?$t(s,t,e):At(s,t,e,i),$t=(s,t,e)=>(e.widgets.push({...s,position:j(s.position,t)}),e),At=(s,t,e,i)=>{const{computedElement:r,slot:a,updateOffset:l,addOffset:d}=Rt[s.type](s,i[s.id],t),g=Mt(e,l);return g.slottables.push(r),T(Object.values(a),g,t+d,i)},Mt=(s,t)=>({widgets:Lt(s.widgets,t),slottables:Ht(s.slottables,t)}),Lt=(s,t)=>s.map(e=>({...e,position:j(e.position,t)})),Ht=(s,t)=>s.map(e=>({...e,position:{...e.position,row:e.position.row+t}})),j=(s,t)=>({...s,rowStart:s.rowStart+t,rowEnd:s.rowEnd+t}),Ot=960,A=12,Tt=0,jt=24,Vt=32,xt=8;class D{constructor(t,e){h(this,"width");h(this,"columns");h(this,"gap");h(this,"margin");h(this,"padding");h(this,"calculatePositions");h(this,"_cellHeight");h(this,"dashPlayerService");this.dashPlayerService=t,this.width=Ot,this.columns=A,this.gap=Tt,this.margin=jt,this.padding=xt,this._cellHeight=Vt,this.calculatePositions=e}static create(t,e){return new D(t,e)}static get columns(){return A}get cellHeight(){return this._cellHeight}get navbarLength(){return this.dashPlayerService.navbarVisible?48:0}get cellWidth(){const t=this.columns-1;return(this.width-2*this.margin-t*this.gap)/this.columns}get rows(){const{widgets:t,slottables:e}=this.calculatePositions();return Math.max(Object.values(t!=null?t:{}).map(i=>i.position.rowEnd).reduce((i,r)=>Math.max(i,r),0)+4,Object.values(e!=null?e:{}).map(i=>i.position.row+i.position.height).reduce((i,r)=>Math.max(i,r),0)+4,20)}get sidebarWidth(){return this.dashPlayerService.hasSidebar?240:0}getCell(t,e){return{x:this.margin+t*(this.cellWidth+(t>0?this.gap:0)),y:this.margin+this.navbarLength+e*(this._cellHeight+(e>0?this.gap:0)),width:this.cellWidth,height:this._cellHeight,referential:"world"}}getCellFrom(t,e){const i=this.getCell(t.i,t.j);return this.cellAt(i.x+e.dx,i.y+e.dy)}areaFromRect(t){const e=this.cellAt(t.x,t.y),i={dx:t.width-1,dy:t.height-1,referential:"world"},r=this.getCellFrom(e,i);return{colStart:e.i,rowStart:e.j,colEnd:r.i,rowEnd:r.j}}rectFromArea(t){const e=this.getCell(t.colStart,t.rowStart),i=this.getCell(t.colEnd,t.rowEnd);return{x:e.x,y:e.y,width:i.x+i.width-e.x,height:i.y+i.height-e.y,referential:"world"}}get height(){return this.rows*(this._cellHeight+this.gap)-this.gap+2*this.margin}cellAt(t,e){return{i:Math.floor((t-this.margin)/(this.cellWidth+this.gap)),j:Math.floor((e-this.margin-this.navbarLength)/(this._cellHeight+this.gap))}}snap(t,e){const i=e==="bottom-right"||e==="top-right"?1:0,r=e==="bottom-left"||e==="bottom-right"?1:0,a=this.cellWidth+this.gap,l=this._cellHeight+this.gap,d=this.margin+this.cellWidth*i,g=this.margin+this.navbarLength+this.cellHeight*r,b=t.x-d,n=t.y-g;return{x:d+a*Math.round(b/a),y:g+l*Math.round(n/l),referential:"world"}}snapDelta(t){const e=this.cellWidth+this.gap,i=this._cellHeight+this.gap;return{dx:e*Math.round(t.dx/e),dy:i*Math.round(t.dy/i),referential:"world"}}height2rows(t){return Math.ceil((t+this.gap)/(this.cellHeight+this.gap))}}class U{constructor(t,e,i){h(this,"_stateTimestamp",Date.now());h(this,"_state");h(this,"runnerData");h(this,"userManager");h(this,"websocketClient");h(this,"_autocompleteState");h(this,"seq",0);h(this,"layoutGrid");h(this,"stateChangeCallbacks",[]);h(this,"updateUserCallbacks",[]);h(this,"onCloseCallbacks",[]);h(this,"onRedirectCallback",null);this._state=st({type:"IDLE"}),this._autocompleteState={suggestionsFor:null,suggestions:[]},this.runnerData=t,this.userManager=e,this.websocketClient=i,this.layoutGrid=D.create(this,()=>this.calculatePositions()),window.__playerService=()=>this,this.userManager.pubsub.subscribe("authenticated",r=>{r?this.endAuth():this.badAuth()})}notifyStateChange(t){this.stateChangeCallbacks.forEach(e=>e(t))}onStateChange(t){this.stateChangeCallbacks.push(t)}setState(t){this._state.value=t,this.notifyStateChange(t)}get state(){return this._state.value}static create(t,e,i){return new U(t,e,i)}updateRunnerData(t){this.runnerData=t}get brokerIsClosed(){var t;return(t=this.websocketClient.isClosed)!=null?t:!0}calculatePositions(t,e){const i=t||(this.state.type==="RUNNING"?this.state.props:{}),r=e!=null?e:this.runnerData.layout.slot;return It(r,i,this.layoutGrid)}updateDashData(t){if(!t)throw new Error("dash is null");if(!t.layout)throw new Error("dash.layout is null");switch(this.state.type){case"RUNNING":{this.runnerData=t;const{widgets:e}=this.calculatePositions();this.setState({...this.state,widgets:e});break}default:throw new Error(`Invalid state ${this.state.type} for updateDashData`)}}async start(t={}){this.clearSuggestions(),this.websocketClient.isClosed||this.websocketClient.reset(),this.websocketClient.onClose(e=>{this.closeCallback(e)}),this.websocketClient.on("program-start-failed",e=>{this.setState({...e,type:"ERROR",cause:"PROGRAM_START_FAILED"})}),this.websocketClient.on("execution-id",()=>{this.websocketClient.send({type:"client-start",state:this.apiPageState,params:t})}),this.websocketClient.on("widgets-computed",e=>{if(e.seq!==this.seq)return;const{widgets:i,slottables:r}=this.calculatePositions(e.props),a=this.state.type==="RUNNING"?{...this.state.inputValues}:{};if(e.variables)for(const l in e.variables){if(!(l in e.variables)){console.warn(`widget ${l} not found in layout`);continue}a[l]=e.variables[l]}this.setState({errors:e.errors,props:e.props,variables:e.variables,type:"RUNNING",eventProcessing:!1,alerts:this.state.type==="RUNNING"?this.state.alerts:[],widgets:i,inputValues:a,slottables:r,authenticatedUser:this.userManager.getUser()})}),this.websocketClient.on("redirect",e=>{this.redirect(e)}),this.websocketClient.on("auth:require-info",e=>{e.refresh?(this.userManager.removeUser(),this.startAuth()):this.userManager.getUser()?this.endAuth():this.startAuth()}),this.websocketClient.on("autocomplete:suggestions",({suggestionsFor:e,suggestions:i})=>{this._autocompleteState={suggestionsFor:e,suggestions:i}}),this.websocketClient.on("alert",e=>{this.state.type==="RUNNING"&&this.setState({...this.state,alerts:[...this.state.alerts,{message:e.message,severity:e.severity,id:this.state.alerts.length}]})}),this.websocketClient.on("execute-js:request",async e=>{this.websocketClient.send({type:"execute-js:response",value:await at(e)})}),this.websocketClient.on("refresh:setup",()=>{this.websocketClient.send({type:"refresh:request"})}),this.websocketClient.connect()}sendWidgetsChanged(t){this.websocketClient.send({type:"widgets-changed",state:this.apiPageState,dashDefinition:{slot:t}})}sendEvalRequest(t){this.websocketClient.send({type:"eval",expression:t,state:this.apiPageState})}sendVariableCreated(t){this.websocketClient.send({name:t,value:null,type:"variable-created",state:this.apiPageState})}makeWidgetsError(t){return{widgets:Object.keys(this.runnerData.layout.slot).reduce((i,r)=>(i[r]={repr:t},i),{}),props:{},variables:{}}}onUpdateUser(t){this.updateUserCallbacks.push(t)}onClose(t){this.onCloseCallbacks.push(t)}closeCallback(t){this.onCloseCallbacks.forEach(e=>e(t))}onRedirect(t){this.onRedirectCallback=t}redirect(t){!this.onRedirectCallback||this.onRedirectCallback(t)}wait(t){return this.websocketClient.wait(t)}on(t,e){this.websocketClient.on(t,e)}onMany(t,e){t.forEach(i=>this.on(i,e))}get apiPageState(){const t=this.state.type==="RUNNING"?this.state.inputValues:{},e=Object.keys(this.runnerData.layout.slot).reduce((i,r)=>{var a;return{...i,[r]:{value:(a=t[r])!=null?a:null}}},{});return{timestamp:this._stateTimestamp,widgets:e}}getUserEmail(){var t,e;switch(this.state.type){case"RUNNING":return(e=(t=this.state.authenticatedUser)==null?void 0:t.claims.email)!=null?e:null;default:return null}}startAuth(){switch(this.state.type){case"RUNNING":case"IDLE":this.setState({type:"AUTHENTICATING",previousState:this.state});break;default:throw new Error(`Invalid state ${this.state.type} for startAuth`)}}async endAuth(){this.websocketClient.send({type:"auth:saved-jwt",jwt:this.userManager.getUser().jwt}),await new Promise((t,e)=>{this.websocketClient.on("auth:valid-jwt",t),this.websocketClient.on("auth:invalid-jwt",e)})}badAuth(){if(this.state.type!=="AUTHENTICATING")throw new Error(`Invalid state ${this.state.type} for badAuth`);this.state.previousState.type==="RUNNING"?this.setState({...this.state.previousState,authenticatedUser:null}):this.state.previousState.type==="IDLE"&&this.setState({...this.state.previousState})}logout(){this.userManager.removeUser(),this.start()}isAuthenticating(){return this.state.type==="AUTHENTICATING"}get suggestionsFor(){return this._autocompleteState.suggestionsFor}get suggestions(){return this._autocompleteState.suggestions}clearSuggestions(){this._autocompleteState={suggestionsFor:null,suggestions:[]}}getAutocompleteSuggestions(t,e){t!==this.suggestionsFor&&this.clearSuggestions(),this.websocketClient.send({type:"autocomplete:load",suggestionsFor:t,code:e})}get navbarVisible(){const{logoUrl:t,brandName:e}=this.runnerData,i=this.getUserEmail();return!!(this.hasSidebar||t||e||i)}get hasSidebar(){const t=this.runnerData.sidebar;return!t||t.length==0?!1:t.some(e=>e.visible)}getWidgetsListeners(){switch(this.state.type){case"RUNNING":return Object.entries(this.state.widgets).reduce((t,[e,i])=>({...t,[e]:this.listenersFromWidget(e,i.type)}),{});default:return{}}}listenersFromWidget(t,e){return O[e].events.reduce((i,r)=>({...i,[r.key]:r.key==="update:value"?a=>this.sendWidgetInputMessage(t,a):a=>this.sendWidgetEventMessage(t,r.key,a)}),{})}sendWidgetInputMessage(t,e){!this.websocketClient||this.websocketClient.send({type:"widget-input",widgetId:t,newValue:e,seq:++this.seq})}getWidgetRunData(t,e=this.runnerData.layout.slot){const i=e[t];if(i)return i;for(const r in e){const a=e[r];if(!w(a))return this.getWidgetRunData(t,a.slot)}return null}sendWidgetEventMessage(t,e,i){var l;if(!this.websocketClient||this.state.type!=="RUNNING")return;const r=this.getWidgetRunData(t);if(!((l=r==null?void 0:r.events)!=null?l:[]).includes(e))return;const a=this.apiPageState;this.websocketClient.send({type:"widget-event",event:{type:e,payload:i},widgetId:t,state:a,seq:++this.seq}),this.setState({...this.state,eventProcessing:!0})}}class G{constructor(t){h(this,"ws");h(this,"pubsub");h(this,"dash");this.pubsub=new ct,this.ws=null,this.dash=t,this.pubsub.wait("close")}static create(t){return new G(t)}get url(){return`${location.protocol==="https:"?"wss:":"ws:"}//${location.host}/_socket?dashPath=${encodeURIComponent(this.dash.path)}`}get isClosed(){return this.ws?this.ws.readyState!==WebSocket.OPEN:!0}on(t,e){this.pubsub.subscribe(t,e)}wait(t){return this.pubsub.wait(t)}reset(){if(!this.ws)throw new Error("no websocket to clear");this.pubsub.reset(),this.ws.close()}async connect(t=1){t>3||await new Promise((e,i)=>{this.ws=new WebSocket(this.url),this.ws.onopen=()=>{e()},this.ws.onerror=r=>{i(r)},this.ws.onclose=()=>{this.pubsub.publish("close")},this.ws.onmessage=r=>{const a=JSON.parse(r.data);this.pubsub.publish(a.type,a)}}).catch(e=>{console.error(e),this.connect(t+1)})}onClose(t){this.pubsub.subscribe("close",t)}close(){if(!this.ws)throw new Error("no websocket to close");this.ws.close()}async send(t){if(!this.ws)throw new Error("no websocket to send");if(this.isClosed)throw new Error("websocket is closed");this.ws.send(JSON.stringify(t))}}function te(s){const t=G.create(s);return U.create(s,dt,t)}export{Qt as D,te as m};
//# sourceMappingURL=index.bf9f5a1a.js.map
