import{d as $,r as x,v as H,b as i,c as f,x as a,F as C,L,N as M,W as q,a5 as N,e as n,O as Q,Q as j,q as A,H as X,J as Y,K as Z,z as t,t as k,w as v,D as V,S as ee}from"./registerWidgets.08d6baab.js";import{L as te}from"./CircularLoading.2d1b6c60.js";import{E as oe}from"./Error.ad70d80c.js";import{R as re,F as ae}from"./broker.477b6f16.js";import{R as se,S as le,_ as ne,L as ie}from"./UnsavedChangesHandler.vue_vue_type_script_setup_true_lang.132a1129.js";import{T as ce,a as W}from"./Tab.2a8edb19.js";import{a as ue}from"./asyncComputed.d051cfa0.js";import{F as me}from"./forms.e73a0849.js";import{W as de}from"./workspaces.c02f8744.js";import{B as pe}from"./BackButton.f16ccdc8.js";import{S as fe}from"./SaveButton.55394a0b.js";import{D as _e}from"./DocsButton.f47eff9e.js";import{P as ve}from"./PreviewButton.82e5760d.js";import"./lottie.1d018d12.js";import"./passwordlessManager.073b43ea.js";import"./pubsub.78fe3466.js";import"./Passwordless.b4bf0234.js";import"./icons.e8e5575c.js";import"./executeJs.1e2bbf54.js";import"./PlayerNavbar.896781ed.js";import"./index.da52e009.js";import"./Steps.0f0643d5.js";import"./Modal.3f337bc0.js";import"./WidgetsFrame.921c2d99.js";import"./ActionButton.vue_vue_type_script_setup_true_lang.d11c90a4.js";import"./dashes.c2c7b6b8.js";import"./activeRecord.e95a5747.js";import"./runnerData.265454ca.js";import"./hooks.cede592a.js";import"./jobs.c62116dd.js";import"./uuid.7a6ccb76.js";import"./login.4514ddd6.js";(function(){try{var s=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},d=new Error().stack;d&&(s._sentryDebugIds=s._sentryDebugIds||{},s._sentryDebugIds[d]="ec1f9cfd-1f87-4269-95f4-68c0be3527d4",s._sentryDebugIdIdentifier="sentry-dbid-ec1f9cfd-1f87-4269-95f4-68c0be3527d4")}catch{}})();const ye="forms_workspace_id_path_key",U=s=>(Q("data-v-7f776cc2"),s=s(),j(),s),he={class:"form-settings"},ge={class:"content"},be={class:"subsection-label"},ke={class:"property-label"},we=["value","onChange"],Se={class:"content"},xe={class:"property"},Ce=U(()=>a("div",{class:"property-label"},"Start smart form automatically",-1)),Ee={class:"property"},Fe=U(()=>a("div",{class:"property-label"},"Allow the user to restart the smart form after it is over",-1)),Re="This path is already being used by another form or dash on your workspace",Be=$({__name:"FormSettings",props:{form:{}},setup(s){const o=x(s.form),y=[{label:"General",props:[{label:"Form name",valueKey:"title"}]},{label:"Welcome Screen",props:[{label:"Title",valueKey:"welcomeTitle"},{label:"Subtitle",valueKey:"startMessage"},{label:"Start button text",valueKey:"startButtonText"}]},{label:"Ending Screen",props:[{label:"Title",valueKey:"endMessage"},{label:"Restart button text",valueKey:"restartButtonText"}]},{label:"Alert Messages",props:[{label:"Error message",valueKey:"errorMessage"}]}],h=H({pathError:null,sectionsShown:[!0,!1,!1]}),w=r=>{r.detail.includes(ye)&&(h.pathError=Re)};return addEventListener("hasura-error",w),(r,u)=>(i(),f("div",he,[a("div",ge,[(i(),f(C,null,L(y,l=>a("div",{key:l.label,class:"subsection"},[a("div",be,M(l.label),1),(i(!0),f(C,null,L(l.props,m=>(i(),f("div",{key:m.label,class:"property column"},[a("div",ke,M(m.label),1),a("input",{class:"property-input",type:"text",value:o.value[m.valueKey],onChange:S=>o.value[m.valueKey]=S.target.value},null,40,we)]))),128))])),64))]),a("div",Se,[a("div",xe,[q(a("input",{"onUpdate:modelValue":u[0]||(u[0]=l=>o.value.autoStart=l),class:"checkbox-input",type:"checkbox"},null,512),[[N,o.value.autoStart]]),Ce]),a("div",Ee,[q(a("input",{"onUpdate:modelValue":u[1]||(u[1]=l=>o.value.allowRestart=l),class:"checkbox-input",type:"checkbox"},null,512),[[N,o.value.allowRestart]]),Fe])]),n(se,{runtime:o.value},null,8,["runtime"])]))}});const Ke=A(Be,[["__scopeId","data-v-7f776cc2"]]),Pe={class:"page"},De={key:1,class:"error"},Ie=$({__name:"FormEditor",setup(s){var F,R,B;const d=X(),o=Y(),y=H({fullscreen:!1,rightPanelCollapsed:!1,hasChanges:!1,started:!1});addEventListener("keydown",e=>{(e.ctrlKey||e.metaKey)&&e.key==="s"&&(e.preventDefault(),S())});const h=x(null),{loading:w,result:r,error:u,refetch:l}=ue(()=>Promise.all([de.get(),me.get(o.params.formPath)]).then(([e,b])=>ee({workspace:e,form:b}))),m=x(!1);async function S(){var e;m.value=!0;try{await((e=r.value)==null?void 0:e.form.save())}finally{m.value=!1}}const p=ie.create(),g=Z(()=>re.create({formPath:o.params.formPath}));(F=g.value)==null||F.on("stdout",e=>{p.log({type:"stdout",log:e.log})}),(R=g.value)==null||R.on("stderr",e=>{p.log({type:"stderr",log:e.log})}),(B=g.value)==null||B.onClose(()=>{p.log({type:"stderr",log:"Program closed"})});const z=()=>{p.clear()},E=async()=>{var e;return p.log({type:"restart"}),(e=h.value)==null?void 0:e.run()},G=({path:e,type:b})=>{b==="dash"?d.push({name:"dashEditor",params:{dashPath:e},query:o.query}):(d.push({name:"editor",params:{formPath:e},query:o.query}),l())},J=()=>{y.started=!0},O=()=>{y.started=!1};return(e,b)=>{var K,P,D,I,T;return i(),f(C,null,[a("div",Pe,[t(w)||!((K=t(r))!=null&&K.form)||!((P=t(r))!=null&&P.workspace)?(i(),k(te,{key:0})):t(u)?(i(),f("div",De,[n(oe,{error:t(u),onReload:t(l)},null,8,["error","onReload"])])):(i(),k(ce,{key:2},{left:v(()=>[n(pe,{link:"/_editor/forms"})]),right:v(()=>{var c,_;return[n(_e),n(ve,{model:(c=t(r))==null?void 0:c.form},null,8,["model"]),n(fe,{model:(_=t(r))==null?void 0:_.form},null,8,["model"])]}),default:v(()=>[n(W,{title:"Preview"},{default:v(()=>{var c,_;return[n(ae,{ref_key:"runner",ref:h,form:(_=t(r))==null?void 0:_.form.makeRunnerData((c=t(r))==null?void 0:c.workspace),params:t(o).query,"is-preview":!0,"enable-auto-focus":!1,broker:g.value,style:{height:"unset",flex:1,overflow:"hidden"},onNavigate:G,onLogout:E,onExit:O,onStart:J},null,8,["form","params","broker"])]}),_:1}),n(W,{title:"Settings"},{default:v(()=>{var c;return[(c=t(r))!=null&&c.form?(i(),k(Ke,{key:0,form:t(r).form},null,8,["form"])):V("",!0)]}),_:1})]),_:1})),(D=t(r))!=null&&D.form?(i(),k(le,{key:3,runtime:"forms","log-service":t(p),onRestart:E,onClearTerminal:z},null,8,["log-service"])):V("",!0)]),n(ne,{"has-changes":(T=(I=t(r))==null?void 0:I.form)==null?void 0:T.hasChanges()},null,8,["has-changes"])],64)}}});const dt=A(Ie,[["__scopeId","data-v-8b7849de"]]);export{dt as default};
//# sourceMappingURL=FormEditor.1426b209.js.map
