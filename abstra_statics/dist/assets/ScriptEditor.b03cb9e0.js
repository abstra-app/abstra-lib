import{d as k,r as v,b as u,ev as x,f as o,c as d,w as n,u as e,bO as h,eA as T,eB as B,eK as C,ex as f,e as w}from"./outputWidgets.e46e0ded.js";import{W as I}from"./workspaces.b56d57a4.js";import{S as A}from"./scripts.4dbb6837.js";import{R as N,S as U,a as $,L as D}from"./SourceCode.8bffe8f1.js";import{B as P}from"./BaseLayout.d48e98d3.js";import{a as E}from"./asyncComputed.ea937eb3.js";import{_ as F}from"./RunButton.vue_vue_type_script_setup_true_lang.7561aadd.js";import{A as L}from"./FormItem.028a21cb.js";import{F as K}from"./Form.e62bba2a.js";import{N as V}from"./NavbarControls.61c340a6.js";import{_ as M}from"./SaveButton.vue_vue_type_script_setup_true_lang.ec754724.js";import{S as W}from"./StageRunSelector.0401f03d.js";import{c as q}from"./index.f3a3c7d6.js";import{A as H}from"./index.b4ecf953.js";import{A as y,T as R}from"./TabPane.1d4c923c.js";import"./runnerData.e8597b04.js";import"./url.24cedcd6.js";import"./record.7c07a1e1.js";import"./pubsub.0ad51ee9.js";import"./uuid.3df5a141.js";import"./icons.d4fdc2de.js";import"./jobs.2f726e1d.js";import"./validations.eba63c76.js";import"./string.44e540f4.js";import"./toggleHighContrast.36a5ed4e.js";import"./index.17dc0681.js";import"./Card.10d8f696.js";import"./Text.dfce2b71.js";import"./Base.237a3458.js";import"./Typography.936b79d0.js";import"./hasIn.e94cc5bd.js";import"./index.6497ffce.js";import"./popupNotifcation.df1d8d5e.js";import"./Link.54aaa0a4.js";import"./DocsButton.vue_vue_type_script_setup_true_lang.57fd095a.js";import"./Paragraph.324cd4bd.js";import"./Modal.917b8a62.js";import"./ant-design.a4db70e5.js";import"./index.11efe501.js";import"./index.8a7fae95.js";import"./index.b0838867.js";(function(){try{var l=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},c=new Error().stack;c&&(l._sentryDebugIds=l._sentryDebugIds||{},l._sentryDebugIds[c]="4ec5f48f-b3f2-42d2-bebb-285acabc85e4",l._sentryDebugIdIdentifier="sentry-dbid-4ec5f48f-b3f2-42d2-bebb-285acabc85e4")}catch{}})();const O={style:{width:"100%",display:"flex","flex-direction":"column"}},j=k({__name:"ScriptTester",props:{script:{},logService:{},stageRunId:{}},emits:["update-stage-run-id"],setup(l,{emit:c}){const t=l,g=v(!1),p=async()=>{g.value=!0;try{const r=t.stageRunId?await t.script.run(t.stageRunId):await t.script.test();r.stderr&&t.logService.log({type:"stderr",log:r.stderr}),r.stdout&&t.logService.log({type:"stdout",log:r.stdout})}finally{g.value=!1,t.stageRunId&&c("update-stage-run-id",null)}};return(r,m)=>(u(),x("div",O,[o(F,{loading:g.value,disabled:r.script.hasChanges(),onClick:p,onSave:m[0]||(m[0]=b=>r.script.save())},null,8,["loading","disabled"])]))}}),z=k({__name:"ScriptSettings",props:{script:{}},setup(l){const t=v(l.script);return(g,p)=>(u(),d(e(K),{layout:"vertical"},{default:n(()=>[o(e(L),{label:"Name",required:""},{default:n(()=>[o(e(h),{value:t.value.title,"onUpdate:value":p[0]||(p[0]=r=>t.value.title=r)},null,8,["value"])]),_:1}),o(N,{runtime:t.value},null,8,["runtime"])]),_:1}))}}),G={style:{width:"50%"}},J={style:{width:"50%"}},Fe=k({__name:"ScriptEditor",setup(l){const c=T(),t=B();function g(){c.push({name:"home"})}const p=v("source-code"),r=v("preview"),m=v(null),b=v(!1),{result:s}=E(()=>Promise.all([I.get(),A.get(t.params.id),I.readTestData()]).then(([S,a,i])=>(a.updateInitialState("test_data",i),C({workspace:S,script:a})))),_=D.create();return(S,a)=>(u(),d(P,null,{navbar:n(()=>[e(s)?(u(),d(e(q),{key:0,title:e(s).script.title,style:{padding:"5px 10px"},onBack:g},{extra:n(()=>[o(V,{"show-save-button":!1,"editing-model":e(s).script},null,8,["editing-model"])]),_:1},8,["title"])):f("",!0)]),content:n(()=>[e(s)?(u(),d(e(H),{key:0,gap:"40",style:{width:"calc(100% - 80px)"}},{default:n(()=>[w("div",G,[o(e(R),{"active-key":p.value,"onUpdate:activeKey":a[0]||(a[0]=i=>p.value=i)},{rightExtra:n(()=>[o(M,{model:e(s).script},null,8,["model"])]),default:n(()=>[o(e(y),{key:"source-code",tab:"Source code"}),f("",!0)]),_:1},8,["active-key"]),p.value==="source-code"?(u(),d(U,{key:0,script:e(s).script,workspace:e(s).workspace},null,8,["script","workspace"])):f("",!0),e(s).script&&p.value==="settings"?(u(),d(z,{key:1,script:e(s).script},null,8,["script"])):f("",!0)]),w("div",J,[o(e(R),{"active-key":r.value,"onUpdate:activeKey":a[1]||(a[1]=i=>r.value=i)},{default:n(()=>[o(e(y),{key:"preview",tab:"Preview"}),o(e(y),{key:"test-data",tab:"Thread data"})]),_:1},8,["active-key"]),e(s).script&&r.value==="preview"?(u(),d(j,{key:0,ref:"tester",script:e(s).script,"log-service":e(_),"stage-run-id":m.value,onUpdateStageRunId:a[2]||(a[2]=i=>m.value=i)},null,8,["script","log-service","stage-run-id"])):f("",!0),r.value==="test-data"?(u(),d(W,{key:1,ref:"stageRunSelector","stage-run-id":m.value,"onUpdate:stageRunId":a[3]||(a[3]=i=>m.value=i),"enable-start-thread":b.value,"onUpdate:enableStartThread":a[4]||(a[4]=i=>b.value=i),stage:e(s).script},null,8,["stage-run-id","enable-start-thread","stage"])):f("",!0)])]),_:1})):f("",!0)]),footer:n(()=>[o($,{runtime:"forms","log-service":e(_)},null,8,["log-service"])]),_:1}))}});export{Fe as default};
//# sourceMappingURL=ScriptEditor.b03cb9e0.js.map
