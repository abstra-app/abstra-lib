import{d as $,r as x,v as H,b as i,c as f,x as a,F as C,L,N as M,W as q,a5 as N,e as n,O as Q,Q as j,q as A,H as X,J as Y,K as Z,z as t,t as k,w as v,D as V,S as ee}from"./registerWidgets.cecc7add.js";import{L as te}from"./CircularLoading.45f7b299.js";import{E as oe}from"./Error.368d18cc.js";import{R as re,F as ae}from"./broker.352d6f95.js";import{R as se,T as le,S as ne,_ as ie,L as ce,a as W}from"./UnsavedChangesHandler.vue_vue_type_script_setup_true_lang.9b100b19.js";import{a as ue}from"./asyncComputed.08fdcc30.js";import{F as me}from"./forms.88a7aa49.js";import{W as de}from"./workspaces.9e1715c9.js";import{B as pe}from"./BackButton.00da8f55.js";import{S as fe}from"./SaveButton.07f1875e.js";import{D as _e}from"./DocsButton.87316217.js";import{P as ve}from"./PreviewButton.de40589e.js";import"./lottie.79ce2fdf.js";import"./passwordlessManager.8b0c672e.js";import"./pubsub.a43e35aa.js";import"./Passwordless.0943eeec.js";import"./icons.a47594f6.js";import"./executeJs.5aff51e5.js";import"./PlayerNavbar.208ad882.js";import"./index.a0dcefc8.js";import"./Steps.5d7ea3ec.js";import"./Modal.4485a18b.js";import"./WidgetsFrame.bbded71d.js";import"./ActionButton.vue_vue_type_script_setup_true_lang.bfc19705.js";import"./dashes.fe46ea3e.js";import"./activeRecord.2a9ab687.js";import"./runnerData.fab8bd8b.js";import"./hooks.f8fb2fa8.js";import"./jobs.ca343ddb.js";import"./uuid.dbda6006.js";(function(){try{var s=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},d=new Error().stack;d&&(s._sentryDebugIds=s._sentryDebugIds||{},s._sentryDebugIds[d]="ad931eea-d2dc-47e5-bc7a-641a1ce717cf",s._sentryDebugIdIdentifier="sentry-dbid-ad931eea-d2dc-47e5-bc7a-641a1ce717cf")}catch{}})();const ye="forms_workspace_id_path_key",U=s=>(Q("data-v-7f776cc2"),s=s(),j(),s),he={class:"form-settings"},ge={class:"content"},be={class:"subsection-label"},ke={class:"property-label"},we=["value","onChange"],Se={class:"content"},xe={class:"property"},Ce=U(()=>a("div",{class:"property-label"},"Start smart form automatically",-1)),Ee={class:"property"},Fe=U(()=>a("div",{class:"property-label"},"Allow the user to restart the smart form after it is over",-1)),Re="This path is already being used by another form or dash on your workspace",Be=$({__name:"FormSettings",props:{form:{}},setup(s){const o=x(s.form),y=[{label:"General",props:[{label:"Form name",valueKey:"title"}]},{label:"Welcome Screen",props:[{label:"Title",valueKey:"welcomeTitle"},{label:"Subtitle",valueKey:"startMessage"},{label:"Start button text",valueKey:"startButtonText"}]},{label:"Ending Screen",props:[{label:"Title",valueKey:"endMessage"},{label:"Restart button text",valueKey:"restartButtonText"}]},{label:"Alert Messages",props:[{label:"Error message",valueKey:"errorMessage"}]}],h=H({pathError:null,sectionsShown:[!0,!1,!1]}),w=r=>{r.detail.includes(ye)&&(h.pathError=Re)};return addEventListener("hasura-error",w),(r,u)=>(i(),f("div",he,[a("div",ge,[(i(),f(C,null,L(y,l=>a("div",{key:l.label,class:"subsection"},[a("div",be,M(l.label),1),(i(!0),f(C,null,L(l.props,m=>(i(),f("div",{key:m.label,class:"property column"},[a("div",ke,M(m.label),1),a("input",{class:"property-input",type:"text",value:o.value[m.valueKey],onChange:S=>o.value[m.valueKey]=S.target.value},null,40,we)]))),128))])),64))]),a("div",Se,[a("div",xe,[q(a("input",{"onUpdate:modelValue":u[0]||(u[0]=l=>o.value.autoStart=l),class:"checkbox-input",type:"checkbox"},null,512),[[N,o.value.autoStart]]),Ce]),a("div",Ee,[q(a("input",{"onUpdate:modelValue":u[1]||(u[1]=l=>o.value.allowRestart=l),class:"checkbox-input",type:"checkbox"},null,512),[[N,o.value.allowRestart]]),Fe])]),n(se,{runtime:o.value},null,8,["runtime"])]))}});const Ke=A(Be,[["__scopeId","data-v-7f776cc2"]]),Pe={class:"page"},De={key:1,class:"error"},Ie=$({__name:"FormEditor",setup(s){var F,R,B;const d=X(),o=Y(),y=H({fullscreen:!1,rightPanelCollapsed:!1,hasChanges:!1,started:!1});addEventListener("keydown",e=>{(e.ctrlKey||e.metaKey)&&e.key==="s"&&(e.preventDefault(),S())});const h=x(null),{loading:w,result:r,error:u,refetch:l}=ue(()=>Promise.all([de.get(),me.get(o.params.formPath)]).then(([e,b])=>ee({workspace:e,form:b}))),m=x(!1);async function S(){var e;m.value=!0;try{await((e=r.value)==null?void 0:e.form.save())}finally{m.value=!1}}const p=ce.create(),g=Z(()=>re.create({formPath:o.params.formPath}));(F=g.value)==null||F.on("stdout",e=>{p.log({type:"stdout",log:e.log})}),(R=g.value)==null||R.on("stderr",e=>{p.log({type:"stderr",log:e.log})}),(B=g.value)==null||B.onClose(()=>{p.log({type:"stderr",log:"Program closed"})});const z=()=>{p.clear()},E=async()=>{var e;return p.log({type:"restart"}),(e=h.value)==null?void 0:e.run()},G=({path:e,type:b})=>{b==="dash"?d.push({name:"dashEditor",params:{dashPath:e},query:o.query}):(d.push({name:"editor",params:{formPath:e},query:o.query}),l())},J=()=>{y.started=!0},O=()=>{y.started=!1};return(e,b)=>{var K,P,D,I,T;return i(),f(C,null,[a("div",Pe,[t(w)||!((K=t(r))!=null&&K.form)||!((P=t(r))!=null&&P.workspace)?(i(),k(te,{key:0})):t(u)?(i(),f("div",De,[n(oe,{error:t(u),onReload:t(l)},null,8,["error","onReload"])])):(i(),k(le,{key:2},{left:v(()=>[n(pe,{link:"/_editor/forms"})]),right:v(()=>{var c,_;return[n(_e),n(ve,{model:(c=t(r))==null?void 0:c.form},null,8,["model"]),n(fe,{model:(_=t(r))==null?void 0:_.form},null,8,["model"])]}),default:v(()=>[n(W,{title:"Preview"},{default:v(()=>{var c,_;return[n(ae,{ref_key:"runner",ref:h,form:(_=t(r))==null?void 0:_.form.makeRunnerData((c=t(r))==null?void 0:c.workspace),params:t(o).query,"is-preview":!0,"enable-auto-focus":!1,broker:g.value,style:{height:"unset",flex:1,overflow:"hidden"},onNavigate:G,onLogout:E,onExit:O,onStart:J},null,8,["form","params","broker"])]}),_:1}),n(W,{title:"Settings"},{default:v(()=>{var c;return[(c=t(r))!=null&&c.form?(i(),k(Ke,{key:0,form:t(r).form},null,8,["form"])):V("",!0)]}),_:1})]),_:1})),(D=t(r))!=null&&D.form?(i(),k(ne,{key:3,runtime:"forms","log-service":t(p),onRestart:E,onClearTerminal:z},null,8,["log-service"])):V("",!0)]),n(ie,{"has-changes":(T=(I=t(r))==null?void 0:I.form)==null?void 0:T.hasChanges()},null,8,["has-changes"])],64)}}});const ut=A(Ie,[["__scopeId","data-v-8b7849de"]]);export{ut as default};
//# sourceMappingURL=FormEditor.3911b717.js.map
