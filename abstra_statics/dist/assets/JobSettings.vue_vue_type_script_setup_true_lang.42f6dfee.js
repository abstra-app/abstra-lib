import{_ as R}from"./RunButton.vue_vue_type_script_setup_true_lang.72547ed1.js";import{d as B,r as k,b as y,eu as w,f as i,G as N,o as G,F as H,w as s,u as n,ad as $,aA as h,cJ as I,b8 as x,eC as T,c as _,eD as U,bU as J,cu as D,ew as P,H as W}from"./outputWidgets.9f98148b.js";import{h as E}from"./index.5e438c9e.js";import{T as F}from"./dayjs.a9424eab.js";import{A as O}from"./FormItem.70c9de0b.js";import{R as q}from"./SmartConsole.232f627f.js";import{A as L}from"./Title.792df510.js";import{F as z}from"./Base.626eaed0.js";(function(){try{var m=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},v=new Error().stack;v&&(m._sentryDebugIds=m._sentryDebugIds||{},m._sentryDebugIds[v]="79f7e245-3ab2-49a3-b1d8-2aca5915e878",m._sentryDebugIdIdentifier="sentry-dbid-79f7e245-3ab2-49a3-b1d8-2aca5915e878")}catch{}})();const K={style:{width:"100%",display:"flex","justify-content":"center"}},se=B({__name:"JobTester",props:{job:{},logService:{}},setup(m,{expose:v}){const d=m,r=k(!1);async function t(){r.value=!0;try{const{stdout:u,stderr:f}=await d.job.test();d.logService.log({type:"stdout",log:u}),d.logService.log({type:"stderr",log:f})}finally{r.value=!1}}return v({test:t}),(u,f)=>(y(),w("div",K,[i(R,{loading:r.value,style:{"max-width":"350px"},onClick:t},null,8,["loading"])]))}}),Q=()=>[...Array(31).keys()].map(m=>m+1),M={0:"Sunday",1:"Monday",2:"Tuesday",3:"Wednesday",4:"Thursday",5:"Friday",6:"Saturday"},X=["hourly","daily","weekly","monthly"],Y={hourly:{minute:"0",hour:"*",day:"*",month:"*",weekday:"*"},daily:{minute:"0",hour:"6",day:"*",month:"*",weekday:"*"},weekly:{minute:"0",hour:"6",day:"*",month:"*",weekday:"1"},monthly:{minute:"0",hour:"6",day:"1",month:"*",weekday:"*"}},Z=B({__name:"CronEditor",props:{crontab:{}},emits:["changeCrontab","saveCrontab","showAdvancedSettings"],setup(m,{emit:v}){const d=m,r=N(()=>{const a=t.hour,l=t.minute;return E(`${a}:${l}:00`,"HH:mm:ss")});G(()=>{const{hour:a,day:l,weekday:c,month:p,minute:C}=d.crontab;p=="*"&&c==="*"&&l!=="*"&&!o([l,a,C])?u.value="monthly":p==="*"&&l==="*"&&c!=="*"&&!o([c,a,C])?u.value="weekly":l==="*"&&c==="*"&&p==="*"&&a!=="*"&&!o([a,C])?u.value="daily":a=="*"&&l==="*"&&c==="*"&&p==="*"&&!o([C])?u.value="hourly":u.value="custom"});const t=H({minute:d.crontab.minute,hour:d.crontab.hour,day:d.crontab.day,month:d.crontab.month,weekday:d.crontab.weekday}),u=k(""),f=k(1),o=a=>a.some(l=>l.includes("-")||l.includes(",")),b=a=>{t.minute=a.minute,t.hour=a.hour,t.day=a.day,t.month=a.month,t.weekday=a.weekday},g=a=>{f.value=0,u.value=a,b(Y[u.value]),v("changeCrontab",t)},A=a=>{f.value=0,t.minute=a,v("changeCrontab",t)},e=a=>{const l=E(a);t.minute=l.minute().toString(),t.hour=l.hour().toString(),v("changeCrontab",t)},S=a=>{f.value=0;const l=a;t.weekday=l,v("changeCrontab",t)},j=a=>{f.value=0;const l=a;t.day=l,v("changeCrontab",t)};return(a,l)=>(y(),w(x,null,[i(n(O),{title:"Recurrence"},{default:s(()=>[i(n($),{placeholder:"Choose a periodicity",value:u.value,"onUpdate:value":g},{default:s(()=>[h(" > "),i(n(I),{value:"",disabled:"",hidden:""},{default:s(()=>[h("Custom")]),_:1}),(y(!0),w(x,null,T(n(X),(c,p)=>(y(),_(n(I),{key:p,value:c},{default:s(()=>[h(U(c),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),i(n(O),null,{default:s(()=>[u.value==="hourly"?(y(),_(n(J),{key:0,value:t.minute,"onUpdate:value":A},{addonBefore:s(()=>[h(" at ")]),addonAfter:s(()=>[h(" minutes ")]),_:1},8,["value"])):u.value==="daily"?(y(),_(n(D),{key:1},{default:s(()=>[i(n(F),{value:r.value,"show-second":!1,"onUpdate:value":e},null,8,["value"])]),_:1})):u.value==="weekly"?(y(),_(n(D),{key:2},{default:s(()=>[h(" on "),i(n($),{style:{width:"200px"},value:Object.values(n(M))[parseInt(t.weekday)],"onUpdate:value":S},{default:s(()=>[(y(!0),w(x,null,T(n(M),(c,p)=>(y(),_(n(I),{key:p,value:p,selected:c===Object.values(n(M))[parseInt(t.weekday)]},{default:s(()=>[h(U(c),1)]),_:2},1032,["value","selected"]))),128))]),_:1},8,["value"]),h(" at "),i(n(F),{value:r.value,"show-second":!1,"onUpdate:value":e},null,8,["value"])]),_:1})):u.value==="monthly"?(y(),_(n(D),{key:3},{default:s(()=>[h(" on "),i(n($),{value:parseInt(t.day),"onUpdate:value":j},{default:s(()=>[(y(!0),w(x,null,T(n(Q)(),(c,p)=>(y(),_(n(I),{key:p,value:c},{default:s(()=>[h(U(c),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"]),h(" at "),i(n(F),{value:r.value,"show-second":!1,"onUpdate:value":e},null,8,["value"])]),_:1})):P("",!0)]),_:1})],64))}}),re=B({__name:"JobSettings",props:{job:{}},setup(m){const v=m,d=k(!1),r=k(v.job),t=()=>{d.value=!d.value},u=()=>{d.value=!1},f=e=>({weekday:e.split(" ")[4],month:e.split(" ")[3],day:e.split(" ")[2],hour:e.split(" ")[1],minute:e.split(" ")[0]}),o=H(f(r.value.schedule)),b=N(()=>`${o.minute} ${o.hour} ${o.day} ${o.month} ${o.weekday}`),g=e=>{o.minute==e.minute&&o.hour==e.hour&&o.day==e.day&&o.month==e.month&&o.weekday==e.weekday||(o.minute=e.minute,o.hour=e.hour,o.day=e.day,o.month=e.month,o.weekday=e.weekday,r.value.schedule=b.value)},A=e=>{e?(r.value.schedule=e,Object.assign(o,f(e))):r.value.schedule=b.value,u()};return W(()=>r.value.schedule,e=>{g({minute:e.split(" ")[0],hour:e.split(" ")[1],day:e.split(" ")[2],month:e.split(" ")[3],weekday:e.split(" ")[4]})}),(e,S)=>(y(),_(n(z),{class:"schedule-editor",layout:"vertical"},{default:s(()=>[i(n(O),{label:"Name",required:""},{default:s(()=>[i(n(J),{value:r.value.title,"onUpdate:value":S[0]||(S[0]=j=>r.value.title=j)},null,8,["value"])]),_:1}),i(q,{runtime:r.value},null,8,["runtime"]),i(n(L),{level:3},{default:s(()=>[h("Schedule")]),_:1}),i(Z,{class:"recurrence-settings",crontab:o,onChangeCrontab:g,onSaveCrontab:A,onShowAdvancedSettings:t},null,8,["crontab"])]),_:1}))}});export{se as _,re as a};
//# sourceMappingURL=JobSettings.vue_vue_type_script_setup_true_lang.42f6dfee.js.map
