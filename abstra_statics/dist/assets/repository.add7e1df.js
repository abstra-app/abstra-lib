import{d as T,X as F,H as j,b as r,eu as b,dh as de,ew as k,ez as pe,e as P,f as c,eG as X,eR as Me,r as $,c as g,w as i,eB as V,aq as L,eD as x,u as a,cI as xe,aC as N,cA as z,v as q,bf as je,eJ as ge,eC as Y,aG as he,ci as Se,eE as $e,eF as De,eS as Te,bE as H,eI as Fe,I as ze,o as Ue,K as Ve,ad as Ne,cz as Ze}from"./outputWidgets.3d482011.js";import"./workspaces.8795ccb7.js";import{H as qe,J as Be,S as be}from"./scripts.45186330.js";import"./envVars.6c780030.js";import{A as Ke}from"./api.72ad6d78.js";import{z as e}from"./index.cf4c23b9.js";import{F as Je}from"./forms.615e2258.js";import{t as He}from"./ant-design.babc5c50.js";import{A as U}from"./Text.0a5a86fb.js";import{a as We}from"./asyncComputed.c5d12cc0.js";import{A as I}from"./index.a3093d22.js";import{s as ee}from"./metadata.fcc83c00.js";import{A as W}from"./index.5a325334.js";import{f as Ge}from"./index.6f6f3aa4.js";import{A as le}from"./Paragraph.241001da.js";import"./index.1e7deb26.js";import{A as K}from"./Title.ce5cdec3.js";import{T as Qe,A as Xe}from"./index.b84fd7cf.js";import{A as ye,C as fe}from"./CollapsePanel.0497f5a8.js";import{A as Ye}from"./Link.52d93940.js";import{A as et}from"./index.0ac52caf.js";import{A as tt}from"./index.7ab1d98a.js";import{E as at}from"./ExpandOutlined.22af314a.js";import{C as nt,A as ot}from"./Card.42147109.js";import{L as st}from"./LoadingOutlined.ef88b72d.js";import{d as it}from"./vuedraggable.umd.f749c7a9.js";import"./index.557fd4bb.js";import{F as rt,A as lt}from"./Form.316fcaf4.js";import{l as Ae}from"./fetch.1899057a.js";(function(){try{var o=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},t=new Error().stack;t&&(o._sentryDebugIds=o._sentryDebugIds||{},o._sentryDebugIds[t]="80c18f36-73a2-4ff1-8119-a38bbaa7f6fe",o._sentryDebugIdIdentifier="sentry-dbid-80c18f36-73a2-4ff1-8119-a38bbaa7f6fe")}catch{}})();var ct={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zM641.7 520.8L442.3 677.6c-7.4 5.8-18.3.6-18.3-8.8V355.3c0-9.4 10.9-14.7 18.3-8.8l199.4 156.7a11.2 11.2 0 010 17.6z"}}]},name:"play-square",theme:"filled"};const ut=ct;var mt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M168 504.2c1-43.7 10-86.1 26.9-126 17.3-41 42.1-77.7 73.7-109.4S337 212.3 378 195c42.4-17.9 87.4-27 133.9-27s91.5 9.1 133.8 27A341.5 341.5 0 01755 268.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.7 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c0-6.7-7.7-10.5-12.9-6.3l-56.4 44.1C765.8 155.1 646.2 92 511.8 92 282.7 92 96.3 275.6 92 503.8a8 8 0 008 8.2h60c4.4 0 7.9-3.5 8-7.8zm756 7.8h-60c-4.4 0-7.9 3.5-8 7.8-1 43.7-10 86.1-26.9 126-17.3 41-42.1 77.8-73.7 109.4A342.45 342.45 0 01512.1 856a342.24 342.24 0 01-243.2-100.8c-9.9-9.9-19.2-20.4-27.8-31.4l60.2-47a8 8 0 00-3-14.1l-175.7-43c-5-1.2-9.9 2.6-9.9 7.7l-.7 181c0 6.7 7.7 10.5 12.9 6.3l56.4-44.1C258.2 868.9 377.8 932 512.2 932c229.2 0 415.5-183.7 419.8-411.8a8 8 0 00-8-8.2z"}}]},name:"sync",theme:"outlined"};const dt=mt,pt=["width","height","fill","transform"],gt={key:0},ht=P("path",{d:"M228,64a36,36,0,1,0-48,33.94V104a12,12,0,0,1-12,12H88a12,12,0,0,1-12-12V97.94a36,36,0,1,0-24,0V104a36,36,0,0,0,36,36h28v18.06a36,36,0,1,0,24,0V140h28a36,36,0,0,0,36-36V97.94A36.07,36.07,0,0,0,228,64ZM64,52A12,12,0,1,1,52,64,12,12,0,0,1,64,52Zm64,152a12,12,0,1,1,12-12A12,12,0,0,1,128,204ZM192,76a12,12,0,1,1,12-12A12,12,0,0,1,192,76Z"},null,-1),St=[ht],bt={key:1},yt=P("path",{d:"M88,64A24,24,0,1,1,64,40,24,24,0,0,1,88,64ZM192,40a24,24,0,1,0,24,24A24,24,0,0,0,192,40Z",opacity:"0.2"},null,-1),ft=P("path",{d:"M224,64a32,32,0,1,0-40,31v9a16,16,0,0,1-16,16H88a16,16,0,0,1-16-16V95a32,32,0,1,0-16,0v9a32,32,0,0,0,32,32h32v25a32,32,0,1,0,16,0V136h32a32,32,0,0,0,32-32V95A32.06,32.06,0,0,0,224,64ZM48,64A16,16,0,1,1,64,80,16,16,0,0,1,48,64Zm96,128a16,16,0,1,1-16-16A16,16,0,0,1,144,192ZM192,80a16,16,0,1,1,16-16A16,16,0,0,1,192,80Z"},null,-1),At=[yt,ft],Ct={key:2},vt=P("path",{d:"M224,64a32,32,0,1,0-40,31v9a16,16,0,0,1-16,16H88a16,16,0,0,1-16-16V95a32,32,0,1,0-16,0v9a32,32,0,0,0,32,32h32v25a32,32,0,1,0,16,0V136h32a32,32,0,0,0,32-32V95A32.06,32.06,0,0,0,224,64ZM144,192a16,16,0,1,1-16-16A16,16,0,0,1,144,192Z"},null,-1),_t=[vt],Rt={key:3},Lt=P("path",{d:"M222,64a30,30,0,1,0-36,29.4V104a18,18,0,0,1-18,18H88a18,18,0,0,1-18-18V93.4a30,30,0,1,0-12,0V104a30,30,0,0,0,30,30h34v28.6a30,30,0,1,0,12,0V134h34a30,30,0,0,0,30-30V93.4A30.05,30.05,0,0,0,222,64ZM46,64A18,18,0,1,1,64,82,18,18,0,0,1,46,64ZM146,192a18,18,0,1,1-18-18A18,18,0,0,1,146,192ZM192,82a18,18,0,1,1,18-18A18,18,0,0,1,192,82Z"},null,-1),Pt=[Lt],Et={key:4},wt=P("path",{d:"M224,64a32,32,0,1,0-40,31v9a16,16,0,0,1-16,16H88a16,16,0,0,1-16-16V95a32,32,0,1,0-16,0v9a32,32,0,0,0,32,32h32v25a32,32,0,1,0,16,0V136h32a32,32,0,0,0,32-32V95A32.06,32.06,0,0,0,224,64ZM48,64A16,16,0,1,1,64,80,16,16,0,0,1,48,64Zm96,128a16,16,0,1,1-16-16A16,16,0,0,1,144,192ZM192,80a16,16,0,1,1,16-16A16,16,0,0,1,192,80Z"},null,-1),Ot=[wt],kt={key:5},It=P("path",{d:"M220,64a28,28,0,1,0-32,27.71V104a20,20,0,0,1-20,20H88a20,20,0,0,1-20-20V91.71a28,28,0,1,0-8,0V104a28,28,0,0,0,28,28h36v32.29a28,28,0,1,0,8,0V132h36a28,28,0,0,0,28-28V91.71A28,28,0,0,0,220,64ZM44,64A20,20,0,1,1,64,84,20,20,0,0,1,44,64ZM148,192a20,20,0,1,1-20-20A20,20,0,0,1,148,192ZM192,84a20,20,0,1,1,20-20A20,20,0,0,1,192,84Z"},null,-1),Mt=[It],xt={name:"PhGitFork"},jt=T({...xt,props:{weight:{type:String},size:{type:[String,Number]},color:{type:String},mirrored:{type:Boolean}},setup(o){const t=o,n=F("weight","regular"),l=F("size","1em"),s=F("color","currentColor"),u=F("mirrored",!1),d=j(()=>{var m;return(m=t.weight)!=null?m:n}),p=j(()=>{var m;return(m=t.size)!=null?m:l}),R=j(()=>{var m;return(m=t.color)!=null?m:s}),A=j(()=>t.mirrored!==void 0?t.mirrored?"scale(-1, 1)":void 0:u?"scale(-1, 1)":void 0);return(m,h)=>(r(),b("svg",pe({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256",width:p.value,height:p.value,fill:R.value,transform:A.value},m.$attrs),[de(m.$slots,"default"),d.value==="bold"?(r(),b("g",gt,St)):d.value==="duotone"?(r(),b("g",bt,At)):d.value==="fill"?(r(),b("g",Ct,_t)):d.value==="light"?(r(),b("g",Rt,Pt)):d.value==="regular"?(r(),b("g",Et,Ot)):d.value==="thin"?(r(),b("g",kt,Mt)):k("",!0)],16,pt))}}),$t=["width","height","fill","transform"],Dt={key:0},Tt=P("path",{d:"M144,180a16,16,0,1,1-16-16A16,16,0,0,1,144,180Zm92-52A108,108,0,1,1,128,20,108.12,108.12,0,0,1,236,128Zm-24,0a84,84,0,1,0-84,84A84.09,84.09,0,0,0,212,128ZM128,64c-24.26,0-44,17.94-44,40v4a12,12,0,0,0,24,0v-4c0-8.82,9-16,20-16s20,7.18,20,16-9,16-20,16a12,12,0,0,0-12,12v8a12,12,0,0,0,23.73,2.56C158.31,137.88,172,122.37,172,104,172,81.94,152.26,64,128,64Z"},null,-1),Ft=[Tt],zt={key:1},Ut=P("path",{d:"M224,128a96,96,0,1,1-96-96A96,96,0,0,1,224,128Z",opacity:"0.2"},null,-1),Vt=P("path",{d:"M140,180a12,12,0,1,1-12-12A12,12,0,0,1,140,180ZM128,72c-22.06,0-40,16.15-40,36v4a8,8,0,0,0,16,0v-4c0-11,10.77-20,24-20s24,9,24,20-10.77,20-24,20a8,8,0,0,0-8,8v8a8,8,0,0,0,16,0v-.72c18.24-3.35,32-17.9,32-35.28C168,88.15,150.06,72,128,72Zm104,56A104,104,0,1,1,128,24,104.11,104.11,0,0,1,232,128Zm-16,0a88,88,0,1,0-88,88A88.1,88.1,0,0,0,216,128Z"},null,-1),Nt=[Ut,Vt],Zt={key:2},qt=P("path",{d:"M128,24A104,104,0,1,0,232,128,104.11,104.11,0,0,0,128,24Zm0,168a12,12,0,1,1,12-12A12,12,0,0,1,128,192Zm8-48.72V144a8,8,0,0,1-16,0v-8a8,8,0,0,1,8-8c13.23,0,24-9,24-20s-10.77-20-24-20-24,9-24,20v4a8,8,0,0,1-16,0v-4c0-19.85,17.94-36,40-36s40,16.15,40,36C168,125.38,154.24,139.93,136,143.28Z"},null,-1),Bt=[qt],Kt={key:3},Jt=P("path",{d:"M138,180a10,10,0,1,1-10-10A10,10,0,0,1,138,180ZM128,74c-21,0-38,15.25-38,34v4a6,6,0,0,0,12,0v-4c0-12.13,11.66-22,26-22s26,9.87,26,22-11.66,22-26,22a6,6,0,0,0-6,6v8a6,6,0,0,0,12,0v-2.42c18.11-2.58,32-16.66,32-33.58C166,89.25,149,74,128,74Zm102,54A102,102,0,1,1,128,26,102.12,102.12,0,0,1,230,128Zm-12,0a90,90,0,1,0-90,90A90.1,90.1,0,0,0,218,128Z"},null,-1),Ht=[Jt],Wt={key:4},Gt=P("path",{d:"M140,180a12,12,0,1,1-12-12A12,12,0,0,1,140,180ZM128,72c-22.06,0-40,16.15-40,36v4a8,8,0,0,0,16,0v-4c0-11,10.77-20,24-20s24,9,24,20-10.77,20-24,20a8,8,0,0,0-8,8v8a8,8,0,0,0,16,0v-.72c18.24-3.35,32-17.9,32-35.28C168,88.15,150.06,72,128,72Zm104,56A104,104,0,1,1,128,24,104.11,104.11,0,0,1,232,128Zm-16,0a88,88,0,1,0-88,88A88.1,88.1,0,0,0,216,128Z"},null,-1),Qt=[Gt],Xt={key:5},Yt=P("path",{d:"M136,180a8,8,0,1,1-8-8A8,8,0,0,1,136,180ZM128,76c-19.85,0-36,14.36-36,32v4a4,4,0,0,0,8,0v-4c0-13.23,12.56-24,28-24s28,10.77,28,24-12.56,24-28,24a4,4,0,0,0-4,4v8a4,4,0,0,0,8,0v-4.2c18-1.77,32-15.36,32-31.8C164,90.36,147.85,76,128,76Zm100,52A100,100,0,1,1,128,28,100.11,100.11,0,0,1,228,128Zm-8,0a92,92,0,1,0-92,92A92.1,92.1,0,0,0,220,128Z"},null,-1),ea=[Yt],ta={name:"PhQuestion"},aa=T({...ta,props:{weight:{type:String},size:{type:[String,Number]},color:{type:String},mirrored:{type:Boolean}},setup(o){const t=o,n=F("weight","regular"),l=F("size","1em"),s=F("color","currentColor"),u=F("mirrored",!1),d=j(()=>{var m;return(m=t.weight)!=null?m:n}),p=j(()=>{var m;return(m=t.size)!=null?m:l}),R=j(()=>{var m;return(m=t.color)!=null?m:s}),A=j(()=>t.mirrored!==void 0?t.mirrored?"scale(-1, 1)":void 0:u?"scale(-1, 1)":void 0);return(m,h)=>(r(),b("svg",pe({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256",width:p.value,height:p.value,fill:R.value,transform:A.value},m.$attrs),[de(m.$slots,"default"),d.value==="bold"?(r(),b("g",Dt,Ft)):d.value==="duotone"?(r(),b("g",zt,Nt)):d.value==="fill"?(r(),b("g",Zt,Bt)):d.value==="light"?(r(),b("g",Kt,Ht)):d.value==="regular"?(r(),b("g",Wt,Qt)):d.value==="thin"?(r(),b("g",Xt,ea)):k("",!0)],16,$t))}});function ce(o){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?Object(arguments[t]):{},l=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(l=l.concat(Object.getOwnPropertySymbols(n).filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable}))),l.forEach(function(s){na(o,s,n[s])})}return o}function na(o,t,n){return t in o?Object.defineProperty(o,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):o[t]=n,o}var te=function(t,n){var l=ce({},t,n.attrs);return c(X,ce({},l,{icon:Me}),null)};te.displayName="EyeInvisibleOutlined";te.inheritAttrs=!1;const oa=te;function ue(o){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?Object(arguments[t]):{},l=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(l=l.concat(Object.getOwnPropertySymbols(n).filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable}))),l.forEach(function(s){sa(o,s,n[s])})}return o}function sa(o,t,n){return t in o?Object.defineProperty(o,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):o[t]=n,o}var ae=function(t,n){var l=ue({},t,n.attrs);return c(X,ue({},l,{icon:ut}),null)};ae.displayName="PlaySquareFilled";ae.inheritAttrs=!1;const ia=ae;function me(o){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?Object(arguments[t]):{},l=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(l=l.concat(Object.getOwnPropertySymbols(n).filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable}))),l.forEach(function(s){ra(o,s,n[s])})}return o}function ra(o,t,n){return t in o?Object.defineProperty(o,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):o[t]=n,o}var ne=function(t,n){var l=me({},t,n.attrs);return c(X,me({},l,{icon:dt}),null)};ne.displayName="SyncOutlined";ne.inheritAttrs=!1;const la=ne;function ca(){const o=$({state:"closed"});function t(){o.value={state:"closed"}}function n(){o.value={state:"visualizations"}}function l(u,d){o.value={state:"stage-run",stageRun:d}}const s=j(()=>"stageRun"in o.value?o.value.stageRun:null);return{closeDrawer:t,openVisualizationEditor:n,inspectStageRun:l,drawerState:o,selectedStageRunForDrawer:s}}const ua=e.boolean(),ma=e.boolean(),da=e.boolean(),pa=e.boolean();e.object({PROJECT_LIVE:ua.optional(),ALLOW_RELEASE:ma.optional(),CONNECTORS_CONSOLE:da.optional(),DUPLICATE_PROJECTS:pa.optional()});const ga=e.string(),ha=e.string(),Sa=e.string(),ba=e.string(),ya=e.string();e.object({plan:ga.optional(),expires:ha.optional(),message:Sa.optional(),messageLink:ba.optional(),messageCTA:ya.optional()});const fa=e.string(),Ce=e.string(),oe=e.string(),Aa=e.string(),Ca=e.string(),va=e.object({id:fa,name:Ce,description:oe.optional(),projectId:Aa,createdAt:Ca}),_a=e.string(),Ra=e.string(),La=e.string(),Pa=e.string(),Ea=e.string().regex(new RegExp("^[0-9]+m$")),wa=e.string().regex(new RegExp("^[0-9]+m$")),Oa=e.string().regex(new RegExp("^[0-9]+Mi$")),ka=e.string().regex(new RegExp("^[0-9]+Mi$")),Ia=e.string().regex(new RegExp("^[0-9]+$")),Ma=e.string().regex(new RegExp("^[0-9]+$")),xa=e.enum(["shared","clickbus","test"]),ja=e.object({requestsCPU:Ea.optional(),limitsCPU:wa.optional(),requestsMemory:Oa.optional(),limitsMemory:ka.optional(),minReplicas:Ia.optional(),timeoutSeconds:Ma.optional(),workerType:xa.optional()});e.object({id:_a,name:Ra,subdomain:La,organizationId:Pa,deploymentResources:ja.optional()});const $a=e.string(),Da=e.string(),ve=e.array(Da),_e=e.string(),Ta=e.string();e.object({id:$a,emailPatterns:ve,projectId:_e,createdAt:Ta});const Fa=e.string().regex(new RegExp("^[0-9]+m$")),za=e.string().regex(new RegExp("^[0-9]+m$")),Ua=e.string().regex(new RegExp("^[0-9]+Mi$")),Va=e.string().regex(new RegExp("^[0-9]+Mi$")),Na=e.string().regex(new RegExp("^[0-9]+$")),Za=e.string().regex(new RegExp("^[0-9]+$")),qa=e.enum(["shared","clickbus","test"]);e.object({requestsCPU:Fa.optional(),limitsCPU:za.optional(),requestsMemory:Ua.optional(),limitsMemory:Va.optional(),minReplicas:Na.optional(),timeoutSeconds:Za.optional(),workerType:qa.optional()});const Ba=e.string(),G=e.string().email(),Ka=e.string(),se=e.array(Ka),Ja=e.string(),Ha=e.string(),Wa=e.object({id:Ba,email:G,roles:se,projectId:Ja,createdAt:Ha}),Re=e.string(),Le=e.string(),Ga=e.boolean(),Qa=e.boolean(),Xa=e.boolean(),Ya=e.boolean(),Pe=e.object({PROJECT_LIVE:Ga,ALLOW_RELEASE:Qa,CONNECTORS_CONSOLE:Xa,DUPLICATE_PROJECTS:Ya}),en=e.string(),tn=e.string(),an=e.string(),nn=e.string(),on=e.string(),Ee=e.object({plan:en.optional(),expires:tn.optional(),message:an.optional(),messageLink:nn.optional(),messageCTA:on.optional()}),sn=e.string().regex(new RegExp("^[0-9]+m$")),rn=e.string().regex(new RegExp("^[0-9]+m$")),ln=e.string().regex(new RegExp("^[0-9]+Mi$")),cn=e.string().regex(new RegExp("^[0-9]+Mi$")),un=e.string().regex(new RegExp("^[0-9]+$")),mn=e.string().regex(new RegExp("^[0-9]+$")),dn=e.enum(["shared","clickbus","test"]),pn=e.object({requestsCPU:sn.optional(),limitsCPU:rn.optional(),requestsMemory:ln.optional(),limitsMemory:cn.optional(),minReplicas:un.optional(),timeoutSeconds:mn.optional(),workerType:dn.optional()}),gn=e.string(),hn=e.array(gn),Sn=e.object({whitelistPatterns:hn.optional()});e.object({id:Re,name:Le,featureFlags:Pe,billingMetadata:Ee,deploymentResources:pn.optional(),membershipsMetadata:Sn.optional()});const bn=e.string(),yn=e.array(bn);e.object({whitelistPatterns:yn.optional()});const fn=Re,An=Le,Cn=Pe,vn=Ee;e.object({id:fn,name:An,featureFlags:Cn,billingMetadata:vn});const _n=oe;e.object({description:_n});const Rn=e.number(),Ln=e.number();e.object({offset:Rn.optional(),limit:Ln.optional()});const Pn=va;e.array(Pn);const En=Ce,wn=oe;e.object({name:En,description:wn.optional()});const On=G,kn=se;e.object({email:On.optional(),roles:kn.optional()});const In=e.number(),Mn=e.number();e.object({offset:In.optional(),limit:Mn.optional()});const xn=Wa;e.array(xn);const jn=G,$n=se;e.object({email:jn,roles:$n});const Dn=ve;e.object({emailPatterns:Dn});const Tn=_e;e.object({projectId:Tn});const Fn=e.boolean();e.object({shouldBeOnboarded:Fn.optional()});const zn=e.string(),Un=e.string(),Vn=e.string(),Nn=e.string();e.object({name:zn.optional(),companyName:Un.optional(),source:Vn.optional(),authorEmail:Nn.optional()});const Zn=e.string(),qn=e.record(e.any()),Bn=e.string(),Kn=e.object({key:Zn,value:qn,type:Bn}),Jn=Kn,Hn=e.array(Jn),Wn=e.string(),Gn=e.enum(["text","image","table","progress-bar"]),Qn=e.object({name:Wn,type:Gn}),Xn=e.string(),Yn=e.string(),eo=e.record(e.any()),we=e.enum(["waiting","running","processing","finished","failed","abandoned"]),to=["waiting","running","processing","finished","failed","abandoned"],ao=e.string(),no=e.string(),oo=e.string(),so=e.string();e.object({id:Xn,stage:Yn,data:eo,status:we,created_at:ao,updated_at:no,parent_id:oo.optional(),execution_id:so.optional()});const io=e.string(),ro=e.string(),lo=e.string(),co=e.string(),uo=we,mo=Hn,po=e.string(),go=e.object({id:io,created_at:ro,updated_at:lo.optional(),assignee:co.optional(),status:uo,content:mo,stage:po.optional()}),ho=go,Oe=e.array(ho),So=e.string(),bo=e.enum(["form","hook","job","script","iterator","condition"]),yo=e.string(),fo=e.string(),Ao=e.boolean(),ke=e.object({id:So,type:bo,title:yo,path:fo.optional(),can_be_started:Ao}),Co=ke,vo=Oe,_o=e.number(),Ro=e.boolean(),Lo=e.object({selected_stage:Co,stage_run_cards:vo,total_count:_o,loading:Ro.optional()}),Po=Lo,Eo=e.array(Po),wo=Eo;e.object({columns:wo});const Oo=Oe,ko=e.string(),Io=e.array(ko),Mo=e.number();e.object({stage_run_cards:Oo,not_found_stages:Io,total_count:Mo});const xo=Qn;e.array(xo);const jo=ke;e.array(jo);const $o=e.string(),Do=e.string(),To=e.literal("bug"),Fo=e.string(),zo=e.string(),Uo=e.string(),Vo=e.object({name:zo,label:Uo}),No=Vo,Zo=e.array(No),qo=e.object({label:Fo,fixes:Zo}),Bo=qo,Ko=e.array(Bo),Jo=e.object({name:$o,label:Do,type:To,issues:Ko}),Ho=e.boolean();e.object({success:Ho});const Wo=Jo;e.array(Wo);const Go=e.string(),Qo=e.string(),Xo=e.object({key:Go,value:Qo}),Yo=Xo;e.array(Yo);const es=G;e.object({email:es});const ts=e.enum(["ALLOWED","UNAUTHORIZED","FORBIDEN"]);e.object({status:ts});function ie(o){switch(o.status){case"waiting":return{color:"blue",text:"Waiting"};case"running":case"processing":return{color:"processing",text:"Running"};case"finished":return{color:"success",text:"Success"};case"failed":return{color:"error",text:"Failed"};case"abandoned":return{color:"warning",text:"Abandoned"}}}const as=10,ns=[...to].filter(o=>o!=="processing"),os=()=>{const o=$([]),t=$({}),n=$(""),l=$([]),s=$(as),u=$(0),d=()=>({status:o.value,data:t.value,search:n.value,stage:l.value});return{stageIds:l,filterStatus:o,filterData:t,filterSearch:n,limit:s,offset:u,filterFactory:d,labelOption:A=>ie({status:A}).text,requestDataFactory:()=>({filter:d(),limit:s.value,offset:u.value})}},J="kanban-selected-stage-ids",ss=({storage:o})=>{const t=$([]),n=$([]),l=j(()=>t.value.filter(m=>!n.value.map(h=>h.stage.id).includes(m.id))),s=async()=>await Promise.all([Je.list(),qe.list(),Be.list(),be.list()]).then(([m,h,_,M])=>[...m,...h,..._,...M].map(w=>({title:w.title,id:w.id,type:w.type,can_be_started:!!(w.type==="job"||w.type==="form"&&w.isInitial),path:w.type==="form"?w.path:void 0}))),u=async()=>{n.value=[]},d=m=>{n.value=n.value.filter(h=>h.stage.id!==m),o.set(J,n.value.map(h=>h.stage).filter(h=>h.id!==m))},p=async(m,h)=>{if(m)n.value=[...n.value.slice(0,h),{stage:m,limit:Z,offset:0},...n.value.slice(h+1)];else{const _=n.value[h].stage;return n.value=[...n.value.slice(0,h),...n.value.slice(h+1)],_}return await o.set(J,n.value.map(_=>_.stage)),m};return{setup:async()=>{const m=await o.get(J)||[];n.value=m.map(h=>({stage:h,limit:Z,offset:0})),t.value=await s()},allStages:t,selectedStages:n,nonSelectedStages:l,clearSelection:u,unselect:d,setStage:p,reorderStages:async m=>{const h=n.value[m.moved.oldIndex];p(null,m.moved.oldIndex),n.value=[...n.value.slice(0,m.moved.newIndex),h,...n.value.slice(m.moved.newIndex)],await o.set(J,n.value.map(_=>_.stage))}}},Z=10,is=1e3,rs=({kanbanRepository:o,storage:t,router:n})=>{const l=os(),s=ss({storage:t}),u=$({columns:[],next_stage_options:[]}),d=async()=>{var y;try{const v=s.selectedStages.value.map(O=>(l.stageIds.value=[O.stage.id],o.getData(l.requestDataFactory()))),S={columns:[]},C=new Set,E=await Promise.all(v);for(const O in v){S.columns.push({stage_run_cards:(y=E[O].stage_run_cards)!=null?y:[],selected_stage:s.selectedStages.value[O].stage,total_count:E[O].total_count,loading:!1});for(const D of E[O].not_found_stages)C.add(D)}const f=Array.from(C);for(const O of f)s.unselect(O);return{columns:S.columns,next_stage_options:s.nonSelectedStages.value}}catch{return s.clearSelection(),{columns:[],next_stage_options:[]}}};function p(y){const v=y.selected_stage.id,S=s.selectedStages.value.find(C=>C.stage.id===v);return S!=null&&S.limit?S.limit<y.total_count:!1}async function R(y){var S;const v=s.selectedStages.value.find(C=>C.stage.id===y.selected_stage.id);v&&(v.limit=((S=v.limit)!=null?S:0)+Z,u.value=await d())}async function A(y){const v=s.selectedStages.value.find(S=>S.stage.id===y);v&&v.limit&&v.limit>Z&&(v.limit-=Z,u.value=await d())}async function m(y,v){const S=await s.setStage(y,v);if(y===null){u.value.columns=u.value.columns.filter(O=>O.selected_stage.id!==S.id);const C=s.allStages.value,E=C.findIndex(O=>O.id===S.id);let f=0;for(const O of u.value.next_stage_options)C.findIndex(Ie=>Ie.id===O.id)<E&&f++;u.value.next_stage_options=[...u.value.next_stage_options.slice(0,f),S,...u.value.next_stage_options.slice(f)]}}async function h(y){var S;if(await s.setStage(y,s.selectedStages.value.length),!y)return;u.value.columns.push({stage_run_cards:[],selected_stage:y,total_count:0,loading:!0}),l.stageIds.value=[y.id];const v=await o.getData(l.requestDataFactory());u.value.columns[u.value.columns.length-1].loading=!1,u.value.columns[u.value.columns.length-1].stage_run_cards=(S=v.stage_run_cards)!=null?S:[],u.value.next_stage_options=s.nonSelectedStages.value}async function _(y){await s.reorderStages(y)}let M=null;return{kanbanState:u,increasePagination:R,hasPagination:p,seeLess:A,setStage:m,addStage:h,cardActionHandler:async(y,v)=>{const S=y.selected_stage,C=v.id;if(S.type==="script"){const E=await be.get(S.id);if(!E)return;await E.run(C)}if(S.type==="form"){const E=n.resolve({path:`/${S.path}`,query:C?{[Ke]:C}:{}});window.open(E.href,C)}},setup:async()=>{await s.setup(),u.value=await d(),M=setInterval(async()=>{u.value=await d()},is)},tearDown:()=>{M&&clearInterval(M)},reorderStages:_,filterController:l}},Q=T({__name:"StageRunData",props:{data:{}},setup(o){return(t,n)=>(r(),g(a(z),{direction:"vertical",style:{overflow:"hidden"}},{default:i(()=>[(r(!0),b(N,null,V(t.data,l=>(r(),b("div",{key:l.key},[c(a(U),{strong:""},{default:i(()=>[L(x(l.key),1)]),_:2},1024),c(a(xe),{"tree-data":a(He)(l.value),selectable:!1},null,8,["tree-data"])]))),128))]),_:1}))}}),ls={key:0},cs={key:1,class:"terminal"},us=T({__name:"ExecutionInspector",props:{logs:{}},setup(o){return(t,n)=>t.logs.length===0?(r(),b("span",ls)):(r(),b("div",cs,[c(a(I),{vertical:""},{default:i(()=>[(r(!0),b(N,null,V(t.logs,l=>(r(),b("pre",{key:l.executionId,class:"log-text"},x(l.payload.text),1))),128))]),_:1})]))}});const ms=q(us,[["__scopeId","data-v-4e71a195"]]),ds=o=>($e("data-v-b7151dd7"),o=o(),De(),o),ps={key:1},gs={key:1},hs=ds(()=>P("span",null,"[Deleted Stage]",-1)),Ss=["onClick"],bs=T({__name:"StageRunInspector",props:{stageRun:{},kanbanRepository:{},stageRunRepository:{}},emits:["close"],setup(o,{emit:t}){const n=o;function l(p){return Object.entries(p).map(([R,A])=>({key:R,value:A,type:typeof A}))}const{result:s,loading:u}=We(()=>{var p;return n.kanbanRepository.getLogs((p=n.stageRun)==null?void 0:p.id)}),d=(p,R)=>{var A;p.stopPropagation(),(A=n.stageRunRepository)==null||A.fork(R),t("close")};return(p,R)=>(r(),g(a(tt),{open:"",title:"Thread details",size:"large",onClose:R[0]||(R[0]=A=>t("close"))},{extra:i(()=>[c(a(le),null,{default:i(()=>[c(a(W),{style:{"font-weight":"600"}},{default:i(()=>{var A;return[L(x(a(ie)({status:(A=p.stageRun)==null?void 0:A.status}).text),1)]}),_:1}),L(" "+x(a(Ge)(new Date(p.stageRun.created_at),{addSuffix:!0})),1)]),_:1})]),default:i(()=>{var A,m,h;return[(A=p.stageRun)!=null&&A.assignee?(r(),g(a(le),{key:0},{default:i(()=>{var _;return[L(" Assignee: "+x((_=p.stageRun)==null?void 0:_.assignee),1)]}),_:1})):k("",!0),((m=p.stageRun)==null?void 0:m.content)&&((h=p.stageRun)==null?void 0:h.content.length)>0?(r(),b("div",ps,[c(a(K),{level:4},{default:i(()=>[L("Current data")]),_:1}),c(Q,{data:p.stageRun.content},null,8,["data"])])):k("",!0),c(a(K),{level:4,style:{"margin-bottom":"30px"}},{default:i(()=>[L(" Timeline ")]),_:1}),a(u)?(r(),g(a(je),{key:2})):a(s)?(r(),g(a(Qe),{key:3},{default:i(()=>[(r(!0),b(N,null,V(a(s),({stage:_,stage_run:M,logs:w})=>(r(),g(a(Xe),{key:M.id},{default:i(()=>[c(a(fe),{ghost:"","expand-icon-position":"end"},{default:i(()=>[c(a(ye),{class:"panel"},ge({header:i(()=>[_?(r(),g(a(I),{key:0,align:"center",gap:15},{default:i(()=>[(r(),g(Y(a(ee)(_.type)))),w.length?(r(),b("span",gs,x(_.title),1)):(r(),g(a(he),{key:0,placement:"right",title:"No logs"},{default:i(()=>[L(x(_.title),1)]),_:2},1024))]),_:2},1024)):(r(),g(a(I),{key:1,align:"center",gap:15},{default:i(()=>[c(a(aa)),hs]),_:1}))]),default:i(()=>[l(M.data).length||w.length?(r(),g(a(I),{key:0,vertical:""},{default:i(()=>[l(M.data).length?(r(),g(a(I),{key:0,gap:0,vertical:""},{default:i(()=>[c(a(K),{level:5},{default:i(()=>[L(" Output data ")]),_:1}),c(Q,{data:l(M.data)},null,8,["data"])]),_:2},1024)):k("",!0),w.length?(r(),g(a(I),{key:1,vertical:"",gap:0},{default:i(()=>[c(a(et)),c(a(K),{level:5},{default:i(()=>[L(" Logs ")]),_:1}),c(ms,{logs:w},null,8,["logs"])]),_:2},1024)):k("",!0)]),_:2},1024)):(r(),g(a(Se),{key:1,description:"No logs"}))]),_:2},[p.stageRunRepository&&_?{name:"extra",fn:i(()=>[P("span",{onClick:B=>d(B,M.id)},[c(a(I),{gap:"small"},{default:i(()=>[c(a(jt),{size:"22"}),c(a(Ye),null,{default:i(()=>[L("Fork")]),_:1})]),_:1})],8,Ss)]),key:"0"}:void 0]),1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})):k("",!0)]}),_:1}))}});const ys=q(bs,[["__scopeId","data-v-b7151dd7"]]),fs=T({__name:"Card",props:{stage:{},card:{}},emits:["inspect","action"],setup(o){const t=o,n=j(()=>ie({status:t.card.status}).text),l=j(()=>Te(new Date(String(t.card.updated_at))));return(s,u)=>{var d,p;return r(),g(a(nt),{size:"small",style:{cursor:"pointer"},"head-style":{"border-bottom":((d=s.card.content)==null?void 0:d.length)>0?"":"none"},"body-style":{display:((p=s.card.content)==null?void 0:p.length)>0?"block":"none"}},ge({title:i(()=>[c(a(W),null,{default:i(()=>[L(x(n.value)+" ",1),n.value==="Running"?(r(),g(a(la),{key:0,spin:!0,style:{"margin-left":"4px"}})):k("",!0)]),_:1})]),default:i(()=>[c(a(z),{direction:"vertical",style:{"max-height":"300px",width:"100%",overflow:"hidden"},onClick:u[0]||(u[0]=R=>s.$emit("inspect"))},{default:i(()=>[c(Q,{data:s.card.content,disabled:!0},null,8,["data"]),s.card.assignee?(r(),g(a(W),{key:0},{default:i(()=>[L(x(s.card.assignee),1)]),_:1})):k("",!0)]),_:1})]),extra:i(()=>[c(a(I),{gap:"10"},{default:i(()=>[c(a(he),null,{title:i(()=>[L(x(s.card.updated_at),1)]),default:i(()=>[c(a(U),{type:"secondary",style:{"font-size":"12px"}},{default:i(()=>[L(x(l.value),1)]),_:1})]),_:1}),c(a(at),{onClick:u[2]||(u[2]=R=>s.$emit("inspect"))})]),_:1})]),_:2},[s.card.status==="waiting"?{name:"actions",fn:i(()=>[c(a(H),{onClick:u[1]||(u[1]=R=>s.$emit("action"))},{default:i(()=>[c(a(ia)),L(" Continue this thread ")]),_:1})]),key:"0"}:void 0]),1032,["head-style","body-style"])}}});class As{constructor(t,n,l){this.router=t,this.column=n,this.kanbanRepository=l}get stage(){return this.column.selected_stage}get canStart(){return this.stage.can_be_started}get launchLink(){return!this.stage.can_be_started||this.stage.type!=="form"||!this.stage.path?null:this.router.resolve({path:`/${this.stage.path}`}).href}click(){if(this.launchLink)return window.open(this.launchLink,"_blank");if(this.stage.type==="job")return this.kanbanRepository.startJob(this.stage.id).catch(console.error)}}const Cs=T({__name:"Column",props:{router:{},hasPagination:{type:Boolean},column:{},kanbanRepository:{}},emits:["increasePagination","cardAction","stageUpdate","cardInspection"],setup(o,{emit:t}){const n=o,l=j(()=>new As(n.router,n.column,n.kanbanRepository));return(s,u)=>(r(),g(a(z),{direction:"vertical",class:"stage-column"},{default:i(()=>[c(a(z),{direction:"horizontal",style:{width:"100%","justify-content":"space-between"}},{default:i(()=>[c(a(I),{gap:"8",style:{"max-width":"200px","padding-left":"10px"}},{default:i(()=>[c(a(I),null,{default:i(()=>[(r(),g(Y(a(ee)(s.column.selected_stage.type)),{size:"20"}))]),_:1}),c(a(U),{ellipsis:"",content:s.column.selected_stage.title},null,8,["content"])]),_:1}),c(a(z),null,{default:i(()=>[s.column.loading?k("",!0):(r(),g(a(U),{key:0,type:"secondary",style:{"font-size":"small","margin-right":"2px"}},{default:i(()=>[L(x(s.column.total_count),1)]),_:1})),s.column.loading?(r(),g(a(st),{key:1})):k("",!0),c(a(H),{type:"text",style:{padding:"4px"},onClick:u[0]||(u[0]=d=>t("stageUpdate",null))},{default:i(()=>[c(a(U),{type:"secondary",style:{"font-size":"small","margin-right":"2px"}},{default:i(()=>[c(a(oa))]),_:1})]),_:1})]),_:1})]),_:1}),c(a(z),{direction:"vertical",style:{width:"100%"}},{default:i(()=>[c(a(I),{justify:"center",align:"center"},{default:i(()=>[s.column.loading?(r(),g(a(ot),{key:0,active:"",block:"",size:"large",class:"skeleton"})):k("",!0)]),_:1}),!s.column.loading&&s.column.stage_run_cards.length===0?(r(),g(a(Se),{key:0})):k("",!0),(r(!0),b(N,null,V(s.column.stage_run_cards,d=>(r(),g(fs,{key:d.id,stage:s.column.selected_stage,card:d,onInspect:p=>t("cardInspection",d),onAction:p=>t("cardAction",d)},null,8,["stage","card","onInspect","onAction"]))),128)),s.hasPagination?(r(),g(a(H),{key:1,style:{width:"100%"},onClick:u[1]||(u[1]=d=>t("increasePagination"))},{default:i(()=>[L("See more")]),_:1})):k("",!0),l.value.canStart?(r(),g(a(H),{key:2,style:{width:"100%"},onClick:u[2]||(u[2]=()=>l.value.click())},{default:i(()=>[L(" Start new thread ")]),_:1})):k("",!0)]),_:1})]),_:1}))}});const vs=q(Cs,[["__scopeId","data-v-66629fc4"]]),_s=T({__name:"EmptyColumn",props:{stages:{}},emits:["stageUpdate"],setup(o,{emit:t}){const n=l=>{t("stageUpdate",l)};return(l,s)=>(r(),g(a(z),{direction:"vertical"},{default:i(()=>[(r(!0),b(N,null,V(l.stages,u=>(r(),g(a(W),{key:u.id,class:"tag",onClick:d=>n(u)},{default:i(()=>[c(a(I),{gap:"8",style:{"max-width":"200px","justify-content":"center","align-items":"center"}},{default:i(()=>[c(a(I),null,{default:i(()=>[(r(),g(Y(a(ee)(u.type)),{size:"20"}))]),_:2},1024),c(a(U),{ellipsis:"",content:u.title},null,8,["content"])]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1}))}});const Rs=q(_s,[["__scopeId","data-v-08e39e62"]]),Ls={style:{"padding-top":"20px","flex-grow":"1"}},Ps={class:"stages-container"},Es={class:"stages-content"},ws=T({__name:"Kanban",props:{storage:{},kanbanRepository:{},stageRunRepository:{}},setup(o){const t=o,n=Fe(),{closeDrawer:l,inspectStageRun:s,drawerState:u,selectedStageRunForDrawer:d}=ca(),p=C=>{y.value=C},{kanbanState:R,setStage:A,addStage:m,setup:h,tearDown:_,cardActionHandler:M,increasePagination:w,hasPagination:B,reorderStages:re,filterController:{filterStatus:y,labelOption:v}}=rs({kanbanRepository:t.kanbanRepository,storage:t.storage,router:n}),S=$([]);return ze(()=>{var C;return(C=R.value)==null?void 0:C.columns},C=>{C!==void 0&&(S.value=C)}),Ue(h),Ve(_),(C,E)=>(r(),b("div",Ls,[c(a(I),{vertical:"",style:{height:"100%"}},{default:i(()=>[c(a(fe),{ghost:""},{default:i(()=>[c(a(ye),{header:"Filters"},{default:i(()=>[c(a(rt),null,{default:i(()=>[c(a(lt),{label:"Status"},{default:i(()=>[c(a(Ne),{value:a(y),style:{width:"325px"},mode:"multiple","onUpdate:value":E[0]||(E[0]=f=>p(f))},{default:i(()=>[(r(!0),b(N,null,V(a(ns),f=>(r(),g(a(Ze),{key:f,value:f},{default:i(()=>[L(x(a(v)(f)),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1})]),_:1})]),_:1})]),_:1}),P("div",Ps,[P("div",Es,[c(a(z),{align:"start"},{default:i(()=>[c(a(it),{modelValue:S.value,"onUpdate:modelValue":E[1]||(E[1]=f=>S.value=f),class:"draggable","item-key":f=>f.selected_stage.id,"ghost-class":"ghost",onStart:a(_),onEnd:a(h),onChange:a(re)},{item:i(({element:f,index:O})=>[(r(),g(a(vs),{key:f.selected_stage.id,column:f,router:a(n),"has-pagination":a(B)(f),"kanban-repository":t.kanbanRepository,class:"stages-content-column",onIncreasePagination:D=>a(w)(f),onCardInspection:D=>a(s)(f,D),onCardAction:D=>a(M)(f,D),onStageUpdate:D=>a(A)(D,O)},null,8,["column","router","has-pagination","kanban-repository","onIncreasePagination","onCardInspection","onCardAction","onStageUpdate"]))]),_:1},8,["modelValue","item-key","onStart","onEnd","onChange"]),c(a(Rs),{stages:a(R).next_stage_options||[],onStageUpdate:E[2]||(E[2]=f=>a(m)(f))},null,8,["stages"])]),_:1})])])]),_:1}),a(u).state==="stage-run"&&a(d)?(r(),g(a(ys),{key:0,"kanban-repository":t.kanbanRepository,"stage-run":a(d),"stage-run-repository":t.stageRunRepository,onClose:a(l)},null,8,["kanban-repository","stage-run","stage-run-repository","onClose"])):k("",!0)]))}});const oi=q(ws,[["__scopeId","data-v-433bedeb"]]);class si{constructor(t,n=localStorage){this.contextKey=t,this.storage=n}makeKey(t){return`${this.contextKey}:${t}`}async get(t){const n=this.storage.getItem(this.makeKey(t));return n?JSON.parse(n):null}async set(t,n){this.storage.setItem(this.makeKey(t),JSON.stringify(n))}}class ii{constructor(t=Ae){this.fetch=t}async getData(t){return(await this.fetch("/_editor/api/kanban",{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}})).json()}async getLogs(t){return(await this.fetch(`/_editor/api/kanban/logs/${t}`)).json()}async startJob(t){await this.fetch(`/_editor/api/kanban/jobs/${t}/start`,{method:"POST"})}}class ri{constructor(t,n=Ae){this.authProvider=t,this.fetch=n}get headers(){return{"Content-Type":"application/json",...this.authProvider.authHeaders()}}async getData(t){return(await this.fetch("/_kanban/",{method:"POST",body:JSON.stringify(t),headers:this.headers})).json()}async getLogs(t){return(await this.fetch(`/_kanban/logs/${t}`,{headers:this.headers})).json()}async startJob(t){await this.fetch(`/_kanban/jobs/${t}/start`,{method:"POST",headers:this.headers})}}export{ii as E,os as F,oi as K,si as L,ri as P};
//# sourceMappingURL=repository.add7e1df.js.map
