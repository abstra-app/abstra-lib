import{a as de,i as ie,c as K,b as H,e as w,f as Te,g as ge,h as V,m as Me,r as M,s as Ee,H as De,ad as Ae,D as Le,X as Re,Y as Ce,p as $,bp as Ie,u as e,v as me,w as o,j as l,b7 as ue,S as Q,U as G,ak as Pe,ac as ze,k as We,aj as je,ae as m,aJ as we,aK as Y,aL as Ue,b8 as ae,M as Be,W as Oe,K as $e,bm as re,c5 as He,bt as Ze,c6 as ne,bs as _e}from"./jwt-decode.esm-X_JHyrHe.js";import{R as Se,u as Fe,E as Ve,L as Ne}from"./ExecutionContext-CcrPJ-9i.js";import{d as fe,c as q,e as Xe,f as Ye}from"./router-BfX34XLs.js";import{a as qe,b as Ge}from"./build-BBu8uuN_.js";import"./tables-DRvslhiY.js";import{_ as Ke}from"./AbstraButton.vue_vue_type_script_setup_true_lang-BBCNEuoZ.js";import{g as Je}from"./datetime-7sgYCmSw.js";import{S as be}from"./index-D_wdY2um.js";import{T as Qe,A as pe}from"./index-DP71ioDC.js";import{R as xe}from"./dayjs-C8WVXRJl.js";import"./string-DXA1IHkK.js";import"./polling-BCWbcVpw.js";import"./ant-design-BcHu_TfS.js";import"./PhCopy.vue-D4jT_0ke.js";import"./PhRobot.vue-CYXzGMGB.js";import"./ts.worker-BwKuk5mh.js";import"./record-BoeAoZE0.js";(function(){try{var _=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},b=new Error().stack;b&&(_._sentryDebugIds=_._sentryDebugIds||{},_._sentryDebugIds[b]="6c41d891-5e4d-463d-9735-a8ec7d150f8b",_._sentryDebugIdIdentifier="sentry-dbid-6c41d891-5e4d-463d-9735-a8ec7d150f8b")}catch{}})();const et=["width","height","fill","transform"],tt={key:0},at=V("path",{d:"M117.18,188.74a12,12,0,0,1,0,17l-5.12,5.12A58.26,58.26,0,0,1,70.6,228h0A58.62,58.62,0,0,1,29.14,127.92L63.89,93.17a58.64,58.64,0,0,1,98.56,28.11,12,12,0,1,1-23.37,5.44,34.65,34.65,0,0,0-58.22-16.58L46.11,144.89A34.62,34.62,0,0,0,70.57,204h0a34.41,34.41,0,0,0,24.49-10.14l5.11-5.12A12,12,0,0,1,117.18,188.74ZM226.83,45.17a58.65,58.65,0,0,0-82.93,0l-5.11,5.11a12,12,0,0,0,17,17l5.12-5.12a34.63,34.63,0,1,1,49,49L175.1,145.86A34.39,34.39,0,0,1,150.61,156h0a34.63,34.63,0,0,1-33.69-26.72,12,12,0,0,0-23.38,5.44A58.64,58.64,0,0,0,150.56,180h.05a58.28,58.28,0,0,0,41.47-17.17l34.75-34.75a58.62,58.62,0,0,0,0-82.91Z"},null,-1),nt=[at],lt={key:1},ot=V("path",{d:"M218.34,119.6,183.6,154.34a46.58,46.58,0,0,1-44.31,12.26c-.31.34-.62.67-.95,1L103.6,202.34A46.63,46.63,0,1,1,37.66,136.4L72.4,101.66A46.6,46.6,0,0,1,116.71,89.4c.31-.34.62-.67,1-1L152.4,53.66a46.63,46.63,0,0,1,65.94,65.94Z",opacity:"0.2"},null,-1),st=V("path",{d:"M240,88.23a54.43,54.43,0,0,1-16,37L189.25,160a54.27,54.27,0,0,1-38.63,16h-.05A54.63,54.63,0,0,1,96,119.84a8,8,0,0,1,16,.45A38.62,38.62,0,0,0,150.58,160h0a38.39,38.39,0,0,0,27.31-11.31l34.75-34.75a38.63,38.63,0,0,0-54.63-54.63l-11,11A8,8,0,0,1,135.7,59l11-11A54.65,54.65,0,0,1,224,48,54.86,54.86,0,0,1,240,88.23ZM109,185.66l-11,11A38.41,38.41,0,0,1,70.6,208h0a38.63,38.63,0,0,1-27.29-65.94L78,107.31A38.63,38.63,0,0,1,144,135.71a8,8,0,0,0,7.78,8.22H152a8,8,0,0,0,8-7.78A54.86,54.86,0,0,0,144,96a54.65,54.65,0,0,0-77.27,0L32,130.75A54.62,54.62,0,0,0,70.56,224h0a54.28,54.28,0,0,0,38.64-16l11-11A8,8,0,0,0,109,185.66Z"},null,-1),it=[ot,st],rt={key:2},ut=V("path",{d:"M208,32H48A16,16,0,0,0,32,48V208a16,16,0,0,0,16,16H208a16,16,0,0,0,16-16V48A16,16,0,0,0,208,32ZM115.7,192.49a43.31,43.31,0,0,1-55-66.43l25.37-25.37a43.35,43.35,0,0,1,61.25,0,42.9,42.9,0,0,1,9.95,15.43,8,8,0,1,1-15,5.6A27.33,27.33,0,0,0,97.37,112L72,137.37a27.32,27.32,0,0,0,34.68,41.91,8,8,0,1,1,9,13.21Zm79.61-62.55-25.37,25.37A43,43,0,0,1,139.32,168h0a43.35,43.35,0,0,1-40.53-28.12,8,8,0,1,1,15-5.6A27.35,27.35,0,0,0,139.28,152h0a27.14,27.14,0,0,0,19.32-8L184,118.63a27.32,27.32,0,0,0-34.68-41.91,8,8,0,1,1-9-13.21,43.32,43.32,0,0,1,55,66.43Z"},null,-1),dt=[ut],ct={key:3},ft=V("path",{d:"M238,88.18a52.42,52.42,0,0,1-15.4,35.66l-34.75,34.75A52.28,52.28,0,0,1,150.62,174h-.05A52.63,52.63,0,0,1,98,119.9a6,6,0,0,1,6-5.84h.17a6,6,0,0,1,5.83,6.16A40.62,40.62,0,0,0,150.58,162h0a40.4,40.4,0,0,0,28.73-11.9l34.75-34.74A40.63,40.63,0,0,0,156.63,57.9l-11,11a6,6,0,0,1-8.49-8.49l11-11a52.62,52.62,0,0,1,74.43,0A52.83,52.83,0,0,1,238,88.18Zm-127.62,98.9-11,11A40.36,40.36,0,0,1,70.6,210h0a40.63,40.63,0,0,1-28.7-69.36L76.62,105.9A40.63,40.63,0,0,1,146,135.77a6,6,0,0,0,5.83,6.16H152a6,6,0,0,0,6-5.84A52.63,52.63,0,0,0,68.14,97.42L33.38,132.16A52.63,52.63,0,0,0,70.56,222h0a52.26,52.26,0,0,0,37.22-15.42l11-11a6,6,0,1,0-8.49-8.48Z"},null,-1),pt=[ft],gt={key:4},vt=V("path",{d:"M240,88.23a54.43,54.43,0,0,1-16,37L189.25,160a54.27,54.27,0,0,1-38.63,16h-.05A54.63,54.63,0,0,1,96,119.84a8,8,0,0,1,16,.45A38.62,38.62,0,0,0,150.58,160h0a38.39,38.39,0,0,0,27.31-11.31l34.75-34.75a38.63,38.63,0,0,0-54.63-54.63l-11,11A8,8,0,0,1,135.7,59l11-11A54.65,54.65,0,0,1,224,48,54.86,54.86,0,0,1,240,88.23ZM109,185.66l-11,11A38.41,38.41,0,0,1,70.6,208h0a38.63,38.63,0,0,1-27.29-65.94L78,107.31A38.63,38.63,0,0,1,144,135.71a8,8,0,0,0,16,.45A54.86,54.86,0,0,0,144,96a54.65,54.65,0,0,0-77.27,0L32,130.75A54.62,54.62,0,0,0,70.56,224h0a54.28,54.28,0,0,0,38.64-16l11-11A8,8,0,0,0,109,185.66Z"},null,-1),ht=[vt],yt={key:5},mt=V("path",{d:"M236,88.12a50.44,50.44,0,0,1-14.81,34.31l-34.75,34.74A50.33,50.33,0,0,1,150.62,172h-.05A50.63,50.63,0,0,1,100,120a4,4,0,0,1,4-3.89h.11a4,4,0,0,1,3.89,4.11A42.64,42.64,0,0,0,150.58,164h0a42.32,42.32,0,0,0,30.14-12.49l34.75-34.74a42.63,42.63,0,1,0-60.29-60.28l-11,11a4,4,0,0,1-5.66-5.65l11-11A50.64,50.64,0,0,1,236,88.12ZM111.78,188.49l-11,11A42.33,42.33,0,0,1,70.6,212h0a42.63,42.63,0,0,1-30.11-72.77l34.75-34.74A42.63,42.63,0,0,1,148,135.82a4,4,0,0,0,8,.23A50.64,50.64,0,0,0,69.55,98.83L34.8,133.57A50.63,50.63,0,0,0,70.56,220h0a50.33,50.33,0,0,0,35.81-14.83l11-11a4,4,0,1,0-5.65-5.66Z"},null,-1),wt=[mt],_t={name:"PhLink"},bt=de({..._t,props:{weight:{type:String},size:{type:[String,Number]},color:{type:String},mirrored:{type:Boolean}},setup(_){const b=_,A=ie("weight","regular"),B=ie("size","1em"),E=ie("color","currentColor"),Z=ie("mirrored",!1),x=K(()=>b.weight??A),L=K(()=>b.size??B),k=K(()=>b.color??E),I=K(()=>b.mirrored!==void 0?b.mirrored?"scale(-1, 1)":void 0:Z?"scale(-1, 1)":void 0);return(N,v)=>(w(),H("svg",Me({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256",width:L.value,height:L.value,fill:k.value,transform:I.value},N.$attrs),[Te(N.$slots,"default"),x.value==="bold"?(w(),H("g",tt,nt)):x.value==="duotone"?(w(),H("g",lt,it)):x.value==="fill"?(w(),H("g",rt,dt)):x.value==="light"?(w(),H("g",ct,pt)):x.value==="regular"?(w(),H("g",gt,ht)):x.value==="thin"?(w(),H("g",yt,wt)):ge("",!0)],16,et))}}),xt={0:"pending",1:"running",2:"finished",3:"failed"};function ke(_){return new Worker("/assets/timeline.worker-CTtnDIl5.js",{type:"module",name:_?.name})}function kt(){const _=M(!0),b=M(!1),A=M(null),B=M([]),E=M([]),Z=Ee([]),x=new Map,L=M(Date.now()),k=M(Date.now()),I=M(Date.now()-6e4),N=M(null);let v=null,R=null;const n=new Se,D=200,U=K(()=>{const g=(k.value-I.value)/6e4;return g<10?1:g<60?5:g<720?30:g<1440?60:g<1440*7?360:1440}),C=K(()=>{const h=U.value*6e4,S=Math.floor(I.value/h)*h,P=Math.ceil(k.value/h)*h,T=[];for(let z=S;z<=P;z+=h)T.push(new Date(z));return T});function i(g){return x.get(g)}function a(g,h){v||(v=new ke,t()),v.postMessage({type:"initCanvas",payload:{canvas:g,pixelRatio:h}},[g])}function t(){v&&(v.onmessage=g=>{const{buffers:h}=g.data;h&&(Z.value=h)})}function d(g,h,S=!1){if(!v)return;const P=g.map(T=>{const z=T.context,r=z?.sentTasks?[...z.sentTasks]:[];return{id:T.id,stageId:T.stageId,createdAt:T.createdAt.getTime(),updatedAt:T.updatedAt.getTime(),sentTasks:r,triggerTaskId:z?.taskId||void 0,status:T.status,shortId:T.shortId,context:T.context}});v.postMessage({type:"data",payload:{executions:P,tasks:h,reset:S}})}function J(){v&&v.postMessage({type:"stagesList",payload:JSON.parse(JSON.stringify(E.value))})}function X(g){v&&v.postMessage({type:"view",payload:g})}function se(){v&&v.postMessage({type:"view",payload:{now:L.value,viewStart:I.value,viewEnd:k.value,spacerWidth:D,rootId:N.value}})}async function ee(g,h){const S=new Set,P=[h];let T=0;const z=1e3;b.value=!0;const r=new Set;try{for(;P.length>0&&T<z;){const s=P.shift();if(S.has(s))continue;S.add(s),T++;let f=x.get(s);if(f||(f=await n.get(g,s),x.set(f.id,f)),!r.has(f.stageId)){r.add(f.stageId);const u=B.value.filter(O=>r.has(O.id));u.length!==E.value.length&&(E.value=u,J())}const c=await n.getExecutionTasks(g,s),y={};if(c.sentTasks.forEach(u=>{y[u.id]={start:new Date(u.created.at).getTime(),end:u.completed?new Date(u.completed.at).getTime():void 0}}),c.triggerTask){const u=c.triggerTask;y[u.id]={start:new Date(u.created.at).getTime(),end:u.completed?new Date(u.completed.at).getTime():void 0}}if(d([f],y,!1),s===h){const u=f.createdAt.getTime(),O=f.updatedAt.getTime(),p=Math.max(1e3,O-u);I.value=u-p,k.value=O+p,_.value=!1}c.triggerTask&&c.triggerTask.created.byExecutionId&&(S.has(c.triggerTask.created.byExecutionId)||P.push(c.triggerTask.created.byExecutionId)),c.sentTasks.forEach(u=>{u.completed&&u.completed.byExecutionId&&(S.has(u.completed.byExecutionId)||P.push(u.completed.byExecutionId))})}}catch(s){console.error("Error loading thread",s),A.value="Failed to load execution thread."}finally{b.value=!1,_.value=!1}}async function te(g,h){if(_.value=!0,A.value=null,E.value=[],B.value=[],Z.value=[],L.value=Date.now(),x.clear(),!h){A.value="No execution ID provided.",_.value=!1;return}N.value=h,v||(v=new ke,t()),R||(R=setInterval(()=>{L.value=Date.now()},6e4));try{const S=await n.get(g,h);if(x.set(S.id,S),S.buildId){const P=await qe.get(S.buildId);P&&(B.value=P.runtimesSorted)}d([],{},!0),await ee(g,h)}catch(S){A.value="Failed to load data.",console.error(S),_.value=!1}}function ce(){v&&(v.terminate(),v=null),R&&(clearInterval(R),R=null)}return De([E,L,I,k],()=>{se()}),{initialLoading:_,loadingGraph:b,error:A,stages:E,stageBuffers:Z,viewStart:I,viewEnd:k,now:L,timelineInterval:U,moments:C,init:te,cleanup:ce,postDataToWorker:d,initCanvas:a,updateView:X,getExecution:i}}const At={style:{height:"100%","min-height":"400px",position:"relative",overflow:"hidden"}},It={key:2,style:{position:"absolute",top:"10px",right:"220px","z-index":"10","pointer-events":"none"}},j=200,le=32,oe=40,St=de({__name:"TimelineComponent",props:{projectId:{},execution:{}},setup(_){const b=_,A=Ae(),{initialLoading:B,loadingGraph:E,error:Z,stages:x,stageBuffers:L,viewStart:k,viewEnd:I,init:N,cleanup:v,initCanvas:R,updateView:n}=kt(),D=M(null),U=M(null),C=M(0),i=M(null),a=M(!1),t=M(0),d=M(0),J=K(()=>{const r=U.value;if(!r)return 0;const s=r.height/window.devicePixelRatio-le;return Math.max(0,x.value.length*oe-s)});function X(r){if(!D.value)return 0;const s=D.value.clientWidth-j,f=I.value-k.value,c=r-j;return k.value+c/s*f}function se(r){if(!D.value)return 0;const s=D.value.clientWidth-j,f=I.value-k.value,c=r-k.value;return j+c/f*s}function ee(r){if(!U.value)return{x:0,y:0};const s=U.value.getBoundingClientRect();return{x:r.clientX-s.left,y:r.clientY-s.top}}function te(r,s){const f=s-le;if(r>j){const c=X(r),y=f+C.value;if(y>=0){const u=Math.floor(y/oe);if(u>=0&&u<x.value.length){const O=x.value[u],p=L.value.find(F=>F.stageId===O.id);if(p){const F=p.count;for(let W=0;W<F;W++){const ve=p.starts[W],he=p.ends[W];if(c>=ve&&c<=he){const ye=u*oe+(oe-24)/2;if(y>=ye&&y<=ye+24)return{type:"execution",data:{id:p.ids[W],status:xt[p.statuses[W]]||"unknown",start:ve,end:he}}}}}}}}return null}const ce=r=>{const{x:s,y:f}=ee(r),c=f-le+C.value,y=Math.floor(c/oe);if(y>=0&&y<x.value.length&&f>le){const p=x.value[y];i.value!==p.id&&(i.value=p.id,n({hoveredStageId:p.id}))}else i.value!==null&&(i.value=null,n({hoveredStageId:null}));if(a.value){d.value=X(s);const p=se(t.value)-j,F=se(d.value)-j;n({selection:{active:!0,start:p,end:F}})}let u={visible:!1,x:0,label:""},O={visible:!1,x:0,y:0,title:"",items:[]};if(s>j){const p=X(s),F=new Date(p);if(!isNaN(F.getTime())){const W=F.toLocaleString([],{month:"numeric",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit",fractionalSecondDigits:3});u={visible:!0,x:s-j,label:W}}}if(s>j&&f>le){const p=te(s,f);if(p){document.body.style.cursor="pointer";const W=((p.data.end-p.data.start)/1e3).toFixed(3)+" s";O={visible:!0,x:s,y:f,title:p.type==="execution"?"Execution":"Task",items:[`Status: ${p.data.status}`,`ID: ${p.data.id}`,`Duration: ${W}`]}}else document.body.style.cursor="default"}else document.body.style.cursor="default";n({cursor:u,tooltip:O})},g=()=>{n({cursor:{visible:!1,x:0},tooltip:{visible:!1,x:0,y:0},hoveredStageId:null}),i.value=null,document.body.style.cursor="default"},h=r=>{const{x:s,y:f}=ee(r);if(s<=j)return;const c=te(s,f);c&&c.type==="execution"||(a.value=!0,t.value=X(s),d.value=t.value)},S=r=>{const{x:s,y:f}=ee(r);if(a.value){const c=Math.min(t.value,d.value),y=Math.max(t.value,d.value);y-c>100&&(k.value=c,I.value=y),a.value=!1,n({selection:{active:!1,start:0,end:0}})}else{const c=te(s,f);if(c&&c.type==="execution"){const y=A.resolve({name:"logs",params:{projectId:b.projectId},query:{executionId:c.data.id}});window.open(y.href,"_blank")}}},P=r=>{if(!D.value)return;const s=D.value.clientWidth-j,f=I.value-k.value;if(r.ctrlKey){const y=Math.exp(-r.deltaY*.005),u=f/y;if(u<100||u>1e3*60*60*24*365*10)return;const O=U.value.getBoundingClientRect(),p=r.clientX-O.left-j,W=k.value+p/s*f-p/s*u;k.value=W,I.value=W+u}else{const c=s/(f/6e4),y=r.deltaX/c*6e4;k.value+=y,I.value+=y,C.value=Math.max(0,Math.min(J.value,C.value+r.deltaY)),n({scrollTop:C.value})}},T=r=>{r.key==="Escape"&&a.value&&(a.value=!1,n({selection:{active:!1,start:0,end:0}}))},z=()=>{D.value&&n({viewportWidth:D.value.clientWidth,viewportHeight:D.value.clientHeight})};return Le(async()=>{if(window.addEventListener("resize",z),window.addEventListener("keydown",T),U.value){const r=U.value.transferControlToOffscreen();R(r,window.devicePixelRatio)}await Re(),z(),await N(b.projectId,b.execution.id)}),Ce(()=>{v(),window.removeEventListener("resize",z),window.removeEventListener("keydown",T)}),(r,s)=>(w(),H("div",At,[V("div",{ref_key:"canvasContainerRef",ref:D,style:{width:"100%",height:"100%",position:"relative",overflow:"hidden"}},[V("canvas",{ref_key:"canvasRef",ref:U,style:{display:"block",width:"100%",height:"100%"},onMousemove:ce,onMouseleave:g,onMousedown:h,onMouseup:S,onWheel:Ie(P,["prevent"])},null,544)],512),e(B)?(w(),$(e(me),{key:0,style:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%","z-index":"20",background:"#fff"},justify:"center",align:"center"},{default:o(()=>[l(e(ue),{size:"large"})]),_:1})):e(Z)?(w(),$(e(me),{key:1,style:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%","z-index":"20",background:"#fff"},justify:"center",align:"center"},{default:o(()=>[l(e(Pe),{type:"danger"},{default:o(()=>[Q(G(e(Z)),1)]),_:1})]),_:1})):ge("",!0),e(E)&&!e(B)?(w(),H("div",It,[l(e(ue))])):ge("",!0)]))}}),Tt={style:{height:"100%",display:"flex","align-items":"center","justify-content":"right",gap:"10px"}},Mt={key:0,style:{display:"flex",width:"100%","justify-content":"center"}},Et=de({__name:"Logs",props:{executionRepository:{},buildRepository:{},showAllFilters:{type:Boolean}},setup(_){const b=_,A=ze(),B=Ae(),E=A.params.projectId,Z=A.query.executionId;function x(){const{stageId:i,buildId:a,status:t,startDate:d,endDate:J,executionId:X}=A.query;return d&&J?{stageId:i,buildId:a,status:t,dateRange:[ne(d),ne(J)]}:{stageId:i,buildId:a,status:t,search:X}}function L(i){const a={};U(),Object.entries(i).forEach(([t,d])=>{typeof d=="string"&&t==="search"&&d?a.executionId=d:typeof d=="string"&&d?a[t]=d:t==="dateRange"&&d&&ne.isDayjs(d[0])&&ne.isDayjs(d[1])&&(a.startDate=d[0].toISOString().slice(0,10),a.endDate=d[1].toISOString().slice(0,10))}),B.replace({query:a})}function k(){const{page:i,pageSize:a}=A.query;return{currentIndex:i?parseInt(i,10):1,pageSize:a?parseInt(a,10):10}}function I(i){i=i.slice(0,6);const a=`${window.location.origin}${window.location.pathname}?executionId=${i}`;navigator.clipboard.writeText(a),_e.success({content:m.translate("i18n_logs_copied_to_clipboard")})}function N(i,a){let t={...i};return t.sentTasks=a.sentTasks,delete t.mockExecution,a.triggerTask&&(t.triggerTask=a.triggerTask,delete t.taskId),t}const v=i=>{switch(i){case"failed":return"#ff4d4f";case"finished":return"#52c41a";case"running":return"#1890ff";case"abandoned":return"#faad14";default:return"#d9d9d9"}},R=Fe();R.init({executionRepository:b.executionRepository,buildRepository:b.buildRepository,projectId:E,filters:x(),pagination:k(),pool:!0,openedExecutionId:Z,onFilterChange:L});const{state:n}=R;function D(i,a){R.fetchExecutionLogsPage(i,a)}We(()=>R.teardown());function U(){const i=n.filters.dateRange,a=ne();!i||!i[1]?n.filters.dateRange=[a.subtract(90,"day"),a]:i[1].diff(i[0],"day")>90&&(n.filters.dateRange=[i[1].subtract(90,"day"),i[1]],_e.warning({content:m.translate("i18n_logs_date_range_limit_warning",null,90)}))}L(n.filters);function C(i,a){return a&&"label"in a&&typeof a.label=="string"?a.label.toLowerCase().includes(i.toLowerCase()):!0}return(i,a)=>(w(),$(e(be),{direction:"vertical",style:{width:"100%",padding:"0px 0px 20px 0px"}},{default:o(()=>[l(e(je),null,{default:o(()=>[Q(G(e(m).translate("i18n_logs_title")),1)]),_:1}),_.showAllFilters?(w(),$(e(we),{key:0,layout:"vertical"},{default:o(()=>[l(e(fe),{gutter:10},{default:o(()=>[l(e(q),{span:12},{default:o(()=>[l(e(Y),{label:e(m).translate("i18n_logs_execution_id_label")},{default:o(()=>[l(e(Ue),{value:e(n).filters.search,"onUpdate:value":a[0]||(a[0]=t=>e(n).filters.search=t),placeholder:e(m).translate("i18n_logs_search_by_execution_id_placeholder"),style:{width:"100%"}},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1}),l(e(q),{span:12},{default:o(()=>[l(e(Y),{label:e(m).translate("i18n_logs_stage_label")},{default:o(()=>[l(e(ae),{value:e(n).filters.stageId,"onUpdate:value":a[1]||(a[1]=t=>e(n).filters.stageId=t),options:e(n).filterOptions.stages,placeholder:e(m).translate("i18n_logs_all_placeholder"),"allow-clear":"","show-search":"","filter-option":C},null,8,["value","options","placeholder"])]),_:1},8,["label"])]),_:1})]),_:1}),l(e(fe),{gutter:10},{default:o(()=>[l(e(q),{span:8},{default:o(()=>[l(e(Y),{label:e(m).translate("i18n_logs_date_label")},{default:o(()=>[l(e(xe),{value:e(n).filters.dateRange,"onUpdate:value":a[2]||(a[2]=t=>e(n).filters.dateRange=t),style:{width:"100%"}},null,8,["value"])]),_:1},8,["label"])]),_:1}),l(e(q),{span:10},{default:o(()=>[l(e(Y),{label:e(m).translate("i18n_logs_version_label")},{default:o(()=>[l(e(ae),{value:e(n).filters.buildId,"onUpdate:value":a[3]||(a[3]=t=>e(n).filters.buildId=t),options:e(n).filterOptions.builds,"option-label":"label","option-value":"value",filter:!1,placeholder:e(m).translate("i18n_logs_all_placeholder"),"allow-clear":"","show-search":"","filter-option":C},null,8,["value","options","placeholder"])]),_:1},8,["label"])]),_:1}),l(e(q),{span:6},{default:o(()=>[l(e(Y),{label:e(m).translate("i18n_logs_status_label")},{default:o(()=>[l(e(ae),{value:e(n).filters.status,"onUpdate:value":a[4]||(a[4]=t=>e(n).filters.status=t),options:e(n).filterOptions.statuses,"option-label":"label","option-value":"value",filter:!1,placeholder:e(m).translate("i18n_logs_all_placeholder"),"allow-clear":"","show-search":"","filter-option":C},null,8,["value","options","placeholder"])]),_:1},8,["label"])]),_:1})]),_:1})]),_:1})):(w(),$(e(we),{key:1,layout:"vertical"},{default:o(()=>[l(e(fe),{gutter:10},{default:o(()=>[l(e(q),{span:8},{default:o(()=>[l(e(Y),{label:e(m).translate("i18n_logs_date_label")},{default:o(()=>[l(e(xe),{value:e(n).filters.dateRange,"onUpdate:value":a[5]||(a[5]=t=>e(n).filters.dateRange=t),style:{width:"100%"}},null,8,["value"])]),_:1},8,["label"])]),_:1}),l(e(q),{span:10},{default:o(()=>[l(e(Y),{label:e(m).translate("i18n_logs_script_label")},{default:o(()=>[l(e(ae),{value:e(n).filters.stageId,"onUpdate:value":a[6]||(a[6]=t=>e(n).filters.stageId=t),options:e(n).filterOptions.stages,placeholder:e(m).translate("i18n_logs_all_placeholder"),"allow-clear":"","show-search":"","filter-option":C},null,8,["value","options","placeholder"])]),_:1},8,["label"])]),_:1}),l(e(q),{span:6},{default:o(()=>[l(e(Y),{label:e(m).translate("i18n_logs_status_label")},{default:o(()=>[l(e(ae),{value:e(n).filters.status,"onUpdate:value":a[7]||(a[7]=t=>e(n).filters.status=t),options:e(n).filterOptions.statuses,"option-label":"label","option-value":"value",filter:!1,placeholder:e(m).translate("i18n_logs_all_placeholder"),"allow-clear":"","show-search":"","filter-option":C},null,8,["value","options","placeholder"])]),_:1},8,["label"])]),_:1})]),_:1})]),_:1})),e(n).currentPage.loadingExecutions||e(n).currentPage.waitingDebounce?(w(),$(e(ue),{key:2,style:{width:"100%"}})):e(n).currentPage.executions&&e(n).currentPage.executions.length>0?(w(),$(e(be),{key:3,direction:"vertical",style:{width:"100%"}},{default:o(()=>[l(e(Xe),{"active-key":e(n).currentPage.openedExecutionIds,"onUpdate:activeKey":a[8]||(a[8]=t=>e(n).currentPage.openedExecutionIds=t),bordered:!1,style:{"background-color":"transparent"},onChange:e(R).fetchEmptyLogs},{default:o(()=>[(w(!0),H(Be,null,Oe(e(n).currentPage.executions,t=>(w(),$(e(Ye),{key:t.id,style:$e({borderRadius:"4px",marginBottom:"10px",border:"0",overflow:"hidden",backgroundColor:"#fff",borderTop:`4px solid ${v(t.status)}`})},{header:o(()=>[l(e(re),{color:"default",style:{"margin-right":"10px"},bordered:!1},{default:o(()=>[Q(G(e(Je)(t.createdAt)),1)]),_:2},1024),l(e(re),{color:"default",style:{"margin-right":"10px"},bordered:!1},{default:o(()=>[Q(G(e(m).translate("i18n_logs_execution_id_label"))+": "+G(t.id.slice(0,8)),1)]),_:2},1024),l(e(re),{color:"default",style:{"margin-right":"10px"},bordered:!1},{default:o(()=>[Q(G(e(m).translate("i18n_logs_version_label"))+": "+G(t.buildId.slice(0,8)),1)]),_:2},1024),l(e(re),{color:e(n).filterOptions.stages.find(d=>d.value===t.stageId)?"default":"red",style:{"margin-right":"10px"},bordered:!1},{default:o(()=>[Q(G(e(n).filterOptions.stages.find(d=>d.value===t.stageId)?.label??"Deleted stage"),1)]),_:2},1032,["color"])]),extra:o(()=>[V("div",Tt,[l(Ke,{type:"text",size:"small",tooltip:e(m).translate("i18n_logs_copy_url_tooltip"),onClick:Ie(d=>I(t.id),["stop"])},{default:o(()=>[l(e(bt))]),_:1},8,["tooltip","onClick"])])]),default:o(()=>[e(n).currentPage.executionData[t.id]?(w(),$(e(Qe),{key:1},{default:o(()=>[l(e(pe),{key:"context",tab:e(m).translate("i18n_executioncontext_header")},{default:o(()=>[l(Ve,{data:N(t.context,e(n).currentPage.executionData[t.id].tasks),"show-fix-with-ai":!1},null,8,["data"])]),_:2},1032,["tab"]),l(e(pe),{key:"logs",tab:"Logs"},{default:o(()=>[l(Ne,{logs:e(n).currentPage.executionData[t.id].logs,pagination:e(n).currentPage.executionData[t.id].logsPagination,onPageChange:d=>D(t.id,d)},null,8,["logs","pagination","onPageChange"])]),_:2},1024),l(e(pe),{key:"timeline",tab:"Timeline"},{default:o(()=>[l(St,{"project-id":e(E),execution:t},null,8,["project-id","execution"])]),_:2},1024)]),_:2},1024)):(w(),H("div",Mt,[l(e(ue))]))]),_:2},1032,["style"]))),128))]),_:1},8,["active-key","onChange"]),l(e(He),{current:e(n).pagination.currentIndex,"onUpdate:current":a[9]||(a[9]=t=>e(n).pagination.currentIndex=t),"page-size":e(n).pagination.pageSize,"onUpdate:pageSize":a[10]||(a[10]=t=>e(n).pagination.pageSize=t),total:e(n).pagination.totalCount,"show-total":t=>e(m).translate("i18n_logs_found_runs",null,t),"show-size-changer":""},null,8,["current","page-size","total","show-total"])]),_:1})):(w(),$(e(Ze),{key:4}))]),_:1}))}}),Xt=de({__name:"Logs",setup(_){const b=new Se,A=new Ge;return(B,E)=>(w(),$(Et,{"execution-repository":e(b),"build-repository":e(A),"show-all-filters":""},null,8,["execution-repository","build-repository"]))}});export{Xt as default};
//# sourceMappingURL=Logs-VBlCetO9.js.map
