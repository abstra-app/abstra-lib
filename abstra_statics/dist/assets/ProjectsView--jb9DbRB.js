import{a as G,j as L,c as j,k as c,f as o,l as ie,e as D,m as i,n as de,r as H,H as he,i as _,b as N,u as e,cy as be,t as M,bm as U,w as s,g as F,bg as Ae,Q as z,Z as X,h as n,aK as ue,bO as ce,b3 as Y,$ as _e,d as Me,ac as je,ag as ke,af as He,N as $e,cz as Fe,bq as oe,b4 as Ze,cA as Ce,J as Ve,P as re,E as O,B as me,cB as Pe,ab as ne,ba as ve,b5 as J,b6 as fe,aM as pe}from"./jwt-decode.esm-BB_D8b27.js";import{_ as E}from"./AbstraButton.vue_vue_type_script_setup_true_lang-vW44dA3M.js";import{b as Ie,f as Ne,e as xe,L as Le,h as Se,k as De}from"./router-m2y41l_X.js";import{a as we,P as ye}from"./project-D9Ctj-kw.js";import"./tables-QluWJUYt.js";import{_ as Te}from"./ExecutionStatusIcon.vue_vue_type_script_setup_true_lang-uzdVDcWL.js";import{G as Ee}from"./PhNotePencil.vue-SEC9kOtV.js";import{G as ze}from"./PhCaretRight.vue-B3Gu3h54.js";import{a as Ue,G as Be}from"./PhFolderPlus.vue-Bo1N5pNU.js";import{I as Oe}from"./PhPlus.vue-DfW3Q3Ml.js";import{M as Ge}from"./member-1aE5bYw4.js";import{O as Re}from"./organization-CcmfiK_Q.js";import{F as qe}from"./folder-BLIKzT-t.js";import{a as se}from"./ant-design-o8o9O-5R.js";import{G as Ke,A as ge}from"./index-CPb9EyuM.js";import"./ts.worker-DbfLESpW.js";import"./record-tPUblyic.js";import"./string-BL-xaPAE.js";import"./LoadingOutlined-CUns_-Tx.js";(function(){try{var m=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},f=new Error().stack;f&&(m._sentryDebugIds=m._sentryDebugIds||{},m._sentryDebugIds[f]="12600f76-d300-4891-9db5-9298c89ce3ee",m._sentryDebugIdIdentifier="sentry-dbid-12600f76-d300-4891-9db5-9298c89ce3ee")}catch{}})();const Qe=["width","height","fill","transform"],We={key:0},Je=i("path",{d:"M224,44H32A20,20,0,0,0,12,64V192a20,20,0,0,0,20,20H224a20,20,0,0,0,20-20V64A20,20,0,0,0,224,44Zm-4,24V88H36V68ZM36,188V112H220v76Zm172-24a12,12,0,0,1-12,12H164a12,12,0,0,1,0-24h32A12,12,0,0,1,208,164Zm-68,0a12,12,0,0,1-12,12H116a12,12,0,0,1,0-24h12A12,12,0,0,1,140,164Z"},null,-1),Xe=[Je],Ye={key:1},et=i("path",{d:"M232,96v96a8,8,0,0,1-8,8H32a8,8,0,0,1-8-8V96Z",opacity:"0.2"},null,-1),tt=i("path",{d:"M224,48H32A16,16,0,0,0,16,64V192a16,16,0,0,0,16,16H224a16,16,0,0,0,16-16V64A16,16,0,0,0,224,48Zm0,16V88H32V64Zm0,128H32V104H224v88Zm-16-24a8,8,0,0,1-8,8H168a8,8,0,0,1,0-16h32A8,8,0,0,1,208,168Zm-64,0a8,8,0,0,1-8,8H120a8,8,0,0,1,0-16h16A8,8,0,0,1,144,168Z"},null,-1),at=[et,tt],lt={key:2},ot=i("path",{d:"M224,48H32A16,16,0,0,0,16,64V192a16,16,0,0,0,16,16H224a16,16,0,0,0,16-16V64A16,16,0,0,0,224,48ZM136,176H120a8,8,0,0,1,0-16h16a8,8,0,0,1,0,16Zm64,0H168a8,8,0,0,1,0-16h32a8,8,0,0,1,0,16ZM32,88V64H224V88Z"},null,-1),rt=[ot],nt={key:3},st=i("path",{d:"M224,50H32A14,14,0,0,0,18,64V192a14,14,0,0,0,14,14H224a14,14,0,0,0,14-14V64A14,14,0,0,0,224,50ZM32,62H224a2,2,0,0,1,2,2V90H30V64A2,2,0,0,1,32,62ZM224,194H32a2,2,0,0,1-2-2V102H226v90A2,2,0,0,1,224,194Zm-18-26a6,6,0,0,1-6,6H168a6,6,0,0,1,0-12h32A6,6,0,0,1,206,168Zm-64,0a6,6,0,0,1-6,6H120a6,6,0,0,1,0-12h16A6,6,0,0,1,142,168Z"},null,-1),it=[st],dt={key:4},ut=i("path",{d:"M224,48H32A16,16,0,0,0,16,64V192a16,16,0,0,0,16,16H224a16,16,0,0,0,16-16V64A16,16,0,0,0,224,48Zm0,16V88H32V64Zm0,128H32V104H224v88Zm-16-24a8,8,0,0,1-8,8H168a8,8,0,0,1,0-16h32A8,8,0,0,1,208,168Zm-64,0a8,8,0,0,1-8,8H120a8,8,0,0,1,0-16h16A8,8,0,0,1,144,168Z"},null,-1),ct=[ut],mt={key:5},vt=i("path",{d:"M224,52H32A12,12,0,0,0,20,64V192a12,12,0,0,0,12,12H224a12,12,0,0,0,12-12V64A12,12,0,0,0,224,52ZM32,60H224a4,4,0,0,1,4,4V92H28V64A4,4,0,0,1,32,60ZM224,196H32a4,4,0,0,1-4-4V100H228v92A4,4,0,0,1,224,196Zm-20-28a4,4,0,0,1-4,4H168a4,4,0,0,1,0-8h32A4,4,0,0,1,204,168Zm-64,0a4,4,0,0,1-4,4H120a4,4,0,0,1,0-8h16A4,4,0,0,1,140,168Z"},null,-1),ft=[vt],pt={name:"PhCreditCard"},gt=G({...pt,props:{weight:{type:String},size:{type:[String,Number]},color:{type:String},mirrored:{type:Boolean}},setup(m){const f=m,r=L("weight","regular"),t=L("size","1em"),p=L("color","currentColor"),b=L("mirrored",!1),g=j(()=>f.weight??r),h=j(()=>f.size??t),Z=j(()=>f.color??p),C=j(()=>f.mirrored!==void 0?f.mirrored?"scale(-1, 1)":void 0:b?"scale(-1, 1)":void 0);return(V,$)=>(o(),c("svg",de({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256",width:h.value,height:h.value,fill:Z.value,transform:C.value},V.$attrs),[ie(V.$slots,"default"),g.value==="bold"?(o(),c("g",We,Xe)):g.value==="duotone"?(o(),c("g",Ye,at)):g.value==="fill"?(o(),c("g",lt,rt)):g.value==="light"?(o(),c("g",nt,it)):g.value==="regular"?(o(),c("g",dt,ct)):g.value==="thin"?(o(),c("g",mt,ft)):D("",!0)],16,Qe))}}),ht=["width","height","fill","transform"],_t={key:0},wt=i("path",{d:"M248.23,112.31A20,20,0,0,0,232,104H220V88a20,20,0,0,0-20-20H132L105.34,48a20.12,20.12,0,0,0-12-4H40A20,20,0,0,0,20,64V208a12,12,0,0,0,12,12H211.1a12,12,0,0,0,11.33-8l28.49-81.47.06-.17A20,20,0,0,0,248.23,112.31ZM92,68l28.8,21.6A12,12,0,0,0,128,92h68v12H69.77a20,20,0,0,0-18.94,13.58L44,137.15V68ZM202.59,196H48.89l23.72-68H226.37Z"},null,-1),yt=[wt],bt={key:1},At=i("path",{d:"M208,88v24H69.77a8,8,0,0,0-7.59,5.47L32,208V64a8,8,0,0,1,8-8H93.33a8,8,0,0,1,4.8,1.6L128,80h72A8,8,0,0,1,208,88Z",opacity:"0.2"},null,-1),Mt=i("path",{d:"M245,110.64A16,16,0,0,0,232,104H216V88a16,16,0,0,0-16-16H130.67L102.94,51.2a16.14,16.14,0,0,0-9.6-3.2H40A16,16,0,0,0,24,64V208a8,8,0,0,0,8,8H211.1a8,8,0,0,0,7.59-5.47l28.49-85.47A16.05,16.05,0,0,0,245,110.64ZM93.34,64,123.2,86.4A8,8,0,0,0,128,88h72v16H69.77a16,16,0,0,0-15.18,10.94L40,158.7V64Zm112,136H43.1l26.67-80H232Z"},null,-1),jt=[At,Mt],kt={key:2},Ht=i("path",{d:"M245,110.64A16,16,0,0,0,232,104H216V88a16,16,0,0,0-16-16H130.67L102.94,51.2a16.14,16.14,0,0,0-9.6-3.2H40A16,16,0,0,0,24,64V208h0a8,8,0,0,0,8,8H211.1a8,8,0,0,0,7.59-5.47l28.49-85.47A16.05,16.05,0,0,0,245,110.64ZM93.34,64,123.2,86.4A8,8,0,0,0,128,88h72v16H69.77a16,16,0,0,0-15.18,10.94L40,158.7V64Z"},null,-1),$t=[Ht],Ft={key:3},Zt=i("path",{d:"M243.36,111.81A14,14,0,0,0,232,106H214V88a14,14,0,0,0-14-14H130L101.74,52.8a14.06,14.06,0,0,0-8.4-2.8H40A14,14,0,0,0,26,64V208a6,6,0,0,0,6,6H211.1a6,6,0,0,0,5.69-4.1l28.49-85.47A14,14,0,0,0,243.36,111.81ZM40,62H93.34a2,2,0,0,1,1.2.4L124.4,84.8A6,6,0,0,0,128,86h72a2,2,0,0,1,2,2v18H69.77a14,14,0,0,0-13.28,9.57L38,171V64A2,2,0,0,1,40,62Zm193.9,58.63L206.78,202H40.33l27.54-82.63a2,2,0,0,1,1.9-1.37H232a2,2,0,0,1,1.9,2.63Z"},null,-1),Ct=[Zt],Vt={key:4},Pt=i("path",{d:"M245,110.64A16,16,0,0,0,232,104H216V88a16,16,0,0,0-16-16H130.67L102.94,51.2a16.14,16.14,0,0,0-9.6-3.2H40A16,16,0,0,0,24,64V208h0a8,8,0,0,0,8,8H211.1a8,8,0,0,0,7.59-5.47l28.49-85.47A16.05,16.05,0,0,0,245,110.64ZM93.34,64,123.2,86.4A8,8,0,0,0,128,88h72v16H69.77a16,16,0,0,0-15.18,10.94L40,158.7V64Zm112,136H43.1l26.67-80H232Z"},null,-1),It=[Pt],Nt={key:5},xt=i("path",{d:"M241.72,113a11.88,11.88,0,0,0-9.73-5H212V88a12,12,0,0,0-12-12H129.33l-28.8-21.6a12.05,12.05,0,0,0-7.2-2.4H40A12,12,0,0,0,28,64V208a4,4,0,0,0,4,4H211.09a4,4,0,0,0,3.79-2.74l28.49-85.47A11.86,11.86,0,0,0,241.72,113ZM40,60H93.33a4,4,0,0,1,2.4.8L125.6,83.2a4,4,0,0,0,2.4.8h72a4,4,0,0,1,4,4v20H69.76a12,12,0,0,0-11.38,8.21L36,183.35V64A4,4,0,0,1,40,60Zm195.78,61.26L208.2,204H37.55L66,118.74A4,4,0,0,1,69.76,116H232a4,4,0,0,1,3.79,5.26Z"},null,-1),Lt=[xt],St={name:"PhFolderOpen"},Dt=G({...St,props:{weight:{type:String},size:{type:[String,Number]},color:{type:String},mirrored:{type:Boolean}},setup(m){const f=m,r=L("weight","regular"),t=L("size","1em"),p=L("color","currentColor"),b=L("mirrored",!1),g=j(()=>f.weight??r),h=j(()=>f.size??t),Z=j(()=>f.color??p),C=j(()=>f.mirrored!==void 0?f.mirrored?"scale(-1, 1)":void 0:b?"scale(-1, 1)":void 0);return(V,$)=>(o(),c("svg",de({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256",width:h.value,height:h.value,fill:Z.value,transform:C.value},V.$attrs),[ie(V.$slots,"default"),g.value==="bold"?(o(),c("g",_t,yt)):g.value==="duotone"?(o(),c("g",bt,jt)):g.value==="fill"?(o(),c("g",kt,$t)):g.value==="light"?(o(),c("g",Ft,Ct)):g.value==="regular"?(o(),c("g",Vt,It)):g.value==="thin"?(o(),c("g",Nt,Lt)):D("",!0)],16,ht))}}),Tt=["width","height","fill","transform"],Et={key:0},zt=i("path",{d:"M164.38,181.1a52,52,0,1,0-72.76,0,75.89,75.89,0,0,0-30,28.89,12,12,0,0,0,20.78,12,53,53,0,0,1,91.22,0,12,12,0,1,0,20.78-12A75.89,75.89,0,0,0,164.38,181.1ZM100,144a28,28,0,1,1,28,28A28,28,0,0,1,100,144Zm147.21,9.59a12,12,0,0,1-16.81-2.39c-8.33-11.09-19.85-19.59-29.33-21.64a12,12,0,0,1-1.82-22.91,20,20,0,1,0-24.78-28.3,12,12,0,1,1-21-11.6,44,44,0,1,1,73.28,48.35,92.18,92.18,0,0,1,22.85,21.69A12,12,0,0,1,247.21,153.59Zm-192.28-24c-9.48,2.05-21,10.55-29.33,21.65A12,12,0,0,1,6.41,136.79,92.37,92.37,0,0,1,29.26,115.1a44,44,0,1,1,73.28-48.35,12,12,0,1,1-21,11.6,20,20,0,1,0-24.78,28.3,12,12,0,0,1-1.82,22.91Z"},null,-1),Ut=[zt],Bt={key:1},Ot=i("path",{d:"M168,144a40,40,0,1,1-40-40A40,40,0,0,1,168,144ZM64,56A32,32,0,1,0,96,88,32,32,0,0,0,64,56Zm128,0a32,32,0,1,0,32,32A32,32,0,0,0,192,56Z",opacity:"0.2"},null,-1),Gt=i("path",{d:"M244.8,150.4a8,8,0,0,1-11.2-1.6A51.6,51.6,0,0,0,192,128a8,8,0,0,1,0-16,24,24,0,1,0-23.24-30,8,8,0,1,1-15.5-4A40,40,0,1,1,219,117.51a67.94,67.94,0,0,1,27.43,21.68A8,8,0,0,1,244.8,150.4ZM190.92,212a8,8,0,1,1-13.85,8,57,57,0,0,0-98.15,0,8,8,0,1,1-13.84-8,72.06,72.06,0,0,1,33.74-29.92,48,48,0,1,1,58.36,0A72.06,72.06,0,0,1,190.92,212ZM128,176a32,32,0,1,0-32-32A32,32,0,0,0,128,176ZM72,120a8,8,0,0,0-8-8A24,24,0,1,1,87.24,82a8,8,0,1,0,15.5-4A40,40,0,1,0,37,117.51,67.94,67.94,0,0,0,9.6,139.19a8,8,0,1,0,12.8,9.61A51.6,51.6,0,0,1,64,128,8,8,0,0,0,72,120Z"},null,-1),Rt=[Ot,Gt],qt={key:2},Kt=i("path",{d:"M64.12,147.8a4,4,0,0,1-4,4.2H16a8,8,0,0,1-7.8-6.17,8.35,8.35,0,0,1,1.62-6.93A67.79,67.79,0,0,1,37,117.51a40,40,0,1,1,66.46-35.8,3.94,3.94,0,0,1-2.27,4.18A64.08,64.08,0,0,0,64,144C64,145.28,64,146.54,64.12,147.8Zm182-8.91A67.76,67.76,0,0,0,219,117.51a40,40,0,1,0-66.46-35.8,3.94,3.94,0,0,0,2.27,4.18A64.08,64.08,0,0,1,192,144c0,1.28,0,2.54-.12,3.8a4,4,0,0,0,4,4.2H240a8,8,0,0,0,7.8-6.17A8.33,8.33,0,0,0,246.17,138.89Zm-89,43.18a48,48,0,1,0-58.37,0A72.13,72.13,0,0,0,65.07,212,8,8,0,0,0,72,224H184a8,8,0,0,0,6.93-12A72.15,72.15,0,0,0,157.19,182.07Z"},null,-1),Qt=[Kt],Wt={key:3},Jt=i("path",{d:"M243.6,148.8a6,6,0,0,1-8.4-1.2A53.58,53.58,0,0,0,192,126a6,6,0,0,1,0-12,26,26,0,1,0-25.18-32.5,6,6,0,0,1-11.62-3,38,38,0,1,1,59.91,39.63A65.69,65.69,0,0,1,244.8,140.4,6,6,0,0,1,243.6,148.8ZM189.19,213a6,6,0,0,1-2.19,8.2,5.9,5.9,0,0,1-3,.81,6,6,0,0,1-5.2-3,59,59,0,0,0-101.62,0,6,6,0,1,1-10.38-6A70.1,70.1,0,0,1,103,182.55a46,46,0,1,1,50.1,0A70.1,70.1,0,0,1,189.19,213ZM128,178a34,34,0,1,0-34-34A34,34,0,0,0,128,178ZM70,120a6,6,0,0,0-6-6A26,26,0,1,1,89.18,81.49a6,6,0,1,0,11.62-3,38,38,0,1,0-59.91,39.63A65.69,65.69,0,0,0,11.2,140.4a6,6,0,1,0,9.6,7.2A53.58,53.58,0,0,1,64,126,6,6,0,0,0,70,120Z"},null,-1),Xt=[Jt],Yt={key:4},ea=i("path",{d:"M244.8,150.4a8,8,0,0,1-11.2-1.6A51.6,51.6,0,0,0,192,128a8,8,0,0,1-7.37-4.89,8,8,0,0,1,0-6.22A8,8,0,0,1,192,112a24,24,0,1,0-23.24-30,8,8,0,1,1-15.5-4A40,40,0,1,1,219,117.51a67.94,67.94,0,0,1,27.43,21.68A8,8,0,0,1,244.8,150.4ZM190.92,212a8,8,0,1,1-13.84,8,57,57,0,0,0-98.16,0,8,8,0,1,1-13.84-8,72.06,72.06,0,0,1,33.74-29.92,48,48,0,1,1,58.36,0A72.06,72.06,0,0,1,190.92,212ZM128,176a32,32,0,1,0-32-32A32,32,0,0,0,128,176ZM72,120a8,8,0,0,0-8-8A24,24,0,1,1,87.24,82a8,8,0,1,0,15.5-4A40,40,0,1,0,37,117.51,67.94,67.94,0,0,0,9.6,139.19a8,8,0,1,0,12.8,9.61A51.6,51.6,0,0,1,64,128,8,8,0,0,0,72,120Z"},null,-1),ta=[ea],aa={key:5},la=i("path",{d:"M237,147.44a4,4,0,0,1-5.48-1.4c-8.33-14-20.93-22-34.56-22a4,4,0,0,1-1.2-.2,36.76,36.76,0,0,1-3.8.2,4,4,0,0,1,0-8,28,28,0,1,0-27.12-35,4,4,0,0,1-7.75-2,36,36,0,1,1,54,39.48c10.81,3.85,20.51,12,27.31,23.48A4,4,0,0,1,237,147.44ZM187.46,214a4,4,0,0,1-1.46,5.46,3.93,3.93,0,0,1-2,.54,4,4,0,0,1-3.46-2,61,61,0,0,0-105.08,0,4,4,0,0,1-6.92-4,68.35,68.35,0,0,1,39.19-31,44,44,0,1,1,40.54,0A68.35,68.35,0,0,1,187.46,214ZM128,180a36,36,0,1,0-36-36A36,36,0,0,0,128,180ZM64,116A28,28,0,1,1,91.12,81a4,4,0,0,0,7.75-2A36,36,0,1,0,45.3,118.75,63.55,63.55,0,0,0,12.8,141.6a4,4,0,0,0,6.4,4.8A55.55,55.55,0,0,1,64,124a4,4,0,0,0,0-8Z"},null,-1),oa=[la],ra={name:"PhUsersThree"},na=G({...ra,props:{weight:{type:String},size:{type:[String,Number]},color:{type:String},mirrored:{type:Boolean}},setup(m){const f=m,r=L("weight","regular"),t=L("size","1em"),p=L("color","currentColor"),b=L("mirrored",!1),g=j(()=>f.weight??r),h=j(()=>f.size??t),Z=j(()=>f.color??p),C=j(()=>f.mirrored!==void 0?f.mirrored?"scale(-1, 1)":void 0:b?"scale(-1, 1)":void 0);return(V,$)=>(o(),c("svg",de({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256",width:h.value,height:h.value,fill:Z.value,transform:C.value},V.$attrs),[ie(V.$slots,"default"),g.value==="bold"?(o(),c("g",Et,Ut)):g.value==="duotone"?(o(),c("g",Bt,Rt)):g.value==="fill"?(o(),c("g",qt,Qt)):g.value==="light"?(o(),c("g",Wt,Xt)):g.value==="regular"?(o(),c("g",Yt,ta)):g.value==="thin"?(o(),c("g",aa,oa)):D("",!0)],16,Tt))}}),sa={class:"card-header"},ia={class:"header-left"},da=["src"],ua={class:"project-info"},ca={class:"project-title"},ma=["href"],va={class:"card-footer"},fa={class:"executions-container"},pa={key:2,class:"no-runs-text"},ga=G({__name:"ProjectCard",props:{project:{}},emits:["click"],setup(m,{emit:f}){const r=m,t=f,p=H(!0),b=H([]),g=H(!1),h=H([]),Z=j(()=>g.value?null:`https://${r.project.subdomain}.abstra.app/_assets/logo`),C=()=>{g.value=!0};he(async()=>{try{const I=new we,[w,S]=await Promise.all([I.getWorkflowStatistics(r.project.id),ye.getStatus(r.project.id)]);b.value=w,h.value=S}catch{const w=["finished","failed","running","abandoned"],S=Array.from({length:5}).map((ee,B)=>({id:`mock-${B}`,status:w[(r.project.id.charCodeAt(B)||0)%w.length],buildId:"mock-build",createdAt:new Date(Date.now()-B*1e6).toISOString(),updatedAt:new Date().toISOString()}));b.value=[{stageId:"mock-stage",lastExecutions:S,pendingTasks:0,lockedTasks:0,completedTasks:0,totalTasks:0}]}finally{p.value=!1}});const V=j(()=>{const I=b.value.flatMap(w=>w.lastExecutions||[]);return I.sort((w,S)=>new Date(S.createdAt).getTime()-new Date(w.createdAt).getTime()),I.slice(0,5)}),$=j(()=>r.project.getUrl()),P=j(()=>r.project.getUrl().replace("https://","").replace(/\/$/,"")),T=j(()=>p.value?null:h.value.some(w=>w.status==="Running")?{text:_.translate("i18n_builds_live"),color:"green"}:{text:_.translate("i18n_builds_inactive"),color:"default"}),R=()=>{t("click",r.project)};return(I,w)=>(o(),c("div",{class:"project-card",onClick:R},[i("div",sa,[i("div",ia,[Z.value?(o(),c("img",{key:0,src:Z.value,class:"project-logo",onError:C},null,40,da)):(o(),N(e(be),{key:1,size:24,weight:"fill",class:"project-icon"})),i("div",ua,[i("h3",ca,M(m.project.name),1),i("a",{href:$.value,target:"_blank",class:"project-url",onClick:w[0]||(w[0]=U(()=>{},["stop"]))},M(P.value),9,ma)])]),T.value?(o(),N(e(Ae),{key:0,color:T.value.color,bordered:!1},{default:s(()=>[F(M(T.value.text),1)]),_:1},8,["color"])):D("",!0)]),i("div",va,[i("div",fa,[p.value?(o(),c(z,{key:0},[w[1]||(w[1]=i("div",{class:"loading-dot"},null,-1)),w[2]||(w[2]=i("div",{class:"loading-dot"},null,-1)),w[3]||(w[3]=i("div",{class:"loading-dot"},null,-1))],64)):V.value.length>0?(o(!0),c(z,{key:1},X(V.value,S=>(o(),c("div",{key:S.id,class:"execution-dot"},[n(Te,{status:S.status},null,8,["status"])]))),128)):(o(),c("span",pa,"No runs yet"))])])]))}}),ha=ue(ga,[["__scopeId","data-v-a989be10"]]),_a=G({__name:"EditableFolderName",props:{folder:{}},emits:["update:name"],setup(m,{emit:f}){const r=m,t=f,p=H(!1),b=H(""),g=H(null);function h(){b.value=r.folder.name,p.value=!0,_e(()=>{g.value?.focus?.()})}function Z(){b.value.trim()&&b.value!==r.folder.name&&t("update:name",b.value.trim()),p.value=!1}function C(){p.value=!1}return(V,$)=>p.value?(o(),N(e(Y),{key:1,ref_key:"inputRef",ref:g,value:b.value,"onUpdate:value":$[0]||($[0]=P=>b.value=P),size:"small",class:"edit-input",onBlur:Z,onClick:$[1]||($[1]=U(()=>{},["stop"])),onKeydown:[ce(Z,["enter"]),ce(C,["escape"])]},null,8,["value"])):(o(),c("h2",{key:0,class:"folder-name",onClick:U(h,["stop"])},[F(M(m.folder.name)+" ",1),n(e(Ee),{class:"edit-icon",size:14})]))}}),wa=ue(_a,[["__scopeId","data-v-1a20da68"]]),ya=Me("projectsView",()=>{const m=H(null),f=H([]),r=H(null),t=H(null),p=H(!1),b=H(""),g=H(!0),h={member:new Ge,project:new we,folder:new qe},Z=j(()=>m.value?.members.map(a=>({label:a.email,value:a.id,disabled:a.id===m.value?.currentMember?.id})).sort((a,v)=>a.label.localeCompare(v.label))),C=j(()=>m.value?.folders.map(a=>({label:a.name,value:a.id}))),V=j(()=>{if(!r.value)return!1;const a=r.value.newName!==r.value.currentName,v=r.value.newName.trim().length>0,y=!je.isEqual(r.value.newMemberIds,r.value.currentMemberIds),x=r.value.newMemberIds.length>0;return r.value.mode==="edit"?a&&v||y&&x:v&&x}),$=j(()=>{if(!t.value)return!1;const a=!!t.value.newFolderId,v=t.value.newName.trim().length>0,y=t.value.newName!==t.value.currentName,x=t.value.newFolderId!==t.value.currentFolderId;return t.value.mode==="edit"?y&&v||x:a&&v}),P=async a=>{const v=Ie.getAuthor()?.claims.email;if(!v)throw new Error("User not authenticated");const[y,x,A,K]=await Promise.all([ye.list(a),Re.get(a),h.member.list(a),h.folder.list(a)]),Q=A.find(W=>W.email===v)??null;f.value.length===0&&K.length===1&&(f.value=[K[0].id]),m.value={projects:y.sort((W,le)=>W.name.localeCompare(le.name)),organization:x,members:A,folders:K.sort((W,le)=>W.name.localeCompare(le.name)),currentMember:Q}},T=a=>m.value?.projects.filter(v=>v.folderId===a&&(!b.value.trim()||v.name.toLowerCase().includes(b.value.toLowerCase()))),R=()=>b.value.trim()?m.value?.folders.filter(a=>T(a.id).length>0)??[]:m.value?.folders??[],I=a=>{f.value.includes(a)?f.value=f.value.filter(v=>v!==a):f.value=[...f.value,a]},w=()=>{r.value=null,t.value=null,p.value=!1};return{fetchedState:m,activeFolderIds:f,draftFolder:r,draftProject:t,isMembersModalOpen:p,searchQuery:b,isDraftProjectValid:$,isDraftFolderValid:V,isDraftFolderUnique:g,memberOptions:Z,folderOptions:C,fetchState:P,getFolderProjects:T,listFolders:R,toggleFolder:I,closeModals:w,openMembersModal:()=>{p.value=!0},inviteMember:async(a,v)=>{await h.member.create({organizationId:a,email:v}),await P(a)},removeMember:async(a,v)=>{const y=m.value?.members.find(A=>A.id===v);if(!y){console.error("Member not found for removal");return}if(await se(_.translate("i18n_projectsview_remove_member_confirm",null,y.email))){m.value&&(m.value.members=m.value.members.filter(A=>A.id!==v));try{await h.member.delete({organizationId:a,authorId:y.authorId})}catch(A){console.error("Failed to remove member",A),await P(a)}}},openCreateFolderModal:()=>{m.value&&(r.value={currentName:"",mode:"create",currentMemberIds:[],modalTitle:"Create Folder",newName:"",newMemberIds:[m.value.currentMember?.id].filter(Boolean),buttonLoading:null})},openCreateProjectModal:(a="")=>{t.value={currentName:"",mode:"create",currentFolderId:"",modalTitle:"Create Project",newName:"",newFolderId:a,buttonLoading:null}},openEditProjectModal:a=>{t.value={id:a.id,mode:"edit",currentName:a.name,currentFolderId:a.folderId,modalTitle:`Edit Project: ${a.name}`,newName:a.name,newFolderId:a.folderId,buttonLoading:null}},openEditFolderModal:a=>{m.value&&(r.value={currentName:a.name,modalTitle:`${a.name} - Settings`,id:a.id,mode:"edit",newName:a.name,newMemberIds:[...a.memberIds],currentMemberIds:a.memberIds,buttonLoading:null})},saveProject:async(a,v)=>{if(t.value){if(t.value.buttonLoading="save",t.value.mode==="edit")await h.project.update(t.value.id,{name:t.value.newName,folderId:t.value.newFolderId});else if(t.value.mode==="create"){const y=await h.project.create({name:t.value.newName,folderId:t.value.newFolderId,organizationId:a});v(y.id);return}await P(a),w()}},deleteProject:async a=>{!t.value||t.value.mode!=="edit"||!await se("Are you sure you want to delete this project? All data will be lost.")||(t.value.buttonLoading="delete",await h.project.delete(t.value.id),await P(a),w())},saveFolder:async a=>{if(g.value=!0,!r.value)return;if(r.value.newName!==r.value.currentName&&!await h.folder.checkNameAvailability(a,r.value.newName)){g.value=!1;return}r.value.buttonLoading="save";const v=[];for(const y of r.value.newMemberIds){if(m.value?.members.find(A=>A.id===y)){v.push(y);continue}if(y.includes("@"))try{const A=await h.member.create({organizationId:a,email:y});v.push(A.id)}catch(A){console.error("Failed to invite member from tag",y,A)}}r.value.mode==="edit"?await h.folder.update(a,{id:r.value.id,name:r.value.newName,memberIds:v,organizationId:a}):r.value.mode==="create"&&await h.folder.create({organizationId:a,name:r.value.newName,memberIds:v}),await P(a),w()},deleteFolder:async a=>{!r.value||r.value.mode!=="edit"||T(r.value.id).length>0||!await se("Are you sure you want to delete this empty folder?",{okText:"Delete",cancelText:"Cancel"})||(r.value.buttonLoading="delete",await h.folder.delete(a,r.value.id),await P(a),w())},moveProject:async(a,v)=>{const y=m.value?.projects.find(A=>A.id===a);if(!y||y.folderId===v)return;const x=y.folderId;y.folderId=v;try{await h.project.update(a,{folderId:v})}catch(A){y.folderId=x,console.error("Failed to move project",A)}},updateFolderName:async(a,v,y,x)=>{const A=m.value?.folders.find(Q=>Q.id===v);if(!A)return;const K=A.name;A.name=y;try{await h.folder.update(a,{id:v,name:y,memberIds:x,organizationId:a})}catch(Q){A.name=K,console.error("Failed to update folder name",Q)}}}}),ba={class:"projects-view"},Aa={key:0,class:"loading-container"},Ma={key:1,class:"loading-container"},ja={class:"header-controls"},ka={class:"left-controls"},Ha={class:"right-controls"},$a={class:"folders-container"},Fa={class:"folder-header-content"},Za={class:"folder-info"},Ca={class:"item-count"},Va=["onClick"],Pa={class:"projects-grid"},Ia=["onClick"],Na={class:"icon-circle-small"},xa={class:"create-project-text"},La={key:3,class:"empty-state"},Sa=G({__name:"ProjectsView",setup(m){const f=ke(),r=He(),t=ya(),p=j(()=>f.params.organizationId),b={navigateToProject:d=>r.push({name:"project",params:{organizationId:p.value,projectId:d}})},g=(d,u)=>u?.label?.toLowerCase().includes(d.toLowerCase())??!1,h=H(!0),Z=H(null);async function C(d,u=!1){if(!(!u&&Z.value===d&&t.fetchedState)){h.value=!0,Z.value=d,t.fetchedState=null;try{await t.fetchState(d)}catch(l){console.error("Failed to fetch organization data:",l)}finally{h.value=!1}}}function V(){const d=p.value;d&&C(d,!0)}$e(p,d=>{d&&C(d)},{immediate:!0}),he(()=>{_e(()=>{setTimeout(()=>{const d=p.value;d&&!t.fetchedState&&C(d,!0)},50)})}),Fe(()=>{const d=p.value;d&&!t.fetchedState&&C(d,!0)});const $=H(""),P=H(!1),T=async()=>{if(!(!$.value||P.value)){P.value=!0;try{await t.inviteMember(p.value,$.value),$.value=""}finally{P.value=!1}}},R=async(d,u)=>{await t.updateFolderName(p.value,d.id,u,d.memberIds)},I=H(null),w=(d,u)=>{d.dataTransfer&&(d.dataTransfer.effectAllowed="move",d.dataTransfer.setData("text/plain",u.id),d.dataTransfer.dropEffect="move")},S=d=>{I.value=d},ee=(d,u)=>{const l=d.currentTarget,k=d.relatedTarget;l.contains(k)||I.value===u&&(I.value=null)},B=(d,u)=>{I.value=null;const l=d.dataTransfer?.getData("text/plain");l&&t.moveProject(l,u)},te=d=>{if(!d)return"";const l=d.split("@")[0].split(/[._-]/).filter(Boolean);return l.length===0?"":l.length===1?l[0][0].toUpperCase():(l[0][0]+l[1][0]).toUpperCase()},ae=d=>({backgroundColor:"#f3f4f6",color:"#9ca3af",fontWeight:"bold",fontSize:"12px"});return(d,u)=>(o(),c(z,null,[i("div",ba,[p.value?h.value?(o(),c("div",Ma,[n(e(Ze),{size:"large"})])):e(t).fetchedState?(o(),c(z,{key:2},[i("div",ja,[i("div",ka,[n(e(Ce),{value:e(t).searchQuery,"onUpdate:value":u[0]||(u[0]=l=>e(t).searchQuery=l),placeholder:e(_).translate("i18n_projectsview_search_placeholder"),class:"search-input"},null,8,["value","placeholder"])]),i("div",Ha,[n(E,{type:"link",onClick:e(t).openMembersModal},{default:s(()=>[n(e(na)),F(" "+M(e(_).translate("i18n_consoleorganization_editors")),1)]),_:1},8,["onClick"]),n(E,{type:"link",onClick:u[1]||(u[1]=l=>e(r).push({name:"billing",params:{organizationId:p.value}}))},{default:s(()=>[n(e(gt)),F(" "+M(e(_).translate("i18n_consoleorganization_billing")),1)]),_:1}),n(E,{type:"link",onClick:e(t).openCreateFolderModal},{default:s(()=>[n(e(Ue)),F(" "+M(e(_).translate("i18n_projectsview_create_folder")||"New Folder"),1)]),_:1},8,["onClick"])])]),i("div",$a,[n(e(xe),{activeKey:e(t).activeFolderIds,"onUpdate:activeKey":u[3]||(u[3]=l=>e(t).activeFolderIds=l),bordered:!1,style:{background:"transparent"}},{expandIcon:s(({isActive:l})=>[n(e(ze),{style:re({transform:l?"rotate(90deg)":"rotate(0deg)",transition:"transform 0.2s"}),size:16},null,8,["style"])]),default:s(()=>[(o(!0),c(z,null,X(e(t).listFolders(),l=>(o(),N(e(Ne),{key:l.id,class:Ve(["folder-card",{"drop-active":I.value===l.id}]),onDragover:U(k=>S(l.id),["prevent"]),onDragleave:k=>ee(k,l.id),onDrop:k=>B(k,l.id)},{header:s(()=>[i("div",Fa,[i("div",Za,[e(t).activeFolderIds.includes(l.id)?(o(),N(e(Dt),{key:0,class:"folder-icon",size:20,weight:"fill"})):(o(),N(e(Be),{key:1,class:"folder-icon",size:20,weight:"fill"})),n(wa,{folder:l,"onUpdate:name":k=>R(l,k)},null,8,["folder","onUpdate:name"]),i("span",Ca,M(e(t).getFolderProjects(l.id)?.length||0)+" projetos ",1)]),i("div",{class:"folder-actions",onClick:u[2]||(u[2]=U(()=>{},["stop"]))},[e(t).fetchedState?(o(),c("div",{key:0,class:"folder-avatars",onClick:U(k=>e(t).openEditFolderModal(l),["stop"])},[n(e(Ke),{"max-count":3,size:"small"},{default:s(()=>[(o(!0),c(z,null,X(l.memberIds,k=>(o(),N(e(ge),{key:k,style:re(ae(k))},{icon:s(()=>[F(M(te(e(t).fetchedState.members.find(q=>q.id===k)?.email)),1)]),_:2},1032,["style"]))),128))]),_:2},1024)],8,Va)):D("",!0)])])]),default:s(()=>[i("div",Pa,[(o(!0),c(z,null,X(e(t).getFolderProjects(l.id),k=>(o(),N(ha,{key:k.id,project:k,draggable:"true",onDragstart:q=>w(q,k),onClick:q=>b.navigateToProject(k.id)},null,8,["project","onDragstart","onClick"]))),128)),i("div",{class:"create-project-card",onClick:k=>e(t).openCreateProjectModal(l.id)},[i("div",Na,[n(e(Oe),{size:20,weight:"bold"})]),i("span",xa,M(e(_).translate("i18n_projectsview_new_project")||"New Project"),1)],8,Ia)])]),_:2},1032,["class","onDragover","onDragleave","onDrop"]))),128))]),_:1},8,["activeKey"])]),e(t).listFolders().length===0&&e(t).searchQuery.trim()?(o(),N(e(oe),{key:0,style:{"margin-top":"50px"}},{description:s(()=>[F(M(e(_).translate("i18n_projectsview_no_projects_search",null,e(t).searchQuery)),1)]),_:1})):D("",!0)],64)):(o(),c("div",La,[n(e(oe),null,{description:s(()=>[i("span",null,M(e(_).translate("i18n_projectsview_loading_error")||"Não foi possível carregar os projetos"),1)]),default:s(()=>[n(E,{type:"primary",onClick:V},{default:s(()=>[F(M(e(_).translate("i18n_projectsview_retry")||"Tentar novamente"),1)]),_:1})]),_:1})])):(o(),c("div",Aa,[n(e(oe),{description:"No organization ID found"})]))]),n(e(ne),{open:e(t).isMembersModalOpen,title:e(_).translate("i18n_projectsview_manage_editors"),footer:null,class:"members-modal",onCancel:e(t).closeModals},{default:s(()=>[n(e(O),{vertical:"",gap:"middle"},{default:s(()=>[n(e(O),{gap:"small"},{default:s(()=>[n(e(Y),{value:$.value,"onUpdate:value":u[4]||(u[4]=l=>$.value=l),placeholder:e(_).translate("i18n_projectsview_invite_by_email"),style:{flex:"1"},onPressEnter:T},null,8,["value","placeholder"]),n(e(me),{type:"primary",disabled:!$.value,loading:P.value,onClick:T},{default:s(()=>[F(M(e(_).translate("i18n_projectsview_invite")),1)]),_:1},8,["disabled","loading"])]),_:1}),n(e(Le),{"item-layout":"horizontal","data-source":e(t).fetchedState?.members||[],style:{"max-height":"400px","overflow-y":"auto"}},{renderItem:s(({item:l})=>[n(e(Se),null,{actions:s(()=>[l.id!==e(t).fetchedState?.currentMember?.id?(o(),N(e(me),{key:0,type:"text",size:"small",onClick:k=>e(t).removeMember(p.value,l.id)},{default:s(()=>[n(e(Pe),{size:14,style:{color:"#d1d5db"}})]),_:1},8,["onClick"])):D("",!0)]),default:s(()=>[n(e(De),null,{title:s(()=>[F(M(l.email),1)]),avatar:s(()=>[n(e(ge),{style:re(ae(l.id))},{icon:s(()=>[F(M(te(l.email)),1)]),_:2},1032,["style"])]),_:2},1024)]),_:2},1024)]),_:1},8,["data-source"])]),_:1})]),_:1},8,["open","title","onCancel"]),n(e(ne),{open:!!e(t).draftFolder,title:e(t).draftFolder?.modalTitle,onCancel:e(t).closeModals},{footer:s(()=>[n(e(O),{justify:e(t).draftFolder?.mode==="edit"?"space-between":"flex-end"},{default:s(()=>[e(t).draftFolder?.mode==="edit"?(o(),N(E,{key:0,danger:"","disabled-tooltip":e(_).translate("i18n_projectsview_cannot_delete_folder"),disabled:e(t).getFolderProjects(e(t).draftFolder?.id).length>0,loading:e(t).draftFolder?.buttonLoading==="delete",onClick:u[7]||(u[7]=U(l=>e(t).deleteFolder(p.value),["stop"]))},{default:s(()=>[n(e(pe)),F(" "+M(e(_).translate("i18n_projectsview_delete_folder")),1)]),_:1},8,["disabled-tooltip","disabled","loading"])):D("",!0),n(e(O),{justify:"flex-end"},{default:s(()=>[n(E,{onClick:e(t).closeModals},{default:s(()=>[F(M(e(_).translate("i18n_projectsview_cancel")),1)]),_:1},8,["onClick"]),n(E,{type:"primary",disabled:!e(t).isDraftFolderValid,loading:e(t).draftFolder?.buttonLoading==="save",onClick:u[8]||(u[8]=l=>e(t).saveFolder(p.value))},{default:s(()=>[F(M(e(_).translate("i18n_projectsview_save")),1)]),_:1},8,["disabled","loading"])]),_:1})]),_:1},8,["justify"])]),default:s(()=>[e(t).draftFolder?(o(),N(e(ve),{key:0,layout:"vertical"},{default:s(()=>[n(e(J),{label:e(_).translate("i18n_projectsview_folder_name"),"validate-status":e(t).isDraftFolderUnique?"":"error",help:e(t).isDraftFolderUnique?"":e(_).translate("i18n_projectsview_folder_exists")},{default:s(()=>[n(e(Y),{value:e(t).draftFolder.newName,"onUpdate:value":u[5]||(u[5]=l=>e(t).draftFolder.newName=l)},null,8,["value"])]),_:1},8,["label","validate-status","help"]),n(e(J),{label:e(_).translate("i18n_projectsview_editors"),tooltip:e(_).translate("i18n_projectsview_editors_tooltip")},{default:s(()=>[n(e(fe),{value:e(t).draftFolder.newMemberIds,"onUpdate:value":u[6]||(u[6]=l=>e(t).draftFolder.newMemberIds=l),mode:"tags",options:e(t).memberOptions,"filter-option":g,placeholder:e(_).translate("i18n_projectsview_choose_editors")},null,8,["value","options","placeholder"])]),_:1},8,["label","tooltip"])]),_:1})):D("",!0)]),_:1},8,["open","title","onCancel"]),n(e(ne),{open:!!e(t).draftProject,title:e(t).draftProject?.modalTitle,onCancel:e(t).closeModals},{footer:s(()=>[n(e(O),{justify:e(t).draftProject?.mode==="edit"?"space-between":"flex-end"},{default:s(()=>[e(t).draftProject?.mode==="edit"?(o(),N(E,{key:0,danger:"",loading:e(t).draftProject?.buttonLoading==="delete",onClick:u[11]||(u[11]=l=>e(t).deleteProject(p.value))},{default:s(()=>[n(e(pe)),F(" "+M(e(_).translate("i18n_projectsview_delete_project")),1)]),_:1},8,["loading"])):D("",!0),n(e(O),{justify:"flex-end"},{default:s(()=>[n(E,{onClick:e(t).closeModals},{default:s(()=>[F(M(e(_).translate("i18n_projectsview_cancel")),1)]),_:1},8,["onClick"]),n(E,{disabled:!e(t).isDraftProjectValid,type:"primary",loading:e(t).draftProject?.buttonLoading==="save",onClick:u[12]||(u[12]=l=>e(t).saveProject(p.value,b.navigateToProject))},{default:s(()=>[F(M(e(_).translate("i18n_projectsview_save")),1)]),_:1},8,["disabled","loading"])]),_:1})]),_:1},8,["justify"])]),default:s(()=>[e(t).draftProject?(o(),N(e(ve),{key:0,layout:"vertical"},{default:s(()=>[n(e(J),{label:e(_).translate("i18n_projectsview_project_name")},{default:s(()=>[n(e(Y),{value:e(t).draftProject.newName,"onUpdate:value":u[9]||(u[9]=l=>e(t).draftProject.newName=l)},null,8,["value"])]),_:1},8,["label"]),n(e(J),{label:e(_).translate("i18n_projectsview_project_folder")},{default:s(()=>[n(e(fe),{value:e(t).draftProject.newFolderId,"onUpdate:value":u[10]||(u[10]=l=>e(t).draftProject.newFolderId=l),options:e(t).folderOptions,placeholder:e(_).translate("i18n_projectsview_choose_folder")},null,8,["value","options","placeholder"])]),_:1},8,["label"])]),_:1})):D("",!0)]),_:1},8,["open","title","onCancel"])],64))}}),n1=ue(Sa,[["__scopeId","data-v-c9e95fea"]]);export{n1 as default};
//# sourceMappingURL=ProjectsView--jb9DbRB.js.map
