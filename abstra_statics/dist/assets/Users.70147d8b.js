var B=Object.defineProperty;var V=(l,o,n)=>o in l?B(l,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):l[o]=n;var _=(l,o,n)=>(V(l,typeof o!="symbol"?o+"":o,n),n);import{d as x,E as A,b as h,c as f,w as i,f as r,u as a,bM as E,ao as b,cA as D,bF as I,ab as L,ez as J,r as W,F as G,et as Q,ev as H,bo as K}from"./outputWidgets.dbf31506.js";import{u as X,o as Y}from"./icons.17139281.js";import{a as Z}from"./asyncComputed.22d83ebd.js";import{z as e}from"./index.cf4c23b9.js";import{A as O}from"./FormItem.14aec113.js";import{F as v}from"./Form.9c899dd2.js";import{A as F}from"./index.4a099b58.js";import{C as y}from"./router.50e0effa.js";import"./jwt-decode.esm.74bd4619.js";import"./index.26ac7d5a.js";import{C as ee}from"./CrudView.6dd71906.js";import{p as U}from"./popupNotifcation.867f61ac.js";import"./hasIn.cb997ddd.js";import"./isNumeric.75337b1e.js";import"./storage.38bf401b.js";import"./index.c87831d1.js";import"./record.d3b10a69.js";import"./pubsub.df3ed44c.js";import"./Title.f2db1f8a.js";import"./Text.44b29478.js";import"./Modal.039b45d9.js";import"./DocsButton.vue_vue_type_script_setup_true_lang.59443374.js";import"./url.11385709.js";import"./index.a66cb776.js";(function(){try{var l=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},o=new Error().stack;o&&(l._sentryDebugIds=l._sentryDebugIds||{},l._sentryDebugIds[o]="04648db9-0d38-47f9-8524-8e8af13200c1",l._sentryDebugIdIdentifier="sentry-dbid-04648db9-0d38-47f9-8524-8e8af13200c1")}catch{}})();class oe{constructor(){_(this,"urlPath","users")}async create(o,n){return y.post(`projects/${o}/${this.urlPath}`,n)}async delete(o,n){await y.delete(`projects/${o}/${this.urlPath}/${n}`)}async list(o,{limit:n,offset:t}){const s={};n&&(s.limit=n.toString()),t&&(s.offset=t.toString());const m=new URLSearchParams(s);return y.get(`projects/${o}/${this.urlPath}?${m.toString()}`)}async update(o,n,t){return y.patch(`projects/${o}/${this.urlPath}/${n}`,t)}}const R=new oe;class S{constructor(o){this.dto=o}static async list(o,n,t){return(await R.list(o,{limit:n,offset:t})).map(m=>new S(m))}static async create(o,n){const t=await R.create(o,n);return new S(t)}async delete(){await R.delete(this.projectId,this.id)}async change(o){this.roles=o.roles,await R.update(this.projectId,this.id,o)}get id(){return this.dto.id}get email(){return this.dto.email}get projectId(){return this.dto.projectId}get roles(){return this.dto.roles}set roles(o){this.dto.roles=o}}const te=e.boolean().default(!0),ne=e.boolean().default(!0),ae=e.boolean().default(!1),se=e.boolean().default(!0),re=e.boolean().default(!1);e.object({PROJECT_LIVE:te.optional(),ALLOW_RELEASE:ne.optional(),CONNECTORS_CONSOLE:ae.optional(),CONNECTORS_EDITOR:se.optional(),DUPLICATE_PROJECTS:re.optional()});const ie=e.string().default("Free");e.object({plan:ie});const le=e.string(),me=e.string(),ce=e.string(),ue=e.string(),pe=e.null(),de=e.string(),Ce=e.union([pe,de]),ge=e.string().regex(new RegExp("^[0-9]+m$")),he=e.string().regex(new RegExp("^[0-9]+m$")),Se=e.string().regex(new RegExp("^[0-9]+Mi$")),ye=e.string().regex(new RegExp("^[0-9]+Mi$")),Re=e.string().regex(new RegExp("^[0-9]+$")),fe=e.string().regex(new RegExp("^[0-9]+$")),Ee=e.enum(["shared","clickbus","test"]),be=e.object({requestsCPU:ge.optional(),limitsCPU:he.optional(),requestsMemory:Se.optional(),limitsMemory:ye.optional(),minReplicas:Re.optional(),timeoutSeconds:fe.optional(),workerType:Ee.optional()});e.object({id:le,name:me,subdomain:ce,organizationId:ue,customDomain:Ce.optional(),deploymentResources:be.optional()});const Oe=e.string().regex(new RegExp("^[0-9]+m$")),we=e.string().regex(new RegExp("^[0-9]+m$")),Pe=e.string().regex(new RegExp("^[0-9]+Mi$")),xe=e.string().regex(new RegExp("^[0-9]+Mi$")),je=e.string().regex(new RegExp("^[0-9]+$")),_e=e.string().regex(new RegExp("^[0-9]+$")),Ue=e.enum(["shared","clickbus","test"]);e.object({requestsCPU:Oe.optional(),limitsCPU:we.optional(),requestsMemory:Pe.optional(),limitsMemory:xe.optional(),minReplicas:je.optional(),timeoutSeconds:_e.optional(),workerType:Ue.optional()});const Ae=e.number(),De=e.number();e.object({limit:Ae.optional(),offset:De.optional()});const Ie=e.string(),T=e.string(),Le=e.literal("workflow_viewer"),ve=["workflow_viewer"],j=e.array(Le),Fe=e.string(),Te=e.string(),Ne=e.object({id:Ie,email:T,roles:j,projectId:Fe,createdAt:Te}),N=e.string(),$=e.string(),$e=e.boolean().default(!0),ke=e.boolean().default(!0),Me=e.boolean().default(!1),ze=e.boolean().default(!0),qe=e.boolean().default(!1),k=e.object({PROJECT_LIVE:$e,ALLOW_RELEASE:ke,CONNECTORS_CONSOLE:Me,CONNECTORS_EDITOR:ze,DUPLICATE_PROJECTS:qe}),Be=e.string().default("Free"),M=e.object({plan:Be}),Ve=e.string().regex(new RegExp("^[0-9]+m$")),Je=e.string().regex(new RegExp("^[0-9]+m$")),We=e.string().regex(new RegExp("^[0-9]+Mi$")),Ge=e.string().regex(new RegExp("^[0-9]+Mi$")),Qe=e.string().regex(new RegExp("^[0-9]+$")),He=e.string().regex(new RegExp("^[0-9]+$")),Ke=e.enum(["shared","clickbus","test"]),Xe=e.object({requestsCPU:Ve.optional(),limitsCPU:Je.optional(),requestsMemory:We.optional(),limitsMemory:Ge.optional(),minReplicas:Qe.optional(),timeoutSeconds:He.optional(),workerType:Ke.optional()});e.object({id:N,name:$,featureFlags:k,billingMetadata:M,deploymentResources:Xe.optional()});const Ye=N,Ze=$,eo=k,oo=M;e.object({id:Ye,name:Ze,featureFlags:eo,billingMetadata:oo});const to=j;e.object({roles:to});const no=e.number(),ao=e.number();e.object({offset:no.optional(),limit:ao.optional()});const so=Ne;e.array(so);const ro=T,io=j;e.object({email:ro,roles:io});const lo=e.boolean();e.object({shouldBeOnboarded:lo.optional()});const mo=e.string(),co=e.string(),uo=e.string(),po=e.string();e.object({name:mo.optional(),companyName:co.optional(),source:uo.optional(),authorEmail:po.optional()});const Co=x({__name:"NewUser",emits:["created","cancel"],setup(l,{emit:o}){const n=ve.map(d=>({label:d,value:d})),t=A({email:"",roles:[]});function s(){o("cancel")}function m(){!t.email||o("created",t)}return(d,C)=>(h(),f(a(F),{open:"",title:"New user",width:720,"body-style":{paddingBottom:"80px"},"footer-style":{textAlign:"right"},onClose:s},{extra:i(()=>[r(a(D),null,{default:i(()=>[r(a(E),{onClick:s},{default:i(()=>[b("Cancel")]),_:1}),r(a(E),{type:"primary",onClick:m},{default:i(()=>[b("Submit")]),_:1})]),_:1})]),default:i(()=>[r(a(v),{model:t,layout:"vertical"},{default:i(()=>[r(a(O),{key:"email",label:"Email",required:!0},{default:i(()=>[r(a(I),{value:t.email,"onUpdate:value":C[0]||(C[0]=p=>t.email=p)},null,8,["value"])]),_:1}),r(a(O),{key:"role",label:"Role"},{default:i(()=>[r(a(L),{value:t.roles,"onUpdate:value":C[1]||(C[1]=p=>t.roles=p),mode:"multiple",options:a(n)},null,8,["value","options"])]),_:1})]),_:1},8,["model"])]),_:1}))}}),go=x({__name:"UpdateUser",props:{roles:{},email:{}},emits:["updated","cancel"],setup(l,{emit:o}){const n=l,t=[{value:"workflow_viewer",label:"Workflow viewer"}],s=A({roles:n.roles});function m(){o("cancel")}function d(){o("updated",s)}return(C,p)=>(h(),f(a(F),{open:"",title:"Update user",width:720,"body-style":{paddingBottom:"80px"},"footer-style":{textAlign:"right"},onClose:m},{extra:i(()=>[r(a(D),null,{default:i(()=>[r(a(E),{onClick:m},{default:i(()=>[b("Cancel")]),_:1}),r(a(E),{type:"primary",onClick:d},{default:i(()=>[b("Submit")]),_:1})]),_:1})]),default:i(()=>[r(a(v),{model:s,layout:"vertical"},{default:i(()=>[r(a(O),{key:"email",label:"Email"},{default:i(()=>[r(a(I),{value:n.email,disabled:""},null,8,["value"])]),_:1}),r(a(O),{key:"role",label:"Role"},{default:i(()=>[r(a(L),{value:s.roles,"onUpdate:value":p[0]||(p[0]=w=>s.roles=w),mode:"multiple",options:t},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1}))}}),zo=x({__name:"Users",setup(l){const n=J().params.projectId,t=W({type:"none"}),s=()=>{t.value.type="none"},m=()=>{t.value.type="new"},d=c=>{t.value={type:"edit",user:c}},C=async c=>{try{await S.create(n,c),s(),P()}catch(u){u instanceof Error&&U("Create Error",u.message)}},p=async c=>{try{if(t.value.type!=="edit")return;t.value.user.roles=c.roles,await t.value.user.change(c),s(),P()}catch(u){u instanceof Error&&U("Update Error",u.message)}},{loading:w,result:z,refetch:P}=Z(()=>S.list(n,100,0)),q=G(()=>{var c,u;return{columns:[{name:"Email"},{name:"Roles"},{name:"",align:"right"}],rows:(u=(c=z.value)==null?void 0:c.map(g=>({key:g.email,cells:[{type:"text",text:g.email},{type:"text",text:g.roles.join(", ")},{type:"actions",actions:[{icon:X,label:"Edit",onClick:()=>d(g)},{icon:Y,label:"Delete",onClick:async()=>{await g.delete(),P()}}]}]})))!=null?u:[]}});return(c,u)=>(h(),Q(K,null,[r(ee,{"entity-name":"users",loading:a(w),title:"Application users",description:"List all application users.","empty-title":"No users yet",table:q.value,"create-button-text":"Add users",onCreate:m},null,8,["loading","table"]),t.value.type==="new"?(h(),f(Co,{key:0,onCancel:s,onCreated:C})):t.value.type==="edit"?(h(),f(go,{key:1,email:t.value.user.email,roles:t.value.user.roles,onUpdated:p,onCancel:s},null,8,["email","roles"])):H("",!0)],64))}});export{zo as default};
//# sourceMappingURL=Users.70147d8b.js.map
