import{d as P,r as w,v as T,b as c,c as m,x as r,F as S,L as C,N as F,V as K,a1 as R,e as s,O as H,Q as W,q as L,K as A,z as a,t as k,w as f,D as U,H as z,J as G}from"./registerWidgets.0a925ff6.js";import{L as J}from"./CircularLoading.63d322f4.js";import{E as O}from"./Error.4a85c82e.js";import{R as Q,F as j}from"./broker.ff33ed68.js";import{R as X,_ as Y,S as Z}from"./UnsavedChangesHandler.vue_vue_type_script_setup_true_lang.70cd3f9b.js";import{T as ee,a as B}from"./Tab.a5c9c887.js";import{l as D}from"./log.b73caccb.js";import{a as I}from"./asyncComputed.57718c9c.js";import{F as te}from"./forms.3d8bf74c.js";import{W as ae}from"./workspaces.f32c860a.js";import{B as re}from"./BackButton.4f762320.js";import{S as oe}from"./SaveButton.0c666679.js";import{D as se}from"./DocsButton.a01586d7.js";import{P as le}from"./PreviewButton.d2007491.js";import"./lottie.a6ae83a3.js";import"./passwordlessManager.ab5003b1.js";import"./icons.d9ce72d6.js";import"./ActionButton.vue_vue_type_script_setup_true_lang.cdf74f91.js";import"./Passwordless.0888f9cc.js";import"./executeJs.2b64d7d8.js";import"./PlayerNavbar.82105838.js";import"./index.665bc3dc.js";import"./WidgetsFrame.3dc21625.js";import"./colors.b1b4c57b.js";import"./Modal.373fa9f4.js";import"./dashes.8f3c64dd.js";import"./activeRecord.ffa40c01.js";import"./runnerData.cb7dff48.js";import"./hooks.03ddb6e5.js";import"./jobs.f74ed002.js";import"./login.8a7aefc5.js";(function(){try{var o=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},d=new Error().stack;d&&(o._sentryDebugIds=o._sentryDebugIds||{},o._sentryDebugIds[d]="93ad582c-6702-4b00-a5a2-ad70d1a6b300",o._sentryDebugIdIdentifier="sentry-dbid-93ad582c-6702-4b00-a5a2-ad70d1a6b300")}catch{}})();const ne="forms_workspace_id_path_key",M=o=>(H("data-v-6ccbe7b5"),o=o(),W(),o),ie={class:"form-settings"},ce={class:"content"},ue={class:"subsection-label"},de={class:"property-label"},me=["value","placeholder","onChange"],pe={class:"content"},fe={class:"property"},_e=M(()=>r("div",{class:"property-label"},"Start smart form automatically",-1)),ve={class:"property"},be=M(()=>r("div",{class:"property-label"}," Allow the user to restart the smart form after it is over ",-1)),he=P({__name:"FormSettings",props:{form:null},setup(o){const t=w(o.form),_=[{label:"General",props:[{label:"Form name",valueKey:"title"}]},{label:"Welcome Screen",props:[{label:"Title",fallbackKey:"title",valueKey:"welcomeTitle"},{label:"Subtitle",valueKey:"startMessage"},{label:"Start button text",valueKey:"startButtonText"}]},{label:"Ending Screen",props:[{label:"Title",valueKey:"endMessage"},{label:"Restart button text",valueKey:"restartButtonText"}]},{label:"Alert Messages",props:[{label:"Error message",valueKey:"errorMessage"}]}],v=T({pathError:null,sectionsShown:[!0,!1,!1]}),h=p=>{p.detail.includes(ne)&&(v.pathError=l)},l="This path is already being used by another form or dash on your workspace";return addEventListener("hasura-error",h),(p,u)=>(c(),m("div",ie,[r("div",ce,[(c(),m(S,null,C(_,n=>r("div",{key:n.label,class:"subsection"},[r("div",ue,F(n.label),1),(c(!0),m(S,null,C(n.props,i=>{var b;return c(),m("div",{key:i.label,class:"property column"},[r("div",de,F(i.label),1),r("input",{class:"property-input",type:"text",value:t.value[i.valueKey],placeholder:(b=i.fallbackKey?t.value[i.fallbackKey]:null)!=null?b:"Enter message",onChange:y=>t.value[i.valueKey]=y.target.value},null,40,me)])}),128))])),64))]),r("div",pe,[r("div",fe,[K(r("input",{"onUpdate:modelValue":u[0]||(u[0]=n=>t.value.autoStart=n),class:"checkbox-input",type:"checkbox"},null,512),[[R,t.value.autoStart]]),_e]),r("div",ve,[K(r("input",{"onUpdate:modelValue":u[1]||(u[1]=n=>t.value.allowRestart=n),class:"checkbox-input",type:"checkbox"},null,512),[[R,t.value.allowRestart]]),be])]),s(X,{runtime:t.value},null,8,["runtime"])]))}});const ye=L(he,[["__scopeId","data-v-6ccbe7b5"]]),ge={class:"page"},ke={key:1,class:"error"},we=P({__name:"FormEditor",setup(o){const d=z(),t=G(),_=T({fullscreen:!1,rightPanelCollapsed:!1,hasChanges:!1,started:!1});addEventListener("keydown",e=>{(e.ctrlKey||e.metaKey)&&e.key==="s"&&(e.preventDefault(),b())});const v=w(null),{loading:h,result:l,error:p,refetch:u}=I(async()=>{const e=await te.get(t.params.formPath);return g(),e}),{result:n}=I(()=>ae.get()),i=w(!1);async function b(){var e;i.value=!0;try{await((e=l.value)==null?void 0:e.save())}finally{i.value=!1}}const y=A(()=>Q.create({isLocal:!1,formPath:t.params.formPath,isPreview:!0})),q=()=>{D.clear()},g=async()=>{var e;return D.log({type:"restart"}),(e=v.value)==null?void 0:e.run()},V=({path:e,type:x})=>{x==="dash"?d.push({name:"dashEditor",params:{dashPath:e},query:t.query}):(d.push({name:"editor",params:{formPath:e},query:t.query}),u())},N=()=>{_.started=!0},$=()=>{_.started=!1};return(e,x)=>{var E;return c(),m(S,null,[r("div",ge,[a(h)||!a(l)||!a(n)?(c(),k(J,{key:0})):a(p)?(c(),m("div",ke,[s(O,{error:a(p),onReload:a(u)},null,8,["error","onReload"])])):(c(),k(ee,{key:2},{left:f(()=>[s(re,{link:"/_editor/forms"})]),right:f(()=>[s(se),s(le,{model:a(l)},null,8,["model"]),s(oe,{model:a(l)},null,8,["model"])]),default:f(()=>[s(B,{title:"Preview"},{default:f(()=>[s(j,{ref_key:"runner",ref:v,form:a(l).makeRunnerData(a(n)),params:a(t).query,"is-preview":!0,"enable-auto-focus":!1,broker:a(y),style:{height:"unset",flex:1,overflow:"hidden"},onNavigate:V,onLogout:g,onExit:$,onStart:N},null,8,["form","params","broker"])]),_:1}),s(B,{title:"Settings"},{default:f(()=>[s(ye,{form:a(l)},null,8,["form"])]),_:1})]),_:1})),a(l)?(c(),k(Z,{key:3,runtime:"forms",onRestart:g,onClearTerminal:q})):U("",!0)]),s(Y,{"has-changes":(E=a(l))==null?void 0:E.hasChanges()},null,8,["has-changes"])],64)}}});const et=L(we,[["__scopeId","data-v-b68827d7"]]);export{et as default};
//# sourceMappingURL=FormEditor.e71461c9.js.map
