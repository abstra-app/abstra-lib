import{d as M,X as D,H as k,b as r,eu as h,dj as pe,ew as L,ez as ge,e as _,f as l,eG as X,eQ as xe,r as Y,F as je,c as g,w as i,eB as V,aq as v,eD as P,u as a,cL as $e,aC as N,cD as z,v as B,bf as De,eJ as he,eC as ee,aG as be,cl as Se,eE as ze,eF as Te,eR as Fe,bF as J,eI as Ue,I as Ve,o as Ne,K as Ze,ad as qe,dh as Be,cC as Ke}from"./outputWidgets.1c4947c7.js";import{a as ye}from"./asyncComputed.ab9c45d0.js";import"./workspaces.bc120589.js";import{S as He}from"./scripts.55ff0a20.js";import"./envVars.0b2f36d2.js";import{A as Je}from"./api.f47cf93f.js";import{z as e}from"./index.cf4c23b9.js";import{t as We}from"./ant-design.5014c7e6.js";import{A as U}from"./Text.4ed32514.js";import{A as R}from"./index.a9af7b0b.js";import{s as te}from"./metadata.369776f7.js";import{A as W}from"./index.83f629a7.js";import{f as Ge}from"./index.8dc832f8.js";import{A as ce}from"./Paragraph.110c4a21.js";import"./index.4e91d000.js";import{A as H}from"./Title.6f4ab7f6.js";import{T as Qe,A as Xe}from"./index.a47624b1.js";import{A as Ae,C as fe}from"./CollapsePanel.bf2d665e.js";import{A as Ye}from"./Link.1d840e4c.js";import{A as et}from"./index.8bbe8aff.js";import{A as tt}from"./index.34bcb4c7.js";import{E as at}from"./ExpandOutlined.66343aca.js";import{C as nt}from"./Card.10f7bd77.js";import{d as ot}from"./vuedraggable.umd.87b5786b.js";import"./index.3d6e7f2d.js";import{F as st,A as it}from"./Form.cba5cdce.js";import{l as Ce}from"./fetch.af8f049b.js";(function(){try{var o=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},t=new Error().stack;t&&(o._sentryDebugIds=o._sentryDebugIds||{},o._sentryDebugIds[t]="d9389aad-c949-461d-8b43-a0f2cc2cb64a",o._sentryDebugIdIdentifier="sentry-dbid-d9389aad-c949-461d-8b43-a0f2cc2cb64a")}catch{}})();var rt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zM641.7 520.8L442.3 677.6c-7.4 5.8-18.3.6-18.3-8.8V355.3c0-9.4 10.9-14.7 18.3-8.8l199.4 156.7a11.2 11.2 0 010 17.6z"}}]},name:"play-square",theme:"filled"};const lt=rt;var ct={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M168 504.2c1-43.7 10-86.1 26.9-126 17.3-41 42.1-77.7 73.7-109.4S337 212.3 378 195c42.4-17.9 87.4-27 133.9-27s91.5 9.1 133.8 27A341.5 341.5 0 01755 268.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.7 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c0-6.7-7.7-10.5-12.9-6.3l-56.4 44.1C765.8 155.1 646.2 92 511.8 92 282.7 92 96.3 275.6 92 503.8a8 8 0 008 8.2h60c4.4 0 7.9-3.5 8-7.8zm756 7.8h-60c-4.4 0-7.9 3.5-8 7.8-1 43.7-10 86.1-26.9 126-17.3 41-42.1 77.8-73.7 109.4A342.45 342.45 0 01512.1 856a342.24 342.24 0 01-243.2-100.8c-9.9-9.9-19.2-20.4-27.8-31.4l60.2-47a8 8 0 00-3-14.1l-175.7-43c-5-1.2-9.9 2.6-9.9 7.7l-.7 181c0 6.7 7.7 10.5 12.9 6.3l56.4-44.1C258.2 868.9 377.8 932 512.2 932c229.2 0 415.5-183.7 419.8-411.8a8 8 0 00-8-8.2z"}}]},name:"sync",theme:"outlined"};const ut=ct,mt=["width","height","fill","transform"],dt={key:0},pt=_("path",{d:"M228,64a36,36,0,1,0-48,33.94V104a12,12,0,0,1-12,12H88a12,12,0,0,1-12-12V97.94a36,36,0,1,0-24,0V104a36,36,0,0,0,36,36h28v18.06a36,36,0,1,0,24,0V140h28a36,36,0,0,0,36-36V97.94A36.07,36.07,0,0,0,228,64ZM64,52A12,12,0,1,1,52,64,12,12,0,0,1,64,52Zm64,152a12,12,0,1,1,12-12A12,12,0,0,1,128,204ZM192,76a12,12,0,1,1,12-12A12,12,0,0,1,192,76Z"},null,-1),gt=[pt],ht={key:1},bt=_("path",{d:"M88,64A24,24,0,1,1,64,40,24,24,0,0,1,88,64ZM192,40a24,24,0,1,0,24,24A24,24,0,0,0,192,40Z",opacity:"0.2"},null,-1),St=_("path",{d:"M224,64a32,32,0,1,0-40,31v9a16,16,0,0,1-16,16H88a16,16,0,0,1-16-16V95a32,32,0,1,0-16,0v9a32,32,0,0,0,32,32h32v25a32,32,0,1,0,16,0V136h32a32,32,0,0,0,32-32V95A32.06,32.06,0,0,0,224,64ZM48,64A16,16,0,1,1,64,80,16,16,0,0,1,48,64Zm96,128a16,16,0,1,1-16-16A16,16,0,0,1,144,192ZM192,80a16,16,0,1,1,16-16A16,16,0,0,1,192,80Z"},null,-1),yt=[bt,St],At={key:2},ft=_("path",{d:"M224,64a32,32,0,1,0-40,31v9a16,16,0,0,1-16,16H88a16,16,0,0,1-16-16V95a32,32,0,1,0-16,0v9a32,32,0,0,0,32,32h32v25a32,32,0,1,0,16,0V136h32a32,32,0,0,0,32-32V95A32.06,32.06,0,0,0,224,64ZM144,192a16,16,0,1,1-16-16A16,16,0,0,1,144,192Z"},null,-1),Ct=[ft],vt={key:3},_t=_("path",{d:"M222,64a30,30,0,1,0-36,29.4V104a18,18,0,0,1-18,18H88a18,18,0,0,1-18-18V93.4a30,30,0,1,0-12,0V104a30,30,0,0,0,30,30h34v28.6a30,30,0,1,0,12,0V134h34a30,30,0,0,0,30-30V93.4A30.05,30.05,0,0,0,222,64ZM46,64A18,18,0,1,1,64,82,18,18,0,0,1,46,64ZM146,192a18,18,0,1,1-18-18A18,18,0,0,1,146,192ZM192,82a18,18,0,1,1,18-18A18,18,0,0,1,192,82Z"},null,-1),Rt=[_t],Lt={key:4},Pt=_("path",{d:"M224,64a32,32,0,1,0-40,31v9a16,16,0,0,1-16,16H88a16,16,0,0,1-16-16V95a32,32,0,1,0-16,0v9a32,32,0,0,0,32,32h32v25a32,32,0,1,0,16,0V136h32a32,32,0,0,0,32-32V95A32.06,32.06,0,0,0,224,64ZM48,64A16,16,0,1,1,64,80,16,16,0,0,1,48,64Zm96,128a16,16,0,1,1-16-16A16,16,0,0,1,144,192ZM192,80a16,16,0,1,1,16-16A16,16,0,0,1,192,80Z"},null,-1),wt=[Pt],Ot={key:5},Et=_("path",{d:"M220,64a28,28,0,1,0-32,27.71V104a20,20,0,0,1-20,20H88a20,20,0,0,1-20-20V91.71a28,28,0,1,0-8,0V104a28,28,0,0,0,28,28h36v32.29a28,28,0,1,0,8,0V132h36a28,28,0,0,0,28-28V91.71A28,28,0,0,0,220,64ZM44,64A20,20,0,1,1,64,84,20,20,0,0,1,44,64ZM148,192a20,20,0,1,1-20-20A20,20,0,0,1,148,192ZM192,84a20,20,0,1,1,20-20A20,20,0,0,1,192,84Z"},null,-1),kt=[Et],It={name:"PhGitFork"},Mt=M({...It,props:{weight:{type:String},size:{type:[String,Number]},color:{type:String},mirrored:{type:Boolean}},setup(o){const t=o,n=D("weight","regular"),c=D("size","1em"),s=D("color","currentColor"),u=D("mirrored",!1),m=k(()=>{var d;return(d=t.weight)!=null?d:n}),p=k(()=>{var d;return(d=t.size)!=null?d:c}),f=k(()=>{var d;return(d=t.color)!=null?d:s}),A=k(()=>t.mirrored!==void 0?t.mirrored?"scale(-1, 1)":void 0:u?"scale(-1, 1)":void 0);return(d,x)=>(r(),h("svg",ge({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256",width:p.value,height:p.value,fill:f.value,transform:A.value},d.$attrs),[pe(d.$slots,"default"),m.value==="bold"?(r(),h("g",dt,gt)):m.value==="duotone"?(r(),h("g",ht,yt)):m.value==="fill"?(r(),h("g",At,Ct)):m.value==="light"?(r(),h("g",vt,Rt)):m.value==="regular"?(r(),h("g",Lt,wt)):m.value==="thin"?(r(),h("g",Ot,kt)):L("",!0)],16,mt))}}),xt=["width","height","fill","transform"],jt={key:0},$t=_("path",{d:"M144,180a16,16,0,1,1-16-16A16,16,0,0,1,144,180Zm92-52A108,108,0,1,1,128,20,108.12,108.12,0,0,1,236,128Zm-24,0a84,84,0,1,0-84,84A84.09,84.09,0,0,0,212,128ZM128,64c-24.26,0-44,17.94-44,40v4a12,12,0,0,0,24,0v-4c0-8.82,9-16,20-16s20,7.18,20,16-9,16-20,16a12,12,0,0,0-12,12v8a12,12,0,0,0,23.73,2.56C158.31,137.88,172,122.37,172,104,172,81.94,152.26,64,128,64Z"},null,-1),Dt=[$t],zt={key:1},Tt=_("path",{d:"M224,128a96,96,0,1,1-96-96A96,96,0,0,1,224,128Z",opacity:"0.2"},null,-1),Ft=_("path",{d:"M140,180a12,12,0,1,1-12-12A12,12,0,0,1,140,180ZM128,72c-22.06,0-40,16.15-40,36v4a8,8,0,0,0,16,0v-4c0-11,10.77-20,24-20s24,9,24,20-10.77,20-24,20a8,8,0,0,0-8,8v8a8,8,0,0,0,16,0v-.72c18.24-3.35,32-17.9,32-35.28C168,88.15,150.06,72,128,72Zm104,56A104,104,0,1,1,128,24,104.11,104.11,0,0,1,232,128Zm-16,0a88,88,0,1,0-88,88A88.1,88.1,0,0,0,216,128Z"},null,-1),Ut=[Tt,Ft],Vt={key:2},Nt=_("path",{d:"M128,24A104,104,0,1,0,232,128,104.11,104.11,0,0,0,128,24Zm0,168a12,12,0,1,1,12-12A12,12,0,0,1,128,192Zm8-48.72V144a8,8,0,0,1-16,0v-8a8,8,0,0,1,8-8c13.23,0,24-9,24-20s-10.77-20-24-20-24,9-24,20v4a8,8,0,0,1-16,0v-4c0-19.85,17.94-36,40-36s40,16.15,40,36C168,125.38,154.24,139.93,136,143.28Z"},null,-1),Zt=[Nt],qt={key:3},Bt=_("path",{d:"M138,180a10,10,0,1,1-10-10A10,10,0,0,1,138,180ZM128,74c-21,0-38,15.25-38,34v4a6,6,0,0,0,12,0v-4c0-12.13,11.66-22,26-22s26,9.87,26,22-11.66,22-26,22a6,6,0,0,0-6,6v8a6,6,0,0,0,12,0v-2.42c18.11-2.58,32-16.66,32-33.58C166,89.25,149,74,128,74Zm102,54A102,102,0,1,1,128,26,102.12,102.12,0,0,1,230,128Zm-12,0a90,90,0,1,0-90,90A90.1,90.1,0,0,0,218,128Z"},null,-1),Kt=[Bt],Ht={key:4},Jt=_("path",{d:"M140,180a12,12,0,1,1-12-12A12,12,0,0,1,140,180ZM128,72c-22.06,0-40,16.15-40,36v4a8,8,0,0,0,16,0v-4c0-11,10.77-20,24-20s24,9,24,20-10.77,20-24,20a8,8,0,0,0-8,8v8a8,8,0,0,0,16,0v-.72c18.24-3.35,32-17.9,32-35.28C168,88.15,150.06,72,128,72Zm104,56A104,104,0,1,1,128,24,104.11,104.11,0,0,1,232,128Zm-16,0a88,88,0,1,0-88,88A88.1,88.1,0,0,0,216,128Z"},null,-1),Wt=[Jt],Gt={key:5},Qt=_("path",{d:"M136,180a8,8,0,1,1-8-8A8,8,0,0,1,136,180ZM128,76c-19.85,0-36,14.36-36,32v4a4,4,0,0,0,8,0v-4c0-13.23,12.56-24,28-24s28,10.77,28,24-12.56,24-28,24a4,4,0,0,0-4,4v8a4,4,0,0,0,8,0v-4.2c18-1.77,32-15.36,32-31.8C164,90.36,147.85,76,128,76Zm100,52A100,100,0,1,1,128,28,100.11,100.11,0,0,1,228,128Zm-8,0a92,92,0,1,0-92,92A92.1,92.1,0,0,0,220,128Z"},null,-1),Xt=[Qt],Yt={name:"PhQuestion"},ea=M({...Yt,props:{weight:{type:String},size:{type:[String,Number]},color:{type:String},mirrored:{type:Boolean}},setup(o){const t=o,n=D("weight","regular"),c=D("size","1em"),s=D("color","currentColor"),u=D("mirrored",!1),m=k(()=>{var d;return(d=t.weight)!=null?d:n}),p=k(()=>{var d;return(d=t.size)!=null?d:c}),f=k(()=>{var d;return(d=t.color)!=null?d:s}),A=k(()=>t.mirrored!==void 0?t.mirrored?"scale(-1, 1)":void 0:u?"scale(-1, 1)":void 0);return(d,x)=>(r(),h("svg",ge({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256",width:p.value,height:p.value,fill:f.value,transform:A.value},d.$attrs),[pe(d.$slots,"default"),m.value==="bold"?(r(),h("g",jt,Dt)):m.value==="duotone"?(r(),h("g",zt,Ut)):m.value==="fill"?(r(),h("g",Vt,Zt)):m.value==="light"?(r(),h("g",qt,Kt)):m.value==="regular"?(r(),h("g",Ht,Wt)):m.value==="thin"?(r(),h("g",Gt,Xt)):L("",!0)],16,xt))}});function ue(o){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?Object(arguments[t]):{},c=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(c=c.concat(Object.getOwnPropertySymbols(n).filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable}))),c.forEach(function(s){ta(o,s,n[s])})}return o}function ta(o,t,n){return t in o?Object.defineProperty(o,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):o[t]=n,o}var ae=function(t,n){var c=ue({},t,n.attrs);return l(X,ue({},c,{icon:xe}),null)};ae.displayName="EyeInvisibleOutlined";ae.inheritAttrs=!1;const aa=ae;function me(o){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?Object(arguments[t]):{},c=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(c=c.concat(Object.getOwnPropertySymbols(n).filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable}))),c.forEach(function(s){na(o,s,n[s])})}return o}function na(o,t,n){return t in o?Object.defineProperty(o,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):o[t]=n,o}var ne=function(t,n){var c=me({},t,n.attrs);return l(X,me({},c,{icon:lt}),null)};ne.displayName="PlaySquareFilled";ne.inheritAttrs=!1;const oa=ne;function de(o){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?Object(arguments[t]):{},c=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(c=c.concat(Object.getOwnPropertySymbols(n).filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable}))),c.forEach(function(s){sa(o,s,n[s])})}return o}function sa(o,t,n){return t in o?Object.defineProperty(o,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):o[t]=n,o}var oe=function(t,n){var c=de({},t,n.attrs);return l(X,de({},c,{icon:ut}),null)};oe.displayName="SyncOutlined";oe.inheritAttrs=!1;const ia=oe;function ra(){const o=Y({state:"closed"});function t(){o.value={state:"closed"}}function n(){o.value={state:"visualizations"}}function c(u,m){o.value={state:"stage-run",stageRun:m}}const s=k(()=>"stageRun"in o.value?o.value.stageRun:null);return{closeDrawer:t,openVisualizationEditor:n,inspectStageRun:c,drawerState:o,selectedStageRunForDrawer:s}}const F="kanban-selected-stage-ids",Z=10,la=({kanbanRepository:o,storage:t,filterFactory:n,router:c})=>{const s=je([]),u=ye(async()=>{try{const b=await o.getData({selection:s.value,filter:n()}),S=await t.get(F)||[];for(const y of b.not_found_stages)t.set(F,S.filter(C=>C!==y)),s.value=s.value.filter(C=>C.stage_id!==y);return b}catch{return s.value=[],await t.set(F,[]),{columns:[],next_stage_options:[]}}});function m(b){const S=b.selected_stage.id,y=s.value.find(C=>C.stage_id===S);return y!=null&&y.limit?y.limit<b.total_count:!1}async function p(b){var y;const S=s.value.find(C=>C.stage_id===b.selected_stage.id);S&&(S.limit=((y=S.limit)!=null?y:0)+Z,await u.refetch())}async function f(b){const S=s.value.find(y=>y.stage_id===b);S&&S.limit&&S.limit>Z&&(S.limit-=Z,await u.refetch())}async function A(){const b=await t.get(F)||[];s.value=b.map(S=>({stage_id:S,limit:Z,offset:0}))}async function d(b,S){b?s.value=[...s.value.slice(0,S),{stage_id:b.id,limit:Z,offset:0},...s.value.slice(S+1)]:s.value=[...s.value.slice(0,S),...s.value.slice(S+1)],await t.set(F,s.value.map(y=>y.stage_id)),await u.refetch()}async function x(b){await d(b,s.value.length)}async function w(b){const S=s.value[b.moved.oldIndex];d(null,b.moved.oldIndex),s.value=[...s.value.slice(0,b.moved.newIndex),S,...s.value.slice(b.moved.newIndex)],await t.set(F,s.value.map(y=>y.stage_id)),await u.refetch()}let O=null;return{kanbanAsyncComputed:u,selection:s,increasePagination:p,hasPagination:m,seeLess:f,setStage:d,addStage:x,cardActionHandler:async(b,S)=>{const y=b.selected_stage,C=S.id;if(y.type==="script"){const I=await He.get(y.id);if(!I)return;await I.run(C)}if(y.type==="form"){const I=c.resolve({path:`/${y.path}`,query:C?{[Je]:C}:{}});window.open(I.href,C)}},setup:async()=>{await A(),u.refetch(),O=setInterval(()=>{u.refetch()},1e3)},tearDown:()=>{O&&clearInterval(O)},reorderStages:w}},ca=e.boolean(),ua=e.boolean(),ma=e.boolean(),da=e.boolean();e.object({PROJECT_LIVE:ca.optional(),ALLOW_RELEASE:ua.optional(),CONNECTORS_CONSOLE:ma.optional(),DUPLICATE_PROJECTS:da.optional()});const pa=e.string(),ga=e.string(),ha=e.string(),ba=e.string(),Sa=e.string();e.object({plan:pa.optional(),expires:ga.optional(),message:ha.optional(),messageLink:ba.optional(),messageCTA:Sa.optional()});const ya=e.string(),ve=e.string(),se=e.string(),Aa=e.string(),fa=e.string(),Ca=e.object({id:ya,name:ve,description:se.optional(),projectId:Aa,createdAt:fa}),va=e.string(),_a=e.string(),Ra=e.string(),La=e.string(),Pa=e.string().regex(new RegExp("^[0-9]+m$")),wa=e.string().regex(new RegExp("^[0-9]+m$")),Oa=e.string().regex(new RegExp("^[0-9]+Mi$")),Ea=e.string().regex(new RegExp("^[0-9]+Mi$")),ka=e.string().regex(new RegExp("^[0-9]+$")),Ia=e.string().regex(new RegExp("^[0-9]+$")),Ma=e.enum(["shared","clickbus","test"]),xa=e.object({requestsCPU:Pa.optional(),limitsCPU:wa.optional(),requestsMemory:Oa.optional(),limitsMemory:Ea.optional(),minReplicas:ka.optional(),timeoutSeconds:Ia.optional(),workerType:Ma.optional()});e.object({id:va,name:_a,subdomain:Ra,organizationId:La,deploymentResources:xa.optional()});const ja=e.string(),$a=e.string(),_e=e.array($a),Re=e.string(),Da=e.string();e.object({id:ja,emailPatterns:_e,projectId:Re,createdAt:Da});const za=e.string().regex(new RegExp("^[0-9]+m$")),Ta=e.string().regex(new RegExp("^[0-9]+m$")),Fa=e.string().regex(new RegExp("^[0-9]+Mi$")),Ua=e.string().regex(new RegExp("^[0-9]+Mi$")),Va=e.string().regex(new RegExp("^[0-9]+$")),Na=e.string().regex(new RegExp("^[0-9]+$")),Za=e.enum(["shared","clickbus","test"]);e.object({requestsCPU:za.optional(),limitsCPU:Ta.optional(),requestsMemory:Fa.optional(),limitsMemory:Ua.optional(),minReplicas:Va.optional(),timeoutSeconds:Na.optional(),workerType:Za.optional()});const qa=e.string(),G=e.string().email(),Ba=e.string(),ie=e.array(Ba),Ka=e.string(),Ha=e.string(),Ja=e.object({id:qa,email:G,roles:ie,projectId:Ka,createdAt:Ha}),Le=e.string(),Pe=e.string(),Wa=e.boolean(),Ga=e.boolean(),Qa=e.boolean(),Xa=e.boolean(),we=e.object({PROJECT_LIVE:Wa,ALLOW_RELEASE:Ga,CONNECTORS_CONSOLE:Qa,DUPLICATE_PROJECTS:Xa}),Ya=e.string(),en=e.string(),tn=e.string(),an=e.string(),nn=e.string(),Oe=e.object({plan:Ya.optional(),expires:en.optional(),message:tn.optional(),messageLink:an.optional(),messageCTA:nn.optional()}),on=e.string().regex(new RegExp("^[0-9]+m$")),sn=e.string().regex(new RegExp("^[0-9]+m$")),rn=e.string().regex(new RegExp("^[0-9]+Mi$")),ln=e.string().regex(new RegExp("^[0-9]+Mi$")),cn=e.string().regex(new RegExp("^[0-9]+$")),un=e.string().regex(new RegExp("^[0-9]+$")),mn=e.enum(["shared","clickbus","test"]),dn=e.object({requestsCPU:on.optional(),limitsCPU:sn.optional(),requestsMemory:rn.optional(),limitsMemory:ln.optional(),minReplicas:cn.optional(),timeoutSeconds:un.optional(),workerType:mn.optional()}),pn=e.string(),gn=e.array(pn),hn=e.object({whitelistPatterns:gn.optional()});e.object({id:Le,name:Pe,featureFlags:we,billingMetadata:Oe,deploymentResources:dn.optional(),membershipsMetadata:hn.optional()});const bn=e.string(),Sn=e.array(bn);e.object({whitelistPatterns:Sn.optional()});const yn=Le,An=Pe,fn=we,Cn=Oe;e.object({id:yn,name:An,featureFlags:fn,billingMetadata:Cn});const vn=se;e.object({description:vn});const _n=e.number(),Rn=e.number();e.object({offset:_n.optional(),limit:Rn.optional()});const Ln=Ca;e.array(Ln);const Pn=ve,wn=se;e.object({name:Pn,description:wn.optional()});const On=G,En=ie;e.object({email:On.optional(),roles:En.optional()});const kn=e.number(),In=e.number();e.object({offset:kn.optional(),limit:In.optional()});const Mn=Ja;e.array(Mn);const xn=G,jn=ie;e.object({email:xn,roles:jn});const $n=_e;e.object({emailPatterns:$n});const Dn=Re;e.object({projectId:Dn});const zn=e.boolean();e.object({shouldBeOnboarded:zn.optional()});const Tn=e.string(),Fn=e.string(),Un=e.string(),Vn=e.string();e.object({name:Tn.optional(),companyName:Fn.optional(),source:Un.optional(),authorEmail:Vn.optional()});const Nn=e.string(),Zn=e.record(e.any()),qn=e.string(),Bn=e.object({key:Nn,value:Zn,type:qn}),Kn=Bn,Hn=e.array(Kn),Jn=e.string(),Wn=e.enum(["text","image","table","progress-bar"]),Gn=e.object({name:Jn,type:Wn}),Qn=e.string(),Xn=e.string(),Yn=e.record(e.any()),Ee=e.enum(["waiting","running","processing","finished","failed","abandoned"]),eo=["waiting","running","processing","finished","failed","abandoned"],to=e.string(),ao=e.string(),no=e.string(),oo=e.string();e.object({id:Qn,stage:Xn,data:Yn,status:Ee,created_at:to,updated_at:ao,parent_id:no.optional(),execution_id:oo.optional()});const so=e.string(),io=e.string(),ro=e.string(),lo=e.string(),co=Ee,uo=Hn,mo=e.object({id:so,created_at:io,updated_at:ro.optional(),assignee:lo.optional(),status:co,content:uo}),po=mo,go=e.array(po),ho=e.string(),bo=e.enum(["form","hook","job","script","iterator","condition"]),So=e.string(),yo=e.string(),Ao=e.boolean(),ke=e.object({id:ho,type:bo,title:So,path:yo.optional(),can_be_started:Ao}),fo=ke,Co=go,vo=ke,Ie=e.array(vo),_o=Ie,Ro=e.number(),Lo=e.object({selected_stage:fo,stage_run_cards:Co,stages:_o,total_count:Ro}),Po=Lo,wo=e.array(Po),Oo=wo,Eo=Ie,ko=e.string(),Io=e.array(ko);e.object({columns:Oo,next_stage_options:Eo,not_found_stages:Io});const Mo=Gn;e.array(Mo);const xo=e.string(),jo=e.string(),$o=e.literal("bug"),Do=e.string(),zo=e.string(),To=e.string(),Fo=e.object({name:zo,label:To}),Uo=Fo,Vo=e.array(Uo),No=e.object({label:Do,fixes:Vo}),Zo=No,qo=e.array(Zo),Bo=e.object({name:xo,label:jo,type:$o,issues:qo}),Ko=e.boolean();e.object({success:Ko});const Ho=Bo;e.array(Ho);const Jo=e.string(),Wo=e.string(),Go=e.object({key:Jo,value:Wo}),Qo=Go;e.array(Qo);const Xo=G;e.object({email:Xo});const Yo=e.enum(["ALLOWED","UNAUTHORIZED","FORBIDEN"]);e.object({status:Yo});function re(o){switch(o.status){case"waiting":return{color:"blue",text:"Waiting"};case"running":case"processing":return{color:"processing",text:"Running"};case"finished":return{color:"success",text:"Success"};case"failed":return{color:"error",text:"Failed"};case"abandoned":return{color:"warning",text:"Abandoned"}}}const q="Show All",es=[q,...eo];function ts(){const o=Y(q);return{filterStatus:o,filterFactory:()=>o.value==q?{}:{status:o.value},labelOption:c=>c==q?q:re({status:c}).text}}const Q=M({__name:"StageRunData",props:{data:{}},setup(o){return(t,n)=>(r(),g(a(z),{direction:"vertical",style:{overflow:"hidden"}},{default:i(()=>[(r(!0),h(N,null,V(t.data,c=>(r(),h("div",{key:c.key},[l(a(U),{strong:""},{default:i(()=>[v(P(c.key),1)]),_:2},1024),l(a($e),{"tree-data":a(We)(c.value),selectable:!1},null,8,["tree-data"])]))),128))]),_:1}))}}),as={key:0},ns={key:1,class:"terminal"},os=M({__name:"ExecutionInspector",props:{logs:{}},setup(o){return(t,n)=>t.logs.length===0?(r(),h("span",as)):(r(),h("div",ns,[l(a(R),{vertical:""},{default:i(()=>[(r(!0),h(N,null,V(t.logs,c=>(r(),h("pre",{key:c.executionId,class:"log-text"},P(c.payload.text),1))),128))]),_:1})]))}});const ss=B(os,[["__scopeId","data-v-4e71a195"]]),is=o=>(ze("data-v-b7151dd7"),o=o(),Te(),o),rs={key:1},ls={key:1},cs=is(()=>_("span",null,"[Deleted Stage]",-1)),us=["onClick"],ms=M({__name:"StageRunInspector",props:{stageRun:{},kanbanRepository:{},stageRunRepository:{}},emits:["close"],setup(o,{emit:t}){const n=o;function c(p){return Object.entries(p).map(([f,A])=>({key:f,value:A,type:typeof A}))}const{result:s,loading:u}=ye(()=>{var p;return n.kanbanRepository.getLogs((p=n.stageRun)==null?void 0:p.id)}),m=(p,f)=>{var A;p.stopPropagation(),(A=n.stageRunRepository)==null||A.fork(f),t("close")};return(p,f)=>(r(),g(a(tt),{open:"",title:"Thread details",size:"large",onClose:f[0]||(f[0]=A=>t("close"))},{extra:i(()=>[l(a(ce),null,{default:i(()=>[l(a(W),{style:{"font-weight":"600"}},{default:i(()=>{var A;return[v(P(a(re)({status:(A=p.stageRun)==null?void 0:A.status}).text),1)]}),_:1}),v(" "+P(a(Ge)(new Date(p.stageRun.created_at),{addSuffix:!0})),1)]),_:1})]),default:i(()=>{var A,d,x;return[(A=p.stageRun)!=null&&A.assignee?(r(),g(a(ce),{key:0},{default:i(()=>{var w;return[v(" Assignee: "+P((w=p.stageRun)==null?void 0:w.assignee),1)]}),_:1})):L("",!0),((d=p.stageRun)==null?void 0:d.content)&&((x=p.stageRun)==null?void 0:x.content.length)>0?(r(),h("div",rs,[l(a(H),{level:4},{default:i(()=>[v("Current data")]),_:1}),l(Q,{data:p.stageRun.content},null,8,["data"])])):L("",!0),l(a(H),{level:4,style:{"margin-bottom":"30px"}},{default:i(()=>[v(" Timeline ")]),_:1}),a(u)?(r(),g(a(De),{key:2})):a(s)?(r(),g(a(Qe),{key:3},{default:i(()=>[(r(!0),h(N,null,V(a(s),({stage:w,stage_run:O,logs:j})=>(r(),g(a(Xe),{key:O.id},{default:i(()=>[l(a(fe),{ghost:"","expand-icon-position":"end"},{default:i(()=>[l(a(Ae),{class:"panel"},he({header:i(()=>[w?(r(),g(a(R),{key:0,align:"center",gap:15},{default:i(()=>[(r(),g(ee(a(te)(w.type)))),j.length?(r(),h("span",ls,P(w.title),1)):(r(),g(a(be),{key:0,placement:"right",title:"No logs"},{default:i(()=>[v(P(w.title),1)]),_:2},1024))]),_:2},1024)):(r(),g(a(R),{key:1,align:"center",gap:15},{default:i(()=>[l(a(ea)),cs]),_:1}))]),default:i(()=>[c(O.data).length||j.length?(r(),g(a(R),{key:0,vertical:""},{default:i(()=>[c(O.data).length?(r(),g(a(R),{key:0,gap:0,vertical:""},{default:i(()=>[l(a(H),{level:5},{default:i(()=>[v(" Output data ")]),_:1}),l(Q,{data:c(O.data)},null,8,["data"])]),_:2},1024)):L("",!0),j.length?(r(),g(a(R),{key:1,vertical:"",gap:0},{default:i(()=>[l(a(et)),l(a(H),{level:5},{default:i(()=>[v(" Logs ")]),_:1}),l(ss,{logs:j},null,8,["logs"])]),_:2},1024)):L("",!0)]),_:2},1024)):(r(),g(a(Se),{key:1,description:"No logs"}))]),_:2},[p.stageRunRepository&&w?{name:"extra",fn:i(()=>[_("span",{onClick:K=>m(K,O.id)},[l(a(R),{gap:"small"},{default:i(()=>[l(a(Mt),{size:"22"}),l(a(Ye),null,{default:i(()=>[v("Fork")]),_:1})]),_:1})],8,us)]),key:"0"}:void 0]),1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})):L("",!0)]}),_:1}))}});const ds=B(ms,[["__scopeId","data-v-b7151dd7"]]),ps=M({__name:"Card",props:{stage:{},card:{}},emits:["inspect","action"],setup(o){const t=o,n=k(()=>re({status:t.card.status}).text),c=k(()=>Fe(new Date(String(t.card.updated_at))));return(s,u)=>{var m,p;return r(),g(a(nt),{size:"small",style:{cursor:"pointer"},"head-style":{"border-bottom":((m=s.card.content)==null?void 0:m.length)>0?"":"none"},"body-style":{display:((p=s.card.content)==null?void 0:p.length)>0?"block":"none"}},he({title:i(()=>[l(a(W),null,{default:i(()=>[v(P(n.value)+" ",1),n.value==="Running"?(r(),g(a(ia),{key:0,spin:!0,style:{"margin-left":"4px"}})):L("",!0)]),_:1})]),default:i(()=>[l(a(z),{direction:"vertical",style:{"max-height":"300px",width:"100%",overflow:"hidden"},onClick:u[0]||(u[0]=f=>s.$emit("inspect"))},{default:i(()=>[l(Q,{data:s.card.content,disabled:!0},null,8,["data"]),s.card.assignee?(r(),g(a(W),{key:0},{default:i(()=>[v(P(s.card.assignee),1)]),_:1})):L("",!0)]),_:1})]),extra:i(()=>[l(a(R),{gap:"10"},{default:i(()=>[l(a(be),null,{title:i(()=>[v(P(s.card.updated_at),1)]),default:i(()=>[l(a(U),{type:"secondary",style:{"font-size":"12px"}},{default:i(()=>[v(P(c.value),1)]),_:1})]),_:1}),l(a(at),{onClick:u[2]||(u[2]=f=>s.$emit("inspect"))})]),_:1})]),_:2},[s.card.status==="waiting"?{name:"actions",fn:i(()=>[l(a(J),{onClick:u[1]||(u[1]=f=>s.$emit("action"))},{default:i(()=>[l(a(oa)),v(" Continue this thread ")]),_:1})]),key:"0"}:void 0]),1032,["head-style","body-style"])}}});class gs{constructor(t,n,c){this.router=t,this.column=n,this.kanbanRepository=c}get stage(){return this.column.selected_stage}get canStart(){return this.stage.can_be_started}get launchLink(){return!this.stage.can_be_started||this.stage.type!=="form"||!this.stage.path?null:this.router.resolve({path:`/${this.stage.path}`}).href}click(){if(this.launchLink)return window.open(this.launchLink,"_blank");if(this.stage.type==="job")return this.kanbanRepository.startJob(this.stage.id).catch(console.error)}}const hs=M({__name:"Column",props:{router:{},hasPagination:{type:Boolean},column:{},kanbanRepository:{}},emits:["increasePagination","cardAction","stageUpdate","cardInspection"],setup(o,{emit:t}){const n=o,c=k(()=>new gs(n.router,n.column,n.kanbanRepository));return(s,u)=>(r(),g(a(z),{direction:"vertical",class:"stage-column"},{default:i(()=>[l(a(z),{direction:"horizontal",style:{width:"100%","justify-content":"space-between"}},{default:i(()=>[l(a(R),{gap:"8",style:{"max-width":"200px","padding-left":"10px"}},{default:i(()=>[l(a(R),null,{default:i(()=>[(r(),g(ee(a(te)(s.column.selected_stage.type)),{size:"20"}))]),_:1}),l(a(U),{ellipsis:"",content:s.column.selected_stage.title},null,8,["content"])]),_:1}),l(a(z),null,{default:i(()=>[l(a(U),{type:"secondary",style:{"font-size":"small","margin-right":"2px"}},{default:i(()=>[v(P(s.column.total_count),1)]),_:1}),l(a(J),{type:"text",style:{padding:"4px"},onClick:u[0]||(u[0]=m=>t("stageUpdate",null))},{default:i(()=>[l(a(U),{type:"secondary",style:{"font-size":"small","margin-right":"2px"}},{default:i(()=>[l(a(aa))]),_:1})]),_:1})]),_:1})]),_:1}),l(a(z),{direction:"vertical",style:{width:"100%"}},{default:i(()=>[s.column.stage_run_cards.length===0?(r(),g(a(Se),{key:0})):L("",!0),(r(!0),h(N,null,V(s.column.stage_run_cards,m=>(r(),g(ps,{key:m.id,stage:s.column.selected_stage,card:m,onInspect:p=>t("cardInspection",m),onAction:p=>t("cardAction",m)},null,8,["stage","card","onInspect","onAction"]))),128)),s.hasPagination?(r(),g(a(J),{key:1,style:{width:"100%"},onClick:u[1]||(u[1]=m=>t("increasePagination"))},{default:i(()=>[v("See more")]),_:1})):L("",!0),c.value.canStart?(r(),g(a(J),{key:2,style:{width:"100%"},onClick:u[2]||(u[2]=()=>c.value.click())},{default:i(()=>[v(" Start new thread ")]),_:1})):L("",!0)]),_:1})]),_:1}))}});const bs=B(hs,[["__scopeId","data-v-2f0be4e2"]]),Ss=M({__name:"EmptyColumn",props:{stages:{}},emits:["stageUpdate"],setup(o,{emit:t}){const n=c=>{t("stageUpdate",c)};return(c,s)=>(r(),g(a(z),{direction:"vertical"},{default:i(()=>[(r(!0),h(N,null,V(c.stages,u=>(r(),g(a(W),{key:u.id,class:"tag",onClick:m=>n(u)},{default:i(()=>[l(a(R),{gap:"8",style:{"max-width":"200px","justify-content":"center","align-items":"center"}},{default:i(()=>[l(a(R),null,{default:i(()=>[(r(),g(ee(a(te)(u.type)),{size:"20"}))]),_:2},1024),l(a(U),{ellipsis:"",content:u.title},null,8,["content"])]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1}))}});const ys=B(Ss,[["__scopeId","data-v-08e39e62"]]),As={style:{"padding-top":"20px","flex-grow":"1"}},fs={class:"stages-container"},Cs={class:"stages-content"},vs=M({__name:"Kanban",props:{storage:{},kanbanRepository:{},stageRunRepository:{}},setup(o){const t=o,n=Ue(),{closeDrawer:c,inspectStageRun:s,drawerState:u,selectedStageRunForDrawer:m}=ra(),{filterFactory:p,filterStatus:f,labelOption:A}=ts(),{kanbanAsyncComputed:d,setStage:x,addStage:w,setup:O,tearDown:j,cardActionHandler:K,increasePagination:le,hasPagination:b,reorderStages:S}=la({kanbanRepository:t.kanbanRepository,storage:t.storage,filterFactory:p,router:n}),y=Y([]);return Ve(()=>{var C;return(C=d.result.value)==null?void 0:C.columns},C=>{C!==void 0&&(y.value=C)}),Ne(O),Ze(j),(C,I)=>(r(),h("div",As,[l(a(R),{vertical:"",style:{height:"100%"}},{default:i(()=>[l(a(fe),{ghost:""},{default:i(()=>[l(a(Ae),{header:"Filters"},{default:i(()=>[l(a(st),null,{default:i(()=>[l(a(it),{label:"Status"},{default:i(()=>[l(a(qe),{value:a(f),"onUpdate:value":I[0]||(I[0]=$=>Be(f)?f.value=$:null),style:{width:"325px"}},{default:i(()=>[(r(!0),h(N,null,V(a(es),$=>(r(),g(a(Ke),{key:$,value:$},{default:i(()=>[v(P(a(A)($)),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1})]),_:1})]),_:1})]),_:1}),_("div",fs,[_("div",Cs,[l(a(z),{align:"start"},{default:i(()=>{var $;return[l(a(ot),{modelValue:y.value,"onUpdate:modelValue":I[1]||(I[1]=E=>y.value=E),class:"draggable","item-key":E=>E.selected_stage.id,"ghost-class":"ghost",onStart:a(j),onEnd:a(O),onChange:a(S)},{item:i(({element:E,index:Me})=>[(r(),g(a(bs),{key:E.selected_stage.id,column:E,router:a(n),"has-pagination":a(b)(E),"kanban-repository":t.kanbanRepository,class:"stages-content-column",onIncreasePagination:T=>a(le)(E),onCardInspection:T=>a(s)(E,T),onCardAction:T=>a(K)(E,T),onStageUpdate:T=>a(x)(T,Me)},null,8,["column","router","has-pagination","kanban-repository","onIncreasePagination","onCardInspection","onCardAction","onStageUpdate"]))]),_:1},8,["modelValue","item-key","onStart","onEnd","onChange"]),l(a(ys),{stages:(($=a(d).result.value)==null?void 0:$.next_stage_options)||[],onStageUpdate:I[2]||(I[2]=E=>a(w)(E))},null,8,["stages"])]}),_:1})])])]),_:1}),a(u).state==="stage-run"&&a(m)?(r(),g(a(ds),{key:0,"kanban-repository":t.kanbanRepository,"stage-run":a(m),"stage-run-repository":t.stageRunRepository,onClose:a(c)},null,8,["kanban-repository","stage-run","stage-run-repository","onClose"])):L("",!0)]))}});const Gs=B(vs,[["__scopeId","data-v-477592ea"]]);class Qs{constructor(t,n=localStorage){this.contextKey=t,this.storage=n}makeKey(t){return`${this.contextKey}:${t}`}async get(t){const n=this.storage.getItem(this.makeKey(t));return n?JSON.parse(n):null}async set(t,n){this.storage.setItem(this.makeKey(t),JSON.stringify(n))}}class Xs{constructor(t=Ce){this.fetch=t}async getData(t){return(await this.fetch("/_editor/api/kanban",{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}})).json()}async getLogs(t){return(await this.fetch(`/_editor/api/kanban/logs/${t}`)).json()}async startJob(t){await this.fetch(`/_editor/api/kanban/jobs/${t}/start`,{method:"POST"})}}class Ys{constructor(t,n=Ce){this.authProvider=t,this.fetch=n}get headers(){return{"Content-Type":"application/json",...this.authProvider.authHeaders()}}async getData(t){return(await this.fetch("/_kanban/",{method:"POST",body:JSON.stringify(t),headers:this.headers})).json()}async getLogs(t){return(await this.fetch(`/_kanban/logs/${t}`,{headers:this.headers})).json()}async startJob(t){await this.fetch(`/_kanban/jobs/${t}/start`,{method:"POST",headers:this.headers})}}export{Xs as E,Gs as K,Qs as L,Ys as P};
//# sourceMappingURL=repository.5ebd8d26.js.map
