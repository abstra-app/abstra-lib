import{u as He}from"./index.27c0ea5f.js";import{d as U,X as F,H as x,b as i,eu as h,dj as q,ew as M,ez as O,e as c,o as Te,G as Ie,c as S,w as t,f as a,u as e,v as Q,r as $,aq as g,bx as T,aC as de,eE as pe,eF as me,by as re,bE as I,eB as Ze,cA as Ue,eI as Le,eA as Re,av as Ee,I as ne,S as se,a as Be,eK as Ne,eD as De,bf as Pe,cw as ze,aG as E}from"./outputWidgets.b2f2adf2.js";import{B as We}from"./BaseLayout.c9230dd9.js";import{F as B,a as je,b as qe,c as Oe,d as Qe,r as ie}from"./FormRunner.015a2e21.js";import{R as Ge,S as Je,a as Ke,L as Xe}from"./SourceCode.75021220.js";import{A as ve}from"./api.8e69ff2e.js";import{a as Ye}from"./asyncComputed.0eb432f7.js";import{F as ea}from"./PhArrowSquareOut.vue.c0b575b0.js";import{G as aa}from"./PhFlowArrow.vue.c0d45cbd.js";import{F as ta}from"./metadata.555f07fb.js";import{F as la}from"./forms.259a2d34.js";import{W as j}from"./workspaces.4fed9670.js";import"./envVars.db9c582c.js";import{_ as oa}from"./SaveButton.vue_vue_type_script_setup_true_lang.eed1bfc2.js";import{T as ra}from"./ThreadSelector.5d1b1552.js";import{M as ce}from"./Modal.29dbfea8.js";import{A as fe}from"./index.63070193.js";import{A as R}from"./Title.d1ce9cd1.js";import{a as N}from"./Text.9554a64b.js";import{A as C,F as G}from"./Form.151a806c.js";import{A as ue}from"./index.adbd3c94.js";import{A as D}from"./index.c47b0dc1.js";import{N as na}from"./NavbarControls.e78fa373.js";import{b as sa}from"./index.f265c294.js";import{A as W,T as ia}from"./TabPane.27e1a36d.js";import{B as ua}from"./Badge.c82fe8b6.js";import{A as da}from"./index.3df7bcb5.js";import{A as pa}from"./Link.326bc6ef.js";import"./pubsub.56b36b75.js";import"./fetch.1fc8b3e7.js";import"./url.de379c40.js";import"./Passwordless.54b92767.js";import"./PhArrowClockwise.vue.2b44c34b.js";import"./CircularLoading.967420bd.js";import"./PlayerNavbar.fc0d5a33.js";import"./PhKanban.vue.b5538c9a.js";import"./PhSignOut.vue.2ace8ff5.js";import"./index.eb1aefdf.js";import"./Paragraph.038d3c4a.js";import"./index.14c519b5.js";import"./WidgetsFrame.b0e6f9af.js";import"./Steps.cf5aac15.js";import"./PhInfo.vue.0f81ec9d.js";import"./Card.1ffebbef.js";import"./index.a64d1f80.js";import"./uuid.040e965c.js";import"./PhCaretRight.vue.772947f3.js";import"./login.679c83d1.js";import"./jobs.5c6fe339.js";import"./record.01220836.js";import"./scripts.b274e126.js";import"./validations.2f7d8a6a.js";import"./string.f1ed14cd.js";import"./toggleHighContrast.d652e5fe.js";import"./PhPencil.vue.04f8aa4c.js";import"./index.cf4c23b9.js";import"./PhCheckCircle.vue.2e2e94f1.js";import"./PhScroll.vue.63b57b9f.js";import"./PhWebhooksLogo.vue.cb29b25a.js";import"./runnerData.f7a85f05.js";import"./UnsavedChangesHandler.bda0b4b0.js";import"./ExclamationCircleOutlined.d4abe47b.js";import"./index.230f82f6.js";import"./hasIn.2f264b73.js";import"./popupNotifcation.45645a97.js";import"./CloseCircleOutlined.9d7fd1b3.js";import"./DocsButton.vue_vue_type_script_setup_true_lang.204f99fb.js";import"./BookOutlined.312749b0.js";import"./isNumeric.75337b1e.js";(function(){try{var f=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},d=new Error().stack;d&&(f._sentryDebugIds=f._sentryDebugIds||{},f._sentryDebugIds[d]="f3f5cedd-884f-41d3-a297-d03d1d9c2f81",f._sentryDebugIdIdentifier="sentry-dbid-f3f5cedd-884f-41d3-a297-d03d1d9c2f81")}catch{}})();const ma=["width","height","fill","transform"],va={key:0},ca=c("path",{d:"M228,48V96a12,12,0,0,1-12,12H168a12,12,0,0,1,0-24h19l-7.8-7.8a75.55,75.55,0,0,0-53.32-22.26h-.43A75.49,75.49,0,0,0,72.39,75.57,12,12,0,1,1,55.61,58.41a99.38,99.38,0,0,1,69.87-28.47H126A99.42,99.42,0,0,1,196.2,59.23L204,67V48a12,12,0,0,1,24,0ZM183.61,180.43a75.49,75.49,0,0,1-53.09,21.63h-.43A75.55,75.55,0,0,1,76.77,179.8L69,172H88a12,12,0,0,0,0-24H40a12,12,0,0,0-12,12v48a12,12,0,0,0,24,0V189l7.8,7.8A99.42,99.42,0,0,0,130,226.06h.56a99.38,99.38,0,0,0,69.87-28.47,12,12,0,0,0-16.78-17.16Z"},null,-1),fa=[ca],ga={key:1},ha=c("path",{d:"M216,128a88,88,0,1,1-88-88A88,88,0,0,1,216,128Z",opacity:"0.2"},null,-1),ya=c("path",{d:"M224,48V96a8,8,0,0,1-8,8H168a8,8,0,0,1,0-16h28.69L182.06,73.37a79.56,79.56,0,0,0-56.13-23.43h-.45A79.52,79.52,0,0,0,69.59,72.71,8,8,0,0,1,58.41,61.27a96,96,0,0,1,135,.79L208,76.69V48a8,8,0,0,1,16,0ZM186.41,183.29a80,80,0,0,1-112.47-.66L59.31,168H88a8,8,0,0,0,0-16H40a8,8,0,0,0-8,8v48a8,8,0,0,0,16,0V179.31l14.63,14.63A95.43,95.43,0,0,0,130,222.06h.53a95.36,95.36,0,0,0,67.07-27.33,8,8,0,0,0-11.18-11.44Z"},null,-1),wa=[ha,ya],_a={key:2},ka=c("path",{d:"M224,48V96a8,8,0,0,1-8,8H168a8,8,0,0,1-5.66-13.66L180.65,72a79.48,79.48,0,0,0-54.72-22.09h-.45A79.52,79.52,0,0,0,69.59,72.71,8,8,0,0,1,58.41,61.27,96,96,0,0,1,192,60.7l18.36-18.36A8,8,0,0,1,224,48ZM186.41,183.29A80,80,0,0,1,75.35,184l18.31-18.31A8,8,0,0,0,88,152H40a8,8,0,0,0-8,8v48a8,8,0,0,0,13.66,5.66L64,195.3a95.42,95.42,0,0,0,66,26.76h.53a95.36,95.36,0,0,0,67.07-27.33,8,8,0,0,0-11.18-11.44Z"},null,-1),ba=[ka],Aa={key:3},Sa=c("path",{d:"M222,48V96a6,6,0,0,1-6,6H168a6,6,0,0,1,0-12h33.52L183.47,72a81.51,81.51,0,0,0-57.53-24h-.46A81.5,81.5,0,0,0,68.19,71.28a6,6,0,1,1-8.38-8.58,93.38,93.38,0,0,1,65.67-26.76H126a93.45,93.45,0,0,1,66,27.53l18,18V48a6,6,0,0,1,12,0ZM187.81,184.72a81.5,81.5,0,0,1-57.29,23.34h-.46a81.51,81.51,0,0,1-57.53-24L54.48,166H88a6,6,0,0,0,0-12H40a6,6,0,0,0-6,6v48a6,6,0,0,0,12,0V174.48l18,18.05a93.45,93.45,0,0,0,66,27.53h.52a93.38,93.38,0,0,0,65.67-26.76,6,6,0,1,0-8.38-8.58Z"},null,-1),$a=[Sa],xa={key:4},Ma=c("path",{d:"M224,48V96a8,8,0,0,1-8,8H168a8,8,0,0,1,0-16h28.69L182.06,73.37a79.56,79.56,0,0,0-56.13-23.43h-.45A79.52,79.52,0,0,0,69.59,72.71,8,8,0,0,1,58.41,61.27a96,96,0,0,1,135,.79L208,76.69V48a8,8,0,0,1,16,0ZM186.41,183.29a80,80,0,0,1-112.47-.66L59.31,168H88a8,8,0,0,0,0-16H40a8,8,0,0,0-8,8v48a8,8,0,0,0,16,0V179.31l14.63,14.63A95.43,95.43,0,0,0,130,222.06h.53a95.36,95.36,0,0,0,67.07-27.33,8,8,0,0,0-11.18-11.44Z"},null,-1),Va=[Ma],Ca={key:5},Fa=c("path",{d:"M220,48V96a4,4,0,0,1-4,4H168a4,4,0,0,1,0-8h38.34L184.89,70.54A84,84,0,0,0,66.8,69.85a4,4,0,1,1-5.6-5.72,92,92,0,0,1,129.34.76L212,86.34V48a4,4,0,0,1,8,0ZM189.2,186.15a83.44,83.44,0,0,1-58.68,23.91h-.47a83.52,83.52,0,0,1-58.94-24.6L49.66,164H88a4,4,0,0,0,0-8H40a4,4,0,0,0-4,4v48a4,4,0,0,0,8,0V169.66l21.46,21.45A91.43,91.43,0,0,0,130,218.06h.51a91.45,91.45,0,0,0,64.28-26.19,4,4,0,1,0-5.6-5.72Z"},null,-1),Ha=[Fa],Ta={name:"PhArrowsClockwise"},Ia=U({...Ta,props:{weight:{type:String},size:{type:[String,Number]},color:{type:String},mirrored:{type:Boolean}},setup(f){const d=f,r=F("weight","regular"),y=F("size","1em"),s=F("color","currentColor"),l=F("mirrored",!1),o=x(()=>{var n;return(n=d.weight)!=null?n:r}),b=x(()=>{var n;return(n=d.size)!=null?n:y}),H=x(()=>{var n;return(n=d.color)!=null?n:s}),v=x(()=>d.mirrored!==void 0?d.mirrored?"scale(-1, 1)":void 0:l?"scale(-1, 1)":void 0);return(n,k)=>(i(),h("svg",O({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256",width:b.value,height:b.value,fill:H.value,transform:v.value},n.$attrs),[q(n.$slots,"default"),o.value==="bold"?(i(),h("g",va,fa)):o.value==="duotone"?(i(),h("g",ga,wa)):o.value==="fill"?(i(),h("g",_a,ba)):o.value==="light"?(i(),h("g",Aa,$a)):o.value==="regular"?(i(),h("g",xa,Va)):o.value==="thin"?(i(),h("g",Ca,Ha)):M("",!0)],16,ma))}}),Za=["width","height","fill","transform"],Ua={key:0},La=c("path",{d:"M234.49,111.07,90.41,22.94A20,20,0,0,0,60,39.87V216.13a20,20,0,0,0,30.41,16.93l144.08-88.13a19.82,19.82,0,0,0,0-33.86ZM84,208.85V47.15L216.16,128Z"},null,-1),Ra=[La],Ea={key:1},Ba=c("path",{d:"M228.23,134.69,84.15,222.81A8,8,0,0,1,72,216.12V39.88a8,8,0,0,1,12.15-6.69l144.08,88.12A7.82,7.82,0,0,1,228.23,134.69Z",opacity:"0.2"},null,-1),Na=c("path",{d:"M232.4,114.49,88.32,26.35a16,16,0,0,0-16.2-.3A15.86,15.86,0,0,0,64,39.87V216.13A15.94,15.94,0,0,0,80,232a16.07,16.07,0,0,0,8.36-2.35L232.4,141.51a15.81,15.81,0,0,0,0-27ZM80,215.94V40l143.83,88Z"},null,-1),Da=[Ba,Na],Pa={key:2},za=c("path",{d:"M240,128a15.74,15.74,0,0,1-7.6,13.51L88.32,229.65a16,16,0,0,1-16.2.3A15.86,15.86,0,0,1,64,216.13V39.87a15.86,15.86,0,0,1,8.12-13.82,16,16,0,0,1,16.2.3L232.4,114.49A15.74,15.74,0,0,1,240,128Z"},null,-1),Wa=[za],ja={key:3},qa=c("path",{d:"M231.36,116.19,87.28,28.06a14,14,0,0,0-14.18-.27A13.69,13.69,0,0,0,66,39.87V216.13a13.69,13.69,0,0,0,7.1,12.08,14,14,0,0,0,14.18-.27l144.08-88.13a13.82,13.82,0,0,0,0-23.62Zm-6.26,13.38L81,217.7a2,2,0,0,1-2.06,0,1.78,1.78,0,0,1-1-1.61V39.87a1.78,1.78,0,0,1,1-1.61A2.06,2.06,0,0,1,80,38a2,2,0,0,1,1,.31L225.1,126.43a1.82,1.82,0,0,1,0,3.14Z"},null,-1),Oa=[qa],Qa={key:4},Ga=c("path",{d:"M232.4,114.49,88.32,26.35a16,16,0,0,0-16.2-.3A15.86,15.86,0,0,0,64,39.87V216.13A15.94,15.94,0,0,0,80,232a16.07,16.07,0,0,0,8.36-2.35L232.4,141.51a15.81,15.81,0,0,0,0-27ZM80,215.94V40l143.83,88Z"},null,-1),Ja=[Ga],Ka={key:5},Xa=c("path",{d:"M230.32,117.9,86.24,29.79a11.91,11.91,0,0,0-12.17-.23A11.71,11.71,0,0,0,68,39.89V216.11a11.71,11.71,0,0,0,6.07,10.33,11.91,11.91,0,0,0,12.17-.23L230.32,138.1a11.82,11.82,0,0,0,0-20.2Zm-4.18,13.37L82.06,219.39a4,4,0,0,1-4.07.07,3.77,3.77,0,0,1-2-3.35V39.89a3.77,3.77,0,0,1,2-3.35,4,4,0,0,1,4.07.07l144.08,88.12a3.8,3.8,0,0,1,0,6.54Z"},null,-1),Ya=[Xa],et={name:"PhPlay"},at=U({...et,props:{weight:{type:String},size:{type:[String,Number]},color:{type:String},mirrored:{type:Boolean}},setup(f){const d=f,r=F("weight","regular"),y=F("size","1em"),s=F("color","currentColor"),l=F("mirrored",!1),o=x(()=>{var n;return(n=d.weight)!=null?n:r}),b=x(()=>{var n;return(n=d.size)!=null?n:y}),H=x(()=>{var n;return(n=d.color)!=null?n:s}),v=x(()=>d.mirrored!==void 0?d.mirrored?"scale(-1, 1)":void 0:l?"scale(-1, 1)":void 0);return(n,k)=>(i(),h("svg",O({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256",width:b.value,height:b.value,fill:H.value,transform:v.value},n.$attrs),[q(n.$slots,"default"),o.value==="bold"?(i(),h("g",Ua,Ra)):o.value==="duotone"?(i(),h("g",Ea,Da)):o.value==="fill"?(i(),h("g",Pa,Wa)):o.value==="light"?(i(),h("g",ja,Oa)):o.value==="regular"?(i(),h("g",Qa,Ja)):o.value==="thin"?(i(),h("g",Ka,Ya)):M("",!0)],16,Za))}}),tt=["width","height","fill","transform"],lt={key:0},ot=c("path",{d:"M200,36H56A20,20,0,0,0,36,56V200a20,20,0,0,0,20,20H200a20,20,0,0,0,20-20V56A20,20,0,0,0,200,36Zm-4,160H60V60H196Z"},null,-1),rt=[ot],nt={key:1},st=c("path",{d:"M208,56V200a8,8,0,0,1-8,8H56a8,8,0,0,1-8-8V56a8,8,0,0,1,8-8H200A8,8,0,0,1,208,56Z",opacity:"0.2"},null,-1),it=c("path",{d:"M200,40H56A16,16,0,0,0,40,56V200a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V56A16,16,0,0,0,200,40Zm0,160H56V56H200V200Z"},null,-1),ut=[st,it],dt={key:2},pt=c("path",{d:"M216,56V200a16,16,0,0,1-16,16H56a16,16,0,0,1-16-16V56A16,16,0,0,1,56,40H200A16,16,0,0,1,216,56Z"},null,-1),mt=[pt],vt={key:3},ct=c("path",{d:"M200,42H56A14,14,0,0,0,42,56V200a14,14,0,0,0,14,14H200a14,14,0,0,0,14-14V56A14,14,0,0,0,200,42Zm2,158a2,2,0,0,1-2,2H56a2,2,0,0,1-2-2V56a2,2,0,0,1,2-2H200a2,2,0,0,1,2,2Z"},null,-1),ft=[ct],gt={key:4},ht=c("path",{d:"M200,40H56A16,16,0,0,0,40,56V200a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V56A16,16,0,0,0,200,40Zm0,160H56V56H200V200Z"},null,-1),yt=[ht],wt={key:5},_t=c("path",{d:"M200,44H56A12,12,0,0,0,44,56V200a12,12,0,0,0,12,12H200a12,12,0,0,0,12-12V56A12,12,0,0,0,200,44Zm4,156a4,4,0,0,1-4,4H56a4,4,0,0,1-4-4V56a4,4,0,0,1,4-4H200a4,4,0,0,1,4,4Z"},null,-1),kt=[_t],bt={name:"PhStop"},At=U({...bt,props:{weight:{type:String},size:{type:[String,Number]},color:{type:String},mirrored:{type:Boolean}},setup(f){const d=f,r=F("weight","regular"),y=F("size","1em"),s=F("color","currentColor"),l=F("mirrored",!1),o=x(()=>{var n;return(n=d.weight)!=null?n:r}),b=x(()=>{var n;return(n=d.size)!=null?n:y}),H=x(()=>{var n;return(n=d.color)!=null?n:s}),v=x(()=>d.mirrored!==void 0?d.mirrored?"scale(-1, 1)":void 0:l?"scale(-1, 1)":void 0);return(n,k)=>(i(),h("svg",O({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256",width:b.value,height:b.value,fill:H.value,transform:v.value},n.$attrs),[q(n.$slots,"default"),o.value==="bold"?(i(),h("g",lt,rt)):o.value==="duotone"?(i(),h("g",nt,ut)):o.value==="fill"?(i(),h("g",dt,mt)):o.value==="light"?(i(),h("g",vt,ft)):o.value==="regular"?(i(),h("g",gt,yt)):o.value==="thin"?(i(),h("g",wt,kt)):M("",!0)],16,tt))}}),St=U({__name:"ThreadSelectorModal",props:{showThreadModal:{type:Boolean},stage:{},executionConfig:{}},emits:["fix-invalid-json","update:execution-config","update:show-thread-modal"],setup(f,{emit:d}){const r=()=>{d("update:show-thread-modal",!1),j.writeTestData(y.threadData)};Te(async()=>y.threadData=await j.readTestData());const y=Ie({threadData:"{}"});return(s,l)=>(i(),S(e(ce),{open:s.showThreadModal,footer:null,onCancel:r},{default:t(()=>[a(ra,{stage:s.stage,"execution-config":s.executionConfig,"onUpdate:executionConfig":l[0]||(l[0]=o=>d("update:execution-config",o)),"onUpdate:showThreadModal":l[1]||(l[1]=o=>d("update:show-thread-modal",o)),onFixInvalidJson:l[2]||(l[2]=o=>d("fix-invalid-json",o,o))},null,8,["stage","execution-config"])]),_:1},8,["open"]))}});const $t=Q(St,[["__scopeId","data-v-541d30a8"]]),ge=f=>(pe("data-v-a8ca44f6"),f=f(),me(),f),xt=ge(()=>c("i",null,"string",-1)),Mt=ge(()=>c("i",null,"string list",-1)),Vt=U({__name:"FormNotificationSettings",props:{form:{}},setup(f){const r=$(f.form);return(y,s)=>(i(),h(de,null,[a(e(G),{layout:"vertical"},{default:t(()=>[a(e(R),{level:4,width:"100%",height:"30px",style:{display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"0px"}},{default:t(()=>[g(" Thread waiting "),a(e(fe),{checked:r.value.notificationTrigger.enabled,"onUpdate:checked":s[0]||(s[0]=l=>r.value.notificationTrigger.enabled=l)},{default:t(()=>[g(" Enabled ")]),_:1},8,["checked"])]),_:1}),a(e(N),{class:"description",style:{fontStyle:"italic",marginBottom:"20px"}},{default:t(()=>[g(" Send emails when the thread is waiting for the form to be filled ")]),_:1}),a(e(C),{label:"Variable name"},{default:t(()=>[a(e(T),{value:r.value.notificationTrigger.variable_name,"onUpdate:value":s[1]||(s[1]=l=>r.value.notificationTrigger.variable_name=l),disabled:!r.value.notificationTrigger.enabled,type:"text",placeholder:"variable_name"},null,8,["value","disabled"])]),_:1})]),_:1}),a(e(ue),{type:"info"},{message:t(()=>[a(e(N),null,{default:t(()=>[g(" Notifications are sent to the emails specified in the thread variables set here. The variables should contain a "),xt,g(" or a "),Mt,g(". ")]),_:1})]),_:1}),a(e(ue),{style:{"margin-top":"20px"}},{message:t(()=>[a(e(N),null,{default:t(()=>[g(" Notifications are a paid feature. Talk to your account manager to enable them. ")]),_:1})]),_:1})],64))}});const Ct=Q(Vt,[["__scopeId","data-v-a8ca44f6"]]),Ft=U({__name:"FormSettings",props:{form:{}},setup(f){const r=$(f.form);return(y,s)=>(i(),S(e(G),{layout:"vertical",style:{"padding-bottom":"50px"}},{default:t(()=>[a(Ge,{runtime:r.value},null,8,["runtime"]),a(e(C),{label:"Form name"},{default:t(()=>[a(e(T),{value:r.value.title,"onUpdate:value":s[0]||(s[0]=l=>r.value.title=l),type:"text",onChange:s[1]||(s[1]=l=>{var o;return r.value.title=(o=l.target.value)!=null?o:""})},null,8,["value"])]),_:1}),a(e(R),{level:3},{default:t(()=>[g(" Texts ")]),_:1}),a(e(R),{level:4},{default:t(()=>[g(" Welcome Screen ")]),_:1}),a(e(C),{label:"Title"},{default:t(()=>[a(e(T),{value:r.value.welcomeTitle,"onUpdate:value":s[2]||(s[2]=l=>r.value.welcomeTitle=l),type:"text",placeholder:r.value.title,disabled:r.value.autoStart},null,8,["value","placeholder","disabled"])]),_:1}),a(e(C),{label:"Description"},{default:t(()=>[a(e(T),{value:r.value.startMessage,"onUpdate:value":s[3]||(s[3]=l=>r.value.startMessage=l),type:"text",disabled:r.value.autoStart},null,8,["value","disabled"])]),_:1}),a(e(C),{label:"Start button label"},{default:t(()=>[a(e(T),{value:r.value.startButtonText,"onUpdate:value":s[4]||(s[4]=l=>r.value.startButtonText=l),type:"text",placeholder:"Start",disabled:r.value.autoStart},null,8,["value","disabled"])]),_:1}),a(e(C),null,{default:t(()=>[a(e(re),{checked:r.value.autoStart,"onUpdate:checked":s[5]||(s[5]=l=>r.value.autoStart=l)},{default:t(()=>[g("Skip welcome screen")]),_:1},8,["checked"])]),_:1}),a(e(R),{level:4},{default:t(()=>[g(" End Screen ")]),_:1}),a(e(C),{label:"End text"},{default:t(()=>[a(e(T),{value:r.value.endMessage,"onUpdate:value":s[6]||(s[6]=l=>r.value.endMessage=l),type:"text",placeholder:"Thank you"},null,8,["value"])]),_:1}),a(e(C),{label:"Restart button label"},{default:t(()=>[a(e(T),{value:r.value.restartButtonText,"onUpdate:value":s[7]||(s[7]=l=>r.value.restartButtonText=l),placeholder:"Restart",type:"text",disabled:!r.value.allowRestart},null,8,["value","disabled"])]),_:1}),a(e(C),{help:!r.value.isInitial&&"Only initial forms can be restarted"},{default:t(()=>[a(e(re),{checked:r.value.allowRestart,"onUpdate:checked":s[8]||(s[8]=l=>r.value.allowRestart=l),disabled:!r.value.isInitial},{default:t(()=>[g("Show restart button at the end")]),_:1},8,["checked","disabled"])]),_:1},8,["help"]),a(e(R),{level:4},{default:t(()=>[g(" Alert Messages ")]),_:1}),a(e(C),{label:"Error message"},{default:t(()=>[a(e(T),{value:r.value.errorMessage,"onUpdate:value":s[9]||(s[9]=l=>r.value.errorMessage=l),type:"text",placeholder:"Something went wrong"},null,8,["value"])]),_:1})]),_:1}))}}),Ht=U({__name:"QueryParamsModal",props:{open:{type:Boolean},close:{type:Function},queryParams:{}},emits:["update:query-params"],setup(f,{emit:d}){const y=$(s(f.queryParams));function s(v){return Object.entries(v).map(([n,k])=>({key:n,value:k,id:Math.random().toString()}))}function l(){const v={};return y.value.forEach(({key:n,value:k})=>{v[n]=k}),v}const o=(v,n,k)=>{y.value[v]={key:n,value:k},d("update:query-params",l())},b=()=>{const v=y.value.length;y.value.push({key:`param-${v}`,value:"value"}),d("update:query-params",l())},H=v=>{y.value.splice(v,1),d("update:query-params",l())};return(v,n)=>(i(),S(e(ce),{open:v.open,onCancel:v.close},{footer:t(()=>[a(e(I),{type:"primary",onClick:v.close},{default:t(()=>[g("OK")]),_:1},8,["onClick"])]),default:t(()=>[a(e(D),{vertical:"",gap:"20"},{default:t(()=>[a(e(N),null,{default:t(()=>[g("Query params")]),_:1}),(i(!0),h(de,null,Ze(y.value,(k,m)=>(i(),S(e(C),{key:m},{default:t(()=>[a(e(Ue),null,{default:t(()=>[a(e(T),{value:k.key,"onUpdate:value":Z=>k.key=Z,type:"text",placeholder:"name",onChange:()=>o(m,k.key,k.value)},null,8,["value","onUpdate:value","onChange"]),a(e(T),{value:k.value,"onUpdate:value":Z=>k.value=Z,type:"text",placeholder:"value",disabled:k.key===e(ve),onChange:()=>o(m,k.key,k.value)},null,8,["value","onUpdate:value","disabled","onChange"]),a(e(I),{danger:"",onClick:Z=>H(m)},{default:t(()=>[g("remove")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128)),a(e(C),null,{default:t(()=>[a(e(I),{type:"dashed",style:{width:"100%"},onClick:b},{default:t(()=>[g(" Add Query Param ")]),_:1})]),_:1})]),_:1})]),_:1},8,["open","onCancel"]))}}),Tt=f=>(pe("data-v-8258bd46"),f=f(),me(),f),It={style:{width:"50%"}},Zt={style:{width:"50%"}},Ut={key:0},Lt={key:1},Rt=Tt(()=>c("br",null,null,-1)),Et={class:"form-preview-container"},Bt=U({__name:"FormEditor",setup(f){var ee;const d=Le(),r=Re(),y=$(null),s=$("source-code"),l=$(null),o=$(null),b=$(null),H=$(null),v=$({}),n=$(!1),k=p=>m.value={...m.value,attached:!!p},m=$({attached:!1,stageRunId:null,pendingFork:!1,isInitial:!1}),Z=x(()=>{var p;return(p=w.value)!=null&&p.form.hasChanges()?{title:"Unsaved changes",message:"Save the form before running the workflow"}:m.value.attached&&m.value.pendingFork?{title:"Past thread selected",message:"Fork the selected thread to run the workflow"}:!m.value.isInitial&&m.value.attached&&!m.value.stageRunId?{title:"No thread selected",message:"Select a thread to run the workflow"}:null}),he=(p,u)=>{var A;(A=y.value)==null||A.setHighlight(p,u)},ye=()=>{var p,u;(p=y.value)==null||p.restartEditor(),(u=y.value)==null||u.startPreviewMode()},we=x(()=>!m.value.isInitial&&m.value.attached&&!!(m.value.pendingFork||!m.value.stageRunId));Ee(()=>m.value.stageRunId?v.value={...v.value,[ve]:m.value.stageRunId}:null);const{result:w,loading:_e,refetch:ke}=Ye(async()=>{const[p,u]=await Promise.all([la.get(r.params.id),j.get()]);return m.value.isInitial=p.isInitial,Ne({form:p,workspace:u})});ne([()=>m.value.attached,v,w],()=>{J()});function J(){if(!w.value)return;const p=!m.value.attached;b.value=w.value.form.makeRunnerData(w.value.workspace),l.value&&l.value.clearListeners(),l.value=new Oe({formRunnerData:b.value,queryParams:v.value,userManager:He,logService:Y,connectionManager:new Qe(w.value.form.id,p),onFormStart:ye,onFormEnd:be,onRedirect:Me,onAuthUpdate:A=>H.value=A,onStateUpdate:A=>o.value=A,onStackTraceUpdate:he});const u=l.value.getState();o.value=u.formState,H.value=u.passwordlessUser}const be=()=>{var p,u,A;m.value={attached:!1,stageRunId:null,pendingFork:!1,isInitial:(u=(p=w.value)==null?void 0:p.form.isInitial)!=null?u:!1},(A=y.value)==null||A.restartEditor()};function Ae(){var p;(p=l.value)==null||p.start()}function K(){var p,u;(p=y.value)==null||p.restartEditor(),(u=l.value)==null||u.reset()}const Se=p=>{ie("editor",d,p.path)};function $e(){d.push({name:"stages"})}const X=$(null),xe=p=>{!w.value||(w.value.form.file=p)},Y=Xe.create();function Me(p,u){ie("editor",d,p,u)}const Ve=()=>{var u,A;if(m.value.attached){let _=`/${(u=w.value)==null?void 0:u.form.path}`;m.value.attached&&m.value.stageRunId&&(_+=`?abstra-run-id=${m.value.stageRunId}`),window.open(_,"_blank")}const p=d.resolve({name:"formPreview",query:r.query,params:{id:(A=w.value)==null?void 0:A.form.id}});window.open(p.href,"_blank")},P=$(!1),Ce=x(()=>{if(!b.value)return"";const p=Object.entries(v.value),u="?"+p.map(([_,V])=>`${_}=${V}`).join("&"),A=p.length?u:"";return`/${b.value.path}${A}`}),z=$((ee=se.get("dontShowReloadHelper"))!=null?ee:!1),Fe=()=>{se.set("dontShowReloadHelper",!0),z.value=!0};return ne(()=>r.params.id,()=>{ke()}),(p,u)=>{const A=Be("ant-text");return i(),S(We,{"no-margins":""},{navbar:t(()=>[e(w)?(i(),S(e(sa),{key:0,title:e(w).form.title,style:{padding:"5px 25px","margin-bottom":"15px"},onBack:$e},{extra:t(()=>[a(na,{"docs-path":"forms/overview","show-save-button":!1,"editing-model":e(w).form},null,8,["editing-model"])]),_:1},8,["title"])):M("",!0)]),content:t(()=>[e(w)?(i(),S(e(D),{key:0,gap:"40",style:{width:"calc(100% - 80px)"}},{default:t(()=>[c("div",It,[a(e(ia),{"active-key":s.value,"onUpdate:activeKey":u[0]||(u[0]=_=>s.value=_)},{rightExtra:t(()=>[a(oa,{model:e(w).form,onSave:J},null,8,["model"])]),default:t(()=>[a(e(W),{key:"source-code",tab:"Source code"}),a(e(W),{key:"settings",tab:"Settings"}),a(e(W),{key:"notifications",tab:"Notifications"})]),_:1},8,["active-key"]),s.value==="source-code"?(i(),S(Je,{key:0,ref_key:"code",ref:y,script:e(w).form,workspace:e(w).workspace,onUpdateFile:xe},null,8,["script","workspace"])):M("",!0),s.value==="settings"?(i(),S(Ft,{key:1,form:e(w).form},null,8,["form"])):M("",!0),s.value==="notifications"?(i(),S(Ct,{key:2,form:e(w).form},null,8,["form"])):M("",!0),n.value?(i(),S($t,{key:3,"execution-config":m.value,"onUpdate:executionConfig":u[1]||(u[1]=_=>m.value=_),"show-thread-modal":n.value,"onUpdate:showThreadModal":u[2]||(u[2]=_=>n.value=_),stage:e(w).form,onFixInvalidJson:u[3]||(u[3]=(_,V)=>{var L;return(L=X.value)==null?void 0:L.fixJson(_,V)})},null,8,["execution-config","show-thread-modal","stage"])):M("",!0)]),c("div",Zt,[a(e(D),{gap:"10",align:"center",justify:"right",style:{"margin-top":"5px"}},{default:t(()=>{var _;return[a(A,null,{default:t(()=>[g(De(m.value.attached?"Workflow ON":"Workflow OFF"),1)]),_:1}),a(e(fe),{disabled:!!o.value&&e(B).includes((_=o.value)==null?void 0:_.type),checked:m.value.attached,"onUpdate:checked":k},null,8,["disabled","checked"]),a(e(ua),{dot:we.value},{default:t(()=>{var V;return[a(e(I),{disabled:!!o.value&&e(B).includes((V=o.value)==null?void 0:V.type),style:{display:"flex",gap:"5px"},onClick:u[4]||(u[4]=L=>n.value=!0)},{icon:t(()=>[a(e(aa),{size:"20"})]),default:t(()=>[g("Thread")]),_:1},8,["disabled"])]}),_:1},8,["dot"])]}),_:1}),a(e(da),{style:{margin:"8px 0px 20px"}}),e(_e)||!b.value||!o.value?(i(),S(e(Pe),{key:0})):M("",!0),o.value&&b.value?(i(),S(e(G),{key:1,layout:"vertical"},{default:t(()=>{var _,V,L,ae,te,le;return[a(e(D),{gap:"small"},{default:t(()=>[o.value.type&&e(je).includes(o.value.type)?(i(),S(e(ze),{key:0,placement:"bottom",open:z.value?void 0:!0},{content:t(()=>[z.value?(i(),h("span",Ut,"Reload form")):(i(),h("span",Lt,[g(" You can reload the form here"),Rt,a(e(pa),{onClick:Fe},{default:t(()=>[g("Don't show this again")]),_:1})]))]),default:t(()=>[a(e(I),{disabled:!!Z.value,onClick:K},{default:t(()=>[a(e(Ia),{size:"20"})]),_:1},8,["disabled"])]),_:1},8,["open"])):M("",!0),e(B).includes(o.value.type)?(i(),S(e(E),{key:1,placement:"bottom"},{title:t(()=>[g("Stop form")]),default:t(()=>[a(e(I),{onClick:K},{default:t(()=>[a(e(At),{size:"20"})]),_:1})]),_:1})):M("",!0),o.value.type==="waiting"?(i(),S(e(E),{key:2,placement:"bottom"},{title:t(()=>[g("Start form")]),default:t(()=>[a(e(I),{disabled:!!Z.value,onClick:Ae},{default:t(()=>[a(e(at),{size:"20"})]),_:1},8,["disabled"])]),_:1})):M("",!0),a(e(T),{disabled:"",value:Ce.value},null,8,["value"]),a(e(E),{placement:"bottom"},{title:t(()=>[g("Edit query params")]),default:t(()=>{var oe;return[a(e(I),{disabled:!!o.value&&e(B).includes((oe=o.value)==null?void 0:oe.type),onClick:u[5]||(u[5]=Nt=>P.value=!0)},{default:t(()=>[a(e(ta),{size:"20"})]),_:1},8,["disabled"])]}),_:1}),a(e(E),{placement:"bottom"},{title:t(()=>[g("Open in Full Screen")]),default:t(()=>[a(e(I),{target:"_blank","aria-label":"Open in Full Screen","aria-describedby":"sss",onClick:Ve},{default:t(()=>[a(e(ea),{size:"20"})]),_:1})]),_:1})]),_:1}),c("div",Et,[a(qe,{"is-preview":"","form-runner-data":b.value,disabled:Z.value,"form-state":o.value,"user-email":(_=H.value)==null?void 0:_.claims.email,onUpdateWidgetErrors:(V=l.value)==null?void 0:V.updateWidgetFrontendErrors,onUpdateWidgetValue:(L=l.value)==null?void 0:L.updateWidgetValue,onActionClicked:(ae=l.value)==null?void 0:ae.handleActionClick,onNavigate:Se,onLogout:(te=l.value)==null?void 0:te.logout,onAutoFillClicked:(le=l.value)==null?void 0:le.handleAutofillClick},null,8,["form-runner-data","disabled","form-state","user-email","onUpdateWidgetErrors","onUpdateWidgetValue","onActionClicked","onLogout","onAutoFillClicked"])])]}),_:1})):M("",!0),a(Ht,{"query-params":v.value,"onUpdate:queryParams":u[6]||(u[6]=_=>v.value=_),open:P.value,close:()=>P.value=!1},null,8,["query-params","open","close"])])]),_:1})):M("",!0)]),footer:t(()=>{var _,V;return[a(Ke,{ref_key:"smartConsole",ref:X,runtime:"forms","log-service":e(Y),stage:(_=e(w))==null?void 0:_.form,workspace:(V=e(w))==null?void 0:V.workspace},null,8,["log-service","stage","workspace"])]}),_:1})}}});const to=Q(Bt,[["__scopeId","data-v-8258bd46"]]);export{to as default};
//# sourceMappingURL=FormEditor.598045a4.js.map
