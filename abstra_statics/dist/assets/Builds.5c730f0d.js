import{C as U}from"./CrudView.408a4461.js";import{d as P,D as x,f as _,o as n,Y as f,$ as T,S as C,e8 as F,a as v,b as d,ee as V,f3 as W,eo as Y,c as m,w as c,u as a,bR as Q,bz as X,bx as J,dc as O,aG as b,e9 as A,cx as K,ea as ee,X as te,ah as ae,e as le,aS as re,aW as ne,cO as oe,db as ie,Z as se,d5 as ue,by as ce,cL as de,eI as pe,a0 as ge}from"./index.0f630b70.js";import{a as L}from"./asyncComputed.2bec113c.js";import{B as me,a as fe,g as ve}from"./datetime.77c87155.js";import{u as he}from"./polling.e2209103.js";import{G as ye}from"./PhArrowCounterClockwise.vue.9318428b.js";import{H as be}from"./PhCube.vue.8fa03c73.js";import{G as Ae}from"./PhDownloadSimple.vue.e40cfd6e.js";import"./gateway.50cd3949.js";import{P as Ce}from"./project.79269899.js";import"./tables.78c50568.js";import{F as ke,a as _e,G as we,I as Oe}from"./PhWebhooksLogo.vue.3edd7efd.js";import{A as M}from"./index.1eaf0cd2.js";import{a as xe,A as $e}from"./index.1dbebed1.js";import{r as Ze}from"./router.0f31f3f1.js";import{E as Se}from"./ExclamationCircleOutlined.b003bf9c.js";import{C as Me}from"./CloseCircleOutlined.176797bf.js";import{L as I}from"./LoadingOutlined.5ed0afbe.js";import"./DocsButton.vue_vue_type_script_setup_true_lang.bf268869.js";import"./BookOutlined.89f2a8c6.js";import"./url.90c69b58.js";import"./PhDotsThreeVertical.vue.e2e73559.js";import"./Badge.ada44968.js";import"./popupNotifcation.dd76a56c.js";import"./record.f729e500.js";import"./string.532e13bb.js";(function(){try{var r=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},e=new Error().stack;e&&(r._sentryDebugIds=r._sentryDebugIds||{},r._sentryDebugIds[e]="50a9170f-fcb8-4767-97bf-02c9cec948ed",r._sentryDebugIdIdentifier="sentry-dbid-50a9170f-fcb8-4767-97bf-02c9cec948ed")}catch{}})();var Pe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M696 480H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h368c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"minus-circle",theme:"outlined"};const je=Pe;var Ie={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372zm-88-532h-48c-4.4 0-8 3.6-8 8v304c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V360c0-4.4-3.6-8-8-8zm224 0h-48c-4.4 0-8 3.6-8 8v304c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V360c0-4.4-3.6-8-8-8z"}}]},name:"pause-circle",theme:"outlined"};const Ve=Ie,ze=["width","height","fill","transform"],Be={key:0},De=v("path",{d:"M140,80v41.21l34.17,20.5a12,12,0,1,1-12.34,20.58l-40-24A12,12,0,0,1,116,128V80a12,12,0,0,1,24,0ZM128,28A99.38,99.38,0,0,0,57.24,57.34c-4.69,4.74-9,9.37-13.24,14V64a12,12,0,0,0-24,0v40a12,12,0,0,0,12,12H72a12,12,0,0,0,0-24H57.77C63,86,68.37,80.22,74.26,74.26a76,76,0,1,1,1.58,109,12,12,0,0,0-16.48,17.46A100,100,0,1,0,128,28Z"},null,-1),He=[De],Le={key:1},Ne=v("path",{d:"M216,128a88,88,0,1,1-88-88A88,88,0,0,1,216,128Z",opacity:"0.2"},null,-1),Ee=v("path",{d:"M136,80v43.47l36.12,21.67a8,8,0,0,1-8.24,13.72l-40-24A8,8,0,0,1,120,128V80a8,8,0,0,1,16,0Zm-8-48A95.44,95.44,0,0,0,60.08,60.15C52.81,67.51,46.35,74.59,40,82V64a8,8,0,0,0-16,0v40a8,8,0,0,0,8,8H72a8,8,0,0,0,0-16H49c7.15-8.42,14.27-16.35,22.39-24.57a80,80,0,1,1,1.66,114.75,8,8,0,1,0-11,11.64A96,96,0,1,0,128,32Z"},null,-1),Ge=[Ne,Ee],Te={key:2},Fe=v("path",{d:"M224,128A96,96,0,0,1,62.11,197.82a8,8,0,1,1,11-11.64A80,80,0,1,0,71.43,71.43C67.9,75,64.58,78.51,61.35,82L77.66,98.34A8,8,0,0,1,72,112H32a8,8,0,0,1-8-8V64a8,8,0,0,1,13.66-5.66L50,70.7c3.22-3.49,6.54-7,10.06-10.55A96,96,0,0,1,224,128ZM128,72a8,8,0,0,0-8,8v48a8,8,0,0,0,3.88,6.86l40,24a8,8,0,1,0,8.24-13.72L136,123.47V80A8,8,0,0,0,128,72Z"},null,-1),Re=[Fe],qe={key:3},Ue=v("path",{d:"M134,80v44.6l37.09,22.25a6,6,0,0,1-6.18,10.3l-40-24A6,6,0,0,1,122,128V80a6,6,0,0,1,12,0Zm-6-46A93.4,93.4,0,0,0,61.51,61.56c-8.58,8.68-16,17-23.51,25.8V64a6,6,0,0,0-12,0v40a6,6,0,0,0,6,6H72a6,6,0,0,0,0-12H44.73C52.86,88.29,60.79,79.35,70,70a82,82,0,1,1,1.7,117.62,6,6,0,1,0-8.24,8.72A94,94,0,1,0,128,34Z"},null,-1),We=[Ue],Ye={key:4},Qe=v("path",{d:"M136,80v43.47l36.12,21.67a8,8,0,0,1-8.24,13.72l-40-24A8,8,0,0,1,120,128V80a8,8,0,0,1,16,0Zm-8-48A95.44,95.44,0,0,0,60.08,60.15C52.81,67.51,46.35,74.59,40,82V64a8,8,0,0,0-16,0v40a8,8,0,0,0,8,8H72a8,8,0,0,0,0-16H49c7.15-8.42,14.27-16.35,22.39-24.57a80,80,0,1,1,1.66,114.75,8,8,0,1,0-11,11.64A96,96,0,1,0,128,32Z"},null,-1),Xe=[Qe],Je={key:5},Ke=v("path",{d:"M132,80v45.74l38.06,22.83a4,4,0,0,1-4.12,6.86l-40-24A4,4,0,0,1,124,128V80a4,4,0,0,1,8,0Zm-4-44A91.42,91.42,0,0,0,62.93,63C53.05,73,44.66,82.47,36,92.86V64a4,4,0,0,0-8,0v40a4,4,0,0,0,4,4H72a4,4,0,0,0,0-8H40.47C49.61,89,58.3,79,68.6,68.6a84,84,0,1,1,1.75,120.49,4,4,0,1,0-5.5,5.82A92,92,0,1,0,128,36Z"},null,-1),et=[Ke],tt={name:"PhClockCounterClockwise"},at=P({...tt,props:{weight:{type:String},size:{type:[String,Number]},color:{type:String},mirrored:{type:Boolean}},setup(r){const e=r,l=x("weight","regular"),p=x("size","1em"),i=x("color","currentColor"),$=x("mirrored",!1),s=_(()=>{var g;return(g=e.weight)!=null?g:l}),w=_(()=>{var g;return(g=e.size)!=null?g:p}),h=_(()=>{var g;return(g=e.color)!=null?g:i}),k=_(()=>e.mirrored!==void 0?e.mirrored?"scale(-1, 1)":void 0:$?"scale(-1, 1)":void 0);return(g,S)=>(n(),f("svg",F({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256",width:w.value,height:w.value,fill:h.value,transform:k.value},g.$attrs),[T(g.$slots,"default"),s.value==="bold"?(n(),f("g",Be,He)):s.value==="duotone"?(n(),f("g",Le,Ge)):s.value==="fill"?(n(),f("g",Te,Re)):s.value==="light"?(n(),f("g",qe,We)):s.value==="regular"?(n(),f("g",Ye,Xe)):s.value==="thin"?(n(),f("g",Je,et)):C("",!0)],16,ze))}}),lt=["width","height","fill","transform"],rt={key:0},nt=v("path",{d:"M128,20A108,108,0,1,0,236,128,108.12,108.12,0,0,0,128,20Zm0,192a84,84,0,1,1,84-84A84.09,84.09,0,0,1,128,212Zm-16-84a16,16,0,1,1-16-16A16,16,0,0,1,112,128Zm64,0a16,16,0,1,1-16-16A16,16,0,0,1,176,128Z"},null,-1),ot=[nt],it={key:1},st=v("path",{d:"M224,128a96,96,0,1,1-96-96A96,96,0,0,1,224,128Z",opacity:"0.2"},null,-1),ut=v("path",{d:"M128,24A104,104,0,1,0,232,128,104.11,104.11,0,0,0,128,24Zm0,192a88,88,0,1,1,88-88A88.1,88.1,0,0,1,128,216Zm56-88a12,12,0,1,1-12-12A12,12,0,0,1,184,128Zm-44,0a12,12,0,1,1-12-12A12,12,0,0,1,140,128Zm-44,0a12,12,0,1,1-12-12A12,12,0,0,1,96,128Z"},null,-1),ct=[st,ut],dt={key:2},pt=v("path",{d:"M128,24A104,104,0,1,0,232,128,104.13,104.13,0,0,0,128,24ZM84,140a12,12,0,1,1,12-12A12,12,0,0,1,84,140Zm44,0a12,12,0,1,1,12-12A12,12,0,0,1,128,140Zm44,0a12,12,0,1,1,12-12A12,12,0,0,1,172,140Z"},null,-1),gt=[pt],mt={key:3},ft=v("path",{d:"M128,26A102,102,0,1,0,230,128,102.12,102.12,0,0,0,128,26Zm0,192a90,90,0,1,1,90-90A90.1,90.1,0,0,1,128,218Zm10-90a10,10,0,1,1-10-10A10,10,0,0,1,138,128Zm-44,0a10,10,0,1,1-10-10A10,10,0,0,1,94,128Zm88,0a10,10,0,1,1-10-10A10,10,0,0,1,182,128Z"},null,-1),vt=[ft],ht={key:4},yt=v("path",{d:"M128,24A104,104,0,1,0,232,128,104.11,104.11,0,0,0,128,24Zm0,192a88,88,0,1,1,88-88A88.1,88.1,0,0,1,128,216Zm12-88a12,12,0,1,1-12-12A12,12,0,0,1,140,128Zm44,0a12,12,0,1,1-12-12A12,12,0,0,1,184,128Zm-88,0a12,12,0,1,1-12-12A12,12,0,0,1,96,128Z"},null,-1),bt=[yt],At={key:5},Ct=v("path",{d:"M128,28A100,100,0,1,0,228,128,100.11,100.11,0,0,0,128,28Zm0,192a92,92,0,1,1,92-92A92.1,92.1,0,0,1,128,220Zm8-92a8,8,0,1,1-8-8A8,8,0,0,1,136,128Zm-44,0a8,8,0,1,1-8-8A8,8,0,0,1,92,128Zm88,0a8,8,0,1,1-8-8A8,8,0,0,1,180,128Z"},null,-1),kt=[Ct],_t={name:"PhDotsThreeCircle"},wt=P({..._t,props:{weight:{type:String},size:{type:[String,Number]},color:{type:String},mirrored:{type:Boolean}},setup(r){const e=r,l=x("weight","regular"),p=x("size","1em"),i=x("color","currentColor"),$=x("mirrored",!1),s=_(()=>{var g;return(g=e.weight)!=null?g:l}),w=_(()=>{var g;return(g=e.size)!=null?g:p}),h=_(()=>{var g;return(g=e.color)!=null?g:i}),k=_(()=>e.mirrored!==void 0?e.mirrored?"scale(-1, 1)":void 0:$?"scale(-1, 1)":void 0);return(g,S)=>(n(),f("svg",F({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256",width:w.value,height:w.value,fill:h.value,transform:k.value},g.$attrs),[T(g.$slots,"default"),s.value==="bold"?(n(),f("g",rt,ot)):s.value==="duotone"?(n(),f("g",it,ct)):s.value==="fill"?(n(),f("g",dt,gt)):s.value==="light"?(n(),f("g",mt,vt)):s.value==="regular"?(n(),f("g",ht,bt)):s.value==="thin"?(n(),f("g",At,kt)):C("",!0)],16,lt))}});function N(r){for(var e=1;e<arguments.length;e++){var l=arguments[e]!=null?Object(arguments[e]):{},p=Object.keys(l);typeof Object.getOwnPropertySymbols=="function"&&(p=p.concat(Object.getOwnPropertySymbols(l).filter(function(i){return Object.getOwnPropertyDescriptor(l,i).enumerable}))),p.forEach(function(i){Ot(r,i,l[i])})}return r}function Ot(r,e,l){return e in r?Object.defineProperty(r,e,{value:l,enumerable:!0,configurable:!0,writable:!0}):r[e]=l,r}var z=function(e,l){var p=N({},e,l.attrs);return d(V,N({},p,{icon:W}),null)};z.displayName="CheckCircleOutlined";z.inheritAttrs=!1;const xt=z;function E(r){for(var e=1;e<arguments.length;e++){var l=arguments[e]!=null?Object(arguments[e]):{},p=Object.keys(l);typeof Object.getOwnPropertySymbols=="function"&&(p=p.concat(Object.getOwnPropertySymbols(l).filter(function(i){return Object.getOwnPropertyDescriptor(l,i).enumerable}))),p.forEach(function(i){$t(r,i,l[i])})}return r}function $t(r,e,l){return e in r?Object.defineProperty(r,e,{value:l,enumerable:!0,configurable:!0,writable:!0}):r[e]=l,r}var B=function(e,l){var p=E({},e,l.attrs);return d(V,E({},p,{icon:je}),null)};B.displayName="MinusCircleOutlined";B.inheritAttrs=!1;const Zt=B;function G(r){for(var e=1;e<arguments.length;e++){var l=arguments[e]!=null?Object(arguments[e]):{},p=Object.keys(l);typeof Object.getOwnPropertySymbols=="function"&&(p=p.concat(Object.getOwnPropertySymbols(l).filter(function(i){return Object.getOwnPropertyDescriptor(l,i).enumerable}))),p.forEach(function(i){St(r,i,l[i])})}return r}function St(r,e,l){return e in r?Object.defineProperty(r,e,{value:l,enumerable:!0,configurable:!0,writable:!0}):r[e]=l,r}var D=function(e,l){var p=G({},e,l.attrs);return d(V,G({},p,{icon:Ve}),null)};D.displayName="PauseCircleOutlined";D.inheritAttrs=!1;const Mt=D,Pt={style:{display:"flex","align-items":"center",gap:"5px"}},jt={key:1},It=P({__name:"BuildInspector",props:{buildSpec:{}},setup(r){const e=r,l=Y(),p=i=>{l.push({name:"logs",params:{projectId:e.buildSpec.projectId},query:i.logQuery})};return(i,$)=>i.buildSpec.runtimes.length>0?(n(),m(a($e),{key:0,"item-layout":"horizontal","data-source":i.buildSpec.runtimes},{renderItem:c(({item:s})=>[d(a(xe),null,{actions:c(()=>[d(a(Q),null,{overlay:c(()=>[d(a(X),null,{default:c(()=>[d(a(J),{onClick:w=>p(s)},{default:c(()=>[v("div",Pt,[d(a(at)),d(a(O),null,{default:c(()=>[b(" View Logs")]),_:1})])]),_:2},1032,["onClick"])]),_:2},1024)]),default:c(()=>[d(a(wt),{style:{cursor:"pointer"}})]),_:2},1024)]),default:c(()=>[s.type=="form"?(n(),m(a(M),{key:0,size:"large"},{default:c(()=>[d(a(ke)),d(a(O),{strong:""},{default:c(()=>[b(A(s.title),1)]),_:2},1024),d(a(O),{type:"secondary",code:""},{default:c(()=>[b("/"+A(s.path),1)]),_:2},1024)]),_:2},1024)):C("",!0),s.type=="job"?(n(),m(a(M),{key:1,size:"large"},{default:c(()=>[d(a(_e)),d(a(O),{strong:""},{default:c(()=>[b(A(s.title),1)]),_:2},1024),d(a(O),{type:"secondary",code:""},{default:c(()=>[b(A(s.schedule),1)]),_:2},1024)]),_:2},1024)):C("",!0),s.type=="hook"?(n(),m(a(M),{key:2,size:"large"},{default:c(()=>[d(a(we)),d(a(O),{strong:""},{default:c(()=>[b(A(s.title),1)]),_:2},1024),d(a(O),{type:"secondary",code:""},{default:c(()=>[b("/_hooks/"+A(s.path),1)]),_:2},1024)]),_:2},1024)):C("",!0),s.type=="script"?(n(),m(a(M),{key:3,size:"large"},{default:c(()=>[d(a(Oe)),d(a(O),{strong:""},{default:c(()=>[b(A(s.title),1)]),_:2},1024)]),_:2},1024)):C("",!0)]),_:2},1024)]),_:1},8,["data-source"])):(n(),f("div",jt,[d(a(K),{description:"No runtimes found. Make sure your project has forms, hooks or jobs before deploying it"})]))}}),Vt=P({__name:"Builds",setup(r){const l=ee().params.projectId,{loading:p,result:i,refetch:$}=L(async()=>{const[t,u]=await Promise.all([me.list(l),Ce.getStatus(l)]);return{b:t.map(y=>({build:y,status:u.filter(Z=>Z.buildId==y.id).map(Z=>Z.status)})),status:u}}),{startPolling:s,endPolling:w}=he({task:$,interval:1e4});te(()=>s()),ae(()=>w());const h=le(null),k=L(async()=>h.value?await fe.get(h.value):null),g=()=>{var o;const t=(o=i.value)==null?void 0:o.b.find(y=>y.build.id===h.value);return`Build ${t==null?void 0:t.build.id.slice(0,8)} - ${t==null?void 0:t.build.createdAt.toLocaleString()}`},S=[{text:"Deploying",tagColor:"blue",check:t=>{var u,o;return(o=t.build.latest&&t.status.some(y=>y=="Running")&&((u=i.value)==null?void 0:u.status.some(y=>y.buildId!==t.build.id)))!=null?o:!1},loading:!0},{text:"Deactivating",tagColor:"orange",check:t=>t.build.status==="success"&&!t.build.latest&&t.status.some(u=>u=="Running"),loading:!0},{text:"Live",tagColor:"green",check:t=>t.build.latest&&t.status.some(u=>u=="Running")},{text:"Sleeping",tagColor:"cyan",check:t=>t.build.latest&&t.status.length===0},{text:"Failed",tagColor:"red",check:t=>t.build.latest&&t.status.some(u=>u=="Failed")},{text:"Inactive",tagColor:"default",check:t=>t.build.status==="success"},{text:"Aborted",tagColor:"default",check:t=>t.build.status==="aborted"||t.build.status==="aborted-by-user"},{text:"Failed",tagColor:"orange",check:t=>t.build.status==="failure"},{text:"Deploying",tagColor:"blue",check:t=>t.build.status==="in-progress",loading:!0},{text:"Uploading",tagColor:"yellow",check:t=>t.build.status==="pending"}];function R(t){var u,o,y,Z,H;return{text:(o=(u=S.find(j=>j.check(t)))==null?void 0:u.text)!=null?o:"unknown",tagColor:(Z=(y=S.find(j=>j.check(t)))==null?void 0:y.tagColor)!=null?Z:"default",hover:(H=t.build.log)!=null?H:void 0}}const q=_(()=>{const t=[{title:"Id"},{title:"Date"},{title:"Abstra Version"},{title:"Status"},{title:"",align:"right"}];return i.value?{columns:t,rows:i.value.b.map(u=>{var o;return{key:u.build.id,cells:[{type:"text",text:u.build.id.slice(0,8)},{key:"date",type:"slot",payload:{date:ve(u.build.createdAt,{weekday:void 0}),distance:pe(u.build.createdAt)}},{type:"text",text:(o=u.build.abstraVersion)!=null?o:"-"},{key:"status",type:"slot",payload:R(u)},{type:"actions",actions:[{icon:be,label:"Inspect build",onClick:async()=>{h.value=u.build.id,k.refetch()}},{icon:ye,label:"View application logs",onClick:()=>{Ze.push({name:"logs",params:{projectId:l},query:{buildId:u.build.id}})}},{icon:Ae,label:"Download files",onClick:()=>u.build.download()}]}]}})}:{columns:t,rows:[]}});return(t,u)=>(n(),f(re,null,[d(U,{"entity-name":"build",loading:a(p),title:"Builds",description:"Each build is a version of your project. You can create a new build by deploying your project from the local editor.","empty-title":"No builds here yet",table:q.value,live:""},{date:c(({payload:o})=>[d(a(ne),null,{title:c(()=>[b(A(o.distance),1)]),default:c(()=>[b(A(o.date)+" ",1)]),_:2},1024)]),status:c(({payload:o})=>[d(a(oe),{open:o.hover?void 0:!1},{content:c(()=>[d(a(ie),{style:{width:"300px",overflow:"auto","font-family":"monospace"},content:o.hover,copyable:""},null,8,["content"])]),default:c(()=>[o.text!=="unknown"?(n(),m(a(ue),{key:0,color:o.tagColor,style:se({cursor:o.hover?"pointer":"default"})},{default:c(()=>[o.text==="Live"?(n(),m(a(xt),{key:0})):o.text==="Inactive"?(n(),m(a(Zt),{key:1})):o.text==="Failed"?(n(),m(a(Se),{key:2})):o.text==="Aborted"?(n(),m(a(Me),{key:3})):o.text==="Sleeping"?(n(),m(a(Mt),{key:4})):o.text==="Uploading"?(n(),m(a(I),{key:5})):o.text==="Deploying"?(n(),m(a(I),{key:6})):o.text==="Deactivating"?(n(),m(a(I),{key:7})):C("",!0),b(" "+A(o.text),1)]),_:2},1032,["color","style"])):C("",!0)]),_:2},1032,["open"])]),_:1},8,["loading","table"]),h.value?(n(),m(a(de),{key:0,footer:null,open:!!h.value,size:"large",width:"80%",title:g(),onCancel:u[0]||(u[0]=o=>h.value=null)},{default:c(()=>[!a(k).result.value||a(k).loading.value?(n(),m(a(ce),{key:0})):a(k).result.value?(n(),m(It,{key:1,"build-spec":a(k).result.value},null,8,["build-spec"])):C("",!0)]),_:1},8,["open","title"])):C("",!0)],64))}});const i1=ge(Vt,[["__scopeId","data-v-83c08404"]]);export{i1 as default};
//# sourceMappingURL=Builds.5c730f0d.js.map
