import{C as o}from"./router.7caa92ea.js";import"./outputWidgets.b00cf7e9.js";(function(){try{var n=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},e=new Error().stack;e&&(n._sentryDebugIds=n._sentryDebugIds||{},n._sentryDebugIds[e]="f210b243-7162-48f3-96a5-a4dad7f3b8a5",n._sentryDebugIdIdentifier="sentry-dbid-f210b243-7162-48f3-96a5-a4dad7f3b8a5")}catch{}})();class l{async list(e){return o.get(`projects/${e}/builds`)}async get(e){return o.get(`builds/${e}`)}async download(e){return o.get(`builds/${e}/download`)}}const a=new l;class u{constructor(e){this.dto=e}static async list(e){return(await a.list(e)).map(s=>new u(s))}get id(){return this.dto.id}get projectId(){return this.dto.projectId}get createdAt(){return new Date(this.dto.createdAt)}get status(){return this.dto.status}get log(){return this.dto.log}get latest(){return this.dto.latest}async download(){const e=await a.download(this.id);if(!e)throw new Error("Download failed");window.open(e.url,"_blank")}}class d{constructor(e,r,s){this.projectId=e,this.buildId=r,this.project=s}static fromV0(e,r,s){const i={hooks:s.hooks.map(t=>({id:t.path,logQuery:{buildId:r,runtimeId:t.path,runtimeTitle:t.title},...t})),forms:s.forms.map(t=>({id:t.path,logQuery:{buildId:r,runtimeId:t.path,runtimeTitle:t.title},...t})),jobs:s.jobs.map(t=>({id:t.identifier,logQuery:{buildId:r,runtimeId:t.identifier,runtimeTitle:t.title},...t})),scripts:[]};return new d(e,r,i)}static fromV1andV2andV3(e,r,s){const i={hooks:s.hooks.map(t=>({logQuery:{buildId:r,runtimeId:t.id,runtimeTitle:t.title},...t})),forms:s.forms.map(t=>({logQuery:{buildId:r,runtimeId:t.id,runtimeTitle:t.title},...t})),jobs:s.jobs.map(t=>({logQuery:{buildId:r,runtimeId:t.id,runtimeTitle:t.title},...t})),scripts:s.scripts.map(t=>({logQuery:{buildId:r,runtimeId:t.id,runtimeTitle:t.title},...t}))};return new d(e,r,i)}static async get(e){const r=await a.get(e);if(!r)throw new Error("Build not found");const{projectId:s,abstraJson:i}=r,t=JSON.parse(i);if(!t.version)throw new Error("Version is invalid");if(t.version==="0.1")return this.fromV0(s,e,t);if(t.version==="1.0")return this.fromV1andV2andV3(s,e,t);if(t.version==="2.0")return this.fromV1andV2andV3(s,e,t);if(t.version==="3.0")return this.fromV1andV2andV3(s,e,t);throw new Error(`Unsupported project version: ${t.version}`)}get runtimes(){return[...this.project.forms.map(e=>({...e,type:"form"})),...this.project.hooks.map(e=>({...e,type:"hook"})),...this.project.jobs.map(e=>({...e,type:"job"}))]}}export{u as B,d as a,l as b};
//# sourceMappingURL=build.10e8a5b0.js.map
