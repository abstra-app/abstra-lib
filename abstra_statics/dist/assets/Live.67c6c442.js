import{d as C,X as k,H,b as l,eu as d,dl as $,ew as j,ez as L,e as _,o as E,a0 as T,u as t,aC as D,eC as P,c as A,w as r,f as i,aq as n,eE as b,cz as N,bf as z,v as M,eB as R,cD as U,ct as q}from"./outputWidgets.f017b1ba.js";import{a as B}from"./asyncComputed.9ec0ae7d.js";import{r as S}from"./router.bd5e0bcd.js";import{B as F,a as G}from"./build.940b62ec.js";import"./index.2d300106.js";import{P as W}from"./project.cffa897f.js";import{C as X}from"./CrudView.ab7e0ba9.js";import{G as J}from"./PhArrowCounterClockwise.vue.02a52dfb.js";import{_ as K,E as O}from"./ExecutionStatusIcon.vue_vue_type_script_setup_true_lang.af051cf4.js";import{A as I}from"./Paragraph.3ffb559e.js";import{A as Q}from"./index.4a35214d.js";import{A as w}from"./Text.01ac3fdf.js";import{A as Z}from"./Link.d1ea88f0.js";import{A as Y}from"./index.b5d890a4.js";import"./Form.c4ae4d63.js";import"./hasIn.a2b4c2f9.js";import"./popupNotifcation.d47f45e7.js";import"./index.cf4c23b9.js";import"./record.e2bcfa5f.js";import"./pubsub.4d72db7b.js";import"./Modal.334f8812.js";import"./DocsButton.vue_vue_type_script_setup_true_lang.377064a4.js";import"./url.42b30a4e.js";import"./index.5cbbe314.js";import"./Title.4002b692.js";import"./Base.bb2b5283.js";import"./Typography.5dfc411f.js";import"./CheckCircleFilled.e9618451.js";import"./LoadingOutlined.00da78e9.js";(function(){try{var f=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},c=new Error().stack;c&&(f._sentryDebugIds=f._sentryDebugIds||{},f._sentryDebugIds[c]="3d0a6dd3-608d-47cd-8a33-62be2042666a",f._sentryDebugIdIdentifier="sentry-dbid-3d0a6dd3-608d-47cd-8a33-62be2042666a")}catch{}})();const ee=["width","height","fill","transform"],te={key:0},ae=_("path",{d:"M180,64H40A12,12,0,0,0,28,76V216a12,12,0,0,0,12,12H180a12,12,0,0,0,12-12V76A12,12,0,0,0,180,64ZM168,204H52V88H168ZM228,40V180a12,12,0,0,1-24,0V52H76a12,12,0,0,1,0-24H216A12,12,0,0,1,228,40Z"},null,-1),oe=[ae],re={key:1},se=_("path",{d:"M184,72V216H40V72Z",opacity:"0.2"},null,-1),le=_("path",{d:"M184,64H40a8,8,0,0,0-8,8V216a8,8,0,0,0,8,8H184a8,8,0,0,0,8-8V72A8,8,0,0,0,184,64Zm-8,144H48V80H176ZM224,40V184a8,8,0,0,1-16,0V48H72a8,8,0,0,1,0-16H216A8,8,0,0,1,224,40Z"},null,-1),ie=[se,le],ne={key:2},de=_("path",{d:"M192,72V216a8,8,0,0,1-8,8H40a8,8,0,0,1-8-8V72a8,8,0,0,1,8-8H184A8,8,0,0,1,192,72Zm24-40H72a8,8,0,0,0,0,16H208V184a8,8,0,0,0,16,0V40A8,8,0,0,0,216,32Z"},null,-1),ce=[de],pe={key:3},ue=_("path",{d:"M184,66H40a6,6,0,0,0-6,6V216a6,6,0,0,0,6,6H184a6,6,0,0,0,6-6V72A6,6,0,0,0,184,66Zm-6,144H46V78H178ZM222,40V184a6,6,0,0,1-12,0V46H72a6,6,0,0,1,0-12H216A6,6,0,0,1,222,40Z"},null,-1),me=[ue],fe={key:4},ge=_("path",{d:"M184,64H40a8,8,0,0,0-8,8V216a8,8,0,0,0,8,8H184a8,8,0,0,0,8-8V72A8,8,0,0,0,184,64Zm-8,144H48V80H176ZM224,40V184a8,8,0,0,1-16,0V48H72a8,8,0,0,1,0-16H216A8,8,0,0,1,224,40Z"},null,-1),_e=[ge],ye={key:5},he=_("path",{d:"M184,68H40a4,4,0,0,0-4,4V216a4,4,0,0,0,4,4H184a4,4,0,0,0,4-4V72A4,4,0,0,0,184,68Zm-4,144H44V76H180ZM220,40V184a4,4,0,0,1-8,0V44H72a4,4,0,0,1,0-8H216A4,4,0,0,1,220,40Z"},null,-1),ve=[he],we={name:"PhCopySimple"},be=C({...we,props:{weight:{type:String},size:{type:[String,Number]},color:{type:String},mirrored:{type:Boolean}},setup(f){const c=f,p=k("weight","regular"),V=k("size","1em"),y=k("color","currentColor"),g=k("mirrored",!1),m=H(()=>{var a;return(a=c.weight)!=null?a:p}),v=H(()=>{var a;return(a=c.size)!=null?a:V}),h=H(()=>{var a;return(a=c.color)!=null?a:y}),e=H(()=>c.mirrored!==void 0?c.mirrored?"scale(-1, 1)":void 0:g?"scale(-1, 1)":void 0);return(a,o)=>(l(),d("svg",L({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256",width:v.value,height:v.value,fill:h.value,transform:e.value},a.$attrs),[$(a.$slots,"default"),m.value==="bold"?(l(),d("g",te,oe)):m.value==="duotone"?(l(),d("g",re,ie)):m.value==="fill"?(l(),d("g",ne,ce)):m.value==="light"?(l(),d("g",pe,me)):m.value==="regular"?(l(),d("g",fe,_e)):m.value==="thin"?(l(),d("g",ye,ve)):j("",!0)],16,ee))}}),Ve={key:0,class:"flex-row"},He={key:1,class:"flex-row"},ke={key:2,class:"flex-row"},Ae=C({__name:"ExecutionsShort",props:{stageId:{},projectId:{}},emits:["select"],setup(f,{emit:c}){const p=f,V=new O,{result:y,refetch:g,loading:m}=B(async()=>{const{executions:e}=await V.list({projectId:p.projectId,stageId:p.stageId,limit:6});return e}),v=e=>{c("select",e)};let h=null;return E(()=>{h=setInterval(()=>g(),15e3)}),T(()=>{h&&clearInterval(h)}),(e,a)=>t(y)?(l(),d("div",Ve,[(l(!0),d(D,null,P(t(y),o=>(l(),A(t(N),{key:o.id,title:o.createdAt.toLocaleString(),onClick:s=>v(o)},{content:r(()=>[i(t(I),null,{default:r(()=>[n("Status: "+b(o.status),1)]),_:2},1024),i(t(I),null,{default:r(()=>[n("Duration: "+b(o.duration_seconds)+" s",1)]),_:2},1024),i(t(I),null,{default:r(()=>[n("Build: "+b(o.buildId.slice(0,6)),1)]),_:2},1024)]),default:r(()=>[i(K,{status:o.status},null,8,["status"])]),_:2},1032,["title","onClick"]))),128))])):t(m)?(l(),d("div",He,[i(t(z))])):(l(),d("div",ke,"None"))}});const Ie=M(Ae,[["__scopeId","data-v-dc7e11a2"]]),Ce={style:{"max-width":"250px",overflow:"hidden","text-overflow":"ellipsis ellipsis","white-space":"nowrap"}},xe={key:1},Se=C({__name:"Live",setup(f){const p=R().params.projectId,V=e=>{S.push({name:"logs",params:{projectId:p},query:{runtimeId:e.stageId,executionId:e.id}})},{loading:y,result:g}=B(async()=>{const a=(await F.list(p)).find(u=>u.latest);if(!a)return null;const[o,s]=await Promise.all([G.get(a.id),W.get(p)]);return{buildSpec:o,project:s}}),m=e=>{var s;if(!("path"in e)||!e.path)return;const a=e.type==="form"?`/${e.path}`:`/_hooks/${e.path}`,o=(s=g.value)==null?void 0:s.project.getUrl(a);!o||(navigator.clipboard.writeText(o),q.success("Copied URL to clipboard"))},v=e=>e.type=="form"?`/${e.path}`.slice(0,30):e.type=="hook"?`/_hooks/${e.path}`.slice(0,30):e.type=="job"?`${e.schedule}`:"",h=H(()=>{var o;const e=[{name:"Type",align:"left"},{name:"Title",align:"left"},{name:"Trigger",align:"left"},{name:"Last Runs"},{name:"",align:"right"}],a=(o=g.value)==null?void 0:o.buildSpec;return a?{columns:e,rows:a.runtimes.map(s=>({key:s.id,cells:[{type:"tag",text:s.type.charAt(0).toUpperCase()+s.type.slice(1),tagColor:"default"},{type:"slot",key:"title",payload:{runtime:s}},{type:"slot",key:"trigger",payload:{runtime:s}},{type:"slot",key:"last-runs",payload:{runtime:s}},{type:"actions",actions:[{icon:J,label:"View script logs",onClick:()=>S.push({name:"logs",params:{projectId:p},query:{runtimeId:s.id}})},{icon:be,label:"Copy URL",onClick:()=>m(s),hide:!["form","hook"].includes(s.type)}]}]}))}:{columns:e,rows:[]}});return(e,a)=>{var o,s;return t(y)||((s=(o=t(g))==null?void 0:o.buildSpec.runtimes.length)!=null?s:0)>0?(l(),A(X,{key:0,"empty-title":"","entity-name":"build",description:"Access and monitor your project's current scripts here.",table:h.value,loading:t(y),title:"Live View"},{extra:r(()=>[i(t(Q),{message:"Last runs will only be shown for deploys with abstra version >= 1.27.0",type:"info","show-icon":""})]),title:r(({payload:u})=>{var x;return[_("div",Ce,[u.runtime.type!="form"?(l(),A(t(w),{key:0},{default:r(()=>[n(b(u.runtime.title),1)]),_:2},1024)):u.runtime.type=="form"?(l(),A(t(Z),{key:1,href:(x=t(g))==null?void 0:x.project.getUrl(u.runtime.path),target:"_blank"},{default:r(()=>[n(b(u.runtime.title),1)]),_:2},1032,["href"])):j("",!0)])]}),"last-runs":r(({payload:u})=>[i(Ie,{"stage-id":u.runtime.id,"project-id":t(p),onSelect:V},null,8,["stage-id","project-id"])]),trigger:r(({payload:u})=>[i(t(Y),{color:"default"},{default:r(()=>[n(b(v(u.runtime)),1)]),_:2},1024)]),_:1},8,["table","loading"])):(l(),d("div",xe,[i(t(U),{direction:"vertical"},{default:r(()=>[i(t(w),null,{default:r(()=>[n("Install abstra using pip:")]),_:1}),i(t(w),{code:"",copyable:""},{default:r(()=>[n("pip install abstra")]),_:1}),i(t(w),null,{default:r(()=>[n("Start a new project using our CLI")]),_:1}),i(t(w),{code:"",copyable:""},{default:r(()=>[n("abstra serve my-new-project")]),_:1}),i(t(w),null,{default:r(()=>[n(" If you have any questions, please reach out to our "),i(t(Z),{href:"https://discord.gg/abstra",target:"_blank"},{default:r(()=>[n(" discord channel ")]),_:1})]),_:1})]),_:1})]))}}});const st=M(Se,[["__scopeId","data-v-69eba159"]]);export{st as default};
//# sourceMappingURL=Live.67c6c442.js.map
