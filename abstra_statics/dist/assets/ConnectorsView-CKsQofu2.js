const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/router-BfX34XLs.js","assets/jwt-decode.esm-X_JHyrHe.js","assets/jwt-decode-D9e-DIPp.css","assets/ts.worker-BwKuk5mh.js"])))=>i.map(i=>d[i]);
import{_ as oe}from"./DocsButton.vue_vue_type_script_setup_true_lang-DoAQCamW.js";import{_ as G}from"./AbstraButton.vue_vue_type_script_setup_true_lang-BBCNEuoZ.js";import{a as R,i as B,c as E,b as w,e as r,f as le,g as j,h as K,m as ie,ah as se,r as H,a8 as M,H as O,p as C,u as n,aJ as ce,w as l,M as U,W as z,aG as re,aH as ue,aK as de,cp as J,bq as pe,br as ge,S as _,U as k,cq as he,bo as ye,b8 as me,bj as fe,bn as ve,j as s,ae as g,ak as L,v as T,aQ as P,cr as Ce,aL as X,bm as W,E as _e,aN as ee,ac as ke,aj as q,be,bf as we,bg as Y,bB as Ie,z as Q,bs as D}from"./jwt-decode.esm-X_JHyrHe.js";import{G as Te}from"./PhDotsThreeVertical.vue-CMiDmYDS.js";import{C as V,a as Se}from"./router-BfX34XLs.js";import{U as xe}from"./UploadOutlined-DTEGiKJB.js";import{_ as Ue}from"./AbstraLogo.vue_vue_type_script_setup_true_lang-1ypD3bda.js";import{L as je}from"./Logo-BOGz_lsb.js";import{A as ne}from"./index-pJ4VFbXY.js";import{C as te}from"./index-DP71ioDC.js";import{S as $e}from"./index-D_wdY2um.js";import"./constants-BpBRrK-g.js";import"./ts.worker-BwKuk5mh.js";(function(){try{var i=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},t=new Error().stack;t&&(i._sentryDebugIds=i._sentryDebugIds||{},i._sentryDebugIds[t]="18a59aca-c83c-4967-b042-27dd847bc9b0",i._sentryDebugIdIdentifier="sentry-dbid-18a59aca-c83c-4967-b042-27dd847bc9b0")}catch{}})();const Ne=["width","height","fill","transform"],Ae={key:0},Ve=K("path",{d:"M216.49,184.49l-32,32a12,12,0,0,1-17-17L179,188H48a12,12,0,0,1,0-24H179l-11.52-11.51a12,12,0,0,1,17-17l32,32A12,12,0,0,1,216.49,184.49Zm-145-64a12,12,0,0,0,17-17L77,92H208a12,12,0,0,0,0-24H77L88.49,56.49a12,12,0,0,0-17-17l-32,32a12,12,0,0,0,0,17Z"},null,-1),Le=[Ve],Ee={key:1},Ke=K("path",{d:"M208,80v96H48V80Z",opacity:"0.2"},null,-1),Fe=K("path",{d:"M213.66,181.66l-32,32a8,8,0,0,1-11.32-11.32L188.69,184H48a8,8,0,0,1,0-16H188.69l-18.35-18.34a8,8,0,0,1,11.32-11.32l32,32A8,8,0,0,1,213.66,181.66Zm-139.32-64a8,8,0,0,0,11.32-11.32L67.31,88H208a8,8,0,0,0,0-16H67.31L85.66,53.66A8,8,0,0,0,74.34,42.34l-32,32a8,8,0,0,0,0,11.32Z"},null,-1),He=[Ke,Fe],ze={key:2},Re=K("path",{d:"M42.34,85.66a8,8,0,0,1,0-11.32l32-32A8,8,0,0,1,88,48V72H208a8,8,0,0,1,0,16H88v24a8,8,0,0,1-13.66,5.66Zm171.32,84.68-32-32A8,8,0,0,0,168,144v24H48a8,8,0,0,0,0,16H168v24a8,8,0,0,0,13.66,5.66l32-32A8,8,0,0,0,213.66,170.34Z"},null,-1),Be=[Re],Pe={key:3},Me=K("path",{d:"M212.24,171.76a6,6,0,0,1,0,8.48l-32,32a6,6,0,0,1-8.48-8.48L193.51,182H48a6,6,0,0,1,0-12H193.51l-21.75-21.76a6,6,0,0,1,8.48-8.48ZM75.76,116.24a6,6,0,0,0,8.48-8.48L62.49,86H208a6,6,0,0,0,0-12H62.49L84.24,52.24a6,6,0,0,0-8.48-8.48l-32,32a6,6,0,0,0,0,8.48Z"},null,-1),qe=[Me],De={key:4},Ze=K("path",{d:"M213.66,181.66l-32,32a8,8,0,0,1-11.32-11.32L188.69,184H48a8,8,0,0,1,0-16H188.69l-18.35-18.34a8,8,0,0,1,11.32-11.32l32,32A8,8,0,0,1,213.66,181.66Zm-139.32-64a8,8,0,0,0,11.32-11.32L67.31,88H208a8,8,0,0,0,0-16H67.31L85.66,53.66A8,8,0,0,0,74.34,42.34l-32,32a8,8,0,0,0,0,11.32Z"},null,-1),Ge=[Ze],Oe={key:5},Je=K("path",{d:"M210.83,173.17a4,4,0,0,1,0,5.66l-32,32a4,4,0,0,1-5.66-5.66L198.34,180H48a4,4,0,0,1,0-8H198.34l-25.17-25.17a4,4,0,0,1,5.66-5.66ZM77.17,114.83a4,4,0,0,0,5.66-5.66L57.66,84H208a4,4,0,0,0,0-8H57.66L82.83,50.83a4,4,0,0,0-5.66-5.66l-32,32a4,4,0,0,0,0,5.66Z"},null,-1),We=[Je],Ye={name:"PhArrowsLeftRight"},Qe=R({...Ye,props:{weight:{type:String},size:{type:[String,Number]},color:{type:String},mirrored:{type:Boolean}},setup(i){const t=i,a=B("weight","regular"),e=B("size","1em"),c=B("color","currentColor"),v=B("mirrored",!1),b=E(()=>t.weight??a),S=E(()=>t.size??e),h=E(()=>t.color??c),I=E(()=>t.mirrored!==void 0?t.mirrored?"scale(-1, 1)":void 0:v?"scale(-1, 1)":void 0);return(N,A)=>(r(),w("svg",ie({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256",width:S.value,height:S.value,fill:h.value,transform:I.value},N.$attrs),[le(N.$slots,"default"),b.value==="bold"?(r(),w("g",Ae,Le)):b.value==="duotone"?(r(),w("g",Ee,He)):b.value==="fill"?(r(),w("g",ze,Be)):b.value==="light"?(r(),w("g",Pe,qe)):b.value==="regular"?(r(),w("g",De,Ge)):b.value==="thin"?(r(),w("g",Oe,We)):j("",!0)],16,Ne))}});class Xe{async generateEcdsaKey(t){const{projectId:a,connectionName:e,connectorType:c}=t;return V.post(`projects/${a}/connectors/${c}/connections/${e}/ecdsa-key`,{})}async createEcdsaConnection(t){const{projectId:a,connectionName:e,connectorType:c,publicKey:v,privateKey:b,accessId:S}=t;return V.post(`projects/${a}/connectors/${c}/connections/${e}/create-ecdsa`,{publicKey:v,privateKey:b,accessId:S})}async generateRsaKey(t){const{projectId:a,connectionName:e,connectorType:c}=t;return V.post(`projects/${a}/connectors/${c}/connections/${e}/rsa-key`,{})}async createRsaConnection(t){const{projectId:a,connectionName:e,connectorType:c,publicKey:v,privateKey:b,apiToken:S}=t;return V.post(`projects/${a}/connectors/${c}/connections/${e}/create-rsa`,{publicKey:v,privateKey:b,apiToken:S})}async getLoginUrl(t,a,e,c,v){return V.get(`projects/${t}/connectors/${e}/connections/${a}/login-url`,{scopeIds:c.join(","),...v})}async listConnectors(t){return V.get(`projects/${t}/connectors`)}async getConnectorsBetaStatus(){const{EnvURL:t}=await se(async()=>{const{EnvURL:a}=await import("./router-BfX34XLs.js").then(e=>e.o);return{EnvURL:a}},__vite__mapDeps([0,1,2,3]));try{const a=await fetch(`${t.cloudApi}/public/connectors/beta-status`);if(!a.ok){if(a.status===404)return console.warn("Beta status endpoint not available yet, returning empty status"),{};throw new Error("Failed to fetch connectors beta status")}return a.json()}catch(a){return console.error("Error fetching beta status:",a),{}}}async createTokenConnection(t){const{projectId:a,connectionName:e,connectorType:c,tokens:v}=t,b={type:"tokens",tokens:v};return V.post(`projects/${a}/connectors/${c}/connections/${e}`,b)}async listConnections(t){return V.get(`projects/${t}/connections`)}async deleteConnection(t){const{projectId:a,connectionName:e,connectorType:c}=t;return V.delete(`projects/${a}/connectors/${c}/connections/${e}`)}async renameConnection(t){const{projectId:a,connectionName:e,connectorType:c,newConnectionName:v}=t;return V.patch(`projects/${a}/connectors/${c}/connections/${e}`,{newConnectionName:v})}}class en{constructor(t,a){this.projectId=t,this.api=a,this.state=H({connectors:[],connections:[],addingConnection:null,editingConnection:null,betaStatus:{}})}state;hasChanges=E(()=>!!this.state.value.editingConnection&&this.state.value.editingConnection.name!==this.state.value.editingConnection.newName);async fetchConnectors(){this.state.value.connectors=await this.api.listConnectors(this.projectId)}async fetchBetaStatus(){this.state.value.betaStatus=await this.api.getConnectorsBetaStatus()}async fetchInitialState(){await this.fetchConnectors(),await Promise.all([this.fetchBetaStatus(),this.refetchConnections()])}async refetchConnections(){const t=await this.api.listConnections(this.projectId);this.state.value.connections=t.map(a=>{const e=this.state.value.connectors.find(c=>c.metadata.key===a.connectionType);return e?{name:a.name,connectorTitle:e.metadata.label,connectorType:a.connectionType,icon:e.metadata.logoUrl}:null}).filter(a=>a!==null)}handleDeletionClick=async t=>{M.confirm({title:"Delete connection",content:"Are you sure you want to delete this connection?",onOk:()=>this.handleDeleteConnection(t)})};handleDeleteConnection=async t=>{await this.api.deleteConnection({projectId:this.projectId,connectionName:t.name,connectorType:t.connectorType}),this.state.value.editingConnection=null,await this.refetchConnections()};handleEditConnectionClick(t){this.state.value.editingConnection={...t,newName:t.name}}async getLoginUrl(t,a,e,c){return this.api.getLoginUrl(this.projectId,a,t,e,c)}slugify(t){return t.toString().toLowerCase().replace(/\s+/g,"-").replace(/[^\w-]+/g,"").replace(/--+/g,"-")}getUniqueName(t){const a=new Set(this.state.value.connections.filter(c=>c.connectorType===t).map(c=>c.name));if(!a.has(t))return t;let e=1;for(;a.has(`${t}-${e}`);)e++;return`${t}-${e}`}handleAddConnectionSubmit=async()=>{const t=this.state.value.addingConnection?.connector.metadata.key,a=this.state.value.addingConnection?.selectedScopeIds,e=this.state.value.addingConnection?.tokenValues??{};if(!t||!a)throw new Error("No connector or scope selected");const{url:c}=await this.getLoginUrl(t,this.getUniqueName(t),a,e);window.location.href=c};handleAddTokenConnectionSubmit=async()=>{const t=this.state.value.addingConnection;if(!t)throw new Error("No connection is being added");const a=t.connector.metadata.key,e=this.getUniqueName(a);await this.api.createTokenConnection({projectId:this.projectId,connectionName:e,connectorType:a,tokens:t.tokenValues}),this.state.value.addingConnection=null,await this.refetchConnections()};async generateEcdsaKey(){const t=this.state.value.addingConnection;if(!t)throw new Error("No connection is being added");const a=t.connector.metadata.key,e=this.getUniqueName(a),v=a==="iugu"?await this.api.generateRsaKey({projectId:this.projectId,connectionName:e,connectorType:a}):await this.api.generateEcdsaKey({projectId:this.projectId,connectionName:e,connectorType:a});return this.state.value.addingConnection&&(this.state.value.addingConnection.connectionName=e,this.state.value.addingConnection.ecdsaKeys=v),v.publicKey}handleAddEcdsaConnectionSubmit=async(t,a)=>{const e=this.state.value.addingConnection;if(!e||!t)throw new Error("No connection is being added or public key is missing");if(!e.connectionName||!e.ecdsaKeys)throw new Error("Keys or connection name not found");const c=e.connector.metadata.key;if(c==="iugu"){if(!a)throw new Error("API Token is missing");await this.api.createRsaConnection({projectId:this.projectId,connectionName:e.connectionName,connectorType:c,publicKey:e.ecdsaKeys.publicKey,privateKey:e.ecdsaKeys.privateKey,apiToken:a})}else{if(!a)throw new Error("Project ID is missing");await this.api.createEcdsaConnection({projectId:this.projectId,connectionName:e.connectionName,connectorType:c,publicKey:e.ecdsaKeys.publicKey,privateKey:e.ecdsaKeys.privateKey,accessId:a})}this.state.value.addingConnection=null,await this.refetchConnections()};renameConnection=async()=>{const{editingConnection:t}=this.state.value;if(!t)throw new Error("No connection is being edited");const a=async()=>{await this.api.renameConnection({projectId:this.projectId,connectionName:t.name,connectorType:t.connectorType,newConnectionName:t.newName}),await this.refetchConnections(),this.state.value.editingConnection=null};M.confirm({title:"Rename connection",content:"Are you sure you want to rename this connection? This will break any existing references to the old name.",onOk:a})};showAddConfirmationModal=t=>{this.state.value.addingConnection={selectedScopeIds:t.auth.type==="oauth2"?t.auth.scopes.map(a=>a.key):[],connector:t,tokenValues:{}}};handleScopeToggle=(t,a)=>{a?this.state.value.addingConnection.selectedScopeIds.push(t):this.state.value.addingConnection.selectedScopeIds=this.state.value.addingConnection.selectedScopeIds.filter(e=>e!==t)}}function nn(i){return new Promise((t,a)=>{const e=new FileReader;e.onload=()=>{const v=e.result.split(",")[1];t(v)},e.onerror=()=>a(e.error),e.readAsDataURL(i)})}const tn={key:6,style:{"margin-top":"16px"}},Z=R({__name:"AuthFormFields",props:{tokens:{},tokenValues:{},uploadedFiles:{default:()=>({})}},emits:["update:tokenValues","update:uploadedFiles","tokenChange"],setup(i,{emit:t}){const a=i,e=t,c=H(a.uploadedFiles||{});function v(u){const d=h.value[u];return d?d.split(",").map(o=>o.trim()):[]}function b(u){if(!u.condition)return!0;const d=Object.keys(u.condition);for(const o of d){const m=u.condition[o].equals;if(h.value[o]!==m)return!1}return!0}function S(u,d){Array.isArray(d)?I(u,d.join(",")):console.error("Expected array for checkbox/select value")}const h=H({...a.tokenValues});O(()=>a.tokenValues,u=>{h.value={...u}},{deep:!0}),O(()=>a.uploadedFiles,u=>{c.value=u||{}},{deep:!0});function I(u,d){h.value[u]=d;const o={...h.value};e("update:tokenValues",o),e("tokenChange")}function N(u){const d=[];return u.key&&d.push({required:!0,message:g.translate("i18n_auth_form_field_required",null,u.label||u.key)}),u.input?.minSize&&d.push({min:u.input.minSize,message:g.translate("i18n_auth_form_field_min_length",null,u.input.minSize)}),u.input?.maxSize&&d.push({max:u.input.maxSize,message:g.translate("i18n_auth_form_field_max_length",null,u.input.maxSize)}),d}async function A(u,d){try{const o=await nn(u),m={...c.value,[d]:{file:u,base64:o}};c.value=m,e("update:uploadedFiles",m),h.value[d]=o;const y={...h.value};e("update:tokenValues",y),e("tokenChange")}catch(o){console.error("Error converting file to base64:",o)}return!1}function $(u){const d={...c.value};delete d[u],c.value=d,e("update:uploadedFiles",d),h.value[u]="";const o={...h.value};e("update:tokenValues",o),e("tokenChange")}function F(u){const d=c.value[u];return d?[{uid:u,name:d.file.name,status:"done",size:d.file.size}]:[]}return(u,d)=>(r(),C(n(ce),{model:h.value,layout:"vertical"},{default:l(()=>[(r(!0),w(U,null,z(i.tokens,o=>re((r(),C(n(de),{key:o.key,required:b(o),label:o.label,name:o.key,rules:N(o)},{default:l(()=>[o.input?.type==="small-string"?(r(),C(n(J),{key:0,value:h.value[o.key],"onUpdate:value":m=>h.value[o.key]=m,placeholder:o.description,maxlength:o.input?.maxSize,minlength:o.input?.minSize,onInput:()=>I(o.key,h.value[o.key]||"")},null,8,["value","onUpdate:value","placeholder","maxlength","minlength","onInput"])):o.input?.type==="radiobox"?(r(),C(n(pe),{key:1,value:h.value[o.key],"onUpdate:value":m=>h.value[o.key]=m,onChange:()=>I(o.key,h.value[o.key]||"")},{default:l(()=>[(r(!0),w(U,null,z(o.input.options,m=>(r(),C(n(ge),{key:m.value,value:m.value},{default:l(()=>[_(k(m.label),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onUpdate:value","onChange"])):o.input?.type==="checkbox"?(r(),w(U,{key:2},[(o.input?.options?.length??0)<=10?(r(),C(n(he),{key:0,value:v(o.key),onChange:m=>S(o.key,m)},{default:l(()=>[(r(!0),w(U,null,z(o.input.options,m=>(r(),C(n(ye),{key:m.value,value:m.value},{default:l(()=>[_(k(m.label),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onChange"])):(r(),C(n(me),{key:1,mode:"multiple",style:{width:"100%"},value:v(o.key),options:o.input.options??[],onChange:m=>S(o.key,m)},null,8,["value","options","onChange"]))],64)):o.input?.type==="large-text"?(r(),C(n(fe),{key:3,value:h.value[o.key],"onUpdate:value":m=>h.value[o.key]=m,placeholder:o.description,maxlength:o.input?.maxSize,minlength:o.input?.minSize,rows:4,onInput:()=>I(o.key,h.value[o.key]||"")},null,8,["value","onUpdate:value","placeholder","maxlength","minlength","onInput"])):o.input?.type==="file"?(r(),C(n(ve),{key:4,"file-list":F(o.key),"before-upload":m=>A(m,o.key),"max-count":1,"show-upload-list":!0,onRemove:()=>$(o.key)},{default:l(()=>[s(G,null,{default:l(()=>[s(n(xe)),_(" "+k(n(g).translate("i18n_auth_form_upload_file",null)),1)]),_:1})]),_:1},8,["file-list","before-upload","onRemove"])):(r(),C(n(J),{key:5,value:h.value[o.key],"onUpdate:value":m=>h.value[o.key]=m,placeholder:o.description,onInput:()=>I(o.key,h.value[o.key]||"")},null,8,["value","onUpdate:value","placeholder","onInput"])),o.instructions?(r(),w("div",tn,[s(n(L),{type:"secondary",style:{"white-space":"pre-line","font-size":"14px"}},{default:l(()=>[_(k(o.instructions),1)]),_:2},1024)])):j("",!0),o.description&&!o.instructions?(r(),C(n(L),{key:7,type:"secondary",style:{display:"block","font-size":"12px","margin-top":"8px"}},{default:l(()=>[_(k(o.description),1)]),_:2},1024)):j("",!0)]),_:2},1032,["required","label","name","rules"])),[[ue,b(o)]])),128))]),_:1},8,["model"]))}}),an=R({__name:"ConnectionHeader",props:{connectorLogoUrl:{},connectorLabel:{}},setup(i){return(t,a)=>(r(),C(n(T),{justify:"center",align:"center",gap:20,style:{"margin-bottom":"24px",padding:"20px 0"}},{default:l(()=>[s(Ue,{"hide-text":"",size:"large"}),s(n(Qe),{size:24}),s(je,{"image-url":i.connectorLogoUrl,"brand-name":i.connectorLabel,size:"medium","hide-text":""},null,8,["image-url","brand-name"])]),_:1}))}}),on=R({__name:"ConnectionModal",props:{addingConnection:{},ecdsaPublicKey:{},ecdsaKeyLoading:{type:Boolean},uploadedFiles:{},loading:{type:Boolean}},emits:["cancel","submit","scope-toggle","generate-ecdsa-key","update:token-values","update:uploaded-files","token-change"],setup(i,{emit:t}){const a=i,e=t,c=E(()=>{switch(a.addingConnection?.connector.auth.type){case"oauth2":return g.translate("i18n_connection_modal_button_authorize",null);case"tokens":return g.translate("i18n_connection_modal_button_create",null);case"ecdsa":{if(!a.ecdsaPublicKey)return g.translate("i18n_connection_modal_button_ok",null);const F=a.addingConnection?.connector.auth.params||[],u=a.addingConnection?.tokenValues||{};return F.every(o=>u[o.key]&&u[o.key].trim().length>0)?g.translate("i18n_connection_modal_button_create",null):g.translate("i18n_connection_modal_button_create_missing_fields",null)}default:return g.translate("i18n_connection_modal_button_ok",null)}});function v(){e("cancel")}function b(){e("submit")}function S($,F){e("scope-toggle",$,F)}function h(){e("generate-ecdsa-key")}function I($){e("update:token-values",$)}function N($){e("update:uploaded-files",$)}function A(){e("token-change")}return($,F)=>(r(),C(n(M),{open:!!i.addingConnection,title:i.addingConnection?n(g).translate("i18n_connection_modal_title_add",null,i.addingConnection.connector.metadata.label):"","ok-text":c.value,"ok-button-props":{disabled:c.value.includes("Required")},"confirm-loading":i.loading,"wrap-class-name":"full-modal",onCancel:v,onOk:b},{default:l(()=>[i.addingConnection?(r(),w(U,{key:0},[s(an,{"connector-logo-url":i.addingConnection.connector.metadata.logoUrl,"connector-label":i.addingConnection.connector.metadata.label},null,8,["connector-logo-url","connector-label"]),i.addingConnection.connector.auth.type==="oauth2"?(r(),w(U,{key:0},[s(n(P),null,{default:l(()=>[_(k(n(g).translate("i18n_connection_modal_oauth2_scopes_instruction",null)),1)]),_:1}),s(n(T),{vertical:"",gap:"10",style:{margin:"30px 0px"}},{default:l(()=>[(r(!0),w(U,null,z(i.addingConnection.connector.auth.scopes,u=>(r(),C(n(T),{key:u.key,justify:"space-between",align:"center"},{default:l(()=>[s(n(T),{vertical:""},{default:l(()=>[s(n(L),null,{default:l(()=>[_(k(u.description),1)]),_:2},1024),s(n(L),{type:"secondary"},{default:l(()=>[_(k(u.key),1)]),_:2},1024)]),_:2},1024),s(n(Ce),{checked:i.addingConnection.selectedScopeIds.includes(u.key),onChange:d=>S(u.key,d)},null,8,["checked","onChange"])]),_:2},1024))),128)),i.addingConnection.connector.auth.params?.length?(r(),C(Z,{key:0,tokens:i.addingConnection.connector.auth.params,"token-values":i.addingConnection.tokenValues,"uploaded-files":i.uploadedFiles,"onUpdate:tokenValues":I,"onUpdate:uploadedFiles":N,onTokenChange:A},null,8,["tokens","token-values","uploaded-files"])):j("",!0)]),_:1})],64)):j("",!0),i.addingConnection.connector.auth.type==="tokens"?(r(),w(U,{key:1},[s(n(P),null,{default:l(()=>[_(k(n(g).translate("i18n_connection_modal_tokens_instruction",null)),1)]),_:1}),s(Z,{tokens:i.addingConnection.connector.auth.tokens,"token-values":i.addingConnection.tokenValues,"uploaded-files":i.uploadedFiles,"onUpdate:tokenValues":I,"onUpdate:uploadedFiles":N,onTokenChange:A},null,8,["tokens","token-values","uploaded-files"])],64)):j("",!0),i.addingConnection.connector.auth.type==="ecdsa"?(r(),w(U,{key:2},[i.ecdsaPublicKey?(r(),C(n(T),{key:1,vertical:"",gap:"16"},{default:l(()=>[s(n(L),{strong:""},{default:l(()=>[_(k(n(g).translate("i18n_connection_modal_ecdsa_keys_generated",null)),1)]),_:1}),s(n(L),{strong:""},{default:l(()=>[_(k(n(g).translate("i18n_connection_modal_ecdsa_copy_public_key",null)),1)]),_:1}),s(n(X),{value:i.ecdsaPublicKey,readonly:"",copyable:"",code:""},null,8,["value"]),s(Z,{tokens:i.addingConnection.connector.auth.params,"token-values":i.addingConnection.tokenValues,"uploaded-files":i.uploadedFiles,"onUpdate:tokenValues":I,"onUpdate:uploadedFiles":N,onTokenChange:A},null,8,["tokens","token-values","uploaded-files"])]),_:1})):(r(),w(U,{key:0},[s(n(P),null,{default:l(()=>[_(k(n(g).translate("i18n_connection_modal_ecdsa_generate_instruction",null)),1)]),_:1}),s(n(T),{vertical:"",gap:"16"},{default:l(()=>[s(G,{loading:i.ecdsaKeyLoading,onClick:h},{default:l(()=>[_(k(n(g).translate("i18n_connection_modal_ecdsa_generate_button",null)),1)]),_:1},8,["loading"])]),_:1})],64))],64)):j("",!0)],64)):j("",!0)]),_:1},8,["open","title","ok-text","ok-button-props","confirm-loading"]))}}),ln=R({__name:"ConnectorCard",props:{title:{},logoUrl:{},description:{},unavailable:{type:Boolean},connector:{},isBeta:{type:Boolean}},setup(i){return(t,a)=>(r(),C(n(te),{class:_e({"connector-card":!0,unavailable:i.unavailable})},{default:l(()=>[s(n(T),{style:{width:"100%"},vertical:"",gap:12},{default:l(()=>[s(n(T),{justify:"space-between"},{default:l(()=>[s(n(ne),{src:i.logoUrl,shape:"square",size:"large"},null,8,["src"]),s(n(T),{gap:8},{default:l(()=>[i.isBeta?(r(),C(n(W),{key:0,color:"orange",style:{height:"fit-content"}},{default:l(()=>[...a[0]||(a[0]=[_("BETA",-1)])]),_:1})):j("",!0),i.unavailable?(r(),C(n(W),{key:1,style:{height:"fit-content"}},{default:l(()=>[_(k(n(g).translate("i18n_connector_card_talk_to_us",null)),1)]),_:1})):j("",!0)]),_:1})]),_:1}),s(n(T),{vertical:""},{default:l(()=>[s(n(L),{strong:""},{default:l(()=>[_(k(i.title),1)]),_:1}),s(n(L),{type:"secondary"},{default:l(()=>[_(k(i.description),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["class"]))}}),sn=ee(ln,[["__scopeId","data-v-86187920"]]),cn={class:"connectors-grid"},rn=R({__name:"ConnectorsView",setup(i){const a=ke().params.projectId,e=new en(a,new Xe),c=H(null),v=H(!1),b=H({}),S=H(!1),h=E(()=>[...e.state.value.connectors.filter(y=>y.auth.type==="oauth2"),...e.state.value.connectors.filter(y=>y.auth.type==="tokens"),...e.state.value.connectors.filter(y=>y.auth.type==="ecdsa"),...e.state.value.connectors.filter(y=>y.auth.type==="manual")]),I=H(""),N=E(()=>{if(!I.value.trim())return h.value;const y=I.value.trim().toLowerCase();return h.value.filter(f=>{const p=f.metadata.label?.toLowerCase()||"",x=f.metadata.key?.toLowerCase()||"";return p.includes(y)||x.includes(y)})}),A=E(()=>e.state.value.connections.filter(y=>y&&y.name&&y.connectorTitle&&y.connectorType));e.fetchInitialState();function $(y){e.state.value.addingConnection&&(e.state.value.addingConnection.tokenValues=y)}function F(y){b.value=y}function u(){c.value=null,v.value=!1,b.value={}}async function d(){v.value=!0;try{const f=(await e.generateEcdsaKey()).replace("-----BEGIN PUBLIC KEY-----","").replace("-----END PUBLIC KEY-----","").replace(/\s/g,"");c.value=f}finally{v.value=!1}}async function o(){const y=e.state.value.addingConnection?.connector.auth.type;S.value=!0;try{switch(y){case"oauth2":return await e.handleAddConnectionSubmit();case"tokens":return await e.handleAddTokenConnectionSubmit();case"ecdsa":{const f=e.state.value.addingConnection?.tokenValues||{},p=e.state.value.addingConnection?.connector.metadata.key;let x="";p==="starkbank"?x=f.projectId||"":p==="iugu"&&(x=f.apiToken||"");const ae=await e.handleAddEcdsaConnectionSubmit(c.value,x);return u(),ae}default:break}}catch(f){const p=x=>{try{return JSON.parse(x),!0}catch{return!1}};if(f instanceof Error&&p(f.message)){const x=Q.object({error:Q.string()}).safeParse(JSON.parse(f.message));if(x.success){D.error(x.data.error);return}else{D.error(g.translate("i18n_connectorsview_failed_to_create_with_message",void 0,{message:f instanceof Error?f.message:"Unknown error"}));return}}else D.error(g.translate("i18n_connectorsview_failed_to_create"))}finally{S.value=!1}}function m(y){y.auth.type==="manual"?Se.showNewMessage(g.translate("i18n_connectors_ask_for_access",null,y.metadata.label)):e.showAddConfirmationModal(y)}return(y,f)=>(r(),w(U,null,[s(n($e),{direction:"vertical",style:{width:"100%","margin-bottom":"30px"}},{default:l(()=>[s(n(T),{align:"center",justify:"space-between"},{default:l(()=>[s(n(q),null,{default:l(()=>[_(k(n(g).translate("i18n_connectorsview_title")),1)]),_:1})]),_:1}),s(n(P),null,{default:l(()=>[_(k(n(g).translate("i18n_connectorsview_description"))+" ",1),s(oe)]),_:1}),A.value.length?(r(),C(n(T),{key:0,vertical:""},{default:l(()=>[s(n(q),{level:2},{default:l(()=>[_(k(n(g).translate("i18n_connectorsview_installed")),1)]),_:1}),s(n(T),{vertical:"",gap:10},{default:l(()=>[(r(!0),w(U,null,z(A.value,p=>(r(),C(n(te),{key:p.name},{default:l(()=>[s(n(T),{align:"center",gap:20},{default:l(()=>[s(n(ne),{src:p.icon,height:"40px",shape:"square"},null,8,["src"]),s(n(L),{strong:""},{default:l(()=>[_(k(p.connectorTitle),1)]),_:2},1024),f[6]||(f[6]=K("div",{style:{"flex-grow":"1"}},null,-1)),s(n(L),{content:p.name,copyable:"",code:""},null,8,["content"]),s(n(be),null,{overlay:l(()=>[s(n(we),null,{default:l(()=>[s(n(Y),{onClick:x=>n(e).handleEditConnectionClick(p)},{default:l(()=>[_(k(n(g).translate("i18n_connectorsview_rename")),1)]),_:1},8,["onClick"]),s(n(Y),{danger:"",onClick:x=>n(e).handleDeletionClick(p)},{default:l(()=>[_(k(n(g).translate("i18n_connectorsview_delete")),1)]),_:1},8,["onClick"])]),_:2},1024)]),default:l(()=>[s(n(Te))]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})):j("",!0),s(n(T),{vertical:""},{default:l(()=>[A.value.length?(r(),C(n(q),{key:0,level:2},{default:l(()=>[_(k(n(g).translate("i18n_connectorsview_available")),1)]),_:1})):j("",!0),s(n(Ie),{value:I.value,"onUpdate:value":f[0]||(f[0]=p=>I.value=p),placeholder:n(g).translate("i18n_connectorsview_search_placeholder"),style:{width:"300px","margin-bottom":"40px"}},null,8,["value","placeholder"]),K("div",cn,[(r(!0),w(U,null,z(N.value,p=>(r(),C(sn,{key:p.metadata.key,title:p.metadata.label,"logo-url":p.metadata.logoUrl,description:p.metadata.description,unavailable:p.auth.type==="manual",connector:p,"is-beta":n(e).state.value.betaStatus[p.metadata.key]??!1,onClick:x=>m(p)},null,8,["title","logo-url","description","unavailable","connector","is-beta","onClick"]))),128))])]),_:1})]),_:1}),s(n(M),{open:!!n(e).state.value.editingConnection,title:n(e).state.value.editingConnection?n(g).translate("i18n_connectorsview_connection_modal_title",void 0,{connector:n(e).state.value.editingConnection.connectorTitle}):"",onCancel:f[3]||(f[3]=p=>n(e).state.value.editingConnection=null)},{footer:l(()=>[s(n(T),{justify:"end"},{default:l(()=>[s(G,{disabled:!n(e).hasChanges.value,onClick:f[2]||(f[2]=p=>n(e).renameConnection())},{default:l(()=>[_(k(n(g).translate("i18n_connectorsview_save")),1)]),_:1},8,["disabled"])]),_:1})]),default:l(()=>[n(e).state.value.editingConnection?(r(),C(n(X),{key:0,value:n(e).state.value.editingConnection.newName,"onUpdate:value":f[1]||(f[1]=p=>n(e).state.value.editingConnection.newName=p)},null,8,["value"])):j("",!0)]),_:1},8,["open","title"]),s(on,{"adding-connection":n(e).state.value.addingConnection,"ecdsa-public-key":c.value,"ecdsa-key-loading":v.value,"uploaded-files":b.value,loading:S.value,onCancel:f[4]||(f[4]=()=>{n(e).state.value.addingConnection=null,u()}),onSubmit:o,onScopeToggle:f[5]||(f[5]=(p,x)=>n(e).handleScopeToggle(p,x)),onGenerateEcdsaKey:d,"onUpdate:tokenValues":$,"onUpdate:uploadedFiles":F},null,8,["adding-connection","ecdsa-public-key","ecdsa-key-loading","uploaded-files","loading"])],64))}}),wn=ee(rn,[["__scopeId","data-v-21b5de4f"]]);export{wn as default};
//# sourceMappingURL=ConnectorsView-CKsQofu2.js.map
