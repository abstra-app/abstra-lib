import{F as D,a as se,b as ie,c as ue,d as de}from"./FormRunner.caa82cb6.js";import{d as T,af as $,g as A,o as u,K as v,O as Q,F as Z,e5 as x,a as y,f as V,b as a,w as r,u as e,d6 as L,az as _,cQ as me,d2 as I,cs as H,bE as M,cr as J,aL as W,eP as pe,eQ as ce,Q as O,c as C,br as fe,aP as B,cu as ve,bM as R,da as z,eb as N,L as X,B as E,d3 as ge,cH as he,eZ as ye,bH as K,ea as be,cE as we,e3 as _e,e4 as ke,h as Y,er as Se,cF as Ae}from"./index.fd66f361.js";import{r as He}from"./redirect.decac195.js";import{a as $e}from"./asyncComputed.c1514d75.js";import"./linters.25176e5c.js";import{F as Me}from"./scripts.5832e54b.js";import{W as Ze}from"./workspaces.5564e380.js";import{R as Ce,_ as Ve}from"./RuntimeCommonSettings.aaed7c81.js";import{A as Fe}from"./index.89096276.js";import{u as Pe}from"./userStore.749badae.js";import{P as Te}from"./PlayerNavbar.f4e17c73.js";import{u as Re}from"./workspaceStore.2a009b33.js";import{W as Ee}from"./PlayerConfigProvider.6c23896e.js";import{F as Le}from"./PhArrowSquareOut.vue.761d1db3.js";import{C as Ie}from"./Card.e007ce72.js";import{A as Ue}from"./index.13458abe.js";import"./Login.vue_vue_type_script_setup_true_lang.fd40095d.js";import"./CircularLoading.0fc86793.js";import"./Logo.94a004d7.js";import"./string.973cdadd.js";import"./Steps.9f66c99c.js";import"./index.54e9a548.js";import"./Watermark.ab6d4815.js";import"./url.32de1d47.js";import"./record.8d6523fc.js";import"./runnerData.4633183b.js";import"./colorHelpers.ffad89ea.js";import"./BaseLayout.97a37605.js";import"./SaveButton.72b214ec.js";import"./UnsavedChangesHandler.c9ee5110.js";import"./ExclamationCircleOutlined.06153509.js";import"./omniChatStore.4b72ae26.js";import"./OmniChat.9a729faa.js";import"./gateway.c8676992.js";import"./popupNotifcation.45eb3465.js";import"./AbstraLogo.vue_vue_type_script_setup_true_lang.4658ce04.js";import"./uuid.0988391e.js";import"./PhClockCounterClockwise.vue.d18f1684.js";import"./LoadingOutlined.8d67646f.js";import"./columns.a93ffaa0.js";import"./controller.a402f323.js";import"./index.f303a37e.js";import"./validations.9d3f6d16.js";import"./metadata.79a32911.js";import"./PhWebhooksLogo.vue.cd20e8b0.js";import"./controller.9d4d4aa4.js";import"./fetch.c880a606.js";import"./PhPencil.vue.22f5fd0d.js";import"./project.196732bf.js";import"./requirements.56f3bf59.js";import"./object.1a8ef115.js";import"./PhCopySimple.vue.c5a3fe52.js";import"./index.959eaebd.js";import"./CollapsePanel.6e31af79.js";import"./Avatar.02092cfa.js";import"./Navbar.47180d12.js";import"./AbstraButton.vue_vue_type_script_setup_true_lang.fe7e55b8.js";import"./PhArrowCounterClockwise.vue.064f9df6.js";import"./PhFilePy.vue.bcd13229.js";import"./PhChats.vue.569b8d96.js";import"./PhRocket.vue.3a58daa3.js";import"./PhPackage.vue.8c770904.js";import"./polling.5fe64c23.js";import"./PhDotsThree.vue.cae130ab.js";import"./PhSignOut.vue.99f479e8.js";import"./PhSparkle.vue.8254c822.js";import"./editor.b1112dd9.js";import"./CloseCircleOutlined.c1bfba2b.js";import"./CheckCircleFilled.2aa45a91.js";import"./SourceCode.08b81630.js";import"./PhFolder.vue.a4dd1c07.js";import"./toggleHighContrast.6fc82fd7.js";import"./TasksManager.30284d3d.js";import"./tasksController.c343a60e.js";import"./ant-design.01b4eef9.js";import"./index.c2006748.js";import"./PhCaretRight.vue.7baabbe8.js";import"./Badge.7cfeacae.js";import"./TabPane.e5cfdd05.js";import"./index.f35aec9d.js";import"./index.19aeeb1f.js";(function(){try{var b=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},d=new Error().stack;d&&(b._sentryDebugIds=b._sentryDebugIds||{},b._sentryDebugIds[d]="c9e2c458-2b2d-4799-8d58-6619c972fdd9",b._sentryDebugIdIdentifier="sentry-dbid-c9e2c458-2b2d-4799-8d58-6619c972fdd9")}catch{}})();const De=["width","height","fill","transform"],Be={key:0},We=y("path",{d:"M228,48V96a12,12,0,0,1-12,12H168a12,12,0,0,1,0-24h19l-7.8-7.8a75.55,75.55,0,0,0-53.32-22.26h-.43A75.49,75.49,0,0,0,72.39,75.57,12,12,0,1,1,55.61,58.41a99.38,99.38,0,0,1,69.87-28.47H126A99.42,99.42,0,0,1,196.2,59.23L204,67V48a12,12,0,0,1,24,0ZM183.61,180.43a75.49,75.49,0,0,1-53.09,21.63h-.43A75.55,75.55,0,0,1,76.77,179.8L69,172H88a12,12,0,0,0,0-24H40a12,12,0,0,0-12,12v48a12,12,0,0,0,24,0V189l7.8,7.8A99.42,99.42,0,0,0,130,226.06h.56a99.38,99.38,0,0,0,69.87-28.47,12,12,0,0,0-16.78-17.16Z"},null,-1),qe=[We],ze={key:1},Ne=y("path",{d:"M216,128a88,88,0,1,1-88-88A88,88,0,0,1,216,128Z",opacity:"0.2"},null,-1),Qe=y("path",{d:"M224,48V96a8,8,0,0,1-8,8H168a8,8,0,0,1,0-16h28.69L182.06,73.37a79.56,79.56,0,0,0-56.13-23.43h-.45A79.52,79.52,0,0,0,69.59,72.71,8,8,0,0,1,58.41,61.27a96,96,0,0,1,135,.79L208,76.69V48a8,8,0,0,1,16,0ZM186.41,183.29a80,80,0,0,1-112.47-.66L59.31,168H88a8,8,0,0,0,0-16H40a8,8,0,0,0-8,8v48a8,8,0,0,0,16,0V179.31l14.63,14.63A95.43,95.43,0,0,0,130,222.06h.53a95.36,95.36,0,0,0,67.07-27.33,8,8,0,0,0-11.18-11.44Z"},null,-1),xe=[Ne,Qe],Oe={key:2},je=y("path",{d:"M224,48V96a8,8,0,0,1-8,8H168a8,8,0,0,1-5.66-13.66L180.65,72a79.48,79.48,0,0,0-54.72-22.09h-.45A79.52,79.52,0,0,0,69.59,72.71,8,8,0,0,1,58.41,61.27,96,96,0,0,1,192,60.7l18.36-18.36A8,8,0,0,1,224,48ZM186.41,183.29A80,80,0,0,1,75.35,184l18.31-18.31A8,8,0,0,0,88,152H40a8,8,0,0,0-8,8v48a8,8,0,0,0,13.66,5.66L64,195.3a95.42,95.42,0,0,0,66,26.76h.53a95.36,95.36,0,0,0,67.07-27.33,8,8,0,0,0-11.18-11.44Z"},null,-1),Ge=[je],Ke={key:3},Ye=y("path",{d:"M222,48V96a6,6,0,0,1-6,6H168a6,6,0,0,1,0-12h33.52L183.47,72a81.51,81.51,0,0,0-57.53-24h-.46A81.5,81.5,0,0,0,68.19,71.28a6,6,0,1,1-8.38-8.58,93.38,93.38,0,0,1,65.67-26.76H126a93.45,93.45,0,0,1,66,27.53l18,18V48a6,6,0,0,1,12,0ZM187.81,184.72a81.5,81.5,0,0,1-57.29,23.34h-.46a81.51,81.51,0,0,1-57.53-24L54.48,166H88a6,6,0,0,0,0-12H40a6,6,0,0,0-6,6v48a6,6,0,0,0,12,0V174.48l18,18.05a93.45,93.45,0,0,0,66,27.53h.52a93.38,93.38,0,0,0,65.67-26.76,6,6,0,1,0-8.38-8.58Z"},null,-1),Je=[Ye],Xe={key:4},ea=y("path",{d:"M224,48V96a8,8,0,0,1-8,8H168a8,8,0,0,1,0-16h28.69L182.06,73.37a79.56,79.56,0,0,0-56.13-23.43h-.45A79.52,79.52,0,0,0,69.59,72.71,8,8,0,0,1,58.41,61.27a96,96,0,0,1,135,.79L208,76.69V48a8,8,0,0,1,16,0ZM186.41,183.29a80,80,0,0,1-112.47-.66L59.31,168H88a8,8,0,0,0,0-16H40a8,8,0,0,0-8,8v48a8,8,0,0,0,16,0V179.31l14.63,14.63A95.43,95.43,0,0,0,130,222.06h.53a95.36,95.36,0,0,0,67.07-27.33,8,8,0,0,0-11.18-11.44Z"},null,-1),aa=[ea],ta={key:5},ra=y("path",{d:"M220,48V96a4,4,0,0,1-4,4H168a4,4,0,0,1,0-8h38.34L184.89,70.54A84,84,0,0,0,66.8,69.85a4,4,0,1,1-5.6-5.72,92,92,0,0,1,129.34.76L212,86.34V48a4,4,0,0,1,8,0ZM189.2,186.15a83.44,83.44,0,0,1-58.68,23.91h-.47a83.52,83.52,0,0,1-58.94-24.6L49.66,164H88a4,4,0,0,0,0-8H40a4,4,0,0,0-4,4v48a4,4,0,0,0,8,0V169.66l21.46,21.45A91.43,91.43,0,0,0,130,218.06h.51a91.45,91.45,0,0,0,64.28-26.19,4,4,0,1,0-5.6-5.72Z"},null,-1),oa=[ra],la={name:"PhArrowsClockwise"},na=T({...la,props:{weight:{type:String},size:{type:[String,Number]},color:{type:String},mirrored:{type:Boolean}},setup(b){const d=b,l=$("weight","regular"),h=$("size","1em"),n=$("color","currentColor"),s=$("mirrored",!1),i=A(()=>{var t;return(t=d.weight)!=null?t:l}),S=A(()=>{var t;return(t=d.size)!=null?t:h}),o=A(()=>{var t;return(t=d.color)!=null?t:n}),g=A(()=>d.mirrored!==void 0?d.mirrored?"scale(-1, 1)":void 0:s?"scale(-1, 1)":void 0);return(t,p)=>(u(),v("svg",x({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256",width:S.value,height:S.value,fill:o.value,transform:g.value},t.$attrs),[Q(t.$slots,"default"),i.value==="bold"?(u(),v("g",Be,qe)):i.value==="duotone"?(u(),v("g",ze,xe)):i.value==="fill"?(u(),v("g",Oe,Ge)):i.value==="light"?(u(),v("g",Ke,Je)):i.value==="regular"?(u(),v("g",Xe,aa)):i.value==="thin"?(u(),v("g",ta,oa)):Z("",!0)],16,De))}}),sa=["width","height","fill","transform"],ia={key:0},ua=y("path",{d:"M28,64A12,12,0,0,1,40,52H216a12,12,0,0,1,0,24H40A12,12,0,0,1,28,64Zm12,76h64a12,12,0,0,0,0-24H40a12,12,0,0,0,0,24Zm80,40H40a12,12,0,0,0,0,24h80a12,12,0,0,0,0-24Zm120.49,20.49a12,12,0,0,1-17,0l-18.08-18.08a44,44,0,1,1,17-17l18.08,18.07A12,12,0,0,1,240.49,200.49ZM184,164a20,20,0,1,0-20-20A20,20,0,0,0,184,164Z"},null,-1),da=[ua],ma={key:1},pa=y("path",{d:"M216,144a32,32,0,1,1-32-32A32,32,0,0,1,216,144Z",opacity:"0.2"},null,-1),ca=y("path",{d:"M32,64a8,8,0,0,1,8-8H216a8,8,0,0,1,0,16H40A8,8,0,0,1,32,64Zm8,72h72a8,8,0,0,0,0-16H40a8,8,0,0,0,0,16Zm88,48H40a8,8,0,0,0,0,16h88a8,8,0,0,0,0-16Zm109.66,13.66a8,8,0,0,1-11.32,0L206,177.36A40,40,0,1,1,217.36,166l20.3,20.3A8,8,0,0,1,237.66,197.66ZM184,168a24,24,0,1,0-24-24A24,24,0,0,0,184,168Z"},null,-1),fa=[pa,ca],va={key:2},ga=y("path",{d:"M32,64a8,8,0,0,1,8-8H216a8,8,0,0,1,0,16H40A8,8,0,0,1,32,64Zm8,72h72a8,8,0,0,0,0-16H40a8,8,0,0,0,0,16Zm88,48H40a8,8,0,0,0,0,16h88a8,8,0,0,0,0-16Zm109.66,2.34L217.36,166A40,40,0,1,0,206,177.36l20.3,20.3a8,8,0,0,0,11.32-11.32Z"},null,-1),ha=[ga],ya={key:3},ba=y("path",{d:"M34,64a6,6,0,0,1,6-6H216a6,6,0,0,1,0,12H40A6,6,0,0,1,34,64Zm6,70h72a6,6,0,0,0,0-12H40a6,6,0,0,0,0,12Zm88,52H40a6,6,0,0,0,0,12h88a6,6,0,0,0,0-12Zm108.24,10.24a6,6,0,0,1-8.48,0l-21.49-21.48a38.06,38.06,0,1,1,8.49-8.49l21.48,21.49A6,6,0,0,1,236.24,196.24ZM184,170a26,26,0,1,0-26-26A26,26,0,0,0,184,170Z"},null,-1),wa=[ba],_a={key:4},ka=y("path",{d:"M32,64a8,8,0,0,1,8-8H216a8,8,0,0,1,0,16H40A8,8,0,0,1,32,64Zm8,72h72a8,8,0,0,0,0-16H40a8,8,0,0,0,0,16Zm88,48H40a8,8,0,0,0,0,16h88a8,8,0,0,0,0-16Zm109.66,13.66a8,8,0,0,1-11.32,0L206,177.36A40,40,0,1,1,217.36,166l20.3,20.3A8,8,0,0,1,237.66,197.66ZM184,168a24,24,0,1,0-24-24A24,24,0,0,0,184,168Z"},null,-1),Sa=[ka],Aa={key:5},Ha=y("path",{d:"M36,64a4,4,0,0,1,4-4H216a4,4,0,0,1,0,8H40A4,4,0,0,1,36,64Zm4,68h72a4,4,0,0,0,0-8H40a4,4,0,0,0,0,8Zm88,56H40a4,4,0,0,0,0,8h88a4,4,0,0,0,0-8Zm106.83,6.83a4,4,0,0,1-5.66,0l-22.72-22.72a36.06,36.06,0,1,1,5.66-5.66l22.72,22.72A4,4,0,0,1,234.83,194.83ZM184,172a28,28,0,1,0-28-28A28,28,0,0,0,184,172Z"},null,-1),$a=[Ha],Ma={name:"PhListMagnifyingGlass"},Za=T({...Ma,props:{weight:{type:String},size:{type:[String,Number]},color:{type:String},mirrored:{type:Boolean}},setup(b){const d=b,l=$("weight","regular"),h=$("size","1em"),n=$("color","currentColor"),s=$("mirrored",!1),i=A(()=>{var t;return(t=d.weight)!=null?t:l}),S=A(()=>{var t;return(t=d.size)!=null?t:h}),o=A(()=>{var t;return(t=d.color)!=null?t:n}),g=A(()=>d.mirrored!==void 0?d.mirrored?"scale(-1, 1)":void 0:s?"scale(-1, 1)":void 0);return(t,p)=>(u(),v("svg",x({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256",width:S.value,height:S.value,fill:o.value,transform:g.value},t.$attrs),[Q(t.$slots,"default"),i.value==="bold"?(u(),v("g",ia,da)):i.value==="duotone"?(u(),v("g",ma,fa)):i.value==="fill"?(u(),v("g",va,ha)):i.value==="light"?(u(),v("g",ya,wa)):i.value==="regular"?(u(),v("g",_a,Sa)):i.value==="thin"?(u(),v("g",Aa,$a)):Z("",!0)],16,sa))}}),Ca=["width","height","fill","transform"],Va={key:0},Fa=y("path",{d:"M200,36H56A20,20,0,0,0,36,56V200a20,20,0,0,0,20,20H200a20,20,0,0,0,20-20V56A20,20,0,0,0,200,36Zm-4,160H60V60H196Z"},null,-1),Pa=[Fa],Ta={key:1},Ra=y("path",{d:"M208,56V200a8,8,0,0,1-8,8H56a8,8,0,0,1-8-8V56a8,8,0,0,1,8-8H200A8,8,0,0,1,208,56Z",opacity:"0.2"},null,-1),Ea=y("path",{d:"M200,40H56A16,16,0,0,0,40,56V200a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V56A16,16,0,0,0,200,40Zm0,160H56V56H200V200Z"},null,-1),La=[Ra,Ea],Ia={key:2},Ua=y("path",{d:"M216,56V200a16,16,0,0,1-16,16H56a16,16,0,0,1-16-16V56A16,16,0,0,1,56,40H200A16,16,0,0,1,216,56Z"},null,-1),Da=[Ua],Ba={key:3},Wa=y("path",{d:"M200,42H56A14,14,0,0,0,42,56V200a14,14,0,0,0,14,14H200a14,14,0,0,0,14-14V56A14,14,0,0,0,200,42Zm2,158a2,2,0,0,1-2,2H56a2,2,0,0,1-2-2V56a2,2,0,0,1,2-2H200a2,2,0,0,1,2,2Z"},null,-1),qa=[Wa],za={key:4},Na=y("path",{d:"M200,40H56A16,16,0,0,0,40,56V200a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V56A16,16,0,0,0,200,40Zm0,160H56V56H200V200Z"},null,-1),Qa=[Na],xa={key:5},Oa=y("path",{d:"M200,44H56A12,12,0,0,0,44,56V200a12,12,0,0,0,12,12H200a12,12,0,0,0,12-12V56A12,12,0,0,0,200,44Zm4,156a4,4,0,0,1-4,4H56a4,4,0,0,1-4-4V56a4,4,0,0,1,4-4H200a4,4,0,0,1,4,4Z"},null,-1),ja=[Oa],Ga={name:"PhStop"},Ka=T({...Ga,props:{weight:{type:String},size:{type:[String,Number]},color:{type:String},mirrored:{type:Boolean}},setup(b){const d=b,l=$("weight","regular"),h=$("size","1em"),n=$("color","currentColor"),s=$("mirrored",!1),i=A(()=>{var t;return(t=d.weight)!=null?t:l}),S=A(()=>{var t;return(t=d.size)!=null?t:h}),o=A(()=>{var t;return(t=d.color)!=null?t:n}),g=A(()=>d.mirrored!==void 0?d.mirrored?"scale(-1, 1)":void 0:s?"scale(-1, 1)":void 0);return(t,p)=>(u(),v("svg",x({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256",width:S.value,height:S.value,fill:o.value,transform:g.value},t.$attrs),[Q(t.$slots,"default"),i.value==="bold"?(u(),v("g",Va,Pa)):i.value==="duotone"?(u(),v("g",Ta,La)):i.value==="fill"?(u(),v("g",Ia,Da)):i.value==="light"?(u(),v("g",Ba,qa)):i.value==="regular"?(u(),v("g",za,Qa)):i.value==="thin"?(u(),v("g",xa,ja)):Z("",!0)],16,Ca))}}),ee=b=>(pe("data-v-c86b3d07"),b=b(),ce(),b),Ya=ee(()=>y("i",null,"string",-1)),Ja=ee(()=>y("i",null,"string list",-1)),Xa=T({__name:"FormNotificationSettings",props:{form:{}},setup(b){const l=V(b.form);return(h,n)=>(u(),v(W,null,[a(e(J),{layout:"vertical"},{default:r(()=>[a(e(L),{level:4,width:"100%",height:"30px",style:{display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"0px"}},{default:r(()=>[_(" Task waiting "),a(e(me),{checked:l.value.notificationTrigger.enabled,"onUpdate:checked":n[0]||(n[0]=s=>l.value.notificationTrigger.enabled=s)},{default:r(()=>[_(" Enabled ")]),_:1},8,["checked"])]),_:1}),a(e(I),{class:"description",style:{fontStyle:"italic",marginBottom:"20px"}},{default:r(()=>[_(" Send emails when new tasks are received ")]),_:1}),a(e(H),{label:"Variable name"},{default:r(()=>[a(e(M),{value:l.value.notificationTrigger.variable_name,"onUpdate:value":n[1]||(n[1]=s=>l.value.notificationTrigger.variable_name=s),disabled:!l.value.notificationTrigger.enabled,type:"text",placeholder:"variable_name"},null,8,["value","disabled"])]),_:1})]),_:1}),a(e(Fe),{type:"info"},{message:r(()=>[a(e(I),null,{default:r(()=>[_(" Notifications are sent to the emails specified in the task payload variables set here. The variables should contain a "),Ya,_(" or a "),Ja,_(". ")]),_:1})]),_:1})],64))}});const et=O(Xa,[["__scopeId","data-v-c86b3d07"]]),at={class:"form-preview"},tt={class:"form-preview-container"},rt=T({__name:"FormPreview",props:{formState:{},formRunnerData:{},isLoading:{type:Boolean},queryParams:{},disabledWarning:{},controller:{},currentPath:{}},emits:["open-query-params-modal"],setup(b,{emit:d}){const l=b,h=Pe(),n=Re(),s=A(()=>{if(!l.formRunnerData)return"";const o=Object.entries(l.queryParams),g="?"+o.map(([p,c])=>`${p}=${c}`).join("&"),t=o.length?g:"";return`/${l.formRunnerData.path}${t}`}),i=()=>d("open-query-params-modal"),S=()=>{let o=`/${l.currentPath}`;const g=new URLSearchParams(l.queryParams);window.open(`${o}?${g.toString()}`,"_blank")};return(o,g)=>(u(),v("div",at,[o.isLoading||!o.formRunnerData||!o.formState?(u(),C(e(fe),{key:0})):Z("",!0),o.formState&&o.formRunnerData?(u(),C(e(z),{key:1,vertical:"",gap:"10",style:{height:"100%",overflow:"hidden"}},{default:r(()=>[a(e(z),{gap:"small"},{default:r(()=>[a(e(B),{title:"Edit query params",placement:"bottom"},{default:r(()=>[a(e(ve),{compact:"",style:{display:"flex"},onClick:i},{default:r(()=>{var t,p;return[a(e(M),{disabled:!!o.formState&&e(D).includes((t=o.formState)==null?void 0:t.type),value:s.value,onKeyup:i},null,8,["disabled","value"]),a(e(R),{disabled:!!o.formState&&e(D).includes((p=o.formState)==null?void 0:p.type),onClick:i},{default:r(()=>[a(e(Za),{size:"20"})]),_:1},8,["disabled"])]}),_:1})]),_:1}),a(e(B),{placement:"bottom"},{title:r(()=>[_("Open in Full Screen")]),default:r(()=>[a(e(R),{target:"_blank","aria-label":"Open in Full Screen","aria-describedby":"sss",onClick:S},{default:r(()=>[a(e(Le),{size:"20"})]),_:1})]),_:1})]),_:1}),y("div",tt,[o.disabledWarning?(u(),C(e(Ie),{key:0,class:"unsaved-changes"},{default:r(()=>[a(e(I),{style:{"font-size":"18px","font-weight":"500"}},{default:r(()=>[_(N(o.disabledWarning.title),1)]),_:1}),a(e(I),{style:{"margin-bottom":"6px"}},{default:r(()=>[_(N(o.disabledWarning.message),1)]),_:1})]),_:1})):Z("",!0),a(Ee,{class:"center","main-color":o.formRunnerData.mainColor,background:o.formRunnerData.theme,"font-family":o.formRunnerData.fontFamily,locale:o.formRunnerData.language},{default:r(()=>{var t,p,c,F,U;return[e(n).state.workspace?(u(),C(Te,{key:0,"current-path":o.currentPath,"hide-login":!0,"runner-data":e(n).state.workspace},null,8,["current-path","runner-data"])):Z("",!0),a(se,{"is-preview":"",class:"runner","form-runner-data":o.formRunnerData,"form-state":o.formState,disabled:!!o.disabledWarning,"user-email":e(h).email,onUpdateWidgetErrors:(t=o.controller)==null?void 0:t.updateWidgetFrontendErrors,onUpdateWidgetValue:(p=o.controller)==null?void 0:p.updateWidgetValue,onActionClicked:(c=o.controller)==null?void 0:c.handleActionClick,onAutoFillClicked:(F=o.controller)==null?void 0:F.handleAutofillClick,onAuthComplete:(U=o.controller)==null?void 0:U.handleAuthComplete},null,8,["form-runner-data","form-state","disabled","user-email","onUpdateWidgetErrors","onUpdateWidgetValue","onActionClicked","onAutoFillClicked","onAuthComplete"])]}),_:1},8,["main-color","background","font-family","locale"])])]),_:1})):Z("",!0)]))}});const ot=O(rt,[["__scopeId","data-v-9c597cc0"]]),lt={key:0},nt={key:1},st=y("br",null,null,-1),it="Start form",ut=T({__name:"FormRunButton",props:{formStateType:{},disabledWarning:{},startMessage:{}},emits:["start","reset"],setup(b,{emit:d}){var S;const l=new X(E.boolean(),"dontShowReloadHelper"),h=V((S=l.get())!=null?S:!1),n=()=>{h.value=!0,l.set(!0)},s=()=>d("reset"),i=()=>d("start");return(o,g)=>(u(),v(W,null,[o.formStateType&&e(ie).includes(o.formStateType)?(u(),C(e(he),{key:0,placement:"bottom",open:h.value?void 0:!0},{content:r(()=>[h.value?(u(),v("span",lt,"Reload form")):(u(),v("span",nt,[_(" You can reload the form here"),st,a(e(ge),{onClick:n},{default:r(()=>[_("Don't show this again")]),_:1})]))]),default:r(()=>[a(e(R),{disabled:!!o.disabledWarning,onClick:s},{default:r(()=>[a(e(na),{size:"20"})]),_:1},8,["disabled"])]),_:1},8,["open"])):Z("",!0),e(D).includes(o.formStateType)?(u(),C(e(B),{key:1,placement:"bottom"},{title:r(()=>[_("Stop form")]),default:r(()=>[a(e(R),{onClick:s},{default:r(()=>[a(e(Ka),{size:"20"})]),_:1})]),_:1})):Z("",!0),o.formStateType==="waiting"?(u(),C(e(B),{key:2,placement:"bottom"},{title:r(()=>{var t;return[_(N((t=o.startMessage)!=null?t:it),1)]}),default:r(()=>[a(e(R),{disabled:!!o.disabledWarning,onClick:i},{default:r(()=>[a(e(ye),{size:"20"})]),_:1},8,["disabled"])]),_:1})):Z("",!0)],64))}}),dt=T({__name:"FormSettings",props:{form:{}},setup(b){const l=V(b.form);return(h,n)=>(u(),C(e(J),{layout:"vertical",class:"form-settings"},{default:r(()=>[a(Ce,{runtime:l.value},null,8,["runtime"]),a(e(H),{label:"Form name"},{default:r(()=>[a(e(M),{value:l.value.title,"onUpdate:value":n[0]||(n[0]=s=>l.value.title=s),type:"text",onChange:n[1]||(n[1]=s=>{var i;return l.value.title=(i=s.target.value)!=null?i:""})},null,8,["value"])]),_:1}),a(e(L),{level:3},{default:r(()=>[_(" Texts ")]),_:1}),a(e(L),{level:4},{default:r(()=>[_(" Welcome Screen ")]),_:1}),a(e(H),{label:"Title"},{default:r(()=>[a(e(M),{value:l.value.welcomeTitle,"onUpdate:value":n[2]||(n[2]=s=>l.value.welcomeTitle=s),type:"text",placeholder:l.value.title,disabled:l.value.autoStart},null,8,["value","placeholder","disabled"])]),_:1}),a(e(H),{label:"Description"},{default:r(()=>[a(e(M),{value:l.value.startMessage,"onUpdate:value":n[3]||(n[3]=s=>l.value.startMessage=s),type:"text",disabled:l.value.autoStart},null,8,["value","disabled"])]),_:1}),a(e(H),{label:"Start button label"},{default:r(()=>[a(e(M),{value:l.value.startButtonText,"onUpdate:value":n[4]||(n[4]=s=>l.value.startButtonText=s),type:"text",placeholder:"Start",disabled:l.value.autoStart},null,8,["value","disabled"])]),_:1}),a(e(H),null,{default:r(()=>[a(e(K),{checked:l.value.autoStart,"onUpdate:checked":n[5]||(n[5]=s=>l.value.autoStart=s)},{default:r(()=>[_("Skip welcome screen")]),_:1},8,["checked"])]),_:1}),a(e(L),{level:4},{default:r(()=>[_(" End Screen ")]),_:1}),a(e(H),{label:"End text"},{default:r(()=>[a(e(M),{value:l.value.endMessage,"onUpdate:value":n[6]||(n[6]=s=>l.value.endMessage=s),type:"text",placeholder:"Thank you"},null,8,["value"])]),_:1}),a(e(H),{label:"Restart button label"},{default:r(()=>[a(e(M),{value:l.value.restartButtonText,"onUpdate:value":n[7]||(n[7]=s=>l.value.restartButtonText=s),placeholder:"Restart",type:"text",disabled:!l.value.allowRestart},null,8,["value","disabled"])]),_:1}),a(e(H),{help:!l.value.isInitial&&"Only initial forms can be restarted"},{default:r(()=>[a(e(K),{checked:l.value.allowRestart,"onUpdate:checked":n[8]||(n[8]=s=>l.value.allowRestart=s),disabled:!l.value.isInitial},{default:r(()=>[_("Show restart button at the end")]),_:1},8,["checked","disabled"])]),_:1},8,["help"]),a(e(L),{level:4},{default:r(()=>[_(" Alert Messages ")]),_:1}),a(e(H),{label:"Error message"},{default:r(()=>[a(e(M),{value:l.value.errorMessage,"onUpdate:value":n[9]||(n[9]=s=>l.value.errorMessage=s),type:"text",placeholder:"Something went wrong"},null,8,["value"])]),_:1})]),_:1}))}});const mt=O(dt,[["__scopeId","data-v-aff64cb2"]]),pt=T({__name:"QueryParamsModal",props:{open:{type:Boolean},queryParams:{}},emits:["update:query-params","close"],setup(b,{emit:d}){const h=V(n(b.queryParams));function n(g){return Object.entries(g).map(([t,p])=>({key:t,value:p,id:Math.random().toString()}))}function s(){const g={};return h.value.forEach(({key:t,value:p})=>{g[t]=p}),g}const i=(g,t,p)=>{h.value[g]={key:t,value:p},d("update:query-params",s())},S=()=>{const g=h.value.length;h.value.push({key:`param-${g}`,value:"value"}),d("update:query-params",s())},o=g=>{h.value.splice(g,1),d("update:query-params",s())};return(g,t)=>(u(),C(e(we),{open:g.open,onCancel:t[1]||(t[1]=p=>d("close"))},{footer:r(()=>[a(e(R),{type:"primary",onClick:t[0]||(t[0]=p=>d("close"))},{default:r(()=>[_("OK")]),_:1})]),default:r(()=>[a(e(z),{vertical:"",gap:"20"},{default:r(()=>[a(e(I),null,{default:r(()=>[_("Query params")]),_:1}),(u(!0),v(W,null,be(h.value,(p,c)=>(u(),C(e(H),{key:c},{default:r(()=>[a(e(Ue),null,{default:r(()=>[a(e(M),{value:p.key,"onUpdate:value":F=>p.key=F,type:"text",placeholder:"name",onChange:()=>i(c,p.key,p.value)},null,8,["value","onUpdate:value","onChange"]),a(e(M),{value:p.value,"onUpdate:value":F=>p.value=F,type:"text",placeholder:"value",onChange:()=>i(c,p.key,p.value)},null,8,["value","onUpdate:value","onChange"]),a(e(R),{danger:"",onClick:F=>o(c)},{default:r(()=>[_("remove")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128)),a(e(H),null,{default:r(()=>[a(e(R),{type:"dashed",style:{width:"100%"},onClick:S},{default:r(()=>[_(" Add Query Param ")]),_:1})]),_:1})]),_:1})]),_:1},8,["open"]))}}),Br=T({__name:"FormEditor",setup(b){const d=_e(),l=ke(),h=new X(E.array(E.object({formId:E.string(),queryParams:E.record(E.string())})),"abstra:queryParams"),n=V(null),s=V(null),i=V(null),S=V(null),o=V({}),g=A(()=>{var m;return(m=c.value)!=null&&m.form.hasChanges()?{title:"Unsaved changes",message:"Save the form before running the workflow"}:null}),t=(m,f)=>{var w,k;(k=(w=n.value)==null?void 0:w.code)==null||k.setHighlight(m,f)},p=()=>{var m,f,w,k;(f=(m=n.value)==null?void 0:m.code)==null||f.restartEditor(),(k=(w=n.value)==null?void 0:w.code)==null||k.startPreviewMode()},{result:c,loading:F,refetch:U}=$e(async()=>{const m=l.params.id;if(!m)return await d.push({name:"workflowEditor"}),null;const[f,w]=await Promise.all([Me.get(m),Ze.get()]);if(!f)return null;const k=h.get();return k==null||k.map(P=>{P.formId===f.id&&(o.value=P.queryParams)}),Se({form:f,workspace:w})});Y([()=>o,c],()=>{G()});const ae=()=>{var w;if(q.value=!1,!c.value)return;const m=h.get()||[];if(!m.some(k=>{var P;return k.formId===((P=c.value)==null?void 0:P.form.id)})){h.set([...m,{formId:(w=c.value)==null?void 0:w.form.id,queryParams:o.value}]);return}h.set(m.map(k=>{var P;return k.formId===((P=c.value)==null?void 0:P.form.id)?{formId:k.formId,queryParams:o.value}:k}))};function j(){var f,w;if(!c.value)return;const m=c.value.form.codeContent;(w=(f=n.value)==null?void 0:f.code)==null||w.updateLocalEditorCode(m),G()}function G(){var f,w;if(!c.value)return;S.value=c.value.form.makeRunnerData(c.value.workspace),s.value=new ue({formRunnerData:S.value,logService:(w=(f=n.value)==null?void 0:f.logService)!=null?w:null,connectionManager:new de(c.value.form.id,"editor",o.value),onFormStart:p,onFormEnd:te,onRedirect:le,onStateUpdate:k=>i.value=k,onStackTraceUpdate:t});const m=s.value.getState();i.value=m.formState}const te=()=>{var m,f;(f=(m=n.value)==null?void 0:m.code)==null||f.restartEditor()};async function re(){var m,f,w,k;(m=n.value)==null||m.closeTerminal();try{await((f=c.value)==null?void 0:f.form.save()),j(),(w=n.value)==null||w.goToTestTab(),(k=s.value)==null||k.start()}catch{Ae.error({message:"Error saving"})}}function oe(){var m,f,w;(f=(m=n.value)==null?void 0:m.code)==null||f.restartEditor(),(w=s.value)==null||w.resetForm()}function le(m,f){He("editor",d,m,f)}const q=V(!1),ne=()=>{var m;!!i.value&&D.includes((m=i.value)==null?void 0:m.type)||(q.value=!0)};return Y(()=>l.params.id,()=>{U()}),(m,f)=>(u(),v(W,null,[e(c)?(u(),C(Ve,{key:0,ref_key:"editor",ref:n,stage:e(c).form,workspace:e(c).workspace,"stage-type":"forms","test-tab-name":"Preview","extra-tab":{key:"notifications",name:"Notifications"},"docs-path":"workflow/forms",onOnSave:j},{settings:r(()=>[a(mt,{form:e(c).form},null,8,["form"])]),test:r(()=>[a(ot,{"form-state":i.value,"form-runner-data":S.value,"is-loading":e(F),"disabled-warning":g.value,"current-path":e(c).form.path,"query-params":o.value,controller:s.value,onOpenQueryParamsModal:ne},null,8,["form-state","form-runner-data","is-loading","disabled-warning","current-path","query-params","controller"])]),"action-button":r(()=>[a(ut,{"form-state-type":i.value.type,"disabled-warning":null,"start-message":"Save & Start form",onStart:re,onReset:oe},null,8,["form-state-type"])]),notifications:r(()=>[a(et,{form:e(c).form},null,8,["form"])]),_:1},8,["stage","workspace"])):Z("",!0),a(pt,{"query-params":o.value,"onUpdate:queryParams":f[0]||(f[0]=w=>o.value=w),open:q.value,onClose:ae},null,8,["query-params","open"])],64))}});export{Br as default};
//# sourceMappingURL=FormEditor.856040bf.js.map
