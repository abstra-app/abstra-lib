import{d as x,o as S,Z as L,u as e,b as c,et as y,bo as T,eA as B,c as h,w as s,f as a,ao as l,eB as _,cw as $,be as E,t as C,ez as R,F as V,e as D,ev as U,cA as N,cq as P}from"./outputWidgets.1fbc3ec5.js";import{a as j}from"./asyncComputed.db8ed1fd.js";import{r as q}from"./router.44c6ca31.js";import"./jwt-decode.esm.74bd4619.js";import{B as M,a as F}from"./build.3610a7d0.js";import"./index.19c0a32b.js";import{P as z}from"./project.90f28984.js";import{C as Q}from"./CrudView.451b6fb5.js";import{Q as Z,R as G}from"./icons.1376347f.js";import{_ as H,E as J}from"./ExecutionStatusIcon.vue_vue_type_script_setup_true_lang.3a5ac839.js";import{A as k}from"./Title.85ff198a.js";import{A as K}from"./index.1e5781d5.js";import{A as f}from"./Text.50f16e73.js";import{A}from"./Link.efed2fb8.js";import{A as O}from"./index.933fed13.js";import"./FormItem.a7016427.js";import"./hasIn.3999713d.js";import"./storage.cce4c409.js";import"./index.b613f35e.js";import"./index.cf4c23b9.js";import"./record.5584bf3b.js";import"./pubsub.d61878e2.js";import"./Form.9ba884dd.js";import"./Modal.89dce4df.js";import"./DocsButton.vue_vue_type_script_setup_true_lang.df3295d7.js";import"./url.9795f953.js";import"./CheckCircleFilled.0f59edcc.js";(function(){try{var d=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},m=new Error().stack;m&&(d._sentryDebugIds=d._sentryDebugIds||{},d._sentryDebugIds[m]="76fa660c-29b3-46f9-8c6c-1df6643a9137",d._sentryDebugIdIdentifier="sentry-dbid-76fa660c-29b3-46f9-8c6c-1df6643a9137")}catch{}})();const W={key:0,class:"flex-row"},X={key:1,class:"flex-row"},Y={key:2,class:"flex-row"},tt=x({__name:"ExecutionsShort",props:{stageId:{},projectId:{}},emits:["select"],setup(d,{emit:m}){const p=d,g=new J,{result:u,refetch:b,loading:w}=j(async()=>{const{executions:r}=await g.list({projectId:p.projectId,stageId:p.stageId,limit:6});return r}),v=r=>{m("select",r)};let o=null;return S(()=>{o=setInterval(()=>b(),15e3)}),L(()=>{o&&clearInterval(o)}),(r,n)=>e(u)?(c(),y("div",W,[(c(!0),y(T,null,B(e(u),t=>(c(),h(e($),{key:t.id,title:t.createdAt.toLocaleString(),onClick:i=>v(t)},{content:s(()=>[a(e(k),null,{default:s(()=>[l("Status: "+_(t.status),1)]),_:2},1024),a(e(k),null,{default:s(()=>[l("Duration: "+_(t.duration_seconds)+" s",1)]),_:2},1024),a(e(k),null,{default:s(()=>[l("Build: "+_(t.buildId.slice(0,6)),1)]),_:2},1024)]),default:s(()=>[a(H,{status:t.status},null,8,["status"])]),_:2},1032,["title","onClick"]))),128))])):e(w)?(c(),y("div",X,[a(e(E))])):(c(),y("div",Y,"None"))}});const et=C(tt,[["__scopeId","data-v-dc7e11a2"]]),ot={style:{"max-width":"250px",overflow:"hidden","text-overflow":"ellipsis ellipsis","white-space":"nowrap"}},st={key:1},at=x({__name:"Live",setup(d){const p=R().params.projectId,{loading:g,result:u}=j(async()=>{const r=(await M.list(p)).find(i=>i.latest);if(!r)return null;const[n,t]=await Promise.all([F.get(r.id),z.get(p)]);return{buildSpec:n,project:t}}),b=o=>{var t;if(!("path"in o)||!o.path)return;const r=o.type==="form"?`/${o.path}`:`/_hooks/${o.path}`,n=(t=u.value)==null?void 0:t.project.getUrl(r);!n||(navigator.clipboard.writeText(n),P.success("Copied URL to clipboard"))},w=o=>o.type=="form"?`/${o.path}`.slice(0,30):o.type=="hook"?`/_hooks/${o.path}`.slice(0,30):o.type=="job"?`${o.schedule}`:"",v=V(()=>{var n;const o=[{name:"Type",align:"left"},{name:"Title",align:"left"},{name:"Trigger",align:"left"},{name:"Last Runs"},{name:"",align:"right"}],r=(n=u.value)==null?void 0:n.buildSpec;return r?{columns:o,rows:r.runtimes.map(t=>({key:t.id,cells:[{type:"tag",text:t.type.charAt(0).toUpperCase()+t.type.slice(1),tagColor:"default"},{type:"slot",key:"title",payload:{runtime:t}},{type:"slot",key:"trigger",payload:{runtime:t}},{type:"slot",key:"last-runs",payload:{runtime:t}},{type:"actions",actions:[{icon:Z,label:"View script logs",onClick:()=>q.push({name:"logs",params:{projectId:p},query:{runtimeId:t.id}})},{icon:G,label:"Copy URL",onClick:()=>b(t),hide:!["form","hook"].includes(t.type)}]}]}))}:{columns:o,rows:[]}});return(o,r)=>{var n,t;return e(g)||((t=(n=e(u))==null?void 0:n.buildSpec.runtimes.length)!=null?t:0)>0?(c(),h(Q,{key:0,"empty-title":"","entity-name":"build",description:"Access and monitor your project's current scripts here.",table:v.value,loading:e(g),title:"Live View"},{extra:s(()=>[a(e(K),{message:"Last runs will only be shown for deploys with abstra version >= 1.27.0",type:"info","show-icon":""})]),title:s(({payload:i})=>{var I;return[D("div",ot,[i.runtime.type!="form"?(c(),h(e(f),{key:0},{default:s(()=>[l(_(i.runtime.title),1)]),_:2},1024)):i.runtime.type=="form"?(c(),h(e(A),{key:1,href:(I=e(u))==null?void 0:I.project.getUrl(i.runtime.path),target:"_blank"},{default:s(()=>[l(_(i.runtime.title),1)]),_:2},1032,["href"])):U("",!0)])]}),"last-runs":s(({payload:i})=>[a(et,{"stage-id":i.runtime.id,"project-id":e(p)},null,8,["stage-id","project-id"])]),trigger:s(({payload:i})=>[a(e(O),{color:"default"},{default:s(()=>[l(_(w(i.runtime)),1)]),_:2},1024)]),_:1},8,["table","loading"])):(c(),y("div",st,[a(e(N),{direction:"vertical"},{default:s(()=>[a(e(f),null,{default:s(()=>[l("Install abstra using pip:")]),_:1}),a(e(f),{code:"",copyable:""},{default:s(()=>[l("pip install abstra")]),_:1}),a(e(f),null,{default:s(()=>[l("Start a new project using our CLI")]),_:1}),a(e(f),{code:"",copyable:""},{default:s(()=>[l("abstra serve my-new-project")]),_:1}),a(e(f),null,{default:s(()=>[l(" If you have any questions, please reach out to our "),a(e(A),{href:"https://discord.gg/abstra",target:"_blank"},{default:s(()=>[l(" discord channel ")]),_:1})]),_:1})]),_:1})]))}}});const $t=C(at,[["__scopeId","data-v-4a06ff35"]]);export{$t as default};
//# sourceMappingURL=Live.d67d6e51.js.map
