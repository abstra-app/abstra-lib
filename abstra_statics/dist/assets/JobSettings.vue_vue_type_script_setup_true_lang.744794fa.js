import{_ as G}from"./RunButton.vue_vue_type_script_setup_true_lang.ac09b01b.js";import{d as B,r as _,b as y,c as b,G as H,o as J,F as N,es as C,f as c,w as s,u as n,ad as j,aA as h,cH as I,b8 as A,ez as x,eA as U,bT as R,cs as D,eu as P,H as W}from"./outputWidgets.350c2fca.js";import{h as E}from"./index.0bff1d0a.js";import{T as F}from"./dayjs.9803eadb.js";import{A as O,a as q}from"./Title.b4e8610d.js";import{R as z}from"./SmartConsole.1bbd495f.js";import{F as L}from"./Form.9032015f.js";(function(){try{var m=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},v=new Error().stack;v&&(m._sentryDebugIds=m._sentryDebugIds||{},m._sentryDebugIds[v]="71d76b4f-c0eb-43b3-9b01-170a8a3ad18d",m._sentryDebugIdIdentifier="sentry-dbid-71d76b4f-c0eb-43b3-9b01-170a8a3ad18d")}catch{}})();const oe=B({__name:"JobTester",props:{job:{},logService:{}},setup(m,{expose:v}){const d=m,r=_(!1);async function t(){r.value=!0;try{const{stdout:u,stderr:f}=await d.job.test();d.logService.log({type:"stdout",log:u}),d.logService.log({type:"stderr",log:f})}finally{r.value=!1}}return v({test:t}),(u,f)=>(y(),b(G,{loading:r.value,onClick:t},null,8,["loading"]))}}),K=()=>[...Array(31).keys()].map(m=>m+1),M={0:"Sunday",1:"Monday",2:"Tuesday",3:"Wednesday",4:"Thursday",5:"Friday",6:"Saturday"},Q=["hourly","daily","weekly","monthly"],X={hourly:{minute:"0",hour:"*",day:"*",month:"*",weekday:"*"},daily:{minute:"0",hour:"6",day:"*",month:"*",weekday:"*"},weekly:{minute:"0",hour:"6",day:"*",month:"*",weekday:"1"},monthly:{minute:"0",hour:"6",day:"1",month:"*",weekday:"*"}},Y=B({__name:"CronEditor",props:{crontab:{}},emits:["changeCrontab","saveCrontab","showAdvancedSettings"],setup(m,{emit:v}){const d=m,r=H(()=>{const a=t.hour,o=t.minute;return E(`${a}:${o}:00`,"HH:mm:ss")});J(()=>{const{hour:a,day:o,weekday:i,month:p,minute:S}=d.crontab;p=="*"&&i==="*"&&o!=="*"&&!l([o,a,S])?u.value="monthly":p==="*"&&o==="*"&&i!=="*"&&!l([i,a,S])?u.value="weekly":o==="*"&&i==="*"&&p==="*"&&a!=="*"&&!l([a,S])?u.value="daily":a=="*"&&o==="*"&&i==="*"&&p==="*"&&!l([S])?u.value="hourly":u.value="custom"});const t=N({minute:d.crontab.minute,hour:d.crontab.hour,day:d.crontab.day,month:d.crontab.month,weekday:d.crontab.weekday}),u=_(""),f=_(1),l=a=>a.some(o=>o.includes("-")||o.includes(",")),k=a=>{t.minute=a.minute,t.hour=a.hour,t.day=a.day,t.month=a.month,t.weekday=a.weekday},w=a=>{f.value=0,u.value=a,k(X[u.value]),v("changeCrontab",t)},T=a=>{f.value=0,t.minute=a,v("changeCrontab",t)},e=a=>{const o=E(a);t.minute=o.minute().toString(),t.hour=o.hour().toString(),v("changeCrontab",t)},g=a=>{f.value=0;const o=a;t.weekday=o,v("changeCrontab",t)},$=a=>{f.value=0;const o=a;t.day=o,v("changeCrontab",t)};return(a,o)=>(y(),C(A,null,[c(n(O),{title:"Recurrence"},{default:s(()=>[c(n(j),{placeholder:"Choose a periodicity",value:u.value,"onUpdate:value":w},{default:s(()=>[h(" > "),c(n(I),{value:"",disabled:"",hidden:""},{default:s(()=>[h("Custom")]),_:1}),(y(!0),C(A,null,x(n(Q),(i,p)=>(y(),b(n(I),{key:p,value:i},{default:s(()=>[h(U(i),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),c(n(O),null,{default:s(()=>[u.value==="hourly"?(y(),b(n(R),{key:0,value:t.minute,"onUpdate:value":T},{addonBefore:s(()=>[h(" at ")]),addonAfter:s(()=>[h(" minutes ")]),_:1},8,["value"])):u.value==="daily"?(y(),b(n(D),{key:1},{default:s(()=>[c(n(F),{value:r.value,"show-second":!1,"onUpdate:value":e},null,8,["value"])]),_:1})):u.value==="weekly"?(y(),b(n(D),{key:2},{default:s(()=>[h(" on "),c(n(j),{style:{width:"200px"},value:Object.values(n(M))[parseInt(t.weekday)],"onUpdate:value":g},{default:s(()=>[(y(!0),C(A,null,x(n(M),(i,p)=>(y(),b(n(I),{key:p,value:p,selected:i===Object.values(n(M))[parseInt(t.weekday)]},{default:s(()=>[h(U(i),1)]),_:2},1032,["value","selected"]))),128))]),_:1},8,["value"]),h(" at "),c(n(F),{value:r.value,"show-second":!1,"onUpdate:value":e},null,8,["value"])]),_:1})):u.value==="monthly"?(y(),b(n(D),{key:3},{default:s(()=>[h(" on "),c(n(j),{value:parseInt(t.day),"onUpdate:value":$},{default:s(()=>[(y(!0),C(A,null,x(n(K)(),(i,p)=>(y(),b(n(I),{key:p,value:i},{default:s(()=>[h(U(i),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"]),h(" at "),c(n(F),{value:r.value,"show-second":!1,"onUpdate:value":e},null,8,["value"])]),_:1})):P("",!0)]),_:1})],64))}}),ue=B({__name:"JobSettings",props:{job:{}},setup(m){const v=m,d=_(!1),r=_(v.job),t=()=>{d.value=!d.value},u=()=>{d.value=!1},f=e=>({weekday:e.split(" ")[4],month:e.split(" ")[3],day:e.split(" ")[2],hour:e.split(" ")[1],minute:e.split(" ")[0]}),l=N(f(r.value.schedule)),k=H(()=>`${l.minute} ${l.hour} ${l.day} ${l.month} ${l.weekday}`),w=e=>{l.minute==e.minute&&l.hour==e.hour&&l.day==e.day&&l.month==e.month&&l.weekday==e.weekday||(l.minute=e.minute,l.hour=e.hour,l.day=e.day,l.month=e.month,l.weekday=e.weekday,r.value.schedule=k.value)},T=e=>{e?(r.value.schedule=e,Object.assign(l,f(e))):r.value.schedule=k.value,u()};return W(()=>r.value.schedule,e=>{w({minute:e.split(" ")[0],hour:e.split(" ")[1],day:e.split(" ")[2],month:e.split(" ")[3],weekday:e.split(" ")[4]})}),(e,g)=>(y(),b(n(L),{class:"schedule-editor",layout:"vertical"},{default:s(()=>[c(n(O),{label:"Name",required:""},{default:s(()=>[c(n(R),{value:r.value.title,"onUpdate:value":g[0]||(g[0]=$=>r.value.title=$)},null,8,["value"])]),_:1}),c(z,{runtime:r.value},null,8,["runtime"]),c(n(q),{level:3},{default:s(()=>[h("Schedule")]),_:1}),c(Y,{class:"recurrence-settings",crontab:l,onChangeCrontab:w,onSaveCrontab:T,onShowAdvancedSettings:t},null,8,["crontab"])]),_:1}))}});export{oe as _,ue as a};
//# sourceMappingURL=JobSettings.vue_vue_type_script_setup_true_lang.744794fa.js.map
