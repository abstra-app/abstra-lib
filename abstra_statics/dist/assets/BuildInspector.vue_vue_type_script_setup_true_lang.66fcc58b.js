import{C as g}from"./gateway.ba63e948.js";import{d as _,b as l,c as f,w as a,u as s,eu as k,f as i,I as m,ew as y,cF as b,aq as d,eD as c,cn as w}from"./outputWidgets.3a9c8b77.js";import{y as v,f as I,j,h as A}from"./icons.31b05586.js";import{a as L}from"./router.72d8b140.js";import{c as p}from"./Text.f82cea2f.js";import{a as S,A as V}from"./index.f206900e.js";(function(){try{var n=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},t=new Error().stack;t&&(n._sentryDebugIds=n._sentryDebugIds||{},n._sentryDebugIds[t]="42e60156-561f-46ff-8e97-b903d57c2288",n._sentryDebugIdIdentifier="sentry-dbid-42e60156-561f-46ff-8e97-b903d57c2288")}catch{}})();class h{constructor(t,r,e){this.projectId=t,this.buildId=r,this.project=e}static fromV0(t,r,e){const u={version:"1.0",hooks:e.hooks.map(o=>({id:o.path,...o})),forms:e.forms.map(o=>({id:o.path,...o})),jobs:e.jobs.map(o=>({id:o.identifier,...o}))};return new h(t,r,u)}static fromV1(t,r,e){return new h(t,r,e)}static from(t,r,e){if(e.version==="0.1")return this.fromV0(t,r,e);if(e.version==="1.0")return this.fromV1(t,r,e);throw new Error(`Unsupported project version: ${e.version}`)}get runtimes(){return[...this.project.forms.map(t=>({...t,type:"form"})),...this.project.hooks.map(t=>({...t,type:"hook"})),...this.project.jobs.map(t=>({...t,type:"job"}))]}}const z=async n=>{try{const t=await g.get(`projects/${n}/latest-build`);if(!t)return null;const{id:r,abstraJson:e}=t,u=JSON.parse(e);if(!u.version)throw new Error("version is invalid");return h.from(n,r,u)}catch(t){return console.log(`Latest build is invalid: ${t.message}`),null}},J=async n=>{try{const t=await g.get(`builds/${n}`);if(!t)return null;const{projectId:r,abstraJson:e}=t,u=JSON.parse(e);if(!u.version)throw new Error("version is invalid");return h.from(r,n,u)}catch(t){return console.log(`Latest build is invalid: ${t.message}`),null}},$={key:1},O=_({__name:"BuildInspector",props:{buildSpec:{},subdomain:{}},setup(n){const t=n,r=e=>!t.subdomain||e.type!="form"?"":`https://${t.subdomain}.abstra.app/${e.path}`;return(e,u)=>e.buildSpec.runtimes.length>0?(l(),f(s(V),{key:0,"item-layout":"horizontal","data-source":e.buildSpec.runtimes},{renderItem:a(({item:o})=>[i(s(S),null,{actions:a(()=>[r(o)?(l(),f(s(L),{key:0,href:r(o),target:"_blank"},{default:a(()=>[i(m,{path:s(v)},null,8,["path"])]),_:2},1032,["href"])):y("",!0)]),default:a(()=>[o.type=="form"?(l(),f(s(b),{key:0,align:"top",size:"large"},{default:a(()=>[i(m,{path:s(I)},null,8,["path"]),i(s(p),{strong:""},{default:a(()=>[d(c(o.title),1)]),_:2},1024),i(s(p),{type:"secondary",code:""},{default:a(()=>[d("/"+c(o.path),1)]),_:2},1024)]),_:2},1024)):y("",!0),o.type=="job"?(l(),f(s(b),{key:1,align:"top",size:"large"},{default:a(()=>[i(m,{path:s(j)},null,8,["path"]),i(s(p),{strong:""},{default:a(()=>[d(c(o.title),1)]),_:2},1024),i(s(p),{type:"secondary",code:""},{default:a(()=>[d(c(o.schedule),1)]),_:2},1024)]),_:2},1024)):y("",!0),o.type=="hook"?(l(),f(s(b),{key:2,align:"top",size:"large"},{default:a(()=>[i(m,{path:s(A)},null,8,["path"]),i(s(p),{strong:""},{default:a(()=>[d(c(o.title),1)]),_:2},1024),i(s(p),{type:"secondary",code:""},{default:a(()=>[d("/_hooks/"+c(o.path),1)]),_:2},1024)]),_:2},1024)):y("",!0)]),_:2},1024)]),_:1},8,["data-source"])):(l(),k("div",$,[i(s(w),{description:"No runtimes found. Make sure your project has forms, hooks or jobs before deploying it"})]))}});export{O as _,J as a,z as g};
//# sourceMappingURL=BuildInspector.vue_vue_type_script_setup_true_lang.66fcc58b.js.map
