import{_ as q}from"./DocsButton.vue_vue_type_script_setup_true_lang.142c6c70.js";import{C as W}from"./ContentLayout.e76b89f2.js";import{p as X}from"./popupNotifcation.9ab5d024.js";import{a as J}from"./ant-design.d5a2ab22.js";import{a as Q}from"./asyncComputed.7bdc3110.js";import{d as R,B as I,f as A,o as d,X as b,Z as T,R as w,eb as Y,a as f,b as i,eh as L,f5 as K,ed as ee,e as te,c as _,w as s,aF as v,u as o,d9 as ae,d7 as x,bP as $,ec as M,d0 as ne,bN as oe,by as re,bw as N,d8 as z,ct as le,eo as ie,ep as se,$ as de}from"./vue-router.af88a013.js";import{C as k}from"./gateway.dd90ae69.js";import"./tables.32690d53.js";import{D as B}from"./DeleteOutlined.93b0775a.js";import{C as ce}from"./Card.44b22860.js";import"./BookOutlined.13c66fa7.js";import"./record.35534097.js";import"./string.fcd21026.js";import"./TabPane.4d56fc1d.js";(function(){try{var a=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},e=new Error().stack;e&&(a._sentryDebugIds=a._sentryDebugIds||{},a._sentryDebugIds[e]="5ccf81b0-9058-49b4-8dcb-5bff0b7be538",a._sentryDebugIdIdentifier="sentry-dbid-5ccf81b0-9058-49b4-8dcb-5bff0b7be538")}catch{}})();var ue={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M400 317.7h73.9V656c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V317.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 163a8 8 0 00-12.6 0l-112 141.7c-4.1 5.3-.4 13 6.3 13zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z"}}]},name:"upload",theme:"outlined"};const pe=ue,fe=["width","height","fill","transform"],me={key:0},ye=f("path",{d:"M144,128a16,16,0,1,1-16-16A16,16,0,0,1,144,128ZM60,112a16,16,0,1,0,16,16A16,16,0,0,0,60,112Zm136,0a16,16,0,1,0,16,16A16,16,0,0,0,196,112Z"},null,-1),he=[ye],be={key:1},ge=f("path",{d:"M240,96v64a16,16,0,0,1-16,16H32a16,16,0,0,1-16-16V96A16,16,0,0,1,32,80H224A16,16,0,0,1,240,96Z",opacity:"0.2"},null,-1),ve=f("path",{d:"M140,128a12,12,0,1,1-12-12A12,12,0,0,1,140,128Zm56-12a12,12,0,1,0,12,12A12,12,0,0,0,196,116ZM60,116a12,12,0,1,0,12,12A12,12,0,0,0,60,116Z"},null,-1),_e=[ge,ve],we={key:2},Ae=f("path",{d:"M224,80H32A16,16,0,0,0,16,96v64a16,16,0,0,0,16,16H224a16,16,0,0,0,16-16V96A16,16,0,0,0,224,80ZM60,140a12,12,0,1,1,12-12A12,12,0,0,1,60,140Zm68,0a12,12,0,1,1,12-12A12,12,0,0,1,128,140Zm68,0a12,12,0,1,1,12-12A12,12,0,0,1,196,140Z"},null,-1),Oe=[Ae],ke={key:3},Ce=f("path",{d:"M138,128a10,10,0,1,1-10-10A10,10,0,0,1,138,128ZM60,118a10,10,0,1,0,10,10A10,10,0,0,0,60,118Zm136,0a10,10,0,1,0,10,10A10,10,0,0,0,196,118Z"},null,-1),je=[Ce],Ie={key:4},Ze=f("path",{d:"M140,128a12,12,0,1,1-12-12A12,12,0,0,1,140,128Zm56-12a12,12,0,1,0,12,12A12,12,0,0,0,196,116ZM60,116a12,12,0,1,0,12,12A12,12,0,0,0,60,116Z"},null,-1),$e=[Ze],Me={key:5},De=f("path",{d:"M136,128a8,8,0,1,1-8-8A8,8,0,0,1,136,128Zm-76-8a8,8,0,1,0,8,8A8,8,0,0,0,60,120Zm136,0a8,8,0,1,0,8,8A8,8,0,0,0,196,120Z"},null,-1),Pe=[De],Se={name:"PhDotsThree"},Ue=R({...Se,props:{weight:{type:String},size:{type:[String,Number]},color:{type:String},mirrored:{type:Boolean}},setup(a){const e=a,n=I("weight","regular"),r=I("size","1em"),p=I("color","currentColor"),Z=I("mirrored",!1),m=A(()=>{var c;return(c=e.weight)!=null?c:n}),O=A(()=>{var c;return(c=e.size)!=null?c:r}),y=A(()=>{var c;return(c=e.color)!=null?c:p}),C=A(()=>e.mirrored!==void 0?e.mirrored?"scale(-1, 1)":void 0:Z?"scale(-1, 1)":void 0);return(c,j)=>(d(),b("svg",Y({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256",width:O.value,height:O.value,fill:y.value,transform:C.value},c.$attrs),[T(c.$slots,"default"),m.value==="bold"?(d(),b("g",me,he)):m.value==="duotone"?(d(),b("g",be,_e)):m.value==="fill"?(d(),b("g",we,Oe)):m.value==="light"?(d(),b("g",ke,je)):m.value==="regular"?(d(),b("g",Ie,$e)):m.value==="thin"?(d(),b("g",Me,Pe)):w("",!0)],16,fe))}});function V(a){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?Object(arguments[e]):{},r=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(p){return Object.getOwnPropertyDescriptor(n,p).enumerable}))),r.forEach(function(p){Fe(a,p,n[p])})}return a}function Fe(a,e,n){return e in a?Object.defineProperty(a,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):a[e]=n,a}var D=function(e,n){var r=V({},e,n.attrs);return i(L,V({},r,{icon:K}),null)};D.displayName="DownloadOutlined";D.inheritAttrs=!1;const xe=D;function E(a){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?Object(arguments[e]):{},r=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(p){return Object.getOwnPropertyDescriptor(n,p).enumerable}))),r.forEach(function(p){Ne(a,p,n[p])})}return a}function Ne(a,e,n){return e in a?Object.defineProperty(a,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):a[e]=n,a}var P=function(e,n){var r=E({},e,n.attrs);return i(L,E({},r,{icon:pe}),null)};P.displayName="UploadOutlined";P.inheritAttrs=!1;const H=P;class S{constructor(e){this.projectId=e}static fromProjectId(e){return new S(e)}async list(){return k.get(`projects/${this.projectId}/files`)}async upload(e,n=""){const r={"Content-Type":"multipart/form-data"};return k.post(`projects/${this.projectId}/files/upload?path=${encodeURIComponent(n+"/"+e.name)}`,e,r)}async download(e){return k.getBlob(`projects/${this.projectId}/files/download?path=${encodeURIComponent(e)}`)}async delete(e){return k.delete(`projects/${this.projectId}/files?path=${encodeURIComponent(e)}`)}async move(e,n){return k.patch(`projects/${this.projectId}/files?path=${encodeURIComponent(e)}&newPath=${encodeURIComponent(n)}`,{})}}const ze=a=>(ie("data-v-048030b3"),a=a(),se(),a),Be=ze(()=>f("br",null,null,-1)),Ve={key:0},Ee={key:0,class:"file-size"},He={class:"action-item"},Re={class:"action-item"},Te=R({__name:"Files",setup(a){const n=ee().params.projectId,r=S.fromProjectId(n),{loading:p,result:Z,refetch:m}=Q(()=>r.list());function O(t){var l,u;return{key:t.path,title:t.name,isLeaf:t.type==="file",file:t,children:t.type==="file"?[]:(u=(l=t.children)==null?void 0:l.map(O))!=null?u:[]}}const y=A(()=>{var t;return(t=Z.value)==null?void 0:t.map(O)}),C=t=>{var l,u;return t.isLeaf?1:(u=(l=t.children)==null?void 0:l.reduce((h,g)=>h+C(g),0))!=null?u:0},c=A(()=>y.value?y==null?void 0:y.value.reduce((t,l)=>t+C(l),0):0),j=te(!1);function U(t){if(t&&t.type==="file")return;const l=document.createElement("input");l.type="file",l.onchange=async()=>{var h;const u=(h=l.files)==null?void 0:h[0];if(!!u)try{j.value=!0,await r.upload(u,t==null?void 0:t.path),await m()}catch{X("Failed to upload file","File already exists")}finally{j.value=!1}},l.click()}async function G(t){if(!t)return;const l=await r.download(t.path),u=document.createElement("a");u.href=URL.createObjectURL(l),u.download=t.name,u.click()}async function F(t){if(!t)return;const l="Are you sure you want to delete this "+(t.type==="file"?"file":"directory and all its contents")+"?";await J(l)&&(await r.delete(t.path),await m())}return(t,l)=>(d(),_(W,null,{default:s(()=>[i(o(ae),null,{default:s(()=>[v("Files")]),_:1}),i(o(x),null,{default:s(()=>[v(" Here you can upload, download and delete files in your persistent dir."),Be,v(" Files can be used in your scripts. "),i(q,{path:"cloud/files"}),T(t.$slots,"description",{},void 0,!0)]),_:3}),i(o($),{type:"primary",loading:j.value,onClick:l[0]||(l[0]=u=>U())},{default:s(()=>[i(o(H)),v(" Upload ")]),_:1},8,["loading"]),i(o(ce),{class:"files"},{default:s(()=>[c.value>0?(d(),_(o(x),{key:0},{default:s(()=>[f("b",null,[v(M(c.value)+" file",1),c.value!==1?(d(),b("span",Ve,"s")):w("",!0)])]),_:1})):w("",!0),y.value&&y.value.length>0?(d(),_(o(ne),{key:1,"tree-data":y.value,selectable:!1},{title:s(({title:u,isLeaf:h,file:g})=>[f("span",null,[v(M(u)+" ",1),h?(d(),b("span",Ee,"("+M(g.size)+")",1)):w("",!0)]),h?(d(),_(o($),{key:0,type:"text",size:"small",style:{float:"inline-end"},onClick:()=>G(g)},{default:s(()=>[i(o(xe))]),_:2},1032,["onClick"])):w("",!0),h?(d(),_(o($),{key:1,type:"text",size:"small",style:{float:"inline-end"},onClick:()=>F(g)},{default:s(()=>[i(o(B))]),_:2},1032,["onClick"])):w("",!0),h?w("",!0):(d(),_(o(oe),{key:2},{overlay:s(()=>[i(o(re),{disabled:o(p)},{default:s(()=>[i(o(N),{danger:!1,onClick:()=>U(g)},{default:s(()=>[f("div",He,[i(o(H)),i(o(z),null,{default:s(()=>[v(" Upload ")]),_:1})])]),_:2},1032,["onClick"]),i(o(N),{danger:!1,onClick:()=>F(g)},{default:s(()=>[f("div",Re,[i(o(B)),i(o(z),null,{default:s(()=>[v(" Delete ")]),_:1})])]),_:2},1032,["onClick"])]),_:2},1032,["disabled"])]),default:s(()=>[i(o(Ue),{style:{cursor:"pointer",float:"inline-end"},size:"25px"})]),_:2},1024))]),_:1},8,["tree-data"])):(d(),_(o(le),{key:2,description:o(p)?"Loading...":"No files"},null,8,["description"]))]),_:1})]),_:3}))}});const rt=de(Te,[["__scopeId","data-v-048030b3"]]);export{rt as default};
//# sourceMappingURL=Files.7173e0ff.js.map
