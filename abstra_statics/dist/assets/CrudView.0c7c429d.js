import{B as O,a as M,g as L,r as Y}from"./router.9170c19d.js";import{_ as Q}from"./DocsButton.vue_vue_type_script_setup_true_lang.3e65e4e9.js";import{i as G}from"./url.eb930402.js";import{G as J}from"./PhDotsThreeVertical.vue.3765371a.js";import{d as z,i as N,al as W,r as $,a as r,b as l,u as n,cQ as q,o as s,f as d,ac as x,ej as I,cE as H,bQ as X,cJ as Z,aI as K,aY as B,cY as ee,g as y,t as f,h as g,cD as te,M as ae,c as le,j as ne,dj as U,A as se,ae as A,de as F,bY as oe,d0 as ue,ad as re,df as C,d9 as P,bW as ie,bE as ce,bD as pe,cS as j,e as de,el as E,S as ye,_ as fe}from"./jwt-decode.esm.efe61f61.js";import{A as R}from"./index.7c0474c0.js";(function(){try{var _=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},m=new Error().stack;m&&(_._sentryDebugIds=_._sentryDebugIds||{},_._sentryDebugIds[m]="508f686d-592a-4c4c-9086-9a4bc282e29c",_._sentryDebugIdIdentifier="sentry-dbid-508f686d-592a-4c4c-9086-9a4bc282e29c")}catch{}})();const me=z({__name:"CreationModal",props:{entityName:{},fields:{},create:{type:Function}},setup(_,{expose:m}){const b=_,T=N.translate("i18n_creationmodal_title",null,{entityName:b.entityName}),p=W({inputValue:{}}),w=$(!1),k=()=>w.value=!0,V=()=>{w.value=!1,p.inputValue={}},S=async()=>{try{await b.create(p.inputValue),V()}catch(c){c instanceof Error&&q.error({message:N.translate("i18n_creationmodal_failed_to_create"),description:c.message})}},t=(c,u)=>{const e=c.target.value,a=b.fields.find(o=>o.key===u);a!=null&&a.format?p.inputValue[u]=a.format(e):p.inputValue[u]=e},v=(c,u)=>{const e=c.target.value,a=b.fields.find(o=>o.key===u);a!=null&&a.blur?p.inputValue[u]=a.blur(e):p.inputValue[u]=e};return m({open:k,close:V}),(c,u)=>(s(),r(n(ae),{open:w.value,title:n(T),onCancel:V,onOk:S},{default:l(()=>[d(n(te),{layout:"vertical"},{default:l(()=>[(s(!0),x(B,null,I(c.fields,e=>{var a;return s(),r(n(H),{key:e.key,label:e.label,help:(a=e.hint)==null?void 0:a.call(e,p.inputValue[e.key]),tooltip:e.tooltip},{default:l(()=>{var o,h,D;return[!e.type||e.type==="text"||e.type==="password"?(s(),r(n(X),{key:0,value:p.inputValue[e.key],"onUpdate:value":i=>p.inputValue[e.key]=i,placeholder:(o=e.placeholder)!=null?o:"",type:(h=e.type)!=null?h:"text",onInput:i=>t(i,e.key),onBlur:i=>v(i,e.key)},null,8,["value","onUpdate:value","placeholder","type","onInput","onBlur"])):e.type==="multiline-text"?(s(),r(n(Z),{key:1,value:p.inputValue[e.key],"onUpdate:value":i=>p.inputValue[e.key]=i,placeholder:(D=e.placeholder)!=null?D:"",onInput:i=>t(i,e.key),onBlur:i=>v(i,e.key)},null,8,["value","onUpdate:value","placeholder","onInput","onBlur"])):e.type==="select"?(s(),r(n(K),{key:2,value:p.inputValue[e.key],"onUpdate:value":i=>p.inputValue[e.key]=i,mode:e.mode},{default:l(()=>[(s(!0),x(B,null,I(e.options,i=>(s(),r(n(ee),{key:typeof i=="string"?i:i.value,value:typeof i=="string"?i:i.value},{default:l(()=>[y(f(typeof i=="string"?i:i.label),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onUpdate:value","mode"])):g("",!0)]}),_:2},1032,["label","help","tooltip"])}),128))]),_:1})]),_:1},8,["open","title"]))}}),ve={class:"action-warning"},ge=z({__name:"CrudView",props:{table:{},loading:{type:Boolean},title:{},emptyTitle:{},entityName:{},description:{},create:{type:Function},createButtonText:{},docsPath:{},live:{type:Boolean},fields:{}},setup(_){const m=_,b=$(null),T=(t,v)=>{var u;const c=(u=m.table.rows[0])==null?void 0:u.cells[v].type;if(!(c==="actions"||c==="slot"))return(e,a)=>p(e,a,v)},p=(t,v,c)=>{const u=t.cells[c],e=v.cells[c];return u.type==="text"&&e.type==="text"||u.type==="tag"&&e.type==="tag"?u.text.localeCompare(e.text):u.type==="tags"&&e.type==="tags"?u.tags[0].text.localeCompare(e.tags[0].text):u.type==="secret"&&e.type==="secret"||u.type==="link"&&e.type==="link"?u.text.localeCompare(e.text):(u.type==="actions"&&e.type==="actions",0)},w=async()=>{var t;m.fields?(t=b.value)==null||t.open():m.create&&await m.create({})},k=$(!1);async function V(t,v){if(!k.value){k.value=!0;try{"onClick"in t?await t.onClick({key:v.key}):"link"in t&&(typeof t.link=="string"&&G(t.link)?open(t.link,"_blank"):Y.push(t.link))}finally{k.value=!1}}}const S=le(()=>({"--columnCount":`${m.table.columns.length}`}));return(t,v)=>{const c=ne("RouterLink");return s(),x(B,null,[d(n(R),{direction:"vertical",class:"crud-view"},{default:l(()=>{var u;return[d(n(U),{align:"center",justify:"space-between"},{default:l(()=>[t.title?(s(),r(n(se),{key:0},{default:l(()=>[y(f(t.title),1)]),_:1})):g("",!0),A(t.$slots,"more",{},void 0,!0)]),_:3}),t.description?(s(),r(n(F),{key:0},{default:l(()=>[y(f(t.description)+" ",1),A(t.$slots,"description",{},void 0,!0),t.docsPath?(s(),r(Q,{key:0,path:t.docsPath},null,8,["path"])):g("",!0)]),_:3})):g("",!0),d(n(U),{gap:"middle"},{default:l(()=>[t.createButtonText?(s(),r(n(oe),{key:0,type:"primary",onClick:w},{default:l(()=>[y(f(t.createButtonText),1)]),_:1})):g("",!0),A(t.$slots,"secondary",{},void 0,!0)]),_:3}),A(t.$slots,"extra",{},void 0,!0),d(n(ue),{"filter-dropdown":!0,size:"small",style:re(S.value),"data-source":t.table.rows,loading:k.value||t.loading&&!t.live,height:400,columns:(u=t.table.columns)==null?void 0:u.map((e,a)=>{var o;return{...e,key:a,filtered:!0,align:(o=e.align)!=null?o:"center",sorter:T(e,a)}})},{emptyText:l(()=>[y(f(t.emptyTitle),1)]),headerCell:l(e=>[y(f(e.title),1)]),bodyCell:l(({column:{key:e},record:a})=>[a.cells[e].type==="slot"?A(t.$slots,a.cells[e].key,{key:0,payload:a.cells[e].payload},void 0,!0):(s(),r(n(j),{key:1,open:a.cells[e].hover?void 0:!1},{content:l(()=>[d(n(F),{style:{width:"300px",overflow:"auto","font-family":"monospace"},copyable:"",content:a.cells[e].hover},null,8,["content"])]),default:l(()=>[a.cells[e].type==="text"?(s(),r(n(C),{key:0,secondary:a.cells[e].secondary,code:a.cells[e].code},{default:l(()=>[d(n(O),{dot:a.cells[e].contentType==="warning",color:"#faad14"},{default:l(()=>[y(f(a.cells[e].text),1)]),_:2},1032,["dot"])]),_:2},1032,["secondary","code"])):a.cells[e].type==="secret"?(s(),r(n(C),{key:1,copyable:{text:a.cells[e].text}},{default:l(()=>[y(" ******** ")]),_:2},1032,["copyable"])):a.cells[e].type==="tag"?(s(),r(n(P),{key:2,color:a.cells[e].tagColor},{default:l(()=>[y(f(a.cells[e].text),1)]),_:2},1032,["color"])):a.cells[e].type==="tags"?(s(),r(n(R),{key:3},{default:l(()=>[(s(!0),x(B,null,I(a.cells[e].tags,(o,h)=>(s(),r(n(P),{key:h,color:o.color},{default:l(()=>[y(f(o.text),1)]),_:2},1032,["color"]))),128))]),_:2},1024)):a.cells[e].type==="link"?(s(),r(c,{key:4,to:a.cells[e].to},{default:l(()=>[y(f(a.cells[e].text),1)]),_:2},1032,["to"])):a.cells[e].type==="actions"?(s(),r(n(ie),{key:5},{overlay:l(()=>[d(n(ce),{disabled:k.value},{default:l(()=>[(s(!0),x(B,null,I(a.cells[e].actions.filter(o=>!o.hide),(o,h)=>(s(),r(n(pe),{key:h,danger:o.dangerous,onClick:D=>V(o,a)},{default:l(()=>[o.popoverMessage?(s(),r(n(j),{key:0,placement:"left"},{content:l(()=>[de("div",ve,[d(n(C),null,{default:l(()=>[y(f(o.popoverMessage),1)]),_:2},1024)])]),default:l(()=>[d(n(C),{disabled:o.disabled,class:"action-item"},{default:l(()=>[o.icon?(s(),r(E(o.icon),{key:0})):g("",!0),y(" "+f(o.label),1)]),_:2},1032,["disabled"])]),_:2},1024)):(s(),r(n(C),{key:1,disabled:o.disabled,class:"action-item"},{default:l(()=>[o.icon?(s(),r(E(o.icon),{key:0})):g("",!0),y(" "+f(o.label),1)]),_:2},1032,["disabled"]))]),_:2},1032,["danger","onClick"]))),128))]),_:2},1032,["disabled"])]),default:l(()=>[d(n(J),{style:{cursor:"pointer"},size:"25px"})]),_:2},1024)):g("",!0)]),_:2},1032,["open"]))]),footer:l(()=>[t.live?(s(),r(n(L),{key:0,justify:"end",gutter:10},{default:l(()=>[d(n(M),{style:{display:"flex","align-items":"center"}},{default:l(()=>[d(n(ye),{size:"small",style:{display:"flex","align-items":"center"}})]),_:1}),d(n(M),null,{default:l(()=>[d(n(C),null,{default:l(()=>[y(f(n(N).translate("i18n_crudview_auto_updating")),1)]),_:1})]),_:1})]),_:1})):g("",!0)]),_:3},8,["style","data-source","loading","columns"])]}),_:3}),t.fields&&t.create?(s(),r(me,{key:0,ref_key:"modalRef",ref:b,fields:t.fields,"entity-name":t.entityName,create:t.create},null,8,["fields","entity-name","create"])):g("",!0)],64)}}});const Ve=fe(ge,[["__scopeId","data-v-21fb039e"]]);export{Ve as C};
//# sourceMappingURL=CrudView.0c7c429d.js.map
