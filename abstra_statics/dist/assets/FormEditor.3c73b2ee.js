import{F as D,a as se,b as ie,c as ue,d as de}from"./FormRunner.569638ab.js";import{d as P,af as $,g as A,o as u,K as f,O as x,F as C,e4 as O,a as b,f as Z,b as a,w as r,u as e,d6 as E,az as _,cQ as me,d2 as U,cs as H,bE as M,cr as J,aL as B,eF as pe,eG as ce,Q,c as F,br as fe,aP as W,cu as ve,bM as T,da as z,ea as N,L as X,B as L,d3 as ge,cH as he,eW as ye,bH as K,e9 as be,cE as we,eH as _e,e3 as ke,h as Y,em as Se,cF as Ae}from"./index.56a4aa2e.js";import{r as He}from"./redirect.f0c398cb.js";import{a as $e}from"./asyncComputed.9c066391.js";import"./linters.bbf68979.js";import{F as Me}from"./scripts.cb0f8348.js";import{W as Ze}from"./workspaces.32be68c6.js";import{R as Ce,_ as Fe}from"./RuntimeCommonSettings.a7837bcc.js";import{A as Ve}from"./index.d70f3c4f.js";import{u as Pe}from"./userStore.31baf024.js";import{P as Te}from"./PlayerNavbar.890e7934.js";import{u as Re}from"./workspaceStore.00fd0aec.js";import{W as Le}from"./PlayerConfigProvider.dd72f809.js";import{F as Ee}from"./PhArrowSquareOut.vue.e519cef2.js";import{C as Ue}from"./Card.e1cbf4fc.js";import{A as Ie}from"./index.31820966.js";import"./Login.vue_vue_type_script_setup_true_lang.5f7e2c41.js";import"./CircularLoading.3b4c2113.js";import"./Logo.376aef10.js";import"./string.c8a67ded.js";import"./Steps.f868dff4.js";import"./index.4d62b1fb.js";import"./Watermark.d474876e.js";import"./url.7ee1877f.js";import"./record.1426f0e6.js";import"./colorHelpers.21549eb9.js";import"./BaseLayout.d9bc47ce.js";import"./SaveButton.eafe8d71.js";import"./UnsavedChangesHandler.492bbe1e.js";import"./ExclamationCircleOutlined.593820b1.js";import"./OmniChat.b31632d8.js";import"./gateway.03a16684.js";import"./popupNotifcation.2b90a8f1.js";import"./AbstraLogo.vue_vue_type_script_setup_true_lang.14f1b61f.js";import"./uuid.46fa2f8f.js";import"./PhClockCounterClockwise.vue.0e7f2088.js";import"./omniChatStore.cbca1242.js";import"./LoadingOutlined.b6085be9.js";import"./columns.1a209a57.js";import"./controller.3e09fcf7.js";import"./vue-flow-core.19436ea1.js";import"./validations.38f1d22d.js";import"./metadata.ed52026a.js";import"./PhWebhooksLogo.vue.f3a45ccc.js";import"./controller.71777a22.js";import"./fetch.ea97a3c3.js";import"./PhPencil.vue.a4f06d6f.js";import"./PhCopySimple.vue.a0d19b08.js";import"./index.33283a34.js";import"./Avatar.1e25a656.js";import"./Navbar.c6e4b101.js";import"./AbstraButton.vue_vue_type_script_setup_true_lang.d158bdf8.js";import"./PhArrowCounterClockwise.vue.cc6b4f94.js";import"./PhFilePy.vue.8f8cb6e2.js";import"./PhChats.vue.38cc21b2.js";import"./PhRocket.vue.2694b0df.js";import"./PhPackage.vue.ad0464c8.js";import"./polling.c6b67ee3.js";import"./PhSignOut.vue.7ca15e87.js";import"./PhSparkle.vue.9dc0bb5c.js";import"./editor.a4e238ac.js";import"./CloseCircleOutlined.ffecd30e.js";import"./CheckCircleFilled.daf6de0a.js";import"./SourceCode.11bde9ae.js";import"./PhFolder.vue.164d7697.js";import"./toggleHighContrast.1f96e29f.js";import"./TasksManager.d860d962.js";import"./tasksController.e6b182b0.js";import"./ant-design.495703a7.js";import"./index.fa1289a9.js";import"./CollapsePanel.013dcfa6.js";import"./index.dc8c9927.js";import"./PhCaretRight.vue.006ebba4.js";import"./Badge.19f199e3.js";import"./TabPane.f81b8fb1.js";import"./index.18709242.js";import"./index.bb9fdcd9.js";(function(){try{var w=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},d=new Error().stack;d&&(w._sentryDebugIds=w._sentryDebugIds||{},w._sentryDebugIds[d]="3b7b2381-9628-4f85-994d-7166aae0978e",w._sentryDebugIdIdentifier="sentry-dbid-3b7b2381-9628-4f85-994d-7166aae0978e")}catch{}})();const De=["width","height","fill","transform"],We={key:0},Be=b("path",{d:"M228,48V96a12,12,0,0,1-12,12H168a12,12,0,0,1,0-24h19l-7.8-7.8a75.55,75.55,0,0,0-53.32-22.26h-.43A75.49,75.49,0,0,0,72.39,75.57,12,12,0,1,1,55.61,58.41a99.38,99.38,0,0,1,69.87-28.47H126A99.42,99.42,0,0,1,196.2,59.23L204,67V48a12,12,0,0,1,24,0ZM183.61,180.43a75.49,75.49,0,0,1-53.09,21.63h-.43A75.55,75.55,0,0,1,76.77,179.8L69,172H88a12,12,0,0,0,0-24H40a12,12,0,0,0-12,12v48a12,12,0,0,0,24,0V189l7.8,7.8A99.42,99.42,0,0,0,130,226.06h.56a99.38,99.38,0,0,0,69.87-28.47,12,12,0,0,0-16.78-17.16Z"},null,-1),qe=[Be],ze={key:1},Ne=b("path",{d:"M216,128a88,88,0,1,1-88-88A88,88,0,0,1,216,128Z",opacity:"0.2"},null,-1),xe=b("path",{d:"M224,48V96a8,8,0,0,1-8,8H168a8,8,0,0,1,0-16h28.69L182.06,73.37a79.56,79.56,0,0,0-56.13-23.43h-.45A79.52,79.52,0,0,0,69.59,72.71,8,8,0,0,1,58.41,61.27a96,96,0,0,1,135,.79L208,76.69V48a8,8,0,0,1,16,0ZM186.41,183.29a80,80,0,0,1-112.47-.66L59.31,168H88a8,8,0,0,0,0-16H40a8,8,0,0,0-8,8v48a8,8,0,0,0,16,0V179.31l14.63,14.63A95.43,95.43,0,0,0,130,222.06h.53a95.36,95.36,0,0,0,67.07-27.33,8,8,0,0,0-11.18-11.44Z"},null,-1),Oe=[Ne,xe],Qe={key:2},je=b("path",{d:"M224,48V96a8,8,0,0,1-8,8H168a8,8,0,0,1-5.66-13.66L180.65,72a79.48,79.48,0,0,0-54.72-22.09h-.45A79.52,79.52,0,0,0,69.59,72.71,8,8,0,0,1,58.41,61.27,96,96,0,0,1,192,60.7l18.36-18.36A8,8,0,0,1,224,48ZM186.41,183.29A80,80,0,0,1,75.35,184l18.31-18.31A8,8,0,0,0,88,152H40a8,8,0,0,0-8,8v48a8,8,0,0,0,13.66,5.66L64,195.3a95.42,95.42,0,0,0,66,26.76h.53a95.36,95.36,0,0,0,67.07-27.33,8,8,0,0,0-11.18-11.44Z"},null,-1),Ge=[je],Ke={key:3},Ye=b("path",{d:"M222,48V96a6,6,0,0,1-6,6H168a6,6,0,0,1,0-12h33.52L183.47,72a81.51,81.51,0,0,0-57.53-24h-.46A81.5,81.5,0,0,0,68.19,71.28a6,6,0,1,1-8.38-8.58,93.38,93.38,0,0,1,65.67-26.76H126a93.45,93.45,0,0,1,66,27.53l18,18V48a6,6,0,0,1,12,0ZM187.81,184.72a81.5,81.5,0,0,1-57.29,23.34h-.46a81.51,81.51,0,0,1-57.53-24L54.48,166H88a6,6,0,0,0,0-12H40a6,6,0,0,0-6,6v48a6,6,0,0,0,12,0V174.48l18,18.05a93.45,93.45,0,0,0,66,27.53h.52a93.38,93.38,0,0,0,65.67-26.76,6,6,0,1,0-8.38-8.58Z"},null,-1),Je=[Ye],Xe={key:4},ea=b("path",{d:"M224,48V96a8,8,0,0,1-8,8H168a8,8,0,0,1,0-16h28.69L182.06,73.37a79.56,79.56,0,0,0-56.13-23.43h-.45A79.52,79.52,0,0,0,69.59,72.71,8,8,0,0,1,58.41,61.27a96,96,0,0,1,135,.79L208,76.69V48a8,8,0,0,1,16,0ZM186.41,183.29a80,80,0,0,1-112.47-.66L59.31,168H88a8,8,0,0,0,0-16H40a8,8,0,0,0-8,8v48a8,8,0,0,0,16,0V179.31l14.63,14.63A95.43,95.43,0,0,0,130,222.06h.53a95.36,95.36,0,0,0,67.07-27.33,8,8,0,0,0-11.18-11.44Z"},null,-1),aa=[ea],ta={key:5},ra=b("path",{d:"M220,48V96a4,4,0,0,1-4,4H168a4,4,0,0,1,0-8h38.34L184.89,70.54A84,84,0,0,0,66.8,69.85a4,4,0,1,1-5.6-5.72,92,92,0,0,1,129.34.76L212,86.34V48a4,4,0,0,1,8,0ZM189.2,186.15a83.44,83.44,0,0,1-58.68,23.91h-.47a83.52,83.52,0,0,1-58.94-24.6L49.66,164H88a4,4,0,0,0,0-8H40a4,4,0,0,0-4,4v48a4,4,0,0,0,8,0V169.66l21.46,21.45A91.43,91.43,0,0,0,130,218.06h.51a91.45,91.45,0,0,0,64.28-26.19,4,4,0,1,0-5.6-5.72Z"},null,-1),oa=[ra],la={name:"PhArrowsClockwise"},na=P({...la,props:{weight:{type:String},size:{type:[String,Number]},color:{type:String},mirrored:{type:Boolean}},setup(w){const d=w,l=$("weight","regular"),y=$("size","1em"),n=$("color","currentColor"),s=$("mirrored",!1),i=A(()=>{var t;return(t=d.weight)!=null?t:l}),k=A(()=>{var t;return(t=d.size)!=null?t:y}),o=A(()=>{var t;return(t=d.color)!=null?t:n}),g=A(()=>d.mirrored!==void 0?d.mirrored?"scale(-1, 1)":void 0:s?"scale(-1, 1)":void 0);return(t,p)=>(u(),f("svg",O({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256",width:k.value,height:k.value,fill:o.value,transform:g.value},t.$attrs),[x(t.$slots,"default"),i.value==="bold"?(u(),f("g",We,qe)):i.value==="duotone"?(u(),f("g",ze,Oe)):i.value==="fill"?(u(),f("g",Qe,Ge)):i.value==="light"?(u(),f("g",Ke,Je)):i.value==="regular"?(u(),f("g",Xe,aa)):i.value==="thin"?(u(),f("g",ta,oa)):C("",!0)],16,De))}}),sa=["width","height","fill","transform"],ia={key:0},ua=b("path",{d:"M28,64A12,12,0,0,1,40,52H216a12,12,0,0,1,0,24H40A12,12,0,0,1,28,64Zm12,76h64a12,12,0,0,0,0-24H40a12,12,0,0,0,0,24Zm80,40H40a12,12,0,0,0,0,24h80a12,12,0,0,0,0-24Zm120.49,20.49a12,12,0,0,1-17,0l-18.08-18.08a44,44,0,1,1,17-17l18.08,18.07A12,12,0,0,1,240.49,200.49ZM184,164a20,20,0,1,0-20-20A20,20,0,0,0,184,164Z"},null,-1),da=[ua],ma={key:1},pa=b("path",{d:"M216,144a32,32,0,1,1-32-32A32,32,0,0,1,216,144Z",opacity:"0.2"},null,-1),ca=b("path",{d:"M32,64a8,8,0,0,1,8-8H216a8,8,0,0,1,0,16H40A8,8,0,0,1,32,64Zm8,72h72a8,8,0,0,0,0-16H40a8,8,0,0,0,0,16Zm88,48H40a8,8,0,0,0,0,16h88a8,8,0,0,0,0-16Zm109.66,13.66a8,8,0,0,1-11.32,0L206,177.36A40,40,0,1,1,217.36,166l20.3,20.3A8,8,0,0,1,237.66,197.66ZM184,168a24,24,0,1,0-24-24A24,24,0,0,0,184,168Z"},null,-1),fa=[pa,ca],va={key:2},ga=b("path",{d:"M32,64a8,8,0,0,1,8-8H216a8,8,0,0,1,0,16H40A8,8,0,0,1,32,64Zm8,72h72a8,8,0,0,0,0-16H40a8,8,0,0,0,0,16Zm88,48H40a8,8,0,0,0,0,16h88a8,8,0,0,0,0-16Zm109.66,2.34L217.36,166A40,40,0,1,0,206,177.36l20.3,20.3a8,8,0,0,0,11.32-11.32Z"},null,-1),ha=[ga],ya={key:3},ba=b("path",{d:"M34,64a6,6,0,0,1,6-6H216a6,6,0,0,1,0,12H40A6,6,0,0,1,34,64Zm6,70h72a6,6,0,0,0,0-12H40a6,6,0,0,0,0,12Zm88,52H40a6,6,0,0,0,0,12h88a6,6,0,0,0,0-12Zm108.24,10.24a6,6,0,0,1-8.48,0l-21.49-21.48a38.06,38.06,0,1,1,8.49-8.49l21.48,21.49A6,6,0,0,1,236.24,196.24ZM184,170a26,26,0,1,0-26-26A26,26,0,0,0,184,170Z"},null,-1),wa=[ba],_a={key:4},ka=b("path",{d:"M32,64a8,8,0,0,1,8-8H216a8,8,0,0,1,0,16H40A8,8,0,0,1,32,64Zm8,72h72a8,8,0,0,0,0-16H40a8,8,0,0,0,0,16Zm88,48H40a8,8,0,0,0,0,16h88a8,8,0,0,0,0-16Zm109.66,13.66a8,8,0,0,1-11.32,0L206,177.36A40,40,0,1,1,217.36,166l20.3,20.3A8,8,0,0,1,237.66,197.66ZM184,168a24,24,0,1,0-24-24A24,24,0,0,0,184,168Z"},null,-1),Sa=[ka],Aa={key:5},Ha=b("path",{d:"M36,64a4,4,0,0,1,4-4H216a4,4,0,0,1,0,8H40A4,4,0,0,1,36,64Zm4,68h72a4,4,0,0,0,0-8H40a4,4,0,0,0,0,8Zm88,56H40a4,4,0,0,0,0,8h88a4,4,0,0,0,0-8Zm106.83,6.83a4,4,0,0,1-5.66,0l-22.72-22.72a36.06,36.06,0,1,1,5.66-5.66l22.72,22.72A4,4,0,0,1,234.83,194.83ZM184,172a28,28,0,1,0-28-28A28,28,0,0,0,184,172Z"},null,-1),$a=[Ha],Ma={name:"PhListMagnifyingGlass"},Za=P({...Ma,props:{weight:{type:String},size:{type:[String,Number]},color:{type:String},mirrored:{type:Boolean}},setup(w){const d=w,l=$("weight","regular"),y=$("size","1em"),n=$("color","currentColor"),s=$("mirrored",!1),i=A(()=>{var t;return(t=d.weight)!=null?t:l}),k=A(()=>{var t;return(t=d.size)!=null?t:y}),o=A(()=>{var t;return(t=d.color)!=null?t:n}),g=A(()=>d.mirrored!==void 0?d.mirrored?"scale(-1, 1)":void 0:s?"scale(-1, 1)":void 0);return(t,p)=>(u(),f("svg",O({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256",width:k.value,height:k.value,fill:o.value,transform:g.value},t.$attrs),[x(t.$slots,"default"),i.value==="bold"?(u(),f("g",ia,da)):i.value==="duotone"?(u(),f("g",ma,fa)):i.value==="fill"?(u(),f("g",va,ha)):i.value==="light"?(u(),f("g",ya,wa)):i.value==="regular"?(u(),f("g",_a,Sa)):i.value==="thin"?(u(),f("g",Aa,$a)):C("",!0)],16,sa))}}),Ca=["width","height","fill","transform"],Fa={key:0},Va=b("path",{d:"M200,36H56A20,20,0,0,0,36,56V200a20,20,0,0,0,20,20H200a20,20,0,0,0,20-20V56A20,20,0,0,0,200,36Zm-4,160H60V60H196Z"},null,-1),Pa=[Va],Ta={key:1},Ra=b("path",{d:"M208,56V200a8,8,0,0,1-8,8H56a8,8,0,0,1-8-8V56a8,8,0,0,1,8-8H200A8,8,0,0,1,208,56Z",opacity:"0.2"},null,-1),La=b("path",{d:"M200,40H56A16,16,0,0,0,40,56V200a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V56A16,16,0,0,0,200,40Zm0,160H56V56H200V200Z"},null,-1),Ea=[Ra,La],Ua={key:2},Ia=b("path",{d:"M216,56V200a16,16,0,0,1-16,16H56a16,16,0,0,1-16-16V56A16,16,0,0,1,56,40H200A16,16,0,0,1,216,56Z"},null,-1),Da=[Ia],Wa={key:3},Ba=b("path",{d:"M200,42H56A14,14,0,0,0,42,56V200a14,14,0,0,0,14,14H200a14,14,0,0,0,14-14V56A14,14,0,0,0,200,42Zm2,158a2,2,0,0,1-2,2H56a2,2,0,0,1-2-2V56a2,2,0,0,1,2-2H200a2,2,0,0,1,2,2Z"},null,-1),qa=[Ba],za={key:4},Na=b("path",{d:"M200,40H56A16,16,0,0,0,40,56V200a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V56A16,16,0,0,0,200,40Zm0,160H56V56H200V200Z"},null,-1),xa=[Na],Oa={key:5},Qa=b("path",{d:"M200,44H56A12,12,0,0,0,44,56V200a12,12,0,0,0,12,12H200a12,12,0,0,0,12-12V56A12,12,0,0,0,200,44Zm4,156a4,4,0,0,1-4,4H56a4,4,0,0,1-4-4V56a4,4,0,0,1,4-4H200a4,4,0,0,1,4,4Z"},null,-1),ja=[Qa],Ga={name:"PhStop"},Ka=P({...Ga,props:{weight:{type:String},size:{type:[String,Number]},color:{type:String},mirrored:{type:Boolean}},setup(w){const d=w,l=$("weight","regular"),y=$("size","1em"),n=$("color","currentColor"),s=$("mirrored",!1),i=A(()=>{var t;return(t=d.weight)!=null?t:l}),k=A(()=>{var t;return(t=d.size)!=null?t:y}),o=A(()=>{var t;return(t=d.color)!=null?t:n}),g=A(()=>d.mirrored!==void 0?d.mirrored?"scale(-1, 1)":void 0:s?"scale(-1, 1)":void 0);return(t,p)=>(u(),f("svg",O({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256",width:k.value,height:k.value,fill:o.value,transform:g.value},t.$attrs),[x(t.$slots,"default"),i.value==="bold"?(u(),f("g",Fa,Pa)):i.value==="duotone"?(u(),f("g",Ta,Ea)):i.value==="fill"?(u(),f("g",Ua,Da)):i.value==="light"?(u(),f("g",Wa,qa)):i.value==="regular"?(u(),f("g",za,xa)):i.value==="thin"?(u(),f("g",Oa,ja)):C("",!0)],16,Ca))}}),ee=w=>(pe("data-v-c86b3d07"),w=w(),ce(),w),Ya=ee(()=>b("i",null,"string",-1)),Ja=ee(()=>b("i",null,"string list",-1)),Xa=P({__name:"FormNotificationSettings",props:{form:{}},setup(w){const l=Z(w.form);return(y,n)=>(u(),f(B,null,[a(e(J),{layout:"vertical"},{default:r(()=>[a(e(E),{level:4,width:"100%",height:"30px",style:{display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"0px"}},{default:r(()=>[_(" Task waiting "),a(e(me),{checked:l.value.notificationTrigger.enabled,"onUpdate:checked":n[0]||(n[0]=s=>l.value.notificationTrigger.enabled=s)},{default:r(()=>[_(" Enabled ")]),_:1},8,["checked"])]),_:1}),a(e(U),{class:"description",style:{fontStyle:"italic",marginBottom:"20px"}},{default:r(()=>[_(" Send emails when new tasks are received ")]),_:1}),a(e(H),{label:"Variable name"},{default:r(()=>[a(e(M),{value:l.value.notificationTrigger.variable_name,"onUpdate:value":n[1]||(n[1]=s=>l.value.notificationTrigger.variable_name=s),disabled:!l.value.notificationTrigger.enabled,type:"text",placeholder:"variable_name"},null,8,["value","disabled"])]),_:1})]),_:1}),a(e(Ve),{type:"info"},{message:r(()=>[a(e(U),null,{default:r(()=>[_(" Notifications are sent to the emails specified in the task payload variables set here. The variables should contain a "),Ya,_(" or a "),Ja,_(". ")]),_:1})]),_:1})],64))}});const et=Q(Xa,[["__scopeId","data-v-c86b3d07"]]),at={class:"form-preview"},tt={class:"form-preview-container"},rt=P({__name:"FormPreview",props:{formState:{},formRunnerData:{},isLoading:{type:Boolean},queryParams:{},disabledWarning:{},controller:{},currentPath:{}},emits:["open-query-params-modal"],setup(w,{emit:d}){const l=w,y=Pe(),n=Re(),s=A(()=>{if(!l.formRunnerData)return"";const o=Object.entries(l.queryParams),g="?"+o.map(([p,c])=>`${p}=${c}`).join("&"),t=o.length?g:"";return`/${l.formRunnerData.path}${t}`}),i=()=>d("open-query-params-modal"),k=()=>{let o=`/${l.currentPath}`;const g=new URLSearchParams(l.queryParams);window.open(`${o}?${g.toString()}`,"_blank")};return(o,g)=>(u(),f("div",at,[o.isLoading||!o.formRunnerData||!o.formState?(u(),F(e(fe),{key:0})):C("",!0),o.formState&&o.formRunnerData?(u(),F(e(z),{key:1,vertical:"",gap:"10",style:{height:"100%",overflow:"hidden"}},{default:r(()=>[a(e(z),{gap:"small"},{default:r(()=>[a(e(W),{title:"Edit query params",placement:"bottom"},{default:r(()=>[a(e(ve),{compact:"",style:{display:"flex"},onClick:i},{default:r(()=>{var t,p;return[a(e(M),{disabled:!!o.formState&&e(D).includes((t=o.formState)==null?void 0:t.type),value:s.value,onKeyup:i},null,8,["disabled","value"]),a(e(T),{disabled:!!o.formState&&e(D).includes((p=o.formState)==null?void 0:p.type),onClick:i},{default:r(()=>[a(e(Za),{size:"20"})]),_:1},8,["disabled"])]}),_:1})]),_:1}),a(e(W),{placement:"bottom"},{title:r(()=>[_("Open in Full Screen")]),default:r(()=>[a(e(T),{target:"_blank","aria-label":"Open in Full Screen","aria-describedby":"sss",onClick:k},{default:r(()=>[a(e(Ee),{size:"20"})]),_:1})]),_:1})]),_:1}),b("div",tt,[o.disabledWarning?(u(),F(e(Ue),{key:0,class:"unsaved-changes"},{default:r(()=>[a(e(U),{style:{"font-size":"18px","font-weight":"500"}},{default:r(()=>[_(N(o.disabledWarning.title),1)]),_:1}),a(e(U),{style:{"margin-bottom":"6px"}},{default:r(()=>[_(N(o.disabledWarning.message),1)]),_:1})]),_:1})):C("",!0),a(Le,{class:"center","main-color":o.formRunnerData.mainColor,background:o.formRunnerData.theme,"font-family":o.formRunnerData.fontFamily,locale:o.formRunnerData.language},{default:r(()=>{var t,p,c,V,I;return[e(n).state.workspace?(u(),F(Te,{key:0,"current-path":o.currentPath,"hide-login":!0,"runner-data":e(n).state.workspace},null,8,["current-path","runner-data"])):C("",!0),a(se,{"is-preview":"",class:"runner","form-runner-data":o.formRunnerData,"form-state":o.formState,disabled:!!o.disabledWarning,"user-email":e(y).email,onUpdateWidgetErrors:(t=o.controller)==null?void 0:t.updateWidgetFrontendErrors,onUpdateWidgetValue:(p=o.controller)==null?void 0:p.updateWidgetValue,onActionClicked:(c=o.controller)==null?void 0:c.handleActionClick,onAutoFillClicked:(V=o.controller)==null?void 0:V.handleAutofillClick,onAuthComplete:(I=o.controller)==null?void 0:I.handleAuthComplete},null,8,["form-runner-data","form-state","disabled","user-email","onUpdateWidgetErrors","onUpdateWidgetValue","onActionClicked","onAutoFillClicked","onAuthComplete"])]}),_:1},8,["main-color","background","font-family","locale"])])]),_:1})):C("",!0)]))}});const ot=Q(rt,[["__scopeId","data-v-9c597cc0"]]),lt={key:0},nt={key:1},st=b("br",null,null,-1),it="Start form",ut=P({__name:"FormRunButton",props:{formStateType:{},disabledWarning:{},startMessage:{}},emits:["start","reset"],setup(w,{emit:d}){var k;const l=new X(L.boolean(),"dontShowReloadHelper"),y=Z((k=l.get())!=null?k:!1),n=()=>{y.value=!0,l.set(!0)},s=()=>d("reset"),i=()=>d("start");return(o,g)=>(u(),f(B,null,[o.formStateType&&e(ie).includes(o.formStateType)?(u(),F(e(he),{key:0,placement:"bottom",open:y.value?void 0:!0},{content:r(()=>[y.value?(u(),f("span",lt,"Reload form")):(u(),f("span",nt,[_(" You can reload the form here"),st,a(e(ge),{onClick:n},{default:r(()=>[_("Don't show this again")]),_:1})]))]),default:r(()=>[a(e(T),{disabled:!!o.disabledWarning,onClick:s},{default:r(()=>[a(e(na),{size:"20"})]),_:1},8,["disabled"])]),_:1},8,["open"])):C("",!0),e(D).includes(o.formStateType)?(u(),F(e(W),{key:1,placement:"bottom"},{title:r(()=>[_("Stop form")]),default:r(()=>[a(e(T),{onClick:s},{default:r(()=>[a(e(Ka),{size:"20"})]),_:1})]),_:1})):C("",!0),o.formStateType==="waiting"?(u(),F(e(W),{key:2,placement:"bottom"},{title:r(()=>{var t;return[_(N((t=o.startMessage)!=null?t:it),1)]}),default:r(()=>[a(e(T),{disabled:!!o.disabledWarning,onClick:i},{default:r(()=>[a(e(ye),{size:"20"})]),_:1},8,["disabled"])]),_:1})):C("",!0)],64))}}),dt=P({__name:"FormSettings",props:{form:{}},setup(w){const l=Z(w.form);return(y,n)=>(u(),F(e(J),{layout:"vertical",class:"form-settings"},{default:r(()=>[a(Ce,{runtime:l.value},null,8,["runtime"]),a(e(H),{label:"Form name"},{default:r(()=>[a(e(M),{value:l.value.title,"onUpdate:value":n[0]||(n[0]=s=>l.value.title=s),type:"text",onChange:n[1]||(n[1]=s=>{var i;return l.value.title=(i=s.target.value)!=null?i:""})},null,8,["value"])]),_:1}),a(e(E),{level:3},{default:r(()=>[_(" Texts ")]),_:1}),a(e(E),{level:4},{default:r(()=>[_(" Welcome Screen ")]),_:1}),a(e(H),{label:"Title"},{default:r(()=>[a(e(M),{value:l.value.welcomeTitle,"onUpdate:value":n[2]||(n[2]=s=>l.value.welcomeTitle=s),type:"text",placeholder:l.value.title,disabled:l.value.autoStart},null,8,["value","placeholder","disabled"])]),_:1}),a(e(H),{label:"Description"},{default:r(()=>[a(e(M),{value:l.value.startMessage,"onUpdate:value":n[3]||(n[3]=s=>l.value.startMessage=s),type:"text",disabled:l.value.autoStart},null,8,["value","disabled"])]),_:1}),a(e(H),{label:"Start button label"},{default:r(()=>[a(e(M),{value:l.value.startButtonText,"onUpdate:value":n[4]||(n[4]=s=>l.value.startButtonText=s),type:"text",placeholder:"Start",disabled:l.value.autoStart},null,8,["value","disabled"])]),_:1}),a(e(H),null,{default:r(()=>[a(e(K),{checked:l.value.autoStart,"onUpdate:checked":n[5]||(n[5]=s=>l.value.autoStart=s)},{default:r(()=>[_("Skip welcome screen")]),_:1},8,["checked"])]),_:1}),a(e(E),{level:4},{default:r(()=>[_(" End Screen ")]),_:1}),a(e(H),{label:"End text"},{default:r(()=>[a(e(M),{value:l.value.endMessage,"onUpdate:value":n[6]||(n[6]=s=>l.value.endMessage=s),type:"text",placeholder:"Thank you"},null,8,["value"])]),_:1}),a(e(H),{label:"Restart button label"},{default:r(()=>[a(e(M),{value:l.value.restartButtonText,"onUpdate:value":n[7]||(n[7]=s=>l.value.restartButtonText=s),placeholder:"Restart",type:"text",disabled:!l.value.allowRestart},null,8,["value","disabled"])]),_:1}),a(e(H),{help:!l.value.isInitial&&"Only initial forms can be restarted"},{default:r(()=>[a(e(K),{checked:l.value.allowRestart,"onUpdate:checked":n[8]||(n[8]=s=>l.value.allowRestart=s),disabled:!l.value.isInitial},{default:r(()=>[_("Show restart button at the end")]),_:1},8,["checked","disabled"])]),_:1},8,["help"]),a(e(E),{level:4},{default:r(()=>[_(" Alert Messages ")]),_:1}),a(e(H),{label:"Error message"},{default:r(()=>[a(e(M),{value:l.value.errorMessage,"onUpdate:value":n[9]||(n[9]=s=>l.value.errorMessage=s),type:"text",placeholder:"Something went wrong"},null,8,["value"])]),_:1})]),_:1}))}});const mt=Q(dt,[["__scopeId","data-v-aff64cb2"]]),pt=P({__name:"QueryParamsModal",props:{open:{type:Boolean},queryParams:{}},emits:["update:query-params","close"],setup(w,{emit:d}){const y=Z(n(w.queryParams));function n(g){return Object.entries(g).map(([t,p])=>({key:t,value:p,id:Math.random().toString()}))}function s(){const g={};return y.value.forEach(({key:t,value:p})=>{g[t]=p}),g}const i=(g,t,p)=>{y.value[g]={key:t,value:p},d("update:query-params",s())},k=()=>{const g=y.value.length;y.value.push({key:`param-${g}`,value:"value"}),d("update:query-params",s())},o=g=>{y.value.splice(g,1),d("update:query-params",s())};return(g,t)=>(u(),F(e(we),{open:g.open,onCancel:t[1]||(t[1]=p=>d("close"))},{footer:r(()=>[a(e(T),{type:"primary",onClick:t[0]||(t[0]=p=>d("close"))},{default:r(()=>[_("OK")]),_:1})]),default:r(()=>[a(e(z),{vertical:"",gap:"20"},{default:r(()=>[a(e(U),null,{default:r(()=>[_("Query params")]),_:1}),(u(!0),f(B,null,be(y.value,(p,c)=>(u(),F(e(H),{key:c},{default:r(()=>[a(e(Ie),null,{default:r(()=>[a(e(M),{value:p.key,"onUpdate:value":V=>p.key=V,type:"text",placeholder:"name",onChange:()=>i(c,p.key,p.value)},null,8,["value","onUpdate:value","onChange"]),a(e(M),{value:p.value,"onUpdate:value":V=>p.value=V,type:"text",placeholder:"value",onChange:()=>i(c,p.key,p.value)},null,8,["value","onUpdate:value","onChange"]),a(e(T),{danger:"",onClick:V=>o(c)},{default:r(()=>[_("remove")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128)),a(e(H),null,{default:r(()=>[a(e(T),{type:"dashed",style:{width:"100%"},onClick:k},{default:r(()=>[_(" Add Query Param ")]),_:1})]),_:1})]),_:1})]),_:1},8,["open"]))}}),E0=P({__name:"FormEditor",setup(w){const d=_e(),l=ke(),y=new X(L.array(L.object({formId:L.string(),queryParams:L.record(L.string())})),"abstra:queryParams"),n=Z(null),s=Z(null),i=Z(null),k=Z(null),o=Z({}),g=A(()=>{var m;return(m=c.value)!=null&&m.form.hasChanges()?{title:"Unsaved changes",message:"Save the form before running the workflow"}:null}),t=(m,v)=>{var h,S;(S=(h=n.value)==null?void 0:h.code)==null||S.setHighlight(m,v)},p=()=>{var m,v,h,S;(v=(m=n.value)==null?void 0:m.code)==null||v.restartEditor(),(S=(h=n.value)==null?void 0:h.code)==null||S.startPreviewMode()},{result:c,loading:V,refetch:I}=$e(async()=>{const[m,v]=await Promise.all([Me.get(l.params.id),Ze.get()]),h=y.get();return h==null||h.map(S=>{S.formId===m.id&&(o.value=S.queryParams)}),Se({form:m,workspace:v})});Y([()=>o,c],()=>{G()});const ae=()=>{var h;if(q.value=!1,!c.value)return;const m=y.get()||[];if(!m.some(S=>{var R;return S.formId===((R=c.value)==null?void 0:R.form.id)})){y.set([...m,{formId:(h=c.value)==null?void 0:h.form.id,queryParams:o.value}]);return}y.set(m.map(S=>{var R;return S.formId===((R=c.value)==null?void 0:R.form.id)?{formId:S.formId,queryParams:o.value}:S}))};function j(){var v,h;if(!c.value)return;const m=c.value.form.codeContent;(h=(v=n.value)==null?void 0:v.code)==null||h.updateLocalEditorCode(m),G()}function G(){var v,h;if(!c.value)return;k.value=c.value.form.makeRunnerData(c.value.workspace),s.value=new ue({formRunnerData:k.value,logService:(h=(v=n.value)==null?void 0:v.logService)!=null?h:null,connectionManager:new de(c.value.form.id,"editor",o.value),onFormStart:p,onFormEnd:te,onRedirect:le,onStateUpdate:S=>i.value=S,onStackTraceUpdate:t});const m=s.value.getState();i.value=m.formState}const te=()=>{var m,v;(v=(m=n.value)==null?void 0:m.code)==null||v.restartEditor()};async function re(){var m,v,h,S;(m=n.value)==null||m.closeTerminal();try{await((v=c.value)==null?void 0:v.form.save()),j(),(h=n.value)==null||h.goToTestTab(),(S=s.value)==null||S.start()}catch{Ae.error({message:"Error saving"})}}function oe(){var m,v,h;(v=(m=n.value)==null?void 0:m.code)==null||v.restartEditor(),(h=s.value)==null||h.resetForm()}function le(m,v){He("editor",d,m,v)}const q=Z(!1),ne=()=>{var m;!!i.value&&D.includes((m=i.value)==null?void 0:m.type)||(q.value=!0)};return Y(()=>l.params.id,()=>{I()}),(m,v)=>(u(),f(B,null,[a(Fe,{ref_key:"editor",ref:n,stage:e(c).form,workspace:e(c).workspace,"stage-type":"forms","test-tab-name":"Preview","extra-tab":{key:"notifications",name:"Notifications"},"docs-path":"concepts/forms",onOnSave:j},{settings:r(()=>[a(mt,{form:e(c).form},null,8,["form"])]),test:r(()=>[a(ot,{"form-state":i.value,"form-runner-data":k.value,"is-loading":e(V),"disabled-warning":g.value,"current-path":e(c).form.path,"query-params":o.value,controller:s.value,onOpenQueryParamsModal:ne},null,8,["form-state","form-runner-data","is-loading","disabled-warning","current-path","query-params","controller"])]),"action-button":r(()=>[a(ut,{"form-state-type":i.value.type,"disabled-warning":null,"start-message":"Save & Start form",onStart:re,onReset:oe},null,8,["form-state-type"])]),notifications:r(()=>[a(et,{form:e(c).form},null,8,["form"])]),_:1},8,["stage","workspace"]),a(pt,{"query-params":o.value,"onUpdate:queryParams":v[0]||(v[0]=h=>o.value=h),open:q.value,onClose:ae},null,8,["query-params","open"])],64))}});export{E0 as default};
//# sourceMappingURL=FormEditor.3c73b2ee.js.map
