import{d as L,r as S,v as M,b as i,c as p,x as r,F as x,L as E,N as F,V as K,a0 as R,e as l,O as H,Q as W,q,K as A,z as t,t as k,w as f,D as U,H as z,J as G}from"./registerWidgets.4a0d8d45.js";import{L as J}from"./CircularLoading.0d3d2390.js";import{E as O}from"./Error.6e8bc0b8.js";import{R as Q,F as j}from"./broker.708dc0a3.js";import{R as X,_ as Y,S as Z}from"./UnsavedChangesHandler.vue_vue_type_script_setup_true_lang.7103a1e5.js";import{T as ee,B as te,a as B}from"./BackButton.e5212f45.js";import{l as P}from"./log.f9199108.js";import{a as T}from"./asyncComputed.52d81103.js";import{F as ae}from"./forms.cc593bbd.js";import{W as re}from"./workspaces.741b6616.js";import{S as se}from"./SaveButton.ce8cb5e4.js";import{P as oe}from"./PreviewButton.6e535bef.js";import"./passwordlessManager.60e6c76f.js";import"./icons.778999cd.js";import"./Passwordless.bf59d50c.js";import"./WidgetsFrame.9a65309e.js";import"./PlayerNavbar.94c81143.js";import"./index.aeb68571.js";import"./Modal.2f62582a.js";import"./dashes.96daa6d5.js";import"./activeRecord.57c6bf02.js";import"./runnerData.18839000.js";import"./hooks.d59fb935.js";import"./jobs.098bcb10.js";import"./login.29b4c1f1.js";import"./sentry.2692e5c6.js";const le="forms_workspace_id_path_key",I=u=>(H("data-v-6ccbe7b5"),u=u(),W(),u),ne={class:"form-settings"},ie={class:"content"},ce={class:"subsection-label"},ue={class:"property-label"},me=["value","placeholder","onChange"],pe={class:"content"},de={class:"property"},fe=I(()=>r("div",{class:"property-label"},"Start smart form automatically",-1)),_e={class:"property"},ve=I(()=>r("div",{class:"property-label"}," Allow the user to restart the smart form after it is over ",-1)),he=L({__name:"FormSettings",props:{form:null},setup(u){const a=S(u.form),m=[{label:"General",props:[{label:"Form name",valueKey:"title"}]},{label:"Welcome Screen",props:[{label:"Title",fallbackKey:"title",valueKey:"welcomeTitle"},{label:"Subtitle",valueKey:"startMessage"},{label:"Start button text",valueKey:"startButtonText"}]},{label:"Ending Screen",props:[{label:"Title",valueKey:"endMessage"},{label:"Restart button text",valueKey:"restartButtonText"}]},{label:"Alert Messages",props:[{label:"Error message",valueKey:"errorMessage"}]}],_=M({pathError:null,sectionsShown:[!0,!1,!1]}),y=d=>{d.detail.includes(le)&&(_.pathError=s)},s="This path is already being used by another form or dash on your workspace";return addEventListener("hasura-error",y),(d,c)=>(i(),p("div",ne,[r("div",ie,[(i(),p(x,null,E(m,o=>r("div",{key:o.label,class:"subsection"},[r("div",ce,F(o.label),1),(i(!0),p(x,null,E(o.props,n=>{var v;return i(),p("div",{key:n.label,class:"property column"},[r("div",ue,F(n.label),1),r("input",{class:"property-input",type:"text",value:a.value[n.valueKey],placeholder:(v=n.fallbackKey?a.value[n.fallbackKey]:null)!=null?v:"Enter message",onChange:b=>a.value[n.valueKey]=b.target.value},null,40,me)])}),128))])),64))]),r("div",pe,[r("div",de,[K(r("input",{"onUpdate:modelValue":c[0]||(c[0]=o=>a.value.autoStart=o),class:"checkbox-input",type:"checkbox"},null,512),[[R,a.value.autoStart]]),fe]),r("div",_e,[K(r("input",{"onUpdate:modelValue":c[1]||(c[1]=o=>a.value.allowRestart=o),class:"checkbox-input",type:"checkbox"},null,512),[[R,a.value.allowRestart]]),ve])]),l(X,{runtime:a.value},null,8,["runtime"])]))}});const ye=q(he,[["__scopeId","data-v-6ccbe7b5"]]),be={class:"page"},ge={key:1,class:"error"},ke=L({__name:"FormEditor",setup(u){const h=z(),a=G(),m=M({fullscreen:!1,rightPanelCollapsed:!1,hasChanges:!1,started:!1});addEventListener("keydown",e=>{(e.ctrlKey||e.metaKey)&&e.key==="s"&&(e.preventDefault(),v())});const _=S(null),{loading:y,result:s,error:d,refetch:c}=T(async()=>{const e=await ae.get(a.params.formPath);return g(),e}),{result:o}=T(()=>re.get()),n=S(!1);async function v(){var e;n.value=!0;try{await((e=s.value)==null?void 0:e.save())}finally{n.value=!1}}const b=A(()=>Q.create({isLocal:!1,formPath:a.params.formPath,isPreview:!0})),V=()=>{P.clear()},g=async()=>{var e;if(!m.started){(e=_.value)==null||e.run();return}P.log({type:"restart"}),m.started=!1},D=({path:e,type:w})=>{w==="dash"?h.push({name:"dashEditor",params:{dashPath:e},query:a.query}):(h.push({name:"editor",params:{formPath:e},query:a.query}),c())},N=()=>{m.started=!0},$=()=>{m.started=!1};return(e,w)=>{var C;return i(),p(x,null,[r("div",be,[t(y)||!t(s)||!t(o)?(i(),k(J,{key:0})):t(d)?(i(),p("div",ge,[l(O,{error:t(d),onReload:t(c)},null,8,["error","onReload"])])):(i(),k(ee,{key:2},{left:f(()=>[l(te,{link:"/_editor/forms"})]),right:f(()=>[l(oe,{model:t(s)},null,8,["model"]),l(se,{model:t(s)},null,8,["model"])]),default:f(()=>[l(B,{title:"Preview"},{default:f(()=>[l(j,{ref_key:"runner",ref:_,form:t(s).makeRunnerData(t(o)),params:t(a).query,"is-preview":!0,"enable-auto-focus":!1,broker:t(b),style:{height:"unset",flex:1,overflow:"hidden"},onNavigate:D,onLogout:g,onExit:$,onStart:N},null,8,["form","params","broker"])]),_:1}),l(B,{title:"Settings"},{default:f(()=>[l(ye,{form:t(s)},null,8,["form"])]),_:1})]),_:1})),t(s)?(i(),k(Z,{key:3,runtime:"forms",onRestart:g,onClearTerminal:V})):U("",!0)]),l(Y,{"has-changes":(C=t(s))==null?void 0:C.hasChanges()},null,8,["has-changes"])],64)}}});const Oe=q(ke,[["__scopeId","data-v-03f857e9"]]);export{Oe as default};
//# sourceMappingURL=FormEditor.7a155214.js.map
