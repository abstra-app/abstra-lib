var te=Object.defineProperty;var ae=(u,l,n)=>l in u?te(u,l,{enumerable:!0,configurable:!0,writable:!0,value:n}):u[l]=n;var O=(u,l,n)=>(ae(u,typeof l!="symbol"?l+"":l,n),n);import{C as le}from"./CrudView.aedd30be.js";import{a as U}from"./asyncComputed.48b98882.js";import{A as q}from"./constants.e94f5190.js";import{d as F,at as P,c as x,o as g,ac as h,ae as se,h as K,ed as ie,e as L,U as ne,ax as re,u as e,aY as oe,ej as de,a as M,b as a,f as s,g as r,t as o,i,de as v,cS as ce,S as ue,_ as Q,ei as pe,bY as R,dj as D,df as B,dd as E,d9 as _e,A as T,es as ge,et as fe,cM as me,eD as he,f7 as ye}from"./jwt-decode.esm.aec58354.js";import{k as N,o as W,r as Y}from"./router.7deddc24.js";import{a as ve,B as be}from"./build.d2a83787.js";import{a as we}from"./organization.6f1f72b0.js";import{a as ke}from"./project.2c28f544.js";import"./tables.dc554f59.js";import{g as Le}from"./datetime.014d3a5a.js";import{u as Se}from"./polling.7d3c0c81.js";import{_ as Ae,R as Ce}from"./repository.1662a6cd.js";import{G as Me}from"./PhArrowCounterClockwise.vue.974197b6.js";import{F as xe}from"./PhArrowSquareOut.vue.82832353.js";import{G as J}from"./PhChats.vue.bc12b69d.js";import{I as Ie}from"./PhCopySimple.vue.ce6cfe66.js";import"./DocsButton.vue_vue_type_script_setup_true_lang.60a32eb8.js";import"./url.ff97b2be.js";import"./PhDotsThreeVertical.vue.3a69ca0f.js";import"./index.8997472c.js";import"./index.6e906fa2.js";import"./record.433b7234.js";import"./string.dc72c110.js";import"./LoadingOutlined.423f91d1.js";(function(){try{var u=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},l=new Error().stack;l&&(u._sentryDebugIds=u._sentryDebugIds||{},u._sentryDebugIds[l]="8bc9f153-fe0e-4bdf-bd97-bc3ab3c6963a",u._sentryDebugIdIdentifier="sentry-dbid-8bc9f153-fe0e-4bdf-bd97-bc3ab3c6963a")}catch{}})();const Ze=["width","height","fill","transform"],je={key:0},$e=L("path",{d:"M227.85,46.89a20,20,0,0,0-18.74-18.74c-13.13-.77-46.65.42-74.48,28.24L131,60H74.36a19.83,19.83,0,0,0-14.14,5.86L25.87,100.19a20,20,0,0,0,11.35,33.95l37.14,5.18,42.32,42.32,5.19,37.18A19.88,19.88,0,0,0,135.34,235a20.13,20.13,0,0,0,6.37,1,19.9,19.9,0,0,0,14.1-5.87l34.34-34.35A19.85,19.85,0,0,0,196,181.64V125l3.6-3.59C227.43,93.54,228.62,60,227.85,46.89ZM76,84h31L75.75,115.28l-27.23-3.8ZM151.6,73.37A72.27,72.27,0,0,1,204,52a72.17,72.17,0,0,1-21.38,52.41L128,159,97,128ZM172,180l-27.49,27.49-3.8-27.23L172,149Zm-72,22c-8.71,11.85-26.19,26-60,26a12,12,0,0,1-12-12c0-33.84,14.12-51.32,26-60A12,12,0,1,1,68.18,175.3C62.3,179.63,55.51,187.8,53,203c15.21-2.51,23.37-9.3,27.7-15.18A12,12,0,1,1,100,202Z"},null,-1),De=[$e],Be={key:1},Ve=L("path",{d:"M184,120v61.65a8,8,0,0,1-2.34,5.65l-34.35,34.35a8,8,0,0,1-13.57-4.53L128,176ZM136,72H74.35a8,8,0,0,0-5.65,2.34L34.35,108.69a8,8,0,0,0,4.53,13.57L80,128ZM40,216c37.65,0,50.69-19.69,54.56-28.18L68.18,161.44C59.69,165.31,40,178.35,40,216Z",opacity:"0.2"},null,-1),ze=L("path",{d:"M223.85,47.12a16,16,0,0,0-15-15c-12.58-.75-44.73.4-71.41,27.07L132.69,64H74.36A15.91,15.91,0,0,0,63,68.68L28.7,103a16,16,0,0,0,9.07,27.16l38.47,5.37,44.21,44.21,5.37,38.49a15.94,15.94,0,0,0,10.78,12.92,16.11,16.11,0,0,0,5.1.83A15.91,15.91,0,0,0,153,227.3L187.32,193A15.91,15.91,0,0,0,192,181.64V123.31l4.77-4.77C223.45,91.86,224.6,59.71,223.85,47.12ZM74.36,80h42.33L77.16,119.52,40,114.34Zm74.41-9.45a76.65,76.65,0,0,1,59.11-22.47,76.46,76.46,0,0,1-22.42,59.16L128,164.68,91.32,128ZM176,181.64,141.67,216l-5.19-37.17L176,139.31Zm-74.16,9.5C97.34,201,82.29,224,40,224a8,8,0,0,1-8-8c0-42.29,23-57.34,32.86-61.85a8,8,0,0,1,6.64,14.56c-6.43,2.93-20.62,12.36-23.12,38.91,26.55-2.5,36-16.69,38.91-23.12a8,8,0,1,1,14.56,6.64Z"},null,-1),Pe=[Ve,ze],Re={key:2},Ee=L("path",{d:"M101.85,191.14C97.34,201,82.29,224,40,224a8,8,0,0,1-8-8c0-42.29,23-57.34,32.86-61.85a8,8,0,0,1,6.64,14.56c-6.43,2.93-20.62,12.36-23.12,38.91,26.55-2.5,36-16.69,38.91-23.12a8,8,0,1,1,14.56,6.64Zm122-144a16,16,0,0,0-15-15c-12.58-.75-44.73.4-71.4,27.07h0L88,108.7A8,8,0,0,1,76.67,97.39l26.56-26.57A4,4,0,0,0,100.41,64H74.35A15.9,15.9,0,0,0,63,68.68L28.7,103a16,16,0,0,0,9.07,27.16l38.47,5.37,44.21,44.21,5.37,38.49a15.94,15.94,0,0,0,10.78,12.92,16.11,16.11,0,0,0,5.1.83A15.91,15.91,0,0,0,153,227.3L187.32,193A16,16,0,0,0,192,181.65V155.59a4,4,0,0,0-6.83-2.82l-26.57,26.56a8,8,0,0,1-11.71-.42,8.2,8.2,0,0,1,.6-11.1l49.27-49.27h0C223.45,91.86,224.6,59.71,223.85,47.12Z"},null,-1),Te=[Ee],Ne={key:3},He=L("path",{d:"M221.86,47.24a14,14,0,0,0-13.11-13.1c-12.31-.73-43.77.39-69.88,26.5L133.52,66H74.35a13.9,13.9,0,0,0-9.89,4.1L30.11,104.44a14,14,0,0,0,7.94,23.76l39.13,5.46,45.16,45.16L127.8,218a14,14,0,0,0,23.76,7.92l34.35-34.35a13.91,13.91,0,0,0,4.1-9.89V122.48l5.35-5.35h0C221.46,91,222.59,59.56,221.86,47.24ZM38.11,115a2,2,0,0,1,.49-2L72.94,78.58A2,2,0,0,1,74.35,78h47.17L77.87,121.64l-38.14-5.32A1.93,1.93,0,0,1,38.11,115ZM178,181.65a2,2,0,0,1-.59,1.41L143.08,217.4a2,2,0,0,1-3.4-1.11l-5.32-38.16L178,134.48Zm8.87-73h0L128,167.51,88.49,128l58.87-58.88a78.47,78.47,0,0,1,60.69-23A2,2,0,0,1,209.88,48,78.47,78.47,0,0,1,186.88,108.64ZM100,190.31C95.68,199.84,81.13,222,40,222a6,6,0,0,1-6-6c0-41.13,22.16-55.68,31.69-60a6,6,0,1,1,5,10.92c-7,3.17-22.53,13.52-24.47,42.91,29.39-1.94,39.74-17.52,42.91-24.47a6,6,0,1,1,10.92,5Z"},null,-1),Ue=[He],Fe={key:4},Ge=L("path",{d:"M223.85,47.12a16,16,0,0,0-15-15c-12.58-.75-44.73.4-71.41,27.07L132.69,64H74.36A15.91,15.91,0,0,0,63,68.68L28.7,103a16,16,0,0,0,9.07,27.16l38.47,5.37,44.21,44.21,5.37,38.49a15.94,15.94,0,0,0,10.78,12.92,16.11,16.11,0,0,0,5.1.83A15.91,15.91,0,0,0,153,227.3L187.32,193A15.91,15.91,0,0,0,192,181.64V123.31l4.77-4.77C223.45,91.86,224.6,59.71,223.85,47.12ZM74.36,80h42.33L77.16,119.52,40,114.34Zm74.41-9.45a76.65,76.65,0,0,1,59.11-22.47,76.46,76.46,0,0,1-22.42,59.16L128,164.68,91.32,128ZM176,181.64,141.67,216l-5.19-37.17L176,139.31Zm-74.16,9.5C97.34,201,82.29,224,40,224a8,8,0,0,1-8-8c0-42.29,23-57.34,32.86-61.85a8,8,0,0,1,6.64,14.56c-6.43,2.93-20.62,12.36-23.12,38.91,26.55-2.5,36-16.69,38.91-23.12a8,8,0,1,1,14.56,6.64Z"},null,-1),Oe=[Ge],qe={key:5},We=L("path",{d:"M219.86,47.36a12,12,0,0,0-11.22-11.22c-12-.71-42.82.38-68.35,25.91L134.35,68h-60a11.9,11.9,0,0,0-8.48,3.52L31.52,105.85a12,12,0,0,0,6.81,20.37l39.79,5.55,46.11,46.11,5.55,39.81a12,12,0,0,0,20.37,6.79l34.34-34.35a11.9,11.9,0,0,0,3.52-8.48v-60l5.94-5.94C219.48,90.18,220.57,59.41,219.86,47.36ZM36.21,115.6a3.94,3.94,0,0,1,1-4.09L71.53,77.17A4,4,0,0,1,74.35,76h52L78.58,123.76,39.44,118.3A3.94,3.94,0,0,1,36.21,115.6ZM180,181.65a4,4,0,0,1-1.17,2.83l-34.35,34.34a4,4,0,0,1-6.79-2.25l-5.46-39.15L180,129.65Zm-52-11.31L85.66,128l60.28-60.29c23.24-23.24,51.25-24.23,62.22-23.58a3.93,3.93,0,0,1,3.71,3.71c.65,11-.35,39-23.58,62.22ZM98.21,189.48C94,198.66,80,220,40,220a4,4,0,0,1-4-4c0-40,21.34-54,30.52-58.21a4,4,0,0,1,3.32,7.28c-7.46,3.41-24.43,14.66-25.76,46.85,32.19-1.33,43.44-18.3,46.85-25.76a4,4,0,1,1,7.28,3.32Z"},null,-1),Ye=[We],Je={name:"PhRocketLaunch"},Ke=F({...Je,props:{weight:{type:String},size:{type:[String,Number]},color:{type:String},mirrored:{type:Boolean}},setup(u){const l=u,n=P("weight","regular"),A=P("size","1em"),C=P("color","currentColor"),I=P("mirrored",!1),y=x(()=>{var f;return(f=l.weight)!=null?f:n}),m=x(()=>{var f;return(f=l.size)!=null?f:A}),Z=x(()=>{var f;return(f=l.color)!=null?f:C}),j=x(()=>l.mirrored!==void 0?l.mirrored?"scale(-1, 1)":void 0:I?"scale(-1, 1)":void 0);return(f,b)=>(g(),h("svg",ie({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256",width:m.value,height:m.value,fill:Z.value,transform:j.value},f.$attrs),[se(f.$slots,"default"),y.value==="bold"?(g(),h("g",je,De)):y.value==="duotone"?(g(),h("g",Be,Pe)):y.value==="fill"?(g(),h("g",Re,Te)):y.value==="light"?(g(),h("g",Ne,Ue)):y.value==="regular"?(g(),h("g",Fe,Oe)):y.value==="thin"?(g(),h("g",qe,Ye)):K("",!0)],16,Ze))}}),Qe={key:0,class:"flex-row"},Xe={key:1,class:"flex-row"},e1={key:2,class:"flex-row"},t1=F({__name:"ExecutionsShort",props:{stageId:{},projectId:{}},emits:["select"],setup(u,{emit:l}){const n=u,A=new Ce,{result:C,refetch:I,loading:y}=U(async()=>{const{executions:b}=await A.list({projectId:n.projectId,stageId:n.stageId,limit:6});return b}),m=b=>{l("select",b)},Z=b=>Le(b,{weekday:void 0}),{startPolling:j,endPolling:f}=Se({task:I,interval:15e3});return ne(()=>j()),re(()=>f()),(b,$)=>e(C)?(g(),h("div",Qe,[(g(!0),h(oe,null,de(e(C),w=>(g(),M(e(ce),{key:w.id,title:Z(w.createdAt),onClick:G=>m(w)},{content:a(()=>[s(e(v),null,{default:a(()=>[r(o(e(i).translate("i18n_executions_short_status",null))+": "+o(w.status),1)]),_:2},1024),s(e(v),null,{default:a(()=>[r(o(e(i).translate("i18n_executions_short_duration",null))+": "+o(w.duration_seconds),1)]),_:2},1024),s(e(v),null,{default:a(()=>[r(o(e(i).translate("i18n_executions_short_version",null))+": "+o(w.buildId.slice(0,6)),1)]),_:2},1024)]),default:a(()=>[s(Ae,{status:w.status},null,8,["status"])]),_:2},1032,["title","onClick"]))),128))])):e(y)?(g(),h("div",Xe,[s(e(ue))])):(g(),h("div",e1,o(e(i).translate("i18n_executions_short_none",null)),1))}});const a1=Q(t1,[["__scopeId","data-v-827cc817"]]);class l1{async list(l){return N.get(`projects/${l}/disabled-stages`)}async disableStage({projectId:l,stageId:n}){return N.patch(`projects/${l}/disabled-stages/${n}`,{enable:!1})}async enableStage({projectId:l,stageId:n}){return N.patch(`projects/${l}/disabled-stages/${n}`,{enable:!0})}}const H=new l1;class V{constructor(l){O(this,"id");this.dto=l,this.id=l}static async list(l){return(await H.list(l)).map(A=>new V(A))}static async disableStage({projectId:l,stageId:n}){return H.disableStage({projectId:l,stageId:n})}static async enableStage({projectId:l,stageId:n}){return H.enableStage({projectId:l,stageId:n})}}const s1=u=>(ge("data-v-9891a85d"),u=u(),fe(),u),i1={style:{"max-width":"250px",overflow:"hidden","text-overflow":"ellipsis ellipsis","white-space":"nowrap"}},n1={key:1},r1=s1(()=>L("br",null,null,-1)),o1=F({__name:"Live",setup(u){const n=pe().params.projectId,A=()=>{var d;const t=(d=m.value)==null?void 0:d.project.getUrl();t&&window.open(t,"_blank")},C=x(()=>{var t;return(t=m==null?void 0:m.value)==null?void 0:t.organization.featureFlags.WEB_EDITOR}),I=t=>{Y.push({name:"logs",params:{projectId:n},query:{stageId:t.stageId,executionId:t.id}})},{loading:y,result:m}=U(async()=>{const[t,d]=await Promise.all([ke.get(n),ve.list(n)]),_=d.find(p=>p.latest),[c,k]=await Promise.all([_&&be.get(_.id),we.get(t.organizationId)]);return{buildSpec:c,project:t,organization:k}}),Z=t=>{var c;if(!("path"in t)||!t.path)return;const d=t.type==="form"?`/${t.path}`:`/_hooks/${t.path}`,_=(c=m.value)==null?void 0:c.project.getUrl(d);!_||(navigator.clipboard.writeText(_),me.success("Copied URL to clipboard"))},j=t=>t.type=="form"?`/${t.path}`:t.type=="hook"?`/_hooks/${t.path}`:t.type=="job"?`${t.schedule}`:"",{result:f,refetch:b}=U(async()=>(await V.list(n)).filter(d=>d)),$=t=>{var d;return(d=f.value)==null?void 0:d.map(_=>_.id).includes(t.id)},w=async t=>{$(t)?await V.enableStage({projectId:n,stageId:t.id}):await V.disableStage({projectId:n,stageId:t.id}),await b()},G=(t,d)=>{const[_,c,k]=t.split(".").map(Number),[p,S,z]=d.split(".").map(Number);return _>p?!0:_<p?!1:c>S?!0:c<S?!1:k>=z},X=t=>{var S,z;const d=$(t),_=d?he:ye,c=d?i.translate("i18n_live_enable_stage"):i.translate("i18n_live_disable_stage"),k="3.18.0",p=!G(((z=(S=m.value)==null?void 0:S.buildSpec)==null?void 0:z.abstraVersion)||"0.0.0",k);return{icon:_,label:c,onClick:()=>p?void 0:w(t),disabled:p,popoverMessage:p?`The Disable Stages feature is supported from version ${k} onward. Make sure to deploy your app in the latest version to use this feature.`:""}},ee=x(()=>{var _;const t=[{title:i.translate("i18n_live_type"),align:"left"},{title:i.translate("i18n_live_title"),align:"left"},{title:i.translate("i18n_live_trigger"),align:"left"},{title:i.translate("i18n_live_last_runs")},{title:"",align:"right"}],d=(_=m.value)==null?void 0:_.buildSpec;return d?{columns:t,rows:d.runtimes.map(c=>({key:c.id,cells:[{type:"tag",text:c.type==="script"?i.translate("i18n_live_tasklet"):c.type.charAt(0).toUpperCase()+c.type.slice(1),tagColor:"default"},{type:"slot",key:"title",payload:{runtime:c}},{type:"slot",key:"trigger",payload:{runtime:c}},{type:"slot",key:"last-runs",payload:{runtime:c}},{type:"actions",actions:[{icon:Me,label:i.translate("i18n_live_view_script_logs"),onClick:()=>Y.push({name:"logs",params:{projectId:n},query:{stageId:c.id}})},{icon:Ie,label:i.translate("i18n_live_copy_url"),onClick:()=>Z(c),hide:!["form","hook"].includes(c.type)},X(c)]}]}))}:{columns:t,rows:[]}});return(t,d)=>{var _,c,k;return e(y)||((k=(c=(_=e(m))==null?void 0:_.buildSpec)==null?void 0:c.runtimes.length)!=null?k:0)>0?(g(),M(le,{key:0,"empty-title":"","entity-name":"build",description:e(i).translate("i18n_live_description"),table:ee.value,loading:e(y),title:e(i).translate("i18n_live_live_view")},{description:a(()=>[s(e(D),{gap:"middle",style:{"margin-top":"12px"}},{default:a(()=>[s(e(R),{onClick:A},{default:a(()=>[r(o(e(i).translate("i18n_live_home")),1),s(e(xe),{class:"icon",size:16})]),_:1})]),_:1})]),title:a(({payload:p})=>{var S;return[L("div",i1,[p.runtime.type!="form"?(g(),M(e(B),{key:0,disabled:$(p.runtime)},{default:a(()=>[r(o(p.runtime.title),1)]),_:2},1032,["disabled"])):p.runtime.type=="form"?(g(),M(e(E),{key:1,href:(S=e(m))==null?void 0:S.project.getUrl(p.runtime.path),target:"_blank",disabled:$(p.runtime)},{default:a(()=>[r(o(p.runtime.title),1)]),_:2},1032,["href","disabled"])):K("",!0)])]}),"last-runs":a(({payload:p})=>[s(a1,{"stage-id":p.runtime.id,"project-id":e(n),onSelect:I},null,8,["stage-id","project-id"])]),trigger:a(({payload:p})=>[s(e(_e),{color:"default",class:"ellipsis"},{default:a(()=>[r(o(j(p.runtime)),1)]),_:2},1024)]),_:1},8,["description","table","loading","title"])):(g(),h("section",n1,[s(e(D),{gap:"middle",align:"center",justify:"center",vertical:!0,style:{height:"100%"}},{default:a(()=>[s(e(T),{style:{display:"flex","align-items":"center",gap:"5px"},level:2},{default:a(()=>[s(e(Ke),{size:"42",color:"#d14056"}),r(" "+o(e(i).translate("i18n_live_waiting_for_first_deploy")),1)]),_:1}),s(e(v),null,{default:a(()=>[r(o(e(i).translate("i18n_live_stages_appear_after_deploy")),1)]),_:1})]),_:1}),C.value?(g(),M(e(D),{key:0,gap:"middle",align:"center",justify:"center",vertical:!0,style:{height:"100%"}},{default:a(()=>[s(e(D),{vertical:"",gap:"small",align:"center",style:{width:"80%"}},{default:a(()=>[s(e(T),{level:5},{default:a(()=>[r(o(e(i).translate("i18n_live_start_with_abstra")),1)]),_:1}),s(e(v),null,{default:a(()=>[r(o(e(i).translate("i18n_live_install_editor"))+" ",1),s(e(B),{code:"",copyable:""},{default:a(()=>[r("pip install abstra")]),_:1})]),_:1}),s(e(v),null,{default:a(()=>[r(o(e(i).translate("i18n_live_run_editor"))+" ",1),s(e(B),{code:"",copyable:""},{default:a(()=>[r("abstra editor my-new-project")]),_:1})]),_:1})]),_:1}),s(e(v),null,{default:a(()=>[r(o(e(i).translate("i18n_live_check_documentation"))+" ",1),s(e(E),{href:e(q).DOCS,target:"_blank"},{default:a(()=>[r(o(e(i).translate("i18n_live_abstra_docs")),1)]),_:1},8,["href"])]),_:1}),s(e(v),null,{default:a(()=>[r(o(e(i).translate("i18n_live_feeling_lost"))+" ",1),s(e(R),{target:"_blank",type:"default",size:"small",onClick:d[0]||(d[0]=()=>e(W).showNewMessage("I need help getting started with Abstra"))},{default:a(()=>[s(e(J))]),_:1})]),_:1})]),_:1})):(g(),M(e(D),{key:1,gap:"middle",align:"center",justify:"center",vertical:!0,style:{height:"100%"}},{default:a(()=>[s(e(T),{style:{display:"flex","align-items":"center",gap:"5px"},level:4},{default:a(()=>[r(o(e(i).translate("i18n_live_set_up_local_environment")),1)]),_:1}),s(e(v),null,{default:a(()=>[r(o(e(i).translate("i18n_live_install_editor"))+" ",1),s(e(B),{code:"",copyable:""},{default:a(()=>[r("pip install abstra")]),_:1}),r1,r(" "+o(e(i).translate("i18n_live_run_editor"))+" ",1),s(e(B),{code:"",copyable:""},{default:a(()=>[r("abstra editor my-new-project")]),_:1})]),_:1}),s(e(v),null,{default:a(()=>[r(o(e(i).translate("i18n_live_check_documentation"))+" ",1),s(e(E),{href:e(q).DOCS,target:"_blank"},{default:a(()=>[r(o(e(i).translate("i18n_live_abstra_docs")),1)]),_:1},8,["href"])]),_:1}),s(e(v),null,{default:a(()=>[r(o(e(i).translate("i18n_live_feeling_lost"))+" ",1),s(e(R),{target:"_blank",type:"default",size:"small",onClick:d[1]||(d[1]=()=>e(W).showNewMessage("I need help getting started with Abstra"))},{default:a(()=>[s(e(J))]),_:1})]),_:1})]),_:1}))]))}}});const B1=Q(o1,[["__scopeId","data-v-9891a85d"]]);export{B1 as default};
//# sourceMappingURL=Live.a405cc34.js.map
