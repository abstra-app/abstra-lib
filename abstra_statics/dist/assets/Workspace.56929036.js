var X=Object.defineProperty;var Z=(a,e,t)=>e in a?X(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t;var d=(a,e,t)=>(Z(a,typeof e!="symbol"?e+"":e,t),t);import{f as l,ez as V,d as P,eA as q,eB as G,r as S,G as H,b as r,eu as _,a_ as A,eC as L,e as x,eD as I,ey as N,I as W,ew as w,c as b,w as s,u as o,t as C,eE as K,eF as ee,aq as v,bU as y,cA as te,ck as ae,o as ne,K as oe,cF as z,cB as se,a as re}from"./outputWidgets.5836624b.js";import{f as le,h as ie,j as ce,c as ue,m as de,p as pe,w as fe}from"./icons.715dfb53.js";import{T as _e}from"./Tooltip.858b8c8c.js";import{_ as me}from"./logo.084e5d7c.js";import{W as he}from"./workspaces.3319e1e1.js";import{l as B,_ as ge}from"./DocsButton.vue_vue_type_script_setup_true_lang.40200eef.js";import{p as be}from"./popupNotifcation.beae79eb.js";import{a as Y}from"./asyncComputed.134d378f.js";import{S as ye}from"./index.9dff36a8.js";import{B as ve}from"./index.1c4c3fb9.js";import{M}from"./transButton.c5f8a15c.js";import{A as we}from"./index.8d4f5f15.js";import{B as ke}from"./BaseLayout.9b7c0fae.js";import{c as xe}from"./index.c1743435.js";import"./record.07dfd257.js";import"./pubsub.a82123ee.js";import"./url.3b0a0ce2.js";import"./isNumeric.75337b1e.js";(function(){try{var a=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},e=new Error().stack;e&&(a._sentryDebugIds=a._sentryDebugIds||{},a._sentryDebugIds[e]="6a91aaef-a125-445b-86bb-de54011b4b69",a._sentryDebugIdIdentifier="sentry-dbid-6a91aaef-a125-445b-86bb-de54011b4b69")}catch{}})();var Oe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M865.3 244.7c-.3-.3-61.1 59.8-182.1 180.6l-84.9-84.9 180.9-180.9c-95.2-57.3-217.5-42.6-296.8 36.7A244.42 244.42 0 00419 432l1.8 6.7-283.5 283.4c-6.2 6.2-6.2 16.4 0 22.6l141.4 141.4c6.2 6.2 16.4 6.2 22.6 0l283.3-283.3 6.7 1.8c83.7 22.3 173.6-.9 236-63.3 79.4-79.3 94.1-201.6 38-296.6z"}}]},name:"tool",theme:"filled"};const Se=Oe;var Ae={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M464 720a48 48 0 1096 0 48 48 0 10-96 0zm16-304v184c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V416c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8zm475.7 440l-416-720c-6.2-10.7-16.9-16-27.7-16s-21.6 5.3-27.7 16l-416 720C56 877.4 71.4 904 96 904h832c24.6 0 40-26.6 27.7-48zm-783.5-27.9L512 239.9l339.8 588.2H172.2z"}}]},name:"warning",theme:"outlined"};const Le=Ae;function U(a){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},n=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(n=n.concat(Object.getOwnPropertySymbols(t).filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable}))),n.forEach(function(i){Ie(a,i,t[i])})}return a}function Ie(a,e,t){return e in a?Object.defineProperty(a,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):a[e]=t,a}var D=function(e,t){var n=U({},e,t.attrs);return l(V,U({},n,{icon:Se}),null)};D.displayName="ToolFilled";D.inheritAttrs=!1;const Pe=D;function R(a){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},n=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(n=n.concat(Object.getOwnPropertySymbols(t).filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable}))),n.forEach(function(i){$e(a,i,t[i])})}return a}function $e(a,e,t){return e in a?Object.defineProperty(a,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):a[e]=t,a}var F=function(e,t){var n=R({},e,t.attrs);return l(V,R({},n,{icon:Le}),null)};F.displayName="WarningOutlined";F.inheritAttrs=!1;const je=F,Be={class:"sidebar"},Ce={class:"section-name"},De=["onClick"],Fe={class:"item-name"},Te={key:0,class:"tag soon"},Ee={key:1,class:"tag beta"},Ne={key:2,class:"tag cloud"},We=P({__name:"Sidebar",setup(a){var m;const e=q(),t=G(),n=S((m=t.name)!=null?m:"forms"),i=H(()=>[{name:"Runtime",items:[{name:"Forms",icon:le,path:"forms"},{name:"Hooks",icon:ie,path:"hooks"},{name:"Jobs",icon:ce,path:"jobs",cloud:!0}]},{name:"Settings",items:[{name:"Style",icon:ue,path:"style"},{name:"Sidebar",icon:de,path:"sidebar"},{name:"Packages",icon:pe,path:"requirements"}]}]),p=h=>{h.unavailable||(e.push(h.path),n.value=h.path)};return(h,O)=>(r(),_("div",Be,[(r(!0),_(A,null,L(i.value,u=>(r(),_("div",{key:u.name,class:"section"},[x("span",Ce,I(u.name),1),(r(!0),_(A,null,L(u.items,c=>(r(),_("div",{key:c.name,role:"button",class:N(["item",{active:n.value===c.path,disabled:c.unavailable||u.cloud}]),tabindex:"0",onClick:f=>p(c)},[l(W,{class:N(["icon",{disabled:c.unavailable,active:n.value===c.path}]),path:c.icon,width:"20",height:"20"},null,8,["class","path"]),x("span",Fe,I(c.name),1),c.unavailable?(r(),_("span",Te,"SOON")):w("",!0),c.beta?(r(),_("span",Ee,"BETA")):w("",!0),c.cloud?(r(),_("span",Ne,"CLOUD")):w("",!0),c.warning?(r(),b(_e,{key:3,class:"warning",text:c.warning,fixed:!0,top:18,left:18},{default:s(()=>[l(W,{path:o(fe),fill:"#D35249",width:"20",height:"20"},null,8,["path"])]),_:2},1032,["text"])):w("",!0)],10,De))),128))]))),128))]))}});const ze=C(We,[["__scopeId","data-v-fe2ede96"]]);const Me={},J=a=>(K("data-v-81cd596e"),a=a(),ee(),a),Ue={class:"logo"},Re=J(()=>x("img",{src:me,alt:"Abstra cloud logo"},null,-1)),Ve=J(()=>x("span",null," Abstra ",-1)),qe=[Re,Ve];function Ge(a,e){return r(),_("div",Ue,qe)}const He=C(Me,[["render",Ge],["__scopeId","data-v-81cd596e"]]);class Ye{async check(){return(await fetch("/_editor/api/linters/check")).json()}async fix(e,t){if(!(await fetch(`/_editor/api/linters/fix/${e}/${t}`,{method:"POST"})).ok)throw new Error("Failed to fix")}}const Q=new Ye;class Je{constructor(e,t){d(this,"name");d(this,"label");d(this,"ruleName");this.name=e.name,this.label=e.label,this.ruleName=t}async fix(){await Q.fix(this.ruleName,this.name)}}class Qe{constructor(e,t){d(this,"label");d(this,"fixes");d(this,"rule");this.label=e.label,this.rule=t,this.fixes=e.fixes.map(n=>new Je(n,t.name))}}class T{constructor(e){d(this,"name");d(this,"label");d(this,"type");d(this,"issues");d(this,"valid");this.name=e.name,this.label=e.label,this.type=e.type,this.issues=e.issues.map(t=>new Qe(t,this)),this.valid=e.valid}static async check(){return(await Q.check()).map(t=>new T(t))}}const Xe=P({__name:"LoginBlock",setup(a){var j;const e="https://cloud.abstra.io/api-key?"+new URLSearchParams({redirect:location.href}),t=S(!1),n=(j=ye.instance)==null?void 0:j.deployEnabled,{loading:i,result:p,refetch:m}=Y(()=>B.get()),h=G(),O=q();function u(){const g=new URL(location.href);g.searchParams.delete("api-key"),O.replace(g.pathname+g.search)}function c(){var g;(g=p.value)!=null&&g.logged?M.success({title:"You're logged in!",content:"You can now deploy your project to Abstra Cloud."}):M.error({title:"Login failed",content:"Please try again. If the problem persists, contact help@abstra.io."})}const f=h.query["api-key"];typeof f=="string"&&B.create(f).then(m).then(u).then(c);async function $(){!p.value||(await B.delete(),m())}async function k(){if(!!p.value){t.value=!0;try{await he.deploy(),window.open(`https://cloud.abstra.io/projects/${p.value.logged&&p.value.project_id}/builds`,"_blank")}catch(g){be("Deploy failed",String(g))}t.value=!1}}return(g,et)=>{var E;return(E=o(p))!=null&&E.logged?(r(),b(o(ae),{key:0},{default:s(()=>[l(o(y),{href:`https://cloud.abstra.io/projects/${o(p).project_id}`,target:"_blank"},{default:s(()=>[v(" Go to console ")]),_:1},8,["href"]),!t.value&&o(n)?(r(),b(o(te),{key:0,title:"Are you sure you want to deploy this project to Abstra Cloud?",onConfirm:k},{default:s(()=>[l(o(y),null,{default:s(()=>[v("Deploy")]),_:1})]),_:1})):o(n)?(r(),b(o(y),{key:1,loading:""},{default:s(()=>[v("Deploying")]),_:1})):w("",!0),l(o(y),{onClick:$},{default:s(()=>[v("Logout")]),_:1})]),_:1})):(r(),b(o(y),{key:1,href:e,loading:o(i),disabled:o(i)},{default:s(()=>[v(" Login to deploy ")]),_:1},8,["loading","disabled"]))}}});const Ze=C(Xe,[["__scopeId","data-v-7b8037ee"]]),Ke=P({__name:"Linter",setup(a){const{result:e,refetch:t}=Y(()=>T.check()),n=H(()=>{var u,c;return(c=(u=e.value)==null?void 0:u.flatMap(f=>f.issues))!=null?c:[]}),i=S(!1);async function p(u){i.value=!0;try{await u.fix(),t()}finally{i.value=!1}}const m=S(!1);function h(){setTimeout(async()=>{await t(),m.value&&h()},1e3)}ne(()=>{m.value=!0,h()}),oe(()=>{m.value=!1});function O(u){return u.type==="bug"?"warning":u.type==="security"?"error":"info"}return(u,c)=>n.value.length>0?(r(),b(o(se),{key:0},{content:s(()=>[l(o(z),{direction:"vertical"},{default:s(()=>[(r(!0),_(A,null,L(n.value,(f,$)=>(r(),b(o(we),{key:$+f.rule.name,type:O(f.rule),style:{width:"400px"},message:f.rule.label},{description:s(()=>[l(o(z),{direction:"vertical"},{default:s(()=>[x("div",null,I(f.label),1),(r(!0),_(A,null,L(f.fixes,k=>(r(),b(o(y),{key:k.name,loading:i.value,disabled:i.value,onClick:j=>p(k)},{icon:s(()=>[l(o(Pe))]),default:s(()=>[v(" "+I(k.label),1)]),_:2},1032,["loading","disabled","onClick"]))),128))]),_:2},1024)]),_:2},1032,["type","message"]))),128))]),_:1})]),default:s(()=>[l(o(ve),{count:n.value.length},{default:s(()=>[l(o(y),null,{default:s(()=>[l(o(je))]),_:1})]),_:1},8,["count"])]),_:1})):w("",!0)}}),vt=P({__name:"Workspace",setup(a){return(e,t)=>{const n=re("router-view");return r(),b(ke,null,{navbar:s(()=>[l(o(xe),{style:{padding:"5px 10px"}},{title:s(()=>[l(He)]),extra:s(()=>[l(Ke),l(ge),l(Ze)]),_:1})]),sidebar:s(()=>[l(ze,{class:"sidebar"})]),content:s(()=>[l(n)]),_:1})}}});export{vt as default};
//# sourceMappingURL=Workspace.56929036.js.map
