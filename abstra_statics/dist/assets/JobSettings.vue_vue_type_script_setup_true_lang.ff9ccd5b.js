import{d as F,r as k,b as y,er as b,f as c,w as u,b0 as m,u as n,cb as R,H as N,o as G,G as H,ad as T,cQ as I,bu as A,ez as $,c as _,eA as U,c4 as J,cD as D,eu as P,J as W}from"./registerWidgets.9a15db03.js";import{f as E,T as M}from"./dayjs.a8ba4c0c.js";import{A as B}from"./FormItem.54e743df.js";import{R as q}from"./SmartConsole.3fc4db0a.js";import{A as z}from"./Title.4a08927d.js";import{F as L}from"./Form.46586f85.js";(function(){try{var v=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},h=new Error().stack;h&&(v._sentryDebugIds=v._sentryDebugIds||{},v._sentryDebugIds[h]="e2db7c26-482f-4b16-9597-23a861196f23",v._sentryDebugIdIdentifier="sentry-dbid-e2db7c26-482f-4b16-9597-23a861196f23")}catch{}})();const le=F({__name:"JobTester",props:{job:{},logService:{}},setup(v,{expose:h}){const d=v,r=k(!1);async function t(){r.value=!0;try{const{stdout:s,stderr:f}=await d.job.test();d.logService.log({type:"stdout",log:s}),d.logService.log({type:"stderr",log:f})}finally{r.value=!1}}return h({test:t}),(s,f)=>(y(),b("div",null,[c(n(R),{loading:r.value,onClick:t},{default:u(()=>[m("run")]),_:1},8,["loading"])]))}}),Q=()=>[...Array(31).keys()].map(v=>v+1),O={0:"Sunday",1:"Monday",2:"Tuesday",3:"Wednesday",4:"Thursday",5:"Friday",6:"Saturday"},K=["hourly","daily","weekly","monthly"],X={hourly:{minute:"0",hour:"*",day:"*",month:"*",weekday:"*"},daily:{minute:"0",hour:"6",day:"*",month:"*",weekday:"*"},weekly:{minute:"0",hour:"6",day:"*",month:"*",weekday:"1"},monthly:{minute:"0",hour:"6",day:"1",month:"*",weekday:"*"}},Y=F({__name:"CronEditor",props:{crontab:{}},emits:["changeCrontab","saveCrontab","showAdvancedSettings"],setup(v,{emit:h}){const d=v,r=N(()=>{const a=t.hour,o=t.minute;return E(`${a}:${o}:00`,"HH:mm:ss")});G(()=>{const{hour:a,day:o,weekday:i,month:p,minute:C}=d.crontab;p=="*"&&i==="*"&&o!=="*"&&!l([o,a,C])?s.value="monthly":p==="*"&&o==="*"&&i!=="*"&&!l([i,a,C])?s.value="weekly":o==="*"&&i==="*"&&p==="*"&&a!=="*"&&!l([a,C])?s.value="daily":a=="*"&&o==="*"&&i==="*"&&p==="*"&&!l([C])?s.value="hourly":s.value="custom"});const t=H({minute:d.crontab.minute,hour:d.crontab.hour,day:d.crontab.day,month:d.crontab.month,weekday:d.crontab.weekday}),s=k(""),f=k(1),l=a=>a.some(o=>o.includes("-")||o.includes(",")),w=a=>{t.minute=a.minute,t.hour=a.hour,t.day=a.day,t.month=a.month,t.weekday=a.weekday},g=a=>{f.value=0,s.value=a,w(X[s.value]),h("changeCrontab",t)},j=a=>{f.value=0,t.minute=a,h("changeCrontab",t)},e=a=>{const o=E(a);t.minute=o.minute().toString(),t.hour=o.hour().toString(),h("changeCrontab",t)},S=a=>{f.value=0;const o=a;t.weekday=o,h("changeCrontab",t)},x=a=>{f.value=0;const o=a;t.day=o,h("changeCrontab",t)};return(a,o)=>(y(),b(A,null,[c(n(B),{title:"Recurrence"},{default:u(()=>[c(n(T),{placeholder:"Choose a periodicity",value:s.value,"onUpdate:value":g},{default:u(()=>[m(" > "),c(n(I),{value:"",disabled:"",hidden:""},{default:u(()=>[m("Custom")]),_:1}),(y(!0),b(A,null,$(n(K),(i,p)=>(y(),_(n(I),{key:p,value:i},{default:u(()=>[m(U(i),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),c(n(B),null,{default:u(()=>[s.value==="hourly"?(y(),_(n(J),{key:0,value:t.minute,"onUpdate:value":j},{addonBefore:u(()=>[m(" at ")]),addonAfter:u(()=>[m(" minutes ")]),_:1},8,["value"])):s.value==="daily"?(y(),_(n(D),{key:1},{default:u(()=>[c(n(M),{value:r.value,"show-second":!1,"onUpdate:value":e},null,8,["value"])]),_:1})):s.value==="weekly"?(y(),_(n(D),{key:2},{default:u(()=>[m(" on "),c(n(T),{style:{width:"200px"},value:Object.values(n(O))[parseInt(t.weekday)],"onUpdate:value":S},{default:u(()=>[(y(!0),b(A,null,$(n(O),(i,p)=>(y(),_(n(I),{key:p,value:p,selected:i===Object.values(n(O))[parseInt(t.weekday)]},{default:u(()=>[m(U(i),1)]),_:2},1032,["value","selected"]))),128))]),_:1},8,["value"]),m(" at "),c(n(M),{value:r.value,"show-second":!1,"onUpdate:value":e},null,8,["value"])]),_:1})):s.value==="monthly"?(y(),_(n(D),{key:3},{default:u(()=>[m(" on "),c(n(T),{value:parseInt(t.day),"onUpdate:value":x},{default:u(()=>[(y(!0),b(A,null,$(n(Q)(),(i,p)=>(y(),_(n(I),{key:p,value:i},{default:u(()=>[m(U(i),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"]),m(" at "),c(n(M),{value:r.value,"show-second":!1,"onUpdate:value":e},null,8,["value"])]),_:1})):P("",!0)]),_:1})],64))}}),oe=F({__name:"JobSettings",props:{job:{}},setup(v){const h=v,d=k(!1),r=k(h.job),t=()=>{d.value=!d.value},s=()=>{d.value=!1},f=e=>({weekday:e.split(" ")[4],month:e.split(" ")[3],day:e.split(" ")[2],hour:e.split(" ")[1],minute:e.split(" ")[0]}),l=H(f(r.value.schedule)),w=N(()=>`${l.minute} ${l.hour} ${l.day} ${l.month} ${l.weekday}`),g=e=>{l.minute==e.minute&&l.hour==e.hour&&l.day==e.day&&l.month==e.month&&l.weekday==e.weekday||(l.minute=e.minute,l.hour=e.hour,l.day=e.day,l.month=e.month,l.weekday=e.weekday,r.value.schedule=w.value)},j=e=>{e?(r.value.schedule=e,Object.assign(l,f(e))):r.value.schedule=w.value,s()};return W(()=>r.value.schedule,e=>{g({minute:e.split(" ")[0],hour:e.split(" ")[1],day:e.split(" ")[2],month:e.split(" ")[3],weekday:e.split(" ")[4]})}),(e,S)=>(y(),_(n(L),{class:"schedule-editor",layout:"vertical"},{default:u(()=>[c(n(B),{label:"Name",required:""},{default:u(()=>[c(n(J),{value:r.value.title,"onUpdate:value":S[0]||(S[0]=x=>r.value.title=x)},null,8,["value"])]),_:1}),c(q,{runtime:r.value},null,8,["runtime"]),c(n(z),{level:3},{default:u(()=>[m("Schedule")]),_:1}),c(Y,{class:"recurrence-settings",crontab:l,onChangeCrontab:g,onSaveCrontab:j,onShowAdvancedSettings:t},null,8,["crontab"])]),_:1}))}});export{le as _,oe as a};
//# sourceMappingURL=JobSettings.vue_vue_type_script_setup_true_lang.ff9ccd5b.js.map
