import{d as v,o as x,a0 as S,u as t,b as p,ev as _,bq as j,eC as C,c as w,w as a,f as o,aq as l,eD as h,cy as A,bg as B,v as T,eB as D,G as E,cC as L}from"./outputWidgets.21bbcff1.js";import{a as k}from"./asyncComputed.e9b58baf.js";import{r as $}from"./router.2820c665.js";import{B as P,a as V}from"./build.f217c9f5.js";import"./index.492bb477.js";import{P as q}from"./project.f4593ecc.js";import{C as R}from"./CrudView.7d3749e0.js";import{Q as N}from"./icons.8c1a3aa6.js";import{_ as M,E as F}from"./ExecutionStatusIcon.vue_vue_type_script_setup_true_lang.1620f13d.js";import{A as I}from"./Title.cfd1fb62.js";import{A as m}from"./Text.192b7616.js";import{A as G}from"./Link.58aec639.js";import"./FormItem.72c7e0f5.js";import"./hasIn.e0cb731c.js";import"./index.179e1961.js";import"./index.cf4c23b9.js";import"./record.9f045685.js";import"./pubsub.8056e5e5.js";import"./Form.a94c2c06.js";import"./Modal.69a3e3bf.js";import"./DocsButton.vue_vue_type_script_setup_true_lang.94a7306d.js";import"./url.35859e56.js";import"./index.2b5e3bc8.js";import"./index.cf01b44a.js";import"./CheckCircleFilled.882d7322.js";(function(){try{var d=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},u=new Error().stack;u&&(d._sentryDebugIds=d._sentryDebugIds||{},d._sentryDebugIds[u]="a0df74ab-5546-465c-bfcb-cad0d85a2cfe",d._sentryDebugIdIdentifier="sentry-dbid-a0df74ab-5546-465c-bfcb-cad0d85a2cfe")}catch{}})();const Q={key:0,class:"flex-row"},U={key:1,class:"flex-row"},z={key:2,class:"flex-row"},H=v({__name:"ExecutionsShort",props:{stageId:{},projectId:{}},emits:["select"],setup(d,{emit:u}){const c=d,y=new F,{result:f,refetch:g,loading:b}=k(async()=>{const{executions:r}=await y.list({projectId:c.projectId,stageId:c.stageId,limit:6});return r}),e=r=>{u("select",r)};let i=null;return x(()=>{i=setInterval(()=>g(),15e3)}),S(()=>{i&&clearInterval(i)}),(r,s)=>t(f)?(p(),_("div",Q,[(p(!0),_(j,null,C(t(f),n=>(p(),w(t(A),{key:n.id,title:n.createdAt.toLocaleString(),onClick:O=>e(n)},{content:a(()=>[o(t(I),null,{default:a(()=>[l("Status: "+h(n.status),1)]),_:2},1024),o(t(I),null,{default:a(()=>[l("Duration: "+h(n.duration_seconds)+" s",1)]),_:2},1024),o(t(I),null,{default:a(()=>[l("Build: "+h(n.buildId.slice(0,6)),1)]),_:2},1024)]),default:a(()=>[o(M,{status:n.status},null,8,["status"])]),_:2},1032,["title","onClick"]))),128))])):t(b)?(p(),_("div",U,[o(t(B))])):(p(),_("div",z,"None"))}});const J=T(H,[["__scopeId","data-v-dc7e11a2"]]),K={key:1},vt=v({__name:"Live",setup(d){const c=D().params.projectId,{loading:y,result:f}=k(async()=>{const i=(await P.list(c)).find(n=>n.latest);if(!i)return null;const[r,s]=await Promise.all([V.get(i.id),q.get(c)]);return{buildSpec:r,project:s}}),g=e=>e.type=="form"?`/${e.path}`:e.type=="hook"?`/_hooks/${e.path}`:e.type=="job"?`${e.schedule}`:"",b=E(()=>{var r;const e=[{name:"Id"},{name:"Type",align:"left"},{name:"Title",align:"left"},{name:"Trigger",align:"left"},{name:"Last Runs"},{name:"",align:"right"}],i=(r=f.value)==null?void 0:r.buildSpec;return i?{columns:e,rows:i.runtimes.map(s=>({key:s.id,cells:[{type:"text",text:s.id.slice(0,8)},{type:"text",text:s.type},{type:"text",text:s.title},{type:"text",text:g(s),secondary:!0,code:!0},{type:"slot",key:"last-runs",payload:{runtime:s}},{type:"actions",actions:[{icon:N,label:"View script logs",onClick:()=>$.push({name:"logs",params:{projectId:c},query:{runtimeId:s.id}})}]}]}))}:{columns:e,rows:[]}});return(e,i)=>{var r,s;return t(y)||((s=(r=t(f))==null?void 0:r.buildSpec.runtimes.length)!=null?s:0)>0?(p(),w(R,{key:0,"empty-title":"__empty_title","entity-name":"build",description:"Access and monitor your project's current scripts here.",table:b.value,loading:t(y),title:"Live View"},{"last-runs":a(({payload:n})=>[o(J,{"stage-id":n.runtime.id,"project-id":t(c)},null,8,["stage-id","project-id"])]),_:1},8,["table","loading"])):(p(),_("div",K,[o(t(L),{direction:"vertical"},{default:a(()=>[o(t(m),null,{default:a(()=>[l("Install abstra using pip:")]),_:1}),o(t(m),{code:"",copyable:""},{default:a(()=>[l("pip install abstra")]),_:1}),o(t(m),null,{default:a(()=>[l("Start a new project using our CLI")]),_:1}),o(t(m),{code:"",copyable:""},{default:a(()=>[l("abstra serve my-new-project")]),_:1}),o(t(m),null,{default:a(()=>[l(" If you have any questions, please reach out to our "),o(t(G),{href:"https://discord.gg/abstra",target:"_blank"},{default:a(()=>[l(" discord channel ")]),_:1})]),_:1})]),_:1})]))}}});export{vt as default};
//# sourceMappingURL=Live.54125ad0.js.map
