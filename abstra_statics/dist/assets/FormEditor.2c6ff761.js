import{P as Te}from"./PlayerNavbar.a123bdb2.js";import{u as Ve}from"./index.0243ba6f.js";import{d as R,a0 as U,y as T,b as d,eq as k,dv as ne,es as x,ev as se,e as b,o as He,N as $e,c as S,w as t,f as a,u as e,co as ue,E as D,r as A,cM as E,ak as f,cI as Z,ce as M,bq as F,cd as ie,aw as de,ew as pe,ex as ce,bt as le,bz as H,eA as Ie,cQ as N,eF as Ue,ey as Re,ap as Ee,O as oe,L as Le,z as Be,B as Ze,cL as Ne,eC as De,bc as Pe,cr as ze,cJ as We,aA as L,f0 as Oe}from"./outputWidgets.fd23be41.js";import{B as je}from"./BaseLayout.87b56e8a.js";import{R as qe,E as Qe,S as Ge,a as Je,L as Ke}from"./SourceCode.b1c330fe.js";import{F as B,a as Ye,b as Xe,c as ea,d as aa,r as ta}from"./FormRunner.fc8f8ec5.js";import{A as j}from"./api.0b4b2b88.js";import{a as la}from"./asyncComputed.1151ee43.js";import{F as oa}from"./PhArrowSquareOut.vue.3a969ee0.js";import{G as ra}from"./PhFlowArrow.vue.6adab8b6.js";import{F as na}from"./metadata.caed30ad.js";import{W as q}from"./workspaces.1feacdf3.js";import{F as sa}from"./forms.02fd92b9.js";import{S as ua}from"./SaveButton.e8ad593e.js";import{T as ia}from"./ThreadSelector.50dfe5aa.js";import{A as ve}from"./index.b93e1c91.js";import{A as re}from"./index.a1f431b5.js";import{A as da}from"./index.3fc5d928.js";import{N as pa}from"./NavbarControls.4097dab9.js";import{b as ca}from"./index.0c47ac36.js";import{A as O,T as va}from"./TabPane.38da95b0.js";import{B as ma}from"./Badge.7b0c9dc7.js";import{A as fa}from"./index.3ac7603f.js";import"./PhSignOut.vue.08444aa0.js";import"./index.688d3200.js";import"./fetch.882c0e5f.js";import"./pubsub.35617498.js";import"./uuid.d7d06b95.js";import"./PhCaretRight.vue.593810ec.js";import"./editor.602ad8eb.js";import"./runnerData.62f32f7a.js";import"./url.003e3fc2.js";import"./record.f44b1b8b.js";import"./PhCheckCircle.vue.df4319d4.js";import"./PhCopySimple.vue.854662b8.js";import"./LoadingOutlined.c884eb16.js";import"./jobs.cc589a38.js";import"./scripts.4676e77d.js";import"./validations.bd678296.js";import"./string.d499de72.js";import"./PhPencil.vue.0b1a177b.js";import"./toggleHighContrast.c9f59506.js";import"./Card.4c6d2170.js";import"./Login.vue_vue_type_script_setup_true_lang.c9b18f55.js";import"./CircularLoading.e1c27de0.js";import"./PhArrowClockwise.vue.679f0207.js";import"./WidgetsFrame.ae61396c.js";import"./Steps.498ed953.js";import"./Watermark.f73a6c2d.js";import"./PhKanban.vue.4031cbe0.js";import"./PhScroll.vue.0a8d7122.js";import"./PhWebhooksLogo.vue.a290f3e3.js";import"./UnsavedChangesHandler.ed2e9fb4.js";import"./ExclamationCircleOutlined.0dcadd7b.js";import"./index.2128c658.js";import"./CloseCircleOutlined.3ea20838.js";import"./popupNotifcation.e639286b.js";import"./DocsButton.vue_vue_type_script_setup_true_lang.e857aa07.js";import"./BookOutlined.aefca60a.js";import"./PhChats.vue.14290151.js";import"./isNumeric.75337b1e.js";(function(){try{var g=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},v=new Error().stack;v&&(g._sentryDebugIds=g._sentryDebugIds||{},g._sentryDebugIds[v]="cc0f5fc2-725c-4acd-9903-77c1f48d5503",g._sentryDebugIdIdentifier="sentry-dbid-cc0f5fc2-725c-4acd-9903-77c1f48d5503")}catch{}})();const ga=["width","height","fill","transform"],ha={key:0},ya=b("path",{d:"M228,48V96a12,12,0,0,1-12,12H168a12,12,0,0,1,0-24h19l-7.8-7.8a75.55,75.55,0,0,0-53.32-22.26h-.43A75.49,75.49,0,0,0,72.39,75.57,12,12,0,1,1,55.61,58.41a99.38,99.38,0,0,1,69.87-28.47H126A99.42,99.42,0,0,1,196.2,59.23L204,67V48a12,12,0,0,1,24,0ZM183.61,180.43a75.49,75.49,0,0,1-53.09,21.63h-.43A75.55,75.55,0,0,1,76.77,179.8L69,172H88a12,12,0,0,0,0-24H40a12,12,0,0,0-12,12v48a12,12,0,0,0,24,0V189l7.8,7.8A99.42,99.42,0,0,0,130,226.06h.56a99.38,99.38,0,0,0,69.87-28.47,12,12,0,0,0-16.78-17.16Z"},null,-1),_a=[ya],ka={key:1},ba=b("path",{d:"M216,128a88,88,0,1,1-88-88A88,88,0,0,1,216,128Z",opacity:"0.2"},null,-1),wa=b("path",{d:"M224,48V96a8,8,0,0,1-8,8H168a8,8,0,0,1,0-16h28.69L182.06,73.37a79.56,79.56,0,0,0-56.13-23.43h-.45A79.52,79.52,0,0,0,69.59,72.71,8,8,0,0,1,58.41,61.27a96,96,0,0,1,135,.79L208,76.69V48a8,8,0,0,1,16,0ZM186.41,183.29a80,80,0,0,1-112.47-.66L59.31,168H88a8,8,0,0,0,0-16H40a8,8,0,0,0-8,8v48a8,8,0,0,0,16,0V179.31l14.63,14.63A95.43,95.43,0,0,0,130,222.06h.53a95.36,95.36,0,0,0,67.07-27.33,8,8,0,0,0-11.18-11.44Z"},null,-1),Sa=[ba,wa],Aa={key:2},xa=b("path",{d:"M224,48V96a8,8,0,0,1-8,8H168a8,8,0,0,1-5.66-13.66L180.65,72a79.48,79.48,0,0,0-54.72-22.09h-.45A79.52,79.52,0,0,0,69.59,72.71,8,8,0,0,1,58.41,61.27,96,96,0,0,1,192,60.7l18.36-18.36A8,8,0,0,1,224,48ZM186.41,183.29A80,80,0,0,1,75.35,184l18.31-18.31A8,8,0,0,0,88,152H40a8,8,0,0,0-8,8v48a8,8,0,0,0,13.66,5.66L64,195.3a95.42,95.42,0,0,0,66,26.76h.53a95.36,95.36,0,0,0,67.07-27.33,8,8,0,0,0-11.18-11.44Z"},null,-1),Ca=[xa],Ma={key:3},Fa=b("path",{d:"M222,48V96a6,6,0,0,1-6,6H168a6,6,0,0,1,0-12h33.52L183.47,72a81.51,81.51,0,0,0-57.53-24h-.46A81.5,81.5,0,0,0,68.19,71.28a6,6,0,1,1-8.38-8.58,93.38,93.38,0,0,1,65.67-26.76H126a93.45,93.45,0,0,1,66,27.53l18,18V48a6,6,0,0,1,12,0ZM187.81,184.72a81.5,81.5,0,0,1-57.29,23.34h-.46a81.51,81.51,0,0,1-57.53-24L54.48,166H88a6,6,0,0,0,0-12H40a6,6,0,0,0-6,6v48a6,6,0,0,0,12,0V174.48l18,18.05a93.45,93.45,0,0,0,66,27.53h.52a93.38,93.38,0,0,0,65.67-26.76,6,6,0,1,0-8.38-8.58Z"},null,-1),Ta=[Fa],Va={key:4},Ha=b("path",{d:"M224,48V96a8,8,0,0,1-8,8H168a8,8,0,0,1,0-16h28.69L182.06,73.37a79.56,79.56,0,0,0-56.13-23.43h-.45A79.52,79.52,0,0,0,69.59,72.71,8,8,0,0,1,58.41,61.27a96,96,0,0,1,135,.79L208,76.69V48a8,8,0,0,1,16,0ZM186.41,183.29a80,80,0,0,1-112.47-.66L59.31,168H88a8,8,0,0,0,0-16H40a8,8,0,0,0-8,8v48a8,8,0,0,0,16,0V179.31l14.63,14.63A95.43,95.43,0,0,0,130,222.06h.53a95.36,95.36,0,0,0,67.07-27.33,8,8,0,0,0-11.18-11.44Z"},null,-1),$a=[Ha],Ia={key:5},Ua=b("path",{d:"M220,48V96a4,4,0,0,1-4,4H168a4,4,0,0,1,0-8h38.34L184.89,70.54A84,84,0,0,0,66.8,69.85a4,4,0,1,1-5.6-5.72,92,92,0,0,1,129.34.76L212,86.34V48a4,4,0,0,1,8,0ZM189.2,186.15a83.44,83.44,0,0,1-58.68,23.91h-.47a83.52,83.52,0,0,1-58.94-24.6L49.66,164H88a4,4,0,0,0,0-8H40a4,4,0,0,0-4,4v48a4,4,0,0,0,8,0V169.66l21.46,21.45A91.43,91.43,0,0,0,130,218.06h.51a91.45,91.45,0,0,0,64.28-26.19,4,4,0,1,0-5.6-5.72Z"},null,-1),Ra=[Ua],Ea={name:"PhArrowsClockwise"},La=R({...Ea,props:{weight:{type:String},size:{type:[String,Number]},color:{type:String},mirrored:{type:Boolean}},setup(g){const v=g,o=U("weight","regular"),y=U("size","1em"),n=U("color","currentColor"),l=U("mirrored",!1),r=T(()=>{var i;return(i=v.weight)!=null?i:o}),w=T(()=>{var i;return(i=v.size)!=null?i:y}),V=T(()=>{var i;return(i=v.color)!=null?i:n}),m=T(()=>v.mirrored!==void 0?v.mirrored?"scale(-1, 1)":void 0:l?"scale(-1, 1)":void 0);return(i,_)=>(d(),k("svg",se({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256",width:w.value,height:w.value,fill:V.value,transform:m.value},i.$attrs),[ne(i.$slots,"default"),r.value==="bold"?(d(),k("g",ha,_a)):r.value==="duotone"?(d(),k("g",ka,Sa)):r.value==="fill"?(d(),k("g",Aa,Ca)):r.value==="light"?(d(),k("g",Ma,Ta)):r.value==="regular"?(d(),k("g",Va,$a)):r.value==="thin"?(d(),k("g",Ia,Ra)):x("",!0)],16,ga))}}),Ba=["width","height","fill","transform"],Za={key:0},Na=b("path",{d:"M200,36H56A20,20,0,0,0,36,56V200a20,20,0,0,0,20,20H200a20,20,0,0,0,20-20V56A20,20,0,0,0,200,36Zm-4,160H60V60H196Z"},null,-1),Da=[Na],Pa={key:1},za=b("path",{d:"M208,56V200a8,8,0,0,1-8,8H56a8,8,0,0,1-8-8V56a8,8,0,0,1,8-8H200A8,8,0,0,1,208,56Z",opacity:"0.2"},null,-1),Wa=b("path",{d:"M200,40H56A16,16,0,0,0,40,56V200a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V56A16,16,0,0,0,200,40Zm0,160H56V56H200V200Z"},null,-1),Oa=[za,Wa],ja={key:2},qa=b("path",{d:"M216,56V200a16,16,0,0,1-16,16H56a16,16,0,0,1-16-16V56A16,16,0,0,1,56,40H200A16,16,0,0,1,216,56Z"},null,-1),Qa=[qa],Ga={key:3},Ja=b("path",{d:"M200,42H56A14,14,0,0,0,42,56V200a14,14,0,0,0,14,14H200a14,14,0,0,0,14-14V56A14,14,0,0,0,200,42Zm2,158a2,2,0,0,1-2,2H56a2,2,0,0,1-2-2V56a2,2,0,0,1,2-2H200a2,2,0,0,1,2,2Z"},null,-1),Ka=[Ja],Ya={key:4},Xa=b("path",{d:"M200,40H56A16,16,0,0,0,40,56V200a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V56A16,16,0,0,0,200,40Zm0,160H56V56H200V200Z"},null,-1),et=[Xa],at={key:5},tt=b("path",{d:"M200,44H56A12,12,0,0,0,44,56V200a12,12,0,0,0,12,12H200a12,12,0,0,0,12-12V56A12,12,0,0,0,200,44Zm4,156a4,4,0,0,1-4,4H56a4,4,0,0,1-4-4V56a4,4,0,0,1,4-4H200a4,4,0,0,1,4,4Z"},null,-1),lt=[tt],ot={name:"PhStop"},rt=R({...ot,props:{weight:{type:String},size:{type:[String,Number]},color:{type:String},mirrored:{type:Boolean}},setup(g){const v=g,o=U("weight","regular"),y=U("size","1em"),n=U("color","currentColor"),l=U("mirrored",!1),r=T(()=>{var i;return(i=v.weight)!=null?i:o}),w=T(()=>{var i;return(i=v.size)!=null?i:y}),V=T(()=>{var i;return(i=v.color)!=null?i:n}),m=T(()=>v.mirrored!==void 0?v.mirrored?"scale(-1, 1)":void 0:l?"scale(-1, 1)":void 0);return(i,_)=>(d(),k("svg",se({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256",width:w.value,height:w.value,fill:V.value,transform:m.value},i.$attrs),[ne(i.$slots,"default"),r.value==="bold"?(d(),k("g",Za,Da)):r.value==="duotone"?(d(),k("g",Pa,Oa)):r.value==="fill"?(d(),k("g",ja,Qa)):r.value==="light"?(d(),k("g",Ga,Ka)):r.value==="regular"?(d(),k("g",Ya,et)):r.value==="thin"?(d(),k("g",at,lt)):x("",!0)],16,Ba))}}),nt=R({__name:"ThreadSelectorModal",props:{showThreadModal:{type:Boolean},stage:{},executionConfig:{}},emits:["fix-invalid-json","update:execution-config","update:show-thread-modal"],setup(g,{emit:v}){const o=()=>{v("update:show-thread-modal",!1),q.writeTestData(y.threadData)};He(async()=>y.threadData=await q.readTestData());const y=$e({threadData:"{}"});return(n,l)=>(d(),S(e(ue),{open:n.showThreadModal,footer:null,onCancel:o},{default:t(()=>[a(ia,{stage:n.stage,"execution-config":n.executionConfig,"onUpdate:executionConfig":l[0]||(l[0]=r=>v("update:execution-config",r)),"onUpdate:showThreadModal":l[1]||(l[1]=r=>v("update:show-thread-modal",r)),onFixInvalidJson:l[2]||(l[2]=r=>v("fix-invalid-json",r,r))},null,8,["stage","execution-config"])]),_:1},8,["open"]))}});const st=D(nt,[["__scopeId","data-v-541d30a8"]]),me=g=>(pe("data-v-a8ca44f6"),g=g(),ce(),g),ut=me(()=>b("i",null,"string",-1)),it=me(()=>b("i",null,"string list",-1)),dt=R({__name:"FormNotificationSettings",props:{form:{}},setup(g){const o=A(g.form);return(y,n)=>(d(),k(de,null,[a(e(ie),{layout:"vertical"},{default:t(()=>[a(e(E),{level:4,width:"100%",height:"30px",style:{display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"0px"}},{default:t(()=>[f(" Thread waiting "),a(e(ve),{checked:o.value.notificationTrigger.enabled,"onUpdate:checked":n[0]||(n[0]=l=>o.value.notificationTrigger.enabled=l)},{default:t(()=>[f(" Enabled ")]),_:1},8,["checked"])]),_:1}),a(e(Z),{class:"description",style:{fontStyle:"italic",marginBottom:"20px"}},{default:t(()=>[f(" Send emails when the thread is waiting for the form to be filled ")]),_:1}),a(e(M),{label:"Variable name"},{default:t(()=>[a(e(F),{value:o.value.notificationTrigger.variable_name,"onUpdate:value":n[1]||(n[1]=l=>o.value.notificationTrigger.variable_name=l),disabled:!o.value.notificationTrigger.enabled,type:"text",placeholder:"variable_name"},null,8,["value","disabled"])]),_:1})]),_:1}),a(e(re),{type:"info"},{message:t(()=>[a(e(Z),null,{default:t(()=>[f(" Notifications are sent to the emails specified in the thread variables set here. The variables should contain a "),ut,f(" or a "),it,f(". ")]),_:1})]),_:1}),a(e(re),{style:{"margin-top":"20px"}},{message:t(()=>[a(e(Z),null,{default:t(()=>[f(" Notifications are a paid feature. Talk to your account manager to enable them. ")]),_:1})]),_:1})],64))}});const pt=D(dt,[["__scopeId","data-v-a8ca44f6"]]),ct=R({__name:"FormSettings",props:{form:{}},setup(g){const o=A(g.form);return(y,n)=>(d(),S(e(ie),{layout:"vertical",class:"form-settings"},{default:t(()=>[a(qe,{runtime:o.value},null,8,["runtime"]),a(e(M),{label:"Form name"},{default:t(()=>[a(e(F),{value:o.value.title,"onUpdate:value":n[0]||(n[0]=l=>o.value.title=l),type:"text",onChange:n[1]||(n[1]=l=>{var r;return o.value.title=(r=l.target.value)!=null?r:""})},null,8,["value"])]),_:1}),a(e(E),{level:3},{default:t(()=>[f(" Texts ")]),_:1}),a(e(E),{level:4},{default:t(()=>[f(" Welcome Screen ")]),_:1}),a(e(M),{label:"Title"},{default:t(()=>[a(e(F),{value:o.value.welcomeTitle,"onUpdate:value":n[2]||(n[2]=l=>o.value.welcomeTitle=l),type:"text",placeholder:o.value.title,disabled:o.value.autoStart},null,8,["value","placeholder","disabled"])]),_:1}),a(e(M),{label:"Description"},{default:t(()=>[a(e(F),{value:o.value.startMessage,"onUpdate:value":n[3]||(n[3]=l=>o.value.startMessage=l),type:"text",disabled:o.value.autoStart},null,8,["value","disabled"])]),_:1}),a(e(M),{label:"Start button label"},{default:t(()=>[a(e(F),{value:o.value.startButtonText,"onUpdate:value":n[4]||(n[4]=l=>o.value.startButtonText=l),type:"text",placeholder:"Start",disabled:o.value.autoStart},null,8,["value","disabled"])]),_:1}),a(e(M),null,{default:t(()=>[a(e(le),{checked:o.value.autoStart,"onUpdate:checked":n[5]||(n[5]=l=>o.value.autoStart=l)},{default:t(()=>[f("Skip welcome screen")]),_:1},8,["checked"])]),_:1}),a(e(E),{level:4},{default:t(()=>[f(" End Screen ")]),_:1}),a(e(M),{label:"End text"},{default:t(()=>[a(e(F),{value:o.value.endMessage,"onUpdate:value":n[6]||(n[6]=l=>o.value.endMessage=l),type:"text",placeholder:"Thank you"},null,8,["value"])]),_:1}),a(e(M),{label:"Restart button label"},{default:t(()=>[a(e(F),{value:o.value.restartButtonText,"onUpdate:value":n[7]||(n[7]=l=>o.value.restartButtonText=l),placeholder:"Restart",type:"text",disabled:!o.value.allowRestart},null,8,["value","disabled"])]),_:1}),a(e(M),{help:!o.value.isInitial&&"Only initial forms can be restarted"},{default:t(()=>[a(e(le),{checked:o.value.allowRestart,"onUpdate:checked":n[8]||(n[8]=l=>o.value.allowRestart=l),disabled:!o.value.isInitial},{default:t(()=>[f("Show restart button at the end")]),_:1},8,["checked","disabled"])]),_:1},8,["help"]),a(e(E),{level:4},{default:t(()=>[f(" Alert Messages ")]),_:1}),a(e(M),{label:"Error message"},{default:t(()=>[a(e(F),{value:o.value.errorMessage,"onUpdate:value":n[9]||(n[9]=l=>o.value.errorMessage=l),type:"text",placeholder:"Something went wrong"},null,8,["value"])]),_:1})]),_:1}))}});const vt=D(ct,[["__scopeId","data-v-596854dc"]]),mt=R({__name:"QueryParamsModal",props:{open:{type:Boolean},close:{type:Function},queryParams:{}},emits:["update:query-params"],setup(g,{emit:v}){const y=A(n(g.queryParams));function n(m){return Object.entries(m).map(([i,_])=>({key:i,value:_,id:Math.random().toString()}))}function l(){const m={};return y.value.forEach(({key:i,value:_})=>{m[i]=_}),m}const r=(m,i,_)=>{y.value[m]={key:i,value:_},v("update:query-params",l())},w=()=>{const m=y.value.length;y.value.push({key:`param-${m}`,value:"value"}),v("update:query-params",l())},V=m=>{y.value.splice(m,1),v("update:query-params",l())};return(m,i)=>(d(),S(e(ue),{open:m.open,onCancel:m.close},{footer:t(()=>[a(e(H),{type:"primary",onClick:m.close},{default:t(()=>[f("OK")]),_:1},8,["onClick"])]),default:t(()=>[a(e(N),{vertical:"",gap:"20"},{default:t(()=>[a(e(Z),null,{default:t(()=>[f("Query params")]),_:1}),(d(!0),k(de,null,Ie(y.value,(_,c)=>(d(),S(e(M),{key:c},{default:t(()=>[a(e(da),null,{default:t(()=>[a(e(F),{value:_.key,"onUpdate:value":$=>_.key=$,type:"text",placeholder:"name",onChange:()=>r(c,_.key,_.value)},null,8,["value","onUpdate:value","onChange"]),a(e(F),{value:_.value,"onUpdate:value":$=>_.value=$,type:"text",placeholder:"value",disabled:_.key===e(j),onChange:()=>r(c,_.key,_.value)},null,8,["value","onUpdate:value","disabled","onChange"]),a(e(H),{danger:"",onClick:$=>V(c)},{default:t(()=>[f("remove")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128)),a(e(M),null,{default:t(()=>[a(e(H),{type:"dashed",style:{width:"100%"},onClick:w},{default:t(()=>[f(" Add Query Param ")]),_:1})]),_:1})]),_:1})]),_:1},8,["open","onCancel"]))}}),ft=g=>(pe("data-v-9fd3a1cf"),g=g(),ce(),g),gt={key:0},ht={key:1},yt=ft(()=>b("br",null,null,-1)),_t={class:"form-preview-container"},kt=R({__name:"FormEditor",setup(g){var Y;const v=Ue(),o=Re(),y=A(null),n=A("source-code"),l=A(null),r=A(null),w=A(null),V=A(null),m=A({}),i=A(!1),_=u=>c.value={...c.value,attached:!!u},c=A({attached:!1,stageRunId:null,pendingFork:!1,isInitial:!1}),$=T(()=>{var u;return(u=h.value)!=null&&u.form.hasChanges()?{title:"Unsaved changes",message:"Save the form before running the workflow"}:c.value.attached&&c.value.pendingFork?{title:"Past thread selected",message:"Fork the selected thread to run the workflow"}:!c.value.isInitial&&c.value.attached&&!c.value.stageRunId?{title:"No thread selected",message:"Select a thread to run the workflow"}:null}),fe=(u,s)=>{var p;(p=y.value)==null||p.setHighlight(u,s)},ge=()=>{var u,s;(u=y.value)==null||u.restartEditor(),(s=y.value)==null||s.startPreviewMode()},he=T(()=>!c.value.isInitial&&c.value.attached&&!!(c.value.pendingFork||!c.value.stageRunId));Ee(()=>c.value.stageRunId?m.value={...m.value,[j]:c.value.stageRunId}:null);const{result:h,loading:ye,refetch:_e}=la(async()=>{const[u,s]=await Promise.all([sa.get(o.params.id),q.get()]);return c.value.isInitial=u.isInitial,Ze({form:u,workspace:s})});oe([()=>c.value.attached,m,h],()=>{Q()});function Q(){if(!h.value)return;const u=!c.value.attached;w.value=h.value.form.makeRunnerData(h.value.workspace),l.value&&l.value.clearListeners(),l.value=new ea({formRunnerData:w.value,userManager:Ve,logService:J,connectionManager:new aa(h.value.form.id,"editor",m.value,u),onFormStart:ge,onFormEnd:ke,onRedirect:xe,onAuthUpdate:p=>V.value=p,onStateUpdate:p=>r.value=p,onStackTraceUpdate:fe});const s=l.value.getState();r.value=s.formState,V.value=s.passwordlessUser}const ke=()=>{var u,s,p;c.value={attached:!1,stageRunId:null,pendingFork:!1,isInitial:(s=(u=h.value)==null?void 0:u.form.isInitial)!=null?s:!1},(p=y.value)==null||p.restartEditor()},be=()=>{var u;(u=l.value)==null||u.logout()};function we(){var u,s;(u=P.value)==null||u.closeConsole(),(s=l.value)==null||s.start()}function G(){var u,s;(u=y.value)==null||u.restartEditor(),(s=l.value)==null||s.reset()}function Se(){v.push({name:"stages"})}const P=A(null),Ae=u=>{!h.value||(h.value.form.file=u)},J=Ke.create();function xe(u,s){ta("editor",v,u,s)}const Ce=()=>{var p;let u=`/${(p=h.value)==null?void 0:p.form.path}`;const s=new URLSearchParams(m.value);c.value.attached&&c.value.stageRunId&&s.set(j,c.value.stageRunId),window.open(`${u}?${s.toString()}`,"_blank")},z=A(!1),Me=T(()=>{if(!w.value)return"";const u=Object.entries(m.value),s="?"+u.map(([C,I])=>`${C}=${I}`).join("&"),p=u.length?s:"";return`/${w.value.path}${p}`}),K=new Le(Be.boolean(),"dontShowReloadHelper"),W=A((Y=K.get())!=null?Y:!1),Fe=()=>{K.set(!0),W.value=!0};return oe(()=>o.params.id,()=>{_e()}),(u,s)=>(d(),S(je,null,{navbar:t(()=>[e(h)?(d(),S(e(ca),{key:0,title:e(h).form.title,style:{padding:"5px 25px",border:"1px solid #f6f6f6"},onBack:Se},{extra:t(()=>[a(pa,{"docs-path":"concepts/forms","show-save-button":!1,"editing-model":e(h).form},null,8,["editing-model"])]),_:1},8,["title"])):x("",!0)]),content:t(()=>[e(h)?(d(),S(Qe,{key:0},{left:t(()=>[a(e(va),{"active-key":n.value,"onUpdate:activeKey":s[0]||(s[0]=p=>n.value=p)},{rightExtra:t(()=>[a(ua,{model:e(h).form,onSave:Q},null,8,["model"])]),default:t(()=>[a(e(O),{key:"source-code",tab:"Source code"}),a(e(O),{key:"settings",tab:"Settings"}),a(e(O),{key:"notifications",tab:"Notifications"})]),_:1},8,["active-key"]),n.value==="source-code"?(d(),S(Ge,{key:0,ref_key:"code",ref:y,script:e(h).form,workspace:e(h).workspace,onUpdateFile:Ae},null,8,["script","workspace"])):x("",!0),n.value==="settings"?(d(),S(vt,{key:1,form:e(h).form},null,8,["form"])):x("",!0),n.value==="notifications"?(d(),S(pt,{key:2,form:e(h).form},null,8,["form"])):x("",!0),i.value?(d(),S(st,{key:3,"execution-config":c.value,"onUpdate:executionConfig":s[1]||(s[1]=p=>c.value=p),"show-thread-modal":i.value,"onUpdate:showThreadModal":s[2]||(s[2]=p=>i.value=p),stage:e(h).form,onFixInvalidJson:s[3]||(s[3]=(p,C)=>{var I;return(I=P.value)==null?void 0:I.fixJson(p,C)})},null,8,["execution-config","show-thread-modal","stage"])):x("",!0)]),right:t(()=>[a(e(N),{gap:"10",align:"center",justify:"right",style:{"margin-top":"6px"}},{default:t(()=>{var p;return[a(e(Ne),null,{default:t(()=>[f(De(c.value.attached?"Workflow ON":"Workflow OFF"),1)]),_:1}),a(e(ve),{disabled:!!r.value&&e(B).includes((p=r.value)==null?void 0:p.type),checked:c.value.attached,"onUpdate:checked":_},null,8,["disabled","checked"]),a(e(ma),{dot:he.value},{default:t(()=>{var C;return[a(e(H),{disabled:!!r.value&&e(B).includes((C=r.value)==null?void 0:C.type),style:{display:"flex",gap:"5px"},onClick:s[4]||(s[4]=I=>i.value=!0)},{icon:t(()=>[a(e(ra),{size:"20"})]),default:t(()=>[f("Thread")]),_:1},8,["disabled"])]}),_:1},8,["dot"])]}),_:1}),a(e(fa),{style:{margin:"7px 0px 16px"}}),e(ye)||!w.value||!r.value?(d(),S(e(Pe),{key:0})):x("",!0),r.value&&w.value?(d(),S(e(N),{key:1,vertical:"",gap:"10",style:{height:"100%",overflow:"hidden"}},{default:t(()=>{var p,C,I,X,ee,ae;return[a(e(N),{gap:"small"},{default:t(()=>[r.value.type&&e(Ye).includes(r.value.type)?(d(),S(e(ze),{key:0,placement:"bottom",open:W.value?void 0:!0},{content:t(()=>[W.value?(d(),k("span",gt,"Reload form")):(d(),k("span",ht,[f(" You can reload the form here"),yt,a(e(We),{onClick:Fe},{default:t(()=>[f("Don't show this again")]),_:1})]))]),default:t(()=>[a(e(H),{disabled:!!$.value,onClick:G},{default:t(()=>[a(e(La),{size:"20"})]),_:1},8,["disabled"])]),_:1},8,["open"])):x("",!0),e(B).includes(r.value.type)?(d(),S(e(L),{key:1,placement:"bottom"},{title:t(()=>[f("Stop form")]),default:t(()=>[a(e(H),{onClick:G},{default:t(()=>[a(e(rt),{size:"20"})]),_:1})]),_:1})):x("",!0),r.value.type==="waiting"?(d(),S(e(L),{key:2,placement:"bottom"},{title:t(()=>[f("Start form")]),default:t(()=>[a(e(H),{disabled:!!$.value,onClick:we},{default:t(()=>[a(e(Oe),{size:"20"})]),_:1},8,["disabled"])]),_:1})):x("",!0),a(e(F),{disabled:"",value:Me.value},null,8,["value"]),a(e(L),{placement:"bottom"},{title:t(()=>[f("Edit query params")]),default:t(()=>{var te;return[a(e(H),{disabled:!!r.value&&e(B).includes((te=r.value)==null?void 0:te.type),onClick:s[5]||(s[5]=bt=>z.value=!0)},{default:t(()=>[a(e(na),{size:"20"})]),_:1},8,["disabled"])]}),_:1}),a(e(L),{placement:"bottom"},{title:t(()=>[f("Open in Full Screen")]),default:t(()=>[a(e(H),{target:"_blank","aria-label":"Open in Full Screen","aria-describedby":"sss",disabled:!c.value.attached,onClick:Ce},{default:t(()=>[a(e(oa),{size:"20"})]),_:1},8,["disabled"])]),_:1})]),_:1}),b("div",_t,[a(Te,{"runner-data":w.value,"user-email":(p=V.value)==null?void 0:p.claims.email,"current-path":e(h).form.path,"hide-login":!0,onLogout:be},null,8,["runner-data","user-email","current-path"]),a(Xe,{"is-preview":"",class:"runner","form-runner-data":w.value,disabled:$.value,"form-state":r.value,"user-email":(C=V.value)==null?void 0:C.claims.email,onUpdateWidgetErrors:(I=l.value)==null?void 0:I.updateWidgetFrontendErrors,onUpdateWidgetValue:(X=l.value)==null?void 0:X.updateWidgetValue,onActionClicked:(ee=l.value)==null?void 0:ee.handleActionClick,onAutoFillClicked:(ae=l.value)==null?void 0:ae.handleAutofillClick},null,8,["form-runner-data","disabled","form-state","user-email","onUpdateWidgetErrors","onUpdateWidgetValue","onActionClicked","onAutoFillClicked"])])]}),_:1})):x("",!0),a(mt,{"query-params":m.value,"onUpdate:queryParams":s[6]||(s[6]=p=>m.value=p),open:z.value,close:()=>z.value=!1},null,8,["query-params","open","close"])]),_:1})):x("",!0)]),footer:t(()=>{var p,C;return[a(Je,{ref_key:"smartConsole",ref:P,"stage-type":"forms","log-service":e(J),stage:(p=e(h))==null?void 0:p.form,workspace:(C=e(h))==null?void 0:C.workspace},null,8,["log-service","stage","workspace"])]}),_:1}))}});const Tl=D(kt,[["__scopeId","data-v-9fd3a1cf"]]);export{Tl as default};
//# sourceMappingURL=FormEditor.2c6ff761.js.map
