var m=Object.defineProperty;var v=(t,e,i)=>e in t?m(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i;var r=(t,e,i)=>(v(t,typeof e!="symbol"?e+"":e,i),i);import{d as _,k as w,j as y,a as l,b as a,o as c,f as n,u as s,dc as h,A as I,g as d,d8 as u,cM as b,ev as P,ew as x,e as f,_ as A,r as W,ed as j}from"./jwt-decode.esm.f1188273.js";import{_ as k}from"./AbstraLogo.vue_vue_type_script_setup_true_lang.b4bd4d96.js";import{B as T}from"./BaseLayout.3a7277a2.js";import{l as g}from"./fetch.542c99d3.js";import"./router.3268f6a9.js";import{P as R}from"./project.11c64e67.js";import"./tables.29a33ac6.js";import"./Logo.529e7b17.js";import"./index.3f0fddde.js";import"./record.fb6be7da.js";import"./string.d399176a.js";(function(){try{var t=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},e=new Error().stack;e&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[e]="c003a430-96fa-4a0e-a747-d5f4d25f5c08",t._sentryDebugIdIdentifier="sentry-dbid-c003a430-96fa-4a0e-a747-d5f4d25f5c08")}catch{}})();const U=t=>(P("data-v-2536661a"),t=t(),x(),t),E=U(()=>f("div",{class:"video-container"},[f("iframe",{class:"responsive-iframe",src:"https://www.youtube.com/embed/videoseries?list=PLFPJgKA6K86ZdAHZ3aPWsrZHX_7jJ3Cc9&autoplay=1&mute=1",frameborder:"0",allow:"autoplay; picture-in-picture;",referrerpolicy:"strict-origin-when-cross-origin",allowfullscreen:""})],-1)),S=_({__name:"View",props:{controller:{}},setup(t){const e=t,i=e.controller.loadingPercentage();return w(()=>{e.controller.start()}),y(()=>{e.controller.cleanUp()}),(o,p)=>(c(),l(T,null,{content:a(()=>[n(s(h),{align:"center",justify:"center",style:{width:"100vw",height:"100dvh"}},{default:a(()=>[n(s(h),{gap:"large",align:"center",vertical:"",style:{width:"45%","min-width":"600px"}},{default:a(()=>[n(k,{size:"large"}),E,n(s(I),{level:3},{default:a(()=>[d("Preparing your environment")]),_:1}),s(i)<100?(c(),l(s(u),{key:0},{default:a(()=>[d("We are setting things up... This may take up to 1 minute.")]),_:1})):(c(),l(s(u),{key:1},{default:a(()=>[d("You will be redirected soon")]),_:1})),n(s(b),{size:[10,10],"show-info":!1,percent:s(i),"stroke-color":"#EA576A"},null,8,["percent"])]),_:1})]),_:1})]),_:1}))}});const V=A(S,[["__scopeId","data-v-2536661a"]]);class B{constructor(e,i,o=g){r(this,"projectId");r(this,"loading");r(this,"fetch",g);r(this,"interval",null);r(this,"urls",null);r(this,"totalWaitTime");r(this,"poolingInterval");r(this,"pingResponded",!1);r(this,"redirectPath");this.projectId=e,this.loading=W(0),this.fetch=o,this.totalWaitTime=6e4,this.poolingInterval=2500,this.redirectPath=i}increment(){this.loading.value+=100/(this.totalWaitTime/this.poolingInterval)}speedUp(){this.totalWaitTime=5e3,this.poolingInterval=500,this.interval&&clearInterval(this.interval),this.interval=setInterval(async()=>{this.increment(),this.loading.value>=100&&this.navigate()},this.poolingInterval)}navigate(){if(this.urls){const e=new URLSearchParams;this.redirectPath&&e.set("redirect",this.redirectPath),window.location.replace(this.urls.redirect+"?"+e.toString())}this.cleanUp()}async ping(){if(!this.urls)return!1;if(this.pingResponded)return!0;const e=await this.fetch(this.urls.ping,{signal:AbortSignal.timeout(500)});return this.pingResponded=e.status===200,this.pingResponded}async start(){const e=await R.startWebEditor(this.projectId);this.urls=e,this.interval=setInterval(async()=>{this.increment(),this.pingResponded||await this.ping()&&this.speedUp(),this.loading.value>=100&&this.navigate()},this.poolingInterval)}cleanUp(){this.interval&&clearInterval(this.interval)}loadingPercentage(){return this.loading}}const Y=_({__name:"WebEditor",setup(t){const e=j(),i=e.params.projectId,o=e.query.redirect,p=new B(i,o);return(C,D)=>(c(),l(V,{controller:s(p)},null,8,["controller"]))}});export{Y as default};
//# sourceMappingURL=WebEditor.53ee7add.js.map
