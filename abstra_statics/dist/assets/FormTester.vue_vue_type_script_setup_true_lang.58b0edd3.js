import{d as N,r as E,H as $,b as d,c as _,w as l,f as a,et as k,eB as C,e as M,aT as y,eC as W,u as e,bq as P,c2 as A,c3 as U,J as D,K as H,ez as j,c9 as x,eN as z,bN as G}from"./outputWidgets.75a5b0b9.js";import{R as J}from"./SmartConsole.c35b14e7.js";import{c as O,A as c}from"./Title.b6c9692d.js";import{F as Q}from"./Form.2c716183.js";import{W as X}from"./workspaces.f47922e6.js";import{R as Y,F as Z}from"./broker.6112f7bc.js";import{a as ee}from"./asyncComputed.c701d7b0.js";import{r as ae}from"./index.a1ee75ca.js";import{_ as te}from"./StageRunSelector.vue_vue_type_script_setup_true_lang.4674e54d.js";import{k as re}from"./icons.c04528be.js";import"./index.e9ba5796.js";import{C as le,A as oe}from"./CollapsePanel.46ee4c6b.js";import{A as I}from"./index.5e9c5434.js";import{A as ne}from"./index.4598445f.js";(function(){try{var m=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},g=new Error().stack;g&&(m._sentryDebugIds=m._sentryDebugIds||{},m._sentryDebugIds[g]="1bf196a5-f665-478a-a6c6-e9362b48500c",m._sentryDebugIdIdentifier="sentry-dbid-1bf196a5-f665-478a-a6c6-e9362b48500c")}catch{}})();const se="forms_workspace_id_path_key",ue="This path is already being used by another form or dash on your workspace",Ce=N({__name:"FormSettings",props:{form:{}},setup(m){const r=E(m.form),n=[{label:"General",props:[{label:"Form name",valueKey:"title"}]},{label:"Welcome Screen",props:[{label:"Title",valueKey:"welcomeTitle"},{label:"Subtitle",valueKey:"startMessage"},{label:"Start button text",valueKey:"startButtonText"}]},{label:"Ending Screen",props:[{label:"Title",valueKey:"endMessage"},{label:"Restart button text",valueKey:"restartButtonText"}]},{label:"Alert Messages",props:[{label:"Error message",valueKey:"errorMessage"}]}],w=$({pathError:null,sectionsShown:[!0,!1,!1]}),S=b=>{b.detail.includes(se)&&(w.pathError=ue)};return addEventListener("hasura-error",S),(b,p)=>(d(),_(e(Q),{layout:"vertical"},{default:l(()=>[a(J,{runtime:r.value},null,8,["runtime"]),(d(),k(P,null,C(n,i=>M("div",{key:i.label},[a(e(O),{level:3},{default:l(()=>[y(W(i.label),1)]),_:2},1024),(d(!0),k(P,null,C(i.props,v=>(d(),_(e(c),{key:v.label,label:v.label},{default:l(()=>[a(e(A),{type:"text",value:r.value[v.valueKey],onChange:f=>r.value[v.valueKey]=f.target.value},null,8,["value","onChange"])]),_:2},1032,["label"]))),128))])),64)),a(e(c),{label:"Start smart form automatically"},{default:l(()=>[a(e(U),{checked:r.value.autoStart,"onUpdate:checked":p[0]||(p[0]=i=>r.value.autoStart=i)},null,8,["checked"])]),_:1}),a(e(c),{label:"Allow the user to restart the smart form after it is over"},{default:l(()=>[a(e(U),{checked:r.value.allowRestart,"onUpdate:checked":p[1]||(p[1]=i=>r.value.allowRestart=i)},null,8,["checked"])]),_:1})]),_:1}))}}),ie={style:{display:"flex","justify-content":"flex-end"}},de={key:1,style:{height:"600px",margin:"20px","border-radius":"10px",overflow:"hidden"}},Pe=N({__name:"FormTester",props:{form:{},logService:{}},setup(m,{expose:g}){var R,B,K,q;const r=m,n=$({queryParams:[],url:`${r.form.path}`,stageRunId:null}),w=D(()=>`/_editor/${r.form.routeName}/${encodeURIComponent(r.form.path)}/preview`),S=t=>{n.stageRunId=t},{result:b,loading:p}=ee(()=>X.get()),i=()=>{n.queryParams.push({name:"",value:""})},v=t=>{n.queryParams=n.queryParams.filter((h,o)=>o!==t)};H([()=>n.stageRunId,()=>n.queryParams],([t,h])=>{const o="abstra-run-id",s=h.find(u=>u.name===o);if(console.log(t,s),t&&!s){n.queryParams.push({name:o,value:t});return}if(!t&&s){n.queryParams=n.queryParams.filter(u=>u.name!==o);return}t&&s&&t!==s.value&&(s.value=t)});const f=D(()=>Y.create({formPath:r.form.path}));(R=f.value)==null||R.on("stdout",t=>{r.logService.log({type:"stdout",log:t.log})}),(B=f.value)==null||B.on("stderr",t=>{r.logService.log({type:"stderr",log:t.log})}),(K=f.value)==null||K.onClose(()=>{r.logService.log({type:"stderr",log:"Program closed"})}),(q=f.value)==null||q.on("files:changed",()=>{r.logService.log({type:"files-changed",log:"Files changed"})});const L=j(),V=({path:t})=>{ae("editor",L,t)},T=E(null);async function F(){var t;return r.logService.log({type:"restart"}),(t=T.value)==null?void 0:t.run()}return g({restart:F}),(t,h)=>(d(),_(e(Q),{layout:"vertical"},{default:l(()=>[a(e(I),{orientation:"left"},{default:l(()=>[y("Params")]),_:1}),a(e(c),null,{default:l(()=>[a(te,{disabled:r.form.isInitial,path:r.form.path,optional:!0,onSelect:h[0]||(h[0]=o=>S(o))},null,8,["disabled","path"])]),_:1}),a(e(c),null,{default:l(()=>[a(e(le),null,{default:l(()=>[a(e(oe),{header:`Query Params (${n.queryParams.length})`},{default:l(()=>[(d(!0),k(P,null,C(n.queryParams,(o,s)=>(d(),_(e(c),{key:s},{default:l(()=>[a(e(ne),null,{default:l(()=>[a(e(A),{value:o.name,"onUpdate:value":u=>o.name=u,type:"text",placeholder:"name"},null,8,["value","onUpdate:value"]),a(e(A),{value:o.value,"onUpdate:value":u=>o.value=u,type:"text",placeholder:"value",disabled:o.name==="stage_run_id"},null,8,["value","onUpdate:value","disabled"]),a(e(x),{danger:"",onClick:u=>v(s)},{default:l(()=>[y("remove")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128)),a(e(c),null,{default:l(()=>[a(e(x),{type:"dashed",style:{width:"100%"},onClick:i},{default:l(()=>[y("Add Query Param")]),_:1})]),_:1})]),_:1},8,["header"])]),_:1})]),_:1}),a(e(c),null,{default:l(()=>[M("div",ie,[a(e(x),{href:w.value,style:{display:"flex",align:"center"},target:"_blank"},{default:l(()=>[a(z,{path:e(re),fill:"currentColor"},null,8,["path"]),y(" Open in new tab ")]),_:1},8,["href"])])]),_:1}),a(e(I),{orientation:"left"},{default:l(()=>[y("Quick Preview")]),_:1}),e(p)||!e(b)?(d(),_(e(G),{key:0})):(d(),k("div",de,[a(Z,{ref_key:"runner",ref:T,form:t.form.makeRunnerData(e(b)),params:{...n.queryParams.reduce((o,{name:s,value:u})=>({...o,[s]:u}),{})},"is-preview":"","enable-auto-focus":"",broker:f.value,onNavigate:V,onLogout:F},null,8,["form","params","broker"])]))]),_:1}))}});export{Pe as _,Ce as a};
//# sourceMappingURL=FormTester.vue_vue_type_script_setup_true_lang.58b0edd3.js.map
