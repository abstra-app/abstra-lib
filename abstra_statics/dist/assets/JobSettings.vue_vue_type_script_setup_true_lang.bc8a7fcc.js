import{d as E,H as N,o as G,G as H,r as A,b as i,er as S,f as d,w as o,u as a,ad as $,b0 as y,cQ as I,bu as C,ez as j,c as f,eA as x,c4 as R,cD as D,eu as J,J as P}from"./registerWidgets.32a97516.js";import{f as B,T as M}from"./dayjs.8c42fac1.js";import{A as F,a as W}from"./Title.fff8b6ce.js";import{R as q}from"./SmartConsole.bb5ce09f.js";import{F as z}from"./Form.c5db2140.js";(function(){try{var h=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},p=new Error().stack;p&&(h._sentryDebugIds=h._sentryDebugIds||{},h._sentryDebugIds[p]="c8be6c88-5099-4272-a950-f38b405c2db8",h._sentryDebugIdIdentifier="sentry-dbid-c8be6c88-5099-4272-a950-f38b405c2db8")}catch{}})();const L=()=>[...Array(31).keys()].map(h=>h+1),O={0:"Sunday",1:"Monday",2:"Tuesday",3:"Wednesday",4:"Thursday",5:"Friday",6:"Saturday"},Q=["hourly","daily","weekly","monthly"],K={hourly:{minute:"0",hour:"*",day:"*",month:"*",weekday:"*"},daily:{minute:"0",hour:"6",day:"*",month:"*",weekday:"*"},weekly:{minute:"0",hour:"6",day:"*",month:"*",weekday:"1"},monthly:{minute:"0",hour:"6",day:"1",month:"*",weekday:"*"}},X=E({__name:"CronEditor",props:{crontab:{}},emits:["changeCrontab","saveCrontab","showAdvancedSettings"],setup(h,{emit:p}){const m=h,c=N(()=>{const t=n.hour,l=n.minute;return B(`${t}:${l}:00`,"HH:mm:ss")});G(()=>{const{hour:t,day:l,weekday:r,month:v,minute:g}=m.crontab;v=="*"&&r==="*"&&l!=="*"&&!u([l,t,g])?s.value="monthly":v==="*"&&l==="*"&&r!=="*"&&!u([r,t,g])?s.value="weekly":l==="*"&&r==="*"&&v==="*"&&t!=="*"&&!u([t,g])?s.value="daily":t=="*"&&l==="*"&&r==="*"&&v==="*"&&!u([g])?s.value="hourly":s.value="custom"});const n=H({minute:m.crontab.minute,hour:m.crontab.hour,day:m.crontab.day,month:m.crontab.month,weekday:m.crontab.weekday}),s=A(""),k=A(1),u=t=>t.some(l=>l.includes("-")||l.includes(",")),b=t=>{n.minute=t.minute,n.hour=t.hour,n.day=t.day,n.month=t.month,n.weekday=t.weekday},w=t=>{k.value=0,s.value=t,b(K[s.value]),p("changeCrontab",n)},T=t=>{k.value=0,n.minute=t,p("changeCrontab",n)},e=t=>{const l=B(t);n.minute=l.minute().toString(),n.hour=l.hour().toString(),p("changeCrontab",n)},_=t=>{k.value=0;const l=t;n.weekday=l,p("changeCrontab",n)},U=t=>{k.value=0;const l=t;n.day=l,p("changeCrontab",n)};return(t,l)=>(i(),S(C,null,[d(a(F),{title:"Recurrence"},{default:o(()=>[d(a($),{placeholder:"Choose a periodicity",value:s.value,"onUpdate:value":w},{default:o(()=>[y(" > "),d(a(I),{value:"",disabled:"",hidden:""},{default:o(()=>[y("Custom")]),_:1}),(i(!0),S(C,null,j(a(Q),(r,v)=>(i(),f(a(I),{key:v,value:r},{default:o(()=>[y(x(r),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),d(a(F),null,{default:o(()=>[s.value==="hourly"?(i(),f(a(R),{key:0,value:n.minute,"onUpdate:value":T},{addonBefore:o(()=>[y(" at ")]),addonAfter:o(()=>[y(" minutes ")]),_:1},8,["value"])):s.value==="daily"?(i(),f(a(D),{key:1},{default:o(()=>[d(a(M),{value:c.value,"show-second":!1,"onUpdate:value":e},null,8,["value"])]),_:1})):s.value==="weekly"?(i(),f(a(D),{key:2},{default:o(()=>[y(" on "),d(a($),{style:{width:"200px"},value:Object.values(a(O))[parseInt(n.weekday)],"onUpdate:value":_},{default:o(()=>[(i(!0),S(C,null,j(a(O),(r,v)=>(i(),f(a(I),{key:v,value:v,selected:r===Object.values(a(O))[parseInt(n.weekday)]},{default:o(()=>[y(x(r),1)]),_:2},1032,["value","selected"]))),128))]),_:1},8,["value"]),y(" at "),d(a(M),{value:c.value,"show-second":!1,"onUpdate:value":e},null,8,["value"])]),_:1})):s.value==="monthly"?(i(),f(a(D),{key:3},{default:o(()=>[y(" on "),d(a($),{value:parseInt(n.day),"onUpdate:value":U},{default:o(()=>[(i(!0),S(C,null,j(a(L)(),(r,v)=>(i(),f(a(I),{key:v,value:r},{default:o(()=>[y(x(r),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"]),y(" at "),d(a(M),{value:c.value,"show-second":!1,"onUpdate:value":e},null,8,["value"])]),_:1})):J("",!0)]),_:1})],64))}}),ae=E({__name:"JobSettings",props:{job:{}},setup(h){const p=h,m=A(!1),c=A(p.job),n=()=>{m.value=!m.value},s=()=>{m.value=!1},k=e=>({weekday:e.split(" ")[4],month:e.split(" ")[3],day:e.split(" ")[2],hour:e.split(" ")[1],minute:e.split(" ")[0]}),u=H(k(c.value.schedule)),b=N(()=>`${u.minute} ${u.hour} ${u.day} ${u.month} ${u.weekday}`),w=e=>{u.minute==e.minute&&u.hour==e.hour&&u.day==e.day&&u.month==e.month&&u.weekday==e.weekday||(u.minute=e.minute,u.hour=e.hour,u.day=e.day,u.month=e.month,u.weekday=e.weekday,c.value.schedule=b.value)},T=e=>{e?(c.value.schedule=e,Object.assign(u,k(e))):c.value.schedule=b.value,s()};return P(()=>c.value.schedule,e=>{w({minute:e.split(" ")[0],hour:e.split(" ")[1],day:e.split(" ")[2],month:e.split(" ")[3],weekday:e.split(" ")[4]})}),(e,_)=>(i(),f(a(z),{class:"schedule-editor",layout:"vertical"},{default:o(()=>[d(a(F),{label:"Name",required:""},{default:o(()=>[d(a(R),{value:c.value.title,"onUpdate:value":_[0]||(_[0]=U=>c.value.title=U)},null,8,["value"])]),_:1}),d(q,{runtime:c.value},null,8,["runtime"]),d(a(W),{level:3},{default:o(()=>[y("Schedule")]),_:1}),d(X,{class:"recurrence-settings",crontab:u,onChangeCrontab:w,onSaveCrontab:T,onShowAdvancedSettings:n},null,8,["crontab"])]),_:1}))}});export{ae as _};
//# sourceMappingURL=JobSettings.vue_vue_type_script_setup_true_lang.bc8a7fcc.js.map
