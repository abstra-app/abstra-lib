import{u as C}from"./userStore-CKQwOFga.js";import{F as D,a as E,b as R}from"./FormRunner-2yobAxWg.js";import{a as S,V as F,r as y,N as U,ag as A,af as I,c as W,b0 as L,H as V,p as K,k as N,b as x,e as B,u as t,h as M,f as v,aK as q}from"./jwt-decode.esm-fjkZIee2.js";import{r as G}from"./redirect-Cex1PTsZ.js";import{a as H}from"./asyncComputed-BmCWu6_h.js";import{u as h}from"./uuid-C1F5kUX7.js";import{L as P}from"./CircularLoading-t0EcTmgV.js";import{f as T,b as j}from"./workspaceStore-BEUAhgMx.js";import"./Login.vue_vue_type_script_setup_true_lang-BvTjF-Bu.js";import"./OTPInput-CuCxyfGa.js";import"./Logo-DUVhzD1O.js";import"./string-c089C_DZ.js";import"./index-C2wua8Uf.js";import"./Steps-CyJdbbG_.js";import"./index-CU67y5Kq.js";import"./Watermark-DLzYD8ax.js";import"./constants-BWnkTKwV.js";import"./url-AMJ6SHft.js";import"./colorHelpers-BLJHXMJZ.js";(function(){try{var n=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},o=new Error().stack;o&&(n._sentryDebugIds=n._sentryDebugIds||{},n._sentryDebugIds[o]="a9c57f1e-eb9d-40aa-aafb-f78ec583f02a",n._sentryDebugIdIdentifier="sentry-dbid-a9c57f1e-eb9d-40aa-aafb-f78ec583f02a")}catch{}})();const z={key:0,class:"loading"},J=S({__name:"Form",setup(n){const o=A(),i=I(),d=F({playerKey:h()}),g=C(),s=y(null),m=y(null);U(o,()=>{o.name==="form"&&w()});const{loading:u,result:e,error:f,refetch:w}=H(async()=>{d.playerKey=h();const a=o.path.slice(1),r=await T(a);if(m.value=await j(),!r){i.push({name:"error",params:{status:"404"}});return}const l=new D({formRunnerData:r,logService:null,connectionManager:new E(r.id,"player",o.query),onRedirect:p,onFormStart:()=>{},onFormEnd:()=>{},onStackTraceUpdate:null,onStateUpdate:k=>s.value=k}),_=l.getState();return s.value=_.formState,{runnerData:r,controller:l}}),b=W(()=>{const a=!u,r=!!f,l=!e||s.value===null;return a&&(r||l)});L(()=>{b.value&&i.push({name:"error",params:{status:"500"}}),e.value?.runnerData&&e.value?.runnerData&&(document.title=e.value?.runnerData.title)});function p(a,r){window.removeEventListener("beforeunload",c),G("player",i,a,r)}V(async()=>{window.addEventListener("beforeunload",c)}),K(()=>{window.removeEventListener("beforeunload",c),e.value?.controller.stop()});const c=a=>{if(e.value?.controller.handleCloseAttempt())return a.preventDefault(),""};return(a,r)=>t(u)?(v(),N("div",z,[M(P)])):t(e)&&t(e).runnerData&&s.value&&!t(f)&&!t(u)?(v(),x(R,{key:d.playerKey,"form-runner-data":t(e).runnerData,"form-state":s.value,"is-preview":!1,"user-email":t(g).email,"worker-capacity":m.value,onRedirect:p,onActionClicked:t(e)?.controller.handleActionClick,onUpdateWidgetErrors:t(e)?.controller.updateWidgetFrontendErrors,onUpdateWidgetValue:t(e)?.controller.updateWidgetValue,onAuthComplete:t(e)?.controller.handleAuthComplete},null,8,["form-runner-data","form-state","user-email","worker-capacity","onActionClicked","onUpdateWidgetErrors","onUpdateWidgetValue","onAuthComplete"])):B("",!0)}}),fe=q(J,[["__scopeId","data-v-22488e59"]]);export{fe as default};
//# sourceMappingURL=Form-Cl_p1klX.js.map
