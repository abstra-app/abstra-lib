var oe=Object.defineProperty;var le=(p,e,a)=>e in p?oe(p,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):p[e]=a;var S=(p,e,a)=>(le(p,typeof e!="symbol"?e+"":e,a),a);import{_ as se}from"./DocsButton.vue_vue_type_script_setup_true_lang.98b7254b.js";import{_ as O}from"./AbstraButton.vue_vue_type_script_setup_true_lang.d5df6189.js";import{d as E,am as F,c as $,o as d,a5 as y,a7 as X,h as A,e6 as ee,e as H,r as z,M as D,a as f,b as i,f as r,u as t,de as _,d4 as ie,g as C,da as M,ed as L,ea as ce,_ as ne,w as Y,i as J,ec as x,cz as re,bJ as B,aR as U,cE as de,db as ue,cy as pe,d9 as R,cW as he,eb as ge,A as q,bP as ve,bx as ye,bw as Q,eG as me,er as fe,es as Ce}from"./jwt-decode.esm.875a2b0a.js";import{G as ke}from"./PhDotsThreeVertical.vue.142b66f7.js";import{h as Z,l as we}from"./router.431cd93c.js";import{G as be}from"./PhWebhooksLogo.vue.6e9af98c.js";import{A as te}from"./index.8e529c37.js";import{C as ae}from"./Card.307ea151.js";import{U as _e}from"./UploadOutlined.0287af8c.js";import{_ as He}from"./AbstraLogo.vue_vue_type_script_setup_true_lang.0381cf1c.js";import{L as Ve}from"./Logo.1b44b8f3.js";import{A as Ae}from"./index.3623555b.js";import"./constants.854610e0.js";import"./index.3dc4874a.js";(function(){try{var p=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},e=new Error().stack;e&&(p._sentryDebugIds=p._sentryDebugIds||{},p._sentryDebugIds[e]="765f6ee7-c3a7-495f-b975-d6c3b8baf7a3",p._sentryDebugIdIdentifier="sentry-dbid-765f6ee7-c3a7-495f-b975-d6c3b8baf7a3")}catch{}})();const $e=["width","height","fill","transform"],Ie={key:0},Te=H("path",{d:"M216.49,184.49l-32,32a12,12,0,0,1-17-17L179,188H48a12,12,0,0,1,0-24H179l-11.52-11.51a12,12,0,0,1,17-17l32,32A12,12,0,0,1,216.49,184.49Zm-145-64a12,12,0,0,0,17-17L77,92H208a12,12,0,0,0,0-24H77L88.49,56.49a12,12,0,0,0-17-17l-32,32a12,12,0,0,0,0,17Z"},null,-1),Se=[Te],Ue={key:1},Me=H("path",{d:"M208,80v96H48V80Z",opacity:"0.2"},null,-1),je=H("path",{d:"M213.66,181.66l-32,32a8,8,0,0,1-11.32-11.32L188.69,184H48a8,8,0,0,1,0-16H188.69l-18.35-18.34a8,8,0,0,1,11.32-11.32l32,32A8,8,0,0,1,213.66,181.66Zm-139.32-64a8,8,0,0,0,11.32-11.32L67.31,88H208a8,8,0,0,0,0-16H67.31L85.66,53.66A8,8,0,0,0,74.34,42.34l-32,32a8,8,0,0,0,0,11.32Z"},null,-1),Ne=[Me,je],Ze={key:2},Fe=H("path",{d:"M42.34,85.66a8,8,0,0,1,0-11.32l32-32A8,8,0,0,1,88,48V72H208a8,8,0,0,1,0,16H88v24a8,8,0,0,1-13.66,5.66Zm171.32,84.68-32-32A8,8,0,0,0,168,144v24H48a8,8,0,0,0,0,16H168v24a8,8,0,0,0,13.66,5.66l32-32A8,8,0,0,0,213.66,170.34Z"},null,-1),Le=[Fe],Ee={key:3},ze=H("path",{d:"M212.24,171.76a6,6,0,0,1,0,8.48l-32,32a6,6,0,0,1-8.48-8.48L193.51,182H48a6,6,0,0,1,0-12H193.51l-21.75-21.76a6,6,0,0,1,8.48-8.48ZM75.76,116.24a6,6,0,0,0,8.48-8.48L62.49,86H208a6,6,0,0,0,0-12H62.49L84.24,52.24a6,6,0,0,0-8.48-8.48l-32,32a6,6,0,0,0,0,8.48Z"},null,-1),Ke=[ze],xe={key:4},Pe=H("path",{d:"M213.66,181.66l-32,32a8,8,0,0,1-11.32-11.32L188.69,184H48a8,8,0,0,1,0-16H188.69l-18.35-18.34a8,8,0,0,1,11.32-11.32l32,32A8,8,0,0,1,213.66,181.66Zm-139.32-64a8,8,0,0,0,11.32-11.32L67.31,88H208a8,8,0,0,0,0-16H67.31L85.66,53.66A8,8,0,0,0,74.34,42.34l-32,32a8,8,0,0,0,0,11.32Z"},null,-1),Re=[Pe],De={key:5},Be=H("path",{d:"M210.83,173.17a4,4,0,0,1,0,5.66l-32,32a4,4,0,0,1-5.66-5.66L198.34,180H48a4,4,0,0,1,0-8H198.34l-25.17-25.17a4,4,0,0,1,5.66-5.66ZM77.17,114.83a4,4,0,0,0,5.66-5.66L57.66,84H208a4,4,0,0,0,0-8H57.66L82.83,50.83a4,4,0,0,0-5.66-5.66l-32,32a4,4,0,0,0,0,5.66Z"},null,-1),qe=[Be],Ge={name:"PhArrowsLeftRight"},Oe=E({...Ge,props:{weight:{type:String},size:{type:[String,Number]},color:{type:String},mirrored:{type:Boolean}},setup(p){const e=p,a=F("weight","regular"),n=F("size","1em"),o=F("color","currentColor"),h=F("mirrored",!1),v=$(()=>{var l;return(l=e.weight)!=null?l:a}),w=$(()=>{var l;return(l=e.size)!=null?l:n}),b=$(()=>{var l;return(l=e.color)!=null?l:o}),T=$(()=>e.mirrored!==void 0?e.mirrored?"scale(-1, 1)":void 0:h?"scale(-1, 1)":void 0);return(l,s)=>(d(),y("svg",ee({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256",width:w.value,height:w.value,fill:b.value,transform:T.value},l.$attrs),[X(l.$slots,"default"),v.value==="bold"?(d(),y("g",Ie,Se)):v.value==="duotone"?(d(),y("g",Ue,Ne)):v.value==="fill"?(d(),y("g",Ze,Le)):v.value==="light"?(d(),y("g",Ee,Ke)):v.value==="regular"?(d(),y("g",xe,Re)):v.value==="thin"?(d(),y("g",De,qe)):A("",!0)],16,$e))}}),We=["width","height","fill","transform"],Ye={key:0},Je=H("path",{d:"M224,64H180V56a28,28,0,0,0-28-28H104A28,28,0,0,0,76,56v8H32A20,20,0,0,0,12,84V192a20,20,0,0,0,20,20H224a20,20,0,0,0,20-20V84A20,20,0,0,0,224,64ZM100,56a4,4,0,0,1,4-4h48a4,4,0,0,1,4,4v8H100ZM220,88v32H196v-4a12,12,0,0,0-24,0v4H84v-4a12,12,0,0,0-24,0v4H36V88ZM36,188V144H60v4a12,12,0,0,0,24,0v-4h88v4a12,12,0,0,0,24,0v-4h24v44Z"},null,-1),Qe=[Je],Xe={key:1},en=H("path",{d:"M232,120v72a8,8,0,0,1-8,8H32a8,8,0,0,1-8-8V120Z",opacity:"0.2"},null,-1),nn=H("path",{d:"M224,64H176V56a24,24,0,0,0-24-24H104A24,24,0,0,0,80,56v8H32A16,16,0,0,0,16,80V192a16,16,0,0,0,16,16H224a16,16,0,0,0,16-16V80A16,16,0,0,0,224,64ZM96,56a8,8,0,0,1,8-8h48a8,8,0,0,1,8,8v8H96ZM32,80H224v32H192v-8a8,8,0,0,0-16,0v8H80v-8a8,8,0,0,0-16,0v8H32ZM224,192H32V128H64v8a8,8,0,0,0,16,0v-8h96v8a8,8,0,0,0,16,0v-8h32v64Z"},null,-1),tn=[en,nn],an={key:2},on=H("path",{d:"M224,64H176V56a24,24,0,0,0-24-24H104A24,24,0,0,0,80,56v8H32A16,16,0,0,0,16,80v28a4,4,0,0,0,4,4H64V96.27A8.17,8.17,0,0,1,71.47,88,8,8,0,0,1,80,96v16h96V96.27A8.17,8.17,0,0,1,183.47,88,8,8,0,0,1,192,96v16h44a4,4,0,0,0,4-4V80A16,16,0,0,0,224,64Zm-64,0H96V56a8,8,0,0,1,8-8h48a8,8,0,0,1,8,8Zm80,68v60a16,16,0,0,1-16,16H32a16,16,0,0,1-16-16V132a4,4,0,0,1,4-4H64v16a8,8,0,0,0,8.53,8A8.17,8.17,0,0,0,80,143.73V128h96v16a8,8,0,0,0,8.53,8,8.17,8.17,0,0,0,7.47-8.25V128h44A4,4,0,0,1,240,132Z"},null,-1),ln=[on],sn={key:3},cn=H("path",{d:"M224,66H174V56a22,22,0,0,0-22-22H104A22,22,0,0,0,82,56V66H32A14,14,0,0,0,18,80V192a14,14,0,0,0,14,14H224a14,14,0,0,0,14-14V80A14,14,0,0,0,224,66ZM94,56a10,10,0,0,1,10-10h48a10,10,0,0,1,10,10V66H94ZM32,78H224a2,2,0,0,1,2,2v34H190V104a6,6,0,0,0-12,0v10H78V104a6,6,0,0,0-12,0v10H30V80A2,2,0,0,1,32,78ZM224,194H32a2,2,0,0,1-2-2V126H66v10a6,6,0,0,0,12,0V126H178v10a6,6,0,0,0,12,0V126h36v66A2,2,0,0,1,224,194Z"},null,-1),rn=[cn],dn={key:4},un=H("path",{d:"M224,64H176V56a24,24,0,0,0-24-24H104A24,24,0,0,0,80,56v8H32A16,16,0,0,0,16,80V192a16,16,0,0,0,16,16H224a16,16,0,0,0,16-16V80A16,16,0,0,0,224,64ZM96,56a8,8,0,0,1,8-8h48a8,8,0,0,1,8,8v8H96ZM224,80v32H192v-8a8,8,0,0,0-16,0v8H80v-8a8,8,0,0,0-16,0v8H32V80Zm0,112H32V128H64v8a8,8,0,0,0,16,0v-8h96v8a8,8,0,0,0,16,0v-8h32v64Z"},null,-1),pn=[un],hn={key:5},gn=H("path",{d:"M224,68H172V56a20,20,0,0,0-20-20H104A20,20,0,0,0,84,56V68H32A12,12,0,0,0,20,80V192a12,12,0,0,0,12,12H224a12,12,0,0,0,12-12V80A12,12,0,0,0,224,68ZM92,56a12,12,0,0,1,12-12h48a12,12,0,0,1,12,12V68H92ZM32,76H224a4,4,0,0,1,4,4v36H188V104a4,4,0,0,0-8,0v12H76V104a4,4,0,0,0-8,0v12H28V80A4,4,0,0,1,32,76ZM224,196H32a4,4,0,0,1-4-4V124H68v12a4,4,0,0,0,8,0V124H180v12a4,4,0,0,0,8,0V124h40v68A4,4,0,0,1,224,196Z"},null,-1),vn=[gn],yn={name:"PhToolbox"},mn=E({...yn,props:{weight:{type:String},size:{type:[String,Number]},color:{type:String},mirrored:{type:Boolean}},setup(p){const e=p,a=F("weight","regular"),n=F("size","1em"),o=F("color","currentColor"),h=F("mirrored",!1),v=$(()=>{var l;return(l=e.weight)!=null?l:a}),w=$(()=>{var l;return(l=e.size)!=null?l:n}),b=$(()=>{var l;return(l=e.color)!=null?l:o}),T=$(()=>e.mirrored!==void 0?e.mirrored?"scale(-1, 1)":void 0:h?"scale(-1, 1)":void 0);return(l,s)=>(d(),y("svg",ee({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256",width:w.value,height:w.value,fill:b.value,transform:T.value},l.$attrs),[X(l.$slots,"default"),v.value==="bold"?(d(),y("g",Ye,Qe)):v.value==="duotone"?(d(),y("g",Xe,tn)):v.value==="fill"?(d(),y("g",an,ln)):v.value==="light"?(d(),y("g",sn,rn)):v.value==="regular"?(d(),y("g",dn,pn)):v.value==="thin"?(d(),y("g",hn,vn)):A("",!0)],16,We))}});class fn{async generateEcdsaKey(e){const{projectId:a,connectionName:n,connectorType:o}=e;return Z.post(`projects/${a}/connectors/${o}/connections/${n}/ecdsa-key`,{})}async createEcdsaConnection(e){const{projectId:a,connectionName:n,connectorType:o,publicKey:h,privateKey:v,accessId:w}=e;return Z.post(`projects/${a}/connectors/${o}/connections/${n}/create-ecdsa`,{publicKey:h,privateKey:v,accessId:w})}async getLoginUrl(e,a,n,o,h){return Z.get(`projects/${e}/connectors/${n}/connections/${a}/login-url`,{scopeIds:o.join(","),...h})}async listConnectors(e){return Z.get(`projects/${e}/connectors`)}async createTokenConnection(e){const{projectId:a,connectionName:n,connectorType:o,tokens:h}=e,v={type:"tokens",tokens:h};return Z.post(`projects/${a}/connectors/${o}/connections/${n}`,v)}async listConnections(e){return Z.get(`projects/${e}/connections`)}async deleteConnection(e){const{projectId:a,connectionName:n,connectorType:o}=e;return Z.delete(`projects/${a}/connectors/${o}/connections/${n}`)}async renameConnection(e){const{projectId:a,connectionName:n,connectorType:o,newConnectionName:h}=e;return Z.patch(`projects/${a}/connectors/${o}/connections/${n}`,{newConnectionName:h})}}class Cn{constructor(e,a){S(this,"state");S(this,"hasChanges",$(()=>!!this.state.value.editingConnection&&this.state.value.editingConnection.name!==this.state.value.editingConnection.newName));S(this,"handleDeletionClick",async e=>{D.confirm({title:"Delete connection",content:"Are you sure you want to delete this connection?",onOk:()=>this.handleDeleteConnection(e)})});S(this,"handleDeleteConnection",async e=>{await this.api.deleteConnection({projectId:this.projectId,connectionName:e.name,connectorType:e.connectorType}),this.state.value.editingConnection=null,await this.refetchConnections()});S(this,"handleAddConnectionSubmit",async()=>{var h,v,w,b;const e=(h=this.state.value.addingConnection)==null?void 0:h.connector.metadata.key,a=(v=this.state.value.addingConnection)==null?void 0:v.selectedScopeIds,n=(b=(w=this.state.value.addingConnection)==null?void 0:w.tokenValues)!=null?b:{};if(!e||!a)throw new Error("No connector or scope selected");const{url:o}=await this.getLoginUrl(e,this.getUniqueName(e),a,n);window.location.href=o});S(this,"handleAddTokenConnectionSubmit",async()=>{const e=this.state.value.addingConnection;if(!e)throw new Error("No connection is being added");const a=e.connector.metadata.key,n=this.getUniqueName(a);await this.api.createTokenConnection({projectId:this.projectId,connectionName:n,connectorType:a,tokens:e.tokenValues}),this.state.value.addingConnection=null,await this.refetchConnections()});S(this,"handleAddEcdsaConnectionSubmit",async(e,a)=>{const n=this.state.value.addingConnection;if(!n||!e||!a)throw new Error("No connection is being added, public key or project ID is missing");if(!n.connectionName||!n.ecdsaKeys)throw new Error("Keys or connection name not found");await this.api.createEcdsaConnection({projectId:this.projectId,connectionName:n.connectionName,connectorType:n.connector.metadata.key,publicKey:n.ecdsaKeys.publicKey,privateKey:n.ecdsaKeys.privateKey,accessId:a}),this.state.value.addingConnection=null,await this.refetchConnections()});S(this,"renameConnection",async()=>{const{editingConnection:e}=this.state.value;if(!e)throw new Error("No connection is being edited");const a=async()=>{await this.api.renameConnection({projectId:this.projectId,connectionName:e.name,connectorType:e.connectorType,newConnectionName:e.newName}),await this.refetchConnections(),this.state.value.editingConnection=null};D.confirm({title:"Rename connection",content:"Are you sure you want to rename this connection? This will break any existing references to the old name.",onOk:a})});S(this,"showAddConfirmationModal",e=>{this.state.value.addingConnection={selectedScopeIds:e.auth.type==="oauth2"?e.auth.scopes.map(a=>a.key):[],connector:e,tokenValues:{}}});S(this,"handleScopeToggle",(e,a)=>{a?this.state.value.addingConnection.selectedScopeIds.push(e):this.state.value.addingConnection.selectedScopeIds=this.state.value.addingConnection.selectedScopeIds.filter(n=>n!==e)});this.projectId=e,this.api=a,this.state=z({connectors:[],connections:[],addingConnection:null,editingConnection:null})}async fetchConnectors(){this.state.value.connectors=await this.api.listConnectors(this.projectId)}async fetchInitialState(){await this.fetchConnectors(),await this.refetchConnections()}async refetchConnections(){const e=await this.api.listConnections(this.projectId);this.state.value.connections=e.map(a=>{const n=this.state.value.connectors.find(o=>o.metadata.key===a.connectionType);return n?{name:a.name,connectorTitle:n.metadata.label,connectorType:a.connectionType,icon:n.metadata.logoUrl}:null}).filter(a=>a!==null)}handleEditConnectionClick(e){this.state.value.editingConnection={...e,newName:e.name}}async getLoginUrl(e,a,n,o){return this.api.getLoginUrl(this.projectId,a,e,n,o)}slugify(e){return e.toString().toLowerCase().replace(/\s+/g,"-").replace(/[^\w-]+/g,"").replace(/--+/g,"-")}getUniqueName(e){const a=this.state.value.connections.filter(n=>n.connectorType===e).length;return a===0?e:`${e}-${a}`}async generateEcdsaKey(){const e=this.state.value.addingConnection;if(!e)throw new Error("No connection is being added");const a=e.connector.metadata.key,n=this.getUniqueName(a),o=await this.api.generateEcdsaKey({projectId:this.projectId,connectionName:n,connectorType:a});return this.state.value.addingConnection&&(this.state.value.addingConnection.connectionName=n,this.state.value.addingConnection.ecdsaKeys=o),o.publicKey}}const kn=E({__name:"ConnectorCard",props:{title:{},logoUrl:{},description:{},unavailable:{type:Boolean},connector:{}},setup(p){const e=p,a=$(()=>{var o;return((o=e.connector)==null?void 0:o.triggers)&&e.connector.triggers.length>0}),n=$(()=>{var o;return((o=e.connector)==null?void 0:o.actions)&&e.connector.actions.length>0});return(o,h)=>(d(),f(t(ae),{class:ce({"connector-card":!0,unavailable:o.unavailable})},{default:i(()=>[r(t(_),{style:{width:"100%"},vertical:"",gap:12},{default:i(()=>[r(t(_),{justify:"space-between"},{default:i(()=>[r(t(te),{src:o.logoUrl,shape:"square",size:"large"},null,8,["src"]),r(t(_),{gap:8},{default:i(()=>[a.value?(d(),f(t(be),{key:0,size:16})):A("",!0),n.value?(d(),f(t(mn),{key:1,size:16})):A("",!0),o.unavailable?(d(),f(t(ie),{key:2,style:{height:"fit-content"}},{default:i(()=>[C("Talk to us")]),_:1})):A("",!0)]),_:1})]),_:1}),r(t(_),{vertical:""},{default:i(()=>[r(t(M),{strong:""},{default:i(()=>[C(L(o.title),1)]),_:1}),r(t(M),{type:"secondary"},{default:i(()=>[C(L(o.description),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["class"]))}});const wn=ne(kn,[["__scopeId","data-v-f5866f99"]]);function bn(p){return new Promise((e,a)=>{const n=new FileReader;n.onload=()=>{const h=n.result.split(",")[1];e(h)},n.onerror=()=>a(n.error),n.readAsDataURL(p)})}const _n={key:5,style:{"margin-top":"16px"}},G=E({__name:"AuthFormFields",props:{tokens:{},tokenValues:{},uploadedFiles:{default:()=>({})}},emits:["update:tokenValues","update:uploadedFiles","tokenChange"],setup(p,{emit:e}){const a=p,n=z(a.uploadedFiles||{}),o=z({...a.tokenValues});Y(()=>a.tokenValues,l=>{o.value={...l}},{deep:!0}),Y(()=>a.uploadedFiles,l=>{n.value=l||{}},{deep:!0});function h(l,s){o.value[l]=s;const k={...o.value};e("update:tokenValues",k),e("tokenChange")}function v(l){var k,V;const s=[];return l.key&&s.push({required:!0,message:`${l.label||l.key} is required`}),(k=l.input)!=null&&k.minSize&&s.push({min:l.input.minSize,message:`Minimum length is ${l.input.minSize}`}),(V=l.input)!=null&&V.maxSize&&s.push({max:l.input.maxSize,message:`Maximum length is ${l.input.maxSize}`}),s}async function w(l,s){try{const k=await bn(l),V={...n.value,[s]:{file:l,base64:k}};n.value=V,e("update:uploadedFiles",V),o.value[s]=k;const c={...o.value};e("update:tokenValues",c),e("tokenChange")}catch(k){console.error("Error converting file to base64:",k)}return!1}function b(l){const s={...n.value};delete s[l],n.value=s,e("update:uploadedFiles",s),o.value[l]="";const k={...o.value};e("update:tokenValues",k),e("tokenChange")}function T(l){const s=n.value[l];return s?[{uid:l,name:s.file.name,status:"done",size:s.file.size}]:[]}return(l,s)=>{const k=J("ARadio"),V=J("ARadioGroup");return d(),f(t(pe),{model:o.value,layout:"vertical"},{default:i(()=>[(d(!0),y(U,null,x(l.tokens,c=>(d(),f(t(re),{key:c.key,label:c.label,name:c.key,rules:v(c)},{default:i(()=>{var u,m,j,g,N,K,P,W;return[((u=c.input)==null?void 0:u.type)==="small-string"?(d(),f(t(B),{key:0,value:o.value[c.key],"onUpdate:value":I=>o.value[c.key]=I,placeholder:c.description,maxlength:(m=c.input)==null?void 0:m.maxSize,minlength:(j=c.input)==null?void 0:j.minSize,type:"password",onInput:()=>h(c.key,o.value[c.key]||"")},null,8,["value","onUpdate:value","placeholder","maxlength","minlength","onInput"])):((g=c.input)==null?void 0:g.type)==="radiobox"?(d(),f(V,{key:1,value:o.value[c.key],"onUpdate:value":I=>o.value[c.key]=I,onChange:()=>h(c.key,o.value[c.key]||"")},{default:i(()=>[(d(!0),y(U,null,x(c.input.options,I=>(d(),f(k,{key:I.value,value:I.value},{default:i(()=>[C(L(I.label),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onUpdate:value","onChange"])):((N=c.input)==null?void 0:N.type)==="large-text"?(d(),f(t(de),{key:2,value:o.value[c.key],"onUpdate:value":I=>o.value[c.key]=I,placeholder:c.description,maxlength:(K=c.input)==null?void 0:K.maxSize,minlength:(P=c.input)==null?void 0:P.minSize,rows:4,onInput:()=>h(c.key,o.value[c.key]||"")},null,8,["value","onUpdate:value","placeholder","maxlength","minlength","onInput"])):((W=c.input)==null?void 0:W.type)==="file"?(d(),f(t(ue),{key:3,"file-list":T(c.key),"before-upload":I=>w(I,c.key),"max-count":1,"show-upload-list":!0,onRemove:()=>b(c.key)},{default:i(()=>[r(O,null,{default:i(()=>[r(t(_e)),C(" Upload File ")]),_:1})]),_:2},1032,["file-list","before-upload","onRemove"])):(d(),f(t(B),{key:4,value:o.value[c.key],"onUpdate:value":I=>o.value[c.key]=I,placeholder:c.description,type:"password",onInput:()=>h(c.key,o.value[c.key]||"")},null,8,["value","onUpdate:value","placeholder","onInput"])),c.instructions?(d(),y("div",_n,[r(t(M),{type:"secondary",style:{"white-space":"pre-line","font-size":"14px"}},{default:i(()=>[C(L(c.instructions),1)]),_:2},1024)])):A("",!0),c.description&&!c.instructions?(d(),f(t(M),{key:6,type:"secondary",style:{display:"block","font-size":"12px","margin-top":"8px"}},{default:i(()=>[C(L(c.description),1)]),_:2},1024)):A("",!0)]}),_:2},1032,["label","name","rules"]))),128))]),_:1},8,["model"])}}}),Hn=E({__name:"ConnectionHeader",props:{connectorLogoUrl:{},connectorLabel:{}},setup(p){return(e,a)=>(d(),f(t(_),{justify:"center",align:"center",gap:20,style:{"margin-bottom":"24px",padding:"20px 0"}},{default:i(()=>[r(He,{"hide-text":"",size:"large"}),r(t(Oe),{size:24}),r(Ve,{"image-url":e.connectorLogoUrl,"brand-name":e.connectorLabel,size:"medium","hide-text":""},null,8,["image-url","brand-name"])]),_:1}))}}),Vn=E({__name:"ConnectionModal",props:{addingConnection:{},ecdsaPublicKey:{},ecdsaKeyLoading:{type:Boolean},uploadedFiles:{}},emits:["cancel","submit","scope-toggle","generate-ecdsa-key","update:token-values","update:uploaded-files","token-change"],setup(p,{emit:e}){const a=p,n=$(()=>{var k,V,c;switch((k=a.addingConnection)==null?void 0:k.connector.auth.type){case"oauth2":return"Authorize";case"tokens":return"Create Connection";case"ecdsa":{if(!a.ecdsaPublicKey)return"OK";const u=((V=a.addingConnection)==null?void 0:V.connector.auth.params)||[],m=((c=a.addingConnection)==null?void 0:c.tokenValues)||{};return u.every(g=>m[g.key]&&m[g.key].trim().length>0)?"Create Connection":"Create Connection (Required fields missing)"}default:return"OK"}});function o(){e("cancel")}function h(){e("submit")}function v(s,k){e("scope-toggle",s,k)}function w(){e("generate-ecdsa-key")}function b(s){e("update:token-values",s)}function T(s){e("update:uploaded-files",s)}function l(){e("token-change")}return(s,k)=>{var V;return d(),f(t(D),{open:!!s.addingConnection,title:`Add ${(V=s.addingConnection)==null?void 0:V.connector.metadata.label} Connection`,"ok-text":n.value,"ok-button-props":{disabled:n.value.includes("Required")},"wrap-class-name":"full-modal",onCancel:o,onOk:h},{default:i(()=>[s.addingConnection?(d(),y(U,{key:0},[r(Hn,{"connector-logo-url":s.addingConnection.connector.metadata.logoUrl,"connector-label":s.addingConnection.connector.metadata.label},null,8,["connector-logo-url","connector-label"]),s.addingConnection.connector.auth.type==="oauth2"?(d(),y(U,{key:0},[r(t(R),null,{default:i(()=>[C(" Please select the scopes you want to authorize for this connection. You can change these later by deleting and re-adding the connection. ")]),_:1}),r(t(_),{vertical:"",gap:"10",style:{margin:"30px 0px"}},{default:i(()=>{var c;return[(d(!0),y(U,null,x(s.addingConnection.connector.auth.scopes,u=>(d(),f(t(_),{key:u.key,justify:"space-between",align:"center"},{default:i(()=>[r(t(_),{vertical:""},{default:i(()=>[r(t(M),null,{default:i(()=>[C(L(u.description),1)]),_:2},1024),r(t(M),{type:"secondary"},{default:i(()=>[C(L(u.key),1)]),_:2},1024)]),_:2},1024),r(t(he),{checked:s.addingConnection.selectedScopeIds.includes(u.key),onChange:m=>v(u.key,m)},null,8,["checked","onChange"])]),_:2},1024))),128)),(c=s.addingConnection.connector.auth.params)!=null&&c.length?(d(),f(G,{key:0,tokens:s.addingConnection.connector.auth.params,"token-values":s.addingConnection.tokenValues,"uploaded-files":s.uploadedFiles,"onUpdate:tokenValues":b,"onUpdate:uploadedFiles":T,onTokenChange:l},null,8,["tokens","token-values","uploaded-files"])):A("",!0)]}),_:1})],64)):A("",!0),s.addingConnection.connector.auth.type==="tokens"?(d(),y(U,{key:1},[r(t(R),null,{default:i(()=>[C(" Please provide the required tokens/credentials for this connection. ")]),_:1}),r(G,{tokens:s.addingConnection.connector.auth.tokens,"token-values":s.addingConnection.tokenValues,"uploaded-files":s.uploadedFiles,"onUpdate:tokenValues":b,"onUpdate:uploadedFiles":T,onTokenChange:l},null,8,["tokens","token-values","uploaded-files"])],64)):A("",!0),s.addingConnection.connector.auth.type==="ecdsa"?(d(),y(U,{key:2},[s.ecdsaPublicKey?(d(),f(t(_),{key:1,vertical:"",gap:"16"},{default:i(()=>[r(t(M),{strong:""},{default:i(()=>[C("Chaves geradas! Agora siga os pr\xF3ximos passos:")]),_:1}),r(t(M),{strong:""},{default:i(()=>[C("1. Copie sua chave p\xFAblica:")]),_:1}),r(t(B),{value:s.ecdsaPublicKey,readonly:"",copyable:"",code:""},null,8,["value"]),r(G,{tokens:s.addingConnection.connector.auth.params,"token-values":s.addingConnection.tokenValues,"uploaded-files":s.uploadedFiles,"onUpdate:tokenValues":b,"onUpdate:uploadedFiles":T,onTokenChange:l},null,8,["tokens","token-values","uploaded-files"])]),_:1})):(d(),y(U,{key:0},[r(t(R),null,{default:i(()=>[C(" Primeiro vamos gerar um par de chaves ECDSA para estabelecer a conex\xE3o segura. ")]),_:1}),r(t(_),{vertical:"",gap:"16"},{default:i(()=>[r(O,{loading:s.ecdsaKeyLoading,onClick:w},{default:i(()=>[C(" Gerar chaves ECDSA ")]),_:1},8,["loading"])]),_:1})],64))],64)):A("",!0)],64)):A("",!0)]),_:1},8,["open","title","ok-text","ok-button-props"])}}}),An=p=>(fe("data-v-618c8aff"),p=p(),Ce(),p),$n=An(()=>H("div",{style:{"flex-grow":"1"}},null,-1)),In={class:"connectors-grid"},Tn=E({__name:"ConnectorsView",setup(p){const a=ge().params.projectId,n=new Cn(a,new fn),o=z(null),h=z(!1),v=z({}),w=$(()=>[...n.state.value.connectors.filter(u=>u.auth.type==="oauth2"),...n.state.value.connectors.filter(u=>u.auth.type==="tokens"),...n.state.value.connectors.filter(u=>u.auth.type==="ecdsa"),...n.state.value.connectors.filter(u=>u.auth.type==="manual")]),b=$(()=>n.state.value.connections.filter(u=>u&&u.name&&u.connectorTitle&&u.connectorType));n.fetchInitialState();function T(u){n.state.value.addingConnection&&(n.state.value.addingConnection.tokenValues=u)}function l(u){v.value=u}function s(){o.value=null,h.value=!1,v.value={}}async function k(){h.value=!0;try{const m=(await n.generateEcdsaKey()).replace("-----BEGIN PUBLIC KEY-----","").replace("-----END PUBLIC KEY-----","").replace(/\s/g,"");o.value=m}finally{h.value=!1}}async function V(){var m,j,g;switch((m=n.state.value.addingConnection)==null?void 0:m.connector.auth.type){case"oauth2":return n.handleAddConnectionSubmit();case"tokens":return n.handleAddTokenConnectionSubmit();case"ecdsa":{const N=((j=n.state.value.addingConnection)==null?void 0:j.tokenValues)||{};let K="";((g=n.state.value.addingConnection)==null?void 0:g.connector.metadata.key)==="starkbank"&&(K=N.projectId||"");const P=await n.handleAddEcdsaConnectionSubmit(o.value,K);return s(),P}}}function c(u){u.auth.type==="manual"?we.showNewMessage(me.translate("i18n_connectors_ask_for_access",null,u.metadata.label)):n.showAddConfirmationModal(u)}return(u,m)=>{var j;return d(),y(U,null,[r(t(Ae),{direction:"vertical",style:{width:"100%","margin-bottom":"30px"}},{default:i(()=>[r(t(_),{align:"center",justify:"space-between"},{default:i(()=>[r(t(q),null,{default:i(()=>[C("Connectors")]),_:1})]),_:1}),r(t(R),null,{default:i(()=>[C(" Add and manage external integrations to your project. "),r(se)]),_:1}),b.value.length?(d(),f(t(_),{key:0,vertical:""},{default:i(()=>[r(t(q),{level:2},{default:i(()=>[C("Installed")]),_:1}),r(t(_),{vertical:"",gap:10},{default:i(()=>[(d(!0),y(U,null,x(b.value,g=>(d(),f(t(ae),{key:g.name},{default:i(()=>[r(t(_),{align:"center",gap:20},{default:i(()=>[r(t(te),{src:g.icon,height:"40px",shape:"square"},null,8,["src"]),r(t(M),{strong:""},{default:i(()=>[C(L(g.connectorTitle),1)]),_:2},1024),$n,r(t(M),{content:g.name,copyable:"",code:""},null,8,["content"]),r(t(ve),null,{overlay:i(()=>[r(t(ye),null,{default:i(()=>[r(t(Q),{onClick:N=>t(n).handleEditConnectionClick(g)},{default:i(()=>[C(" Rename ")]),_:2},1032,["onClick"]),r(t(Q),{danger:"",onClick:N=>t(n).handleDeletionClick(g)},{default:i(()=>[C(" Delete ")]),_:2},1032,["onClick"])]),_:2},1024)]),default:i(()=>[r(t(ke))]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})):A("",!0),r(t(_),{vertical:""},{default:i(()=>[b.value.length?(d(),f(t(q),{key:0,level:2},{default:i(()=>[C("Available")]),_:1})):A("",!0),H("div",In,[(d(!0),y(U,null,x(w.value,g=>(d(),f(wn,{key:g.metadata.key,title:g.metadata.label,"logo-url":g.metadata.logoUrl,description:g.metadata.description,unavailable:g.auth.type==="manual",connector:g,onClick:N=>c(g)},null,8,["title","logo-url","description","unavailable","connector","onClick"]))),128))])]),_:1})]),_:1}),r(t(D),{open:!!t(n).state.value.editingConnection,title:`${(j=t(n).state.value.editingConnection)==null?void 0:j.connectorTitle} Connection`,onCancel:m[2]||(m[2]=g=>t(n).state.value.editingConnection=null)},{footer:i(()=>[r(t(_),{justify:"end"},{default:i(()=>[r(O,{disabled:!t(n).hasChanges.value,onClick:m[1]||(m[1]=g=>t(n).renameConnection())},{default:i(()=>[C(" Save ")]),_:1},8,["disabled"])]),_:1})]),default:i(()=>[t(n).state.value.editingConnection?(d(),f(t(B),{key:0,value:t(n).state.value.editingConnection.newName,"onUpdate:value":m[0]||(m[0]=g=>t(n).state.value.editingConnection.newName=g)},null,8,["value"])):A("",!0)]),_:1},8,["open","title"]),r(Vn,{"adding-connection":t(n).state.value.addingConnection,"ecdsa-public-key":o.value,"ecdsa-key-loading":h.value,"uploaded-files":v.value,onCancel:m[3]||(m[3]=()=>{t(n).state.value.addingConnection=null,s()}),onSubmit:V,onScopeToggle:m[4]||(m[4]=(g,N)=>t(n).handleScopeToggle(g,N)),onGenerateEcdsaKey:k,"onUpdate:tokenValues":T,"onUpdate:uploadedFiles":l},null,8,["adding-connection","ecdsa-public-key","ecdsa-key-loading","uploaded-files"])],64)}}});const Bn=ne(Tn,[["__scopeId","data-v-618c8aff"]]);export{Bn as default};
//# sourceMappingURL=ConnectorsView.d7119588.js.map
