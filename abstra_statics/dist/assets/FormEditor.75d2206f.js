import{d as R,D as P,f as H,o as u,Y as b,$ as oe,S as A,e8 as le,a as w,e as M,b as a,w as t,u as e,dd as D,aG as y,cX as be,d9 as I,cz as C,bL as F,cy as ne,aS as j,em as ke,en as Se,a0 as G,c as _,by as we,aW as B,cB as _e,bT as L,dh as O,e9 as Q,N as se,O as E,da as Ae,cO as Me,eM as Ce,bO as J,eb as $e,cL as Fe,eo as He,ea as Te,g as ee,X as Ze,ah as Pe,eg as Le,z as Re,a_ as ae,a$ as te,cM as Ee}from"./index.c093892f.js";import{B as Ue}from"./BaseLayout.e3a8b862.js";import{I as Ve,R as De,S as Ie,L as Be,a as We,E as Ne,b as qe,c as ze}from"./SmartChat.378e5742.js";import{S as xe}from"./SaveButton.9d94ef50.js";import{F as W,a as Oe,b as Qe,c as je,d as Ge,r as Ke}from"./FormRunner.a31c32f8.js";import{a as Xe}from"./asyncComputed.c20e9b65.js";import{F as Ye}from"./scripts.d6ea311a.js";import"./linters.6cbabc15.js";import{W as Je}from"./workspaces.719af878.js";import{A as ea}from"./index.e7d5893b.js";import{b as aa,u as ta}from"./workspaceStore.0c7f971c.js";import{P as ra}from"./PlayerNavbar.9850dcb6.js";import{W as oa}from"./PlayerConfigProvider.76ef31d8.js";import{F as la}from"./PhArrowSquareOut.vue.8bd28d5b.js";import{C as na}from"./Card.ff99a1b4.js";import{A as sa}from"./index.189745e7.js";import{T as ia}from"./TasksManager.ea266dcb.js";import{N as ua}from"./NavbarControls.559934d4.js";import{A as V,T as re}from"./TabPane.231f9a84.js";import{b as da}from"./index.ea3cbb5d.js";import"./editor.74768517.js";import"./url.b4f46c51.js";import"./colorHelpers.37165e53.js";import"./validations.43d2a9d5.js";import"./string.0a7c8737.js";import"./uuid.ac0ad5ef.js";import"./PhCaretRight.vue.88e9ff8b.js";import"./Badge.6fe17d0a.js";import"./LoadingOutlined.fb6d8974.js";import"./polling.71e02ccd.js";import"./PhFolder.vue.985e3cca.js";import"./PhPencil.vue.85ad7352.js";import"./toggleHighContrast.a2b5d71a.js";import"./AbstraLogo.vue_vue_type_script_setup_true_lang.ccd671e0.js";import"./Logo.7dd71689.js";import"./ant-design.40803dff.js";import"./ai.b9419b2e.js";import"./PhCheckCircle.vue.095e7092.js";import"./PhCopySimple.vue.ef1d231b.js";import"./Avatar.dfcf8478.js";import"./UnsavedChangesHandler.a0faf92d.js";import"./ExclamationCircleOutlined.fce97790.js";import"./Login.vue_vue_type_script_setup_true_lang.4bd80963.js";import"./CircularLoading.abd30394.js";import"./index.fba67541.js";import"./Steps.bf4f04c9.js";import"./index.463297c4.js";import"./Watermark.e4041ffe.js";import"./record.99cc12e7.js";import"./metadata.d5401936.js";import"./PhWebhooksLogo.vue.d15f7652.js";import"./PhSignOut.vue.d430363a.js";import"./index.9220ad48.js";import"./tasksController.42ba7d39.js";import"./gateway.398bf4cd.js";import"./popupNotifcation.b38b8600.js";import"./AbstraButton.vue_vue_type_script_setup_true_lang.3f44e6dd.js";import"./index.8a5bd241.js";import"./CollapsePanel.438e21fd.js";import"./index.cfce5214.js";import"./CloseCircleOutlined.5f3db5ce.js";import"./DocsButton.vue_vue_type_script_setup_true_lang.f0ff0f8d.js";import"./BookOutlined.d58fb569.js";import"./PhChats.vue.ecc994cb.js";(function(){try{var h=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},p=new Error().stack;p&&(h._sentryDebugIds=h._sentryDebugIds||{},h._sentryDebugIds[p]="c1beb1ad-e631-4104-a57c-8874d77150b3",h._sentryDebugIdIdentifier="sentry-dbid-c1beb1ad-e631-4104-a57c-8874d77150b3")}catch{}})();const ma=["width","height","fill","transform"],pa={key:0},ca=w("path",{d:"M228,48V96a12,12,0,0,1-12,12H168a12,12,0,0,1,0-24h19l-7.8-7.8a75.55,75.55,0,0,0-53.32-22.26h-.43A75.49,75.49,0,0,0,72.39,75.57,12,12,0,1,1,55.61,58.41a99.38,99.38,0,0,1,69.87-28.47H126A99.42,99.42,0,0,1,196.2,59.23L204,67V48a12,12,0,0,1,24,0ZM183.61,180.43a75.49,75.49,0,0,1-53.09,21.63h-.43A75.55,75.55,0,0,1,76.77,179.8L69,172H88a12,12,0,0,0,0-24H40a12,12,0,0,0-12,12v48a12,12,0,0,0,24,0V189l7.8,7.8A99.42,99.42,0,0,0,130,226.06h.56a99.38,99.38,0,0,0,69.87-28.47,12,12,0,0,0-16.78-17.16Z"},null,-1),fa=[ca],va={key:1},ga=w("path",{d:"M216,128a88,88,0,1,1-88-88A88,88,0,0,1,216,128Z",opacity:"0.2"},null,-1),ya=w("path",{d:"M224,48V96a8,8,0,0,1-8,8H168a8,8,0,0,1,0-16h28.69L182.06,73.37a79.56,79.56,0,0,0-56.13-23.43h-.45A79.52,79.52,0,0,0,69.59,72.71,8,8,0,0,1,58.41,61.27a96,96,0,0,1,135,.79L208,76.69V48a8,8,0,0,1,16,0ZM186.41,183.29a80,80,0,0,1-112.47-.66L59.31,168H88a8,8,0,0,0,0-16H40a8,8,0,0,0-8,8v48a8,8,0,0,0,16,0V179.31l14.63,14.63A95.43,95.43,0,0,0,130,222.06h.53a95.36,95.36,0,0,0,67.07-27.33,8,8,0,0,0-11.18-11.44Z"},null,-1),ha=[ga,ya],ba={key:2},ka=w("path",{d:"M224,48V96a8,8,0,0,1-8,8H168a8,8,0,0,1-5.66-13.66L180.65,72a79.48,79.48,0,0,0-54.72-22.09h-.45A79.52,79.52,0,0,0,69.59,72.71,8,8,0,0,1,58.41,61.27,96,96,0,0,1,192,60.7l18.36-18.36A8,8,0,0,1,224,48ZM186.41,183.29A80,80,0,0,1,75.35,184l18.31-18.31A8,8,0,0,0,88,152H40a8,8,0,0,0-8,8v48a8,8,0,0,0,13.66,5.66L64,195.3a95.42,95.42,0,0,0,66,26.76h.53a95.36,95.36,0,0,0,67.07-27.33,8,8,0,0,0-11.18-11.44Z"},null,-1),Sa=[ka],wa={key:3},_a=w("path",{d:"M222,48V96a6,6,0,0,1-6,6H168a6,6,0,0,1,0-12h33.52L183.47,72a81.51,81.51,0,0,0-57.53-24h-.46A81.5,81.5,0,0,0,68.19,71.28a6,6,0,1,1-8.38-8.58,93.38,93.38,0,0,1,65.67-26.76H126a93.45,93.45,0,0,1,66,27.53l18,18V48a6,6,0,0,1,12,0ZM187.81,184.72a81.5,81.5,0,0,1-57.29,23.34h-.46a81.51,81.51,0,0,1-57.53-24L54.48,166H88a6,6,0,0,0,0-12H40a6,6,0,0,0-6,6v48a6,6,0,0,0,12,0V174.48l18,18.05a93.45,93.45,0,0,0,66,27.53h.52a93.38,93.38,0,0,0,65.67-26.76,6,6,0,1,0-8.38-8.58Z"},null,-1),Aa=[_a],Ma={key:4},Ca=w("path",{d:"M224,48V96a8,8,0,0,1-8,8H168a8,8,0,0,1,0-16h28.69L182.06,73.37a79.56,79.56,0,0,0-56.13-23.43h-.45A79.52,79.52,0,0,0,69.59,72.71,8,8,0,0,1,58.41,61.27a96,96,0,0,1,135,.79L208,76.69V48a8,8,0,0,1,16,0ZM186.41,183.29a80,80,0,0,1-112.47-.66L59.31,168H88a8,8,0,0,0,0-16H40a8,8,0,0,0-8,8v48a8,8,0,0,0,16,0V179.31l14.63,14.63A95.43,95.43,0,0,0,130,222.06h.53a95.36,95.36,0,0,0,67.07-27.33,8,8,0,0,0-11.18-11.44Z"},null,-1),$a=[Ca],Fa={key:5},Ha=w("path",{d:"M220,48V96a4,4,0,0,1-4,4H168a4,4,0,0,1,0-8h38.34L184.89,70.54A84,84,0,0,0,66.8,69.85a4,4,0,1,1-5.6-5.72,92,92,0,0,1,129.34.76L212,86.34V48a4,4,0,0,1,8,0ZM189.2,186.15a83.44,83.44,0,0,1-58.68,23.91h-.47a83.52,83.52,0,0,1-58.94-24.6L49.66,164H88a4,4,0,0,0,0-8H40a4,4,0,0,0-4,4v48a4,4,0,0,0,8,0V169.66l21.46,21.45A91.43,91.43,0,0,0,130,218.06h.51a91.45,91.45,0,0,0,64.28-26.19,4,4,0,1,0-5.6-5.72Z"},null,-1),Ta=[Ha],Za={name:"PhArrowsClockwise"},Pa=R({...Za,props:{weight:{type:String},size:{type:[String,Number]},color:{type:String},mirrored:{type:Boolean}},setup(h){const p=h,o=P("weight","regular"),g=P("size","1em"),n=P("color","currentColor"),s=P("mirrored",!1),m=H(()=>{var r;return(r=p.weight)!=null?r:o}),k=H(()=>{var r;return(r=p.size)!=null?r:g}),l=H(()=>{var r;return(r=p.color)!=null?r:n}),v=H(()=>p.mirrored!==void 0?p.mirrored?"scale(-1, 1)":void 0:s?"scale(-1, 1)":void 0);return(r,f)=>(u(),b("svg",le({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256",width:k.value,height:k.value,fill:l.value,transform:v.value},r.$attrs),[oe(r.$slots,"default"),m.value==="bold"?(u(),b("g",pa,fa)):m.value==="duotone"?(u(),b("g",va,ha)):m.value==="fill"?(u(),b("g",ba,Sa)):m.value==="light"?(u(),b("g",wa,Aa)):m.value==="regular"?(u(),b("g",Ma,$a)):m.value==="thin"?(u(),b("g",Fa,Ta)):A("",!0)],16,ma))}}),La=["width","height","fill","transform"],Ra={key:0},Ea=w("path",{d:"M28,64A12,12,0,0,1,40,52H216a12,12,0,0,1,0,24H40A12,12,0,0,1,28,64Zm12,76h64a12,12,0,0,0,0-24H40a12,12,0,0,0,0,24Zm80,40H40a12,12,0,0,0,0,24h80a12,12,0,0,0,0-24Zm120.49,20.49a12,12,0,0,1-17,0l-18.08-18.08a44,44,0,1,1,17-17l18.08,18.07A12,12,0,0,1,240.49,200.49ZM184,164a20,20,0,1,0-20-20A20,20,0,0,0,184,164Z"},null,-1),Ua=[Ea],Va={key:1},Da=w("path",{d:"M216,144a32,32,0,1,1-32-32A32,32,0,0,1,216,144Z",opacity:"0.2"},null,-1),Ia=w("path",{d:"M32,64a8,8,0,0,1,8-8H216a8,8,0,0,1,0,16H40A8,8,0,0,1,32,64Zm8,72h72a8,8,0,0,0,0-16H40a8,8,0,0,0,0,16Zm88,48H40a8,8,0,0,0,0,16h88a8,8,0,0,0,0-16Zm109.66,13.66a8,8,0,0,1-11.32,0L206,177.36A40,40,0,1,1,217.36,166l20.3,20.3A8,8,0,0,1,237.66,197.66ZM184,168a24,24,0,1,0-24-24A24,24,0,0,0,184,168Z"},null,-1),Ba=[Da,Ia],Wa={key:2},Na=w("path",{d:"M32,64a8,8,0,0,1,8-8H216a8,8,0,0,1,0,16H40A8,8,0,0,1,32,64Zm8,72h72a8,8,0,0,0,0-16H40a8,8,0,0,0,0,16Zm88,48H40a8,8,0,0,0,0,16h88a8,8,0,0,0,0-16Zm109.66,2.34L217.36,166A40,40,0,1,0,206,177.36l20.3,20.3a8,8,0,0,0,11.32-11.32Z"},null,-1),qa=[Na],za={key:3},xa=w("path",{d:"M34,64a6,6,0,0,1,6-6H216a6,6,0,0,1,0,12H40A6,6,0,0,1,34,64Zm6,70h72a6,6,0,0,0,0-12H40a6,6,0,0,0,0,12Zm88,52H40a6,6,0,0,0,0,12h88a6,6,0,0,0,0-12Zm108.24,10.24a6,6,0,0,1-8.48,0l-21.49-21.48a38.06,38.06,0,1,1,8.49-8.49l21.48,21.49A6,6,0,0,1,236.24,196.24ZM184,170a26,26,0,1,0-26-26A26,26,0,0,0,184,170Z"},null,-1),Oa=[xa],Qa={key:4},ja=w("path",{d:"M32,64a8,8,0,0,1,8-8H216a8,8,0,0,1,0,16H40A8,8,0,0,1,32,64Zm8,72h72a8,8,0,0,0,0-16H40a8,8,0,0,0,0,16Zm88,48H40a8,8,0,0,0,0,16h88a8,8,0,0,0,0-16Zm109.66,13.66a8,8,0,0,1-11.32,0L206,177.36A40,40,0,1,1,217.36,166l20.3,20.3A8,8,0,0,1,237.66,197.66ZM184,168a24,24,0,1,0-24-24A24,24,0,0,0,184,168Z"},null,-1),Ga=[ja],Ka={key:5},Xa=w("path",{d:"M36,64a4,4,0,0,1,4-4H216a4,4,0,0,1,0,8H40A4,4,0,0,1,36,64Zm4,68h72a4,4,0,0,0,0-8H40a4,4,0,0,0,0,8Zm88,56H40a4,4,0,0,0,0,8h88a4,4,0,0,0,0-8Zm106.83,6.83a4,4,0,0,1-5.66,0l-22.72-22.72a36.06,36.06,0,1,1,5.66-5.66l22.72,22.72A4,4,0,0,1,234.83,194.83ZM184,172a28,28,0,1,0-28-28A28,28,0,0,0,184,172Z"},null,-1),Ya=[Xa],Ja={name:"PhListMagnifyingGlass"},et=R({...Ja,props:{weight:{type:String},size:{type:[String,Number]},color:{type:String},mirrored:{type:Boolean}},setup(h){const p=h,o=P("weight","regular"),g=P("size","1em"),n=P("color","currentColor"),s=P("mirrored",!1),m=H(()=>{var r;return(r=p.weight)!=null?r:o}),k=H(()=>{var r;return(r=p.size)!=null?r:g}),l=H(()=>{var r;return(r=p.color)!=null?r:n}),v=H(()=>p.mirrored!==void 0?p.mirrored?"scale(-1, 1)":void 0:s?"scale(-1, 1)":void 0);return(r,f)=>(u(),b("svg",le({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256",width:k.value,height:k.value,fill:l.value,transform:v.value},r.$attrs),[oe(r.$slots,"default"),m.value==="bold"?(u(),b("g",Ra,Ua)):m.value==="duotone"?(u(),b("g",Va,Ba)):m.value==="fill"?(u(),b("g",Wa,qa)):m.value==="light"?(u(),b("g",za,Oa)):m.value==="regular"?(u(),b("g",Qa,Ga)):m.value==="thin"?(u(),b("g",Ka,Ya)):A("",!0)],16,La))}}),ie=h=>(ke("data-v-c86b3d07"),h=h(),Se(),h),at=ie(()=>w("i",null,"string",-1)),tt=ie(()=>w("i",null,"string list",-1)),rt=R({__name:"FormNotificationSettings",props:{form:{}},setup(h){const o=M(h.form);return(g,n)=>(u(),b(j,null,[a(e(ne),{layout:"vertical"},{default:t(()=>[a(e(D),{level:4,width:"100%",height:"30px",style:{display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"0px"}},{default:t(()=>[y(" Task waiting "),a(e(be),{checked:o.value.notificationTrigger.enabled,"onUpdate:checked":n[0]||(n[0]=s=>o.value.notificationTrigger.enabled=s)},{default:t(()=>[y(" Enabled ")]),_:1},8,["checked"])]),_:1}),a(e(I),{class:"description",style:{fontStyle:"italic",marginBottom:"20px"}},{default:t(()=>[y(" Send emails when new tasks are received ")]),_:1}),a(e(C),{label:"Variable name"},{default:t(()=>[a(e(F),{value:o.value.notificationTrigger.variable_name,"onUpdate:value":n[1]||(n[1]=s=>o.value.notificationTrigger.variable_name=s),disabled:!o.value.notificationTrigger.enabled,type:"text",placeholder:"variable_name"},null,8,["value","disabled"])]),_:1})]),_:1}),a(e(ea),{type:"info"},{message:t(()=>[a(e(I),null,{default:t(()=>[y(" Notifications are sent to the emails specified in the task payload variables set here. The variables should contain a "),at,y(" or a "),tt,y(". ")]),_:1})]),_:1})],64))}});const ot=G(rt,[["__scopeId","data-v-c86b3d07"]]),lt={class:"form-preview"},nt={class:"form-preview-container"},st=R({__name:"FormPreview",props:{formState:{},formRunnerData:{},isLoading:{type:Boolean},queryParams:{},disabledWarning:{},controller:{},currentPath:{}},emits:["open-query-params-modal"],setup(h,{emit:p}){const o=h,g=aa(),n=ta(),s=H(()=>{if(!o.formRunnerData)return"";const l=Object.entries(o.queryParams),v="?"+l.map(([f,$])=>`${f}=${$}`).join("&"),r=l.length?v:"";return`/${o.formRunnerData.path}${r}`}),m=()=>p("open-query-params-modal"),k=()=>{let l=`/${o.currentPath}`;const v=new URLSearchParams(o.queryParams);window.open(`${l}?${v.toString()}`,"_blank")};return(l,v)=>(u(),b("div",lt,[l.isLoading||!l.formRunnerData||!l.formState?(u(),_(e(we),{key:0})):A("",!0),l.formState&&l.formRunnerData?(u(),_(e(O),{key:1,vertical:"",gap:"10",style:{height:"100%",overflow:"hidden"}},{default:t(()=>[a(e(O),{gap:"small"},{default:t(()=>[a(e(B),{title:"Edit query params",placement:"bottom"},{default:t(()=>[a(e(_e),{compact:"",style:{display:"flex"},onClick:m},{default:t(()=>{var r,f;return[a(e(F),{disabled:!!l.formState&&e(W).includes((r=l.formState)==null?void 0:r.type),value:s.value,onKeyup:m},null,8,["disabled","value"]),a(e(L),{disabled:!!l.formState&&e(W).includes((f=l.formState)==null?void 0:f.type),onClick:m},{default:t(()=>[a(e(et),{size:"20"})]),_:1},8,["disabled"])]}),_:1})]),_:1}),a(e(B),{placement:"bottom"},{title:t(()=>[y("Open in Full Screen")]),default:t(()=>[a(e(L),{target:"_blank","aria-label":"Open in Full Screen","aria-describedby":"sss",onClick:k},{default:t(()=>[a(e(la),{size:"20"})]),_:1})]),_:1})]),_:1}),w("div",nt,[l.disabledWarning?(u(),_(e(na),{key:0,class:"unsaved-changes"},{default:t(()=>[a(e(I),{style:{"font-size":"18px","font-weight":"500"}},{default:t(()=>[y(Q(l.disabledWarning.title),1)]),_:1}),a(e(I),{style:{"margin-bottom":"6px"}},{default:t(()=>[y(Q(l.disabledWarning.message),1)]),_:1})]),_:1})):A("",!0),a(oa,{class:"center","main-color":l.formRunnerData.mainColor,background:l.formRunnerData.theme,"font-family":l.formRunnerData.fontFamily,locale:l.formRunnerData.language},{default:t(()=>{var r,f,$,T,d;return[e(n).state.workspace?(u(),_(ra,{key:0,"current-path":l.currentPath,"hide-login":!0,"runner-data":e(n).state.workspace},null,8,["current-path","runner-data"])):A("",!0),a(Oe,{"is-preview":"",class:"runner","form-runner-data":l.formRunnerData,"form-state":l.formState,disabled:!!l.disabledWarning,"user-email":e(g).email,onUpdateWidgetErrors:(r=l.controller)==null?void 0:r.updateWidgetFrontendErrors,onUpdateWidgetValue:(f=l.controller)==null?void 0:f.updateWidgetValue,onActionClicked:($=l.controller)==null?void 0:$.handleActionClick,onAutoFillClicked:(T=l.controller)==null?void 0:T.handleAutofillClick,onAuthComplete:(d=l.controller)==null?void 0:d.handleAuthComplete},null,8,["form-runner-data","form-state","disabled","user-email","onUpdateWidgetErrors","onUpdateWidgetValue","onActionClicked","onAutoFillClicked","onAuthComplete"])]}),_:1},8,["main-color","background","font-family","locale"])])]),_:1})):A("",!0)]))}});const it=G(st,[["__scopeId","data-v-9c597cc0"]]),ut={key:0},dt={key:1},mt=w("br",null,null,-1),pt="Start form",ct=R({__name:"FormRunButton",props:{formStateType:{},disabledWarning:{},startMessage:{}},emits:["start","reset"],setup(h,{emit:p}){var k;const o=new se(E.boolean(),"dontShowReloadHelper"),g=M((k=o.get())!=null?k:!1),n=()=>{g.value=!0,o.set(!0)},s=()=>p("reset"),m=()=>p("start");return(l,v)=>(u(),b(j,null,[l.formStateType&&e(Qe).includes(l.formStateType)?(u(),_(e(Me),{key:0,placement:"bottom",open:g.value?void 0:!0},{content:t(()=>[g.value?(u(),b("span",ut,"Reload form")):(u(),b("span",dt,[y(" You can reload the form here"),mt,a(e(Ae),{onClick:n},{default:t(()=>[y("Don't show this again")]),_:1})]))]),default:t(()=>[a(e(L),{disabled:!!l.disabledWarning,onClick:s},{default:t(()=>[a(e(Pa),{size:"20"})]),_:1},8,["disabled"])]),_:1},8,["open"])):A("",!0),e(W).includes(l.formStateType)?(u(),_(e(B),{key:1,placement:"bottom"},{title:t(()=>[y("Stop form")]),default:t(()=>[a(e(L),{onClick:s},{default:t(()=>[a(e(Ve),{size:"20"})]),_:1})]),_:1})):A("",!0),l.formStateType==="waiting"?(u(),_(e(B),{key:2,placement:"bottom"},{title:t(()=>{var r;return[y(Q((r=l.startMessage)!=null?r:pt),1)]}),default:t(()=>[a(e(L),{disabled:!!l.disabledWarning,onClick:m},{default:t(()=>[a(e(Ce),{size:"20"})]),_:1},8,["disabled"])]),_:1})):A("",!0)],64))}}),ft=R({__name:"FormSettings",props:{form:{}},setup(h){const o=M(h.form);return(g,n)=>(u(),_(e(ne),{layout:"vertical",class:"form-settings"},{default:t(()=>[a(De,{runtime:o.value},null,8,["runtime"]),a(e(C),{label:"Form name"},{default:t(()=>[a(e(F),{value:o.value.title,"onUpdate:value":n[0]||(n[0]=s=>o.value.title=s),type:"text",onChange:n[1]||(n[1]=s=>{var m;return o.value.title=(m=s.target.value)!=null?m:""})},null,8,["value"])]),_:1}),a(e(D),{level:3},{default:t(()=>[y(" Texts ")]),_:1}),a(e(D),{level:4},{default:t(()=>[y(" Welcome Screen ")]),_:1}),a(e(C),{label:"Title"},{default:t(()=>[a(e(F),{value:o.value.welcomeTitle,"onUpdate:value":n[2]||(n[2]=s=>o.value.welcomeTitle=s),type:"text",placeholder:o.value.title,disabled:o.value.autoStart},null,8,["value","placeholder","disabled"])]),_:1}),a(e(C),{label:"Description"},{default:t(()=>[a(e(F),{value:o.value.startMessage,"onUpdate:value":n[3]||(n[3]=s=>o.value.startMessage=s),type:"text",disabled:o.value.autoStart},null,8,["value","disabled"])]),_:1}),a(e(C),{label:"Start button label"},{default:t(()=>[a(e(F),{value:o.value.startButtonText,"onUpdate:value":n[4]||(n[4]=s=>o.value.startButtonText=s),type:"text",placeholder:"Start",disabled:o.value.autoStart},null,8,["value","disabled"])]),_:1}),a(e(C),null,{default:t(()=>[a(e(J),{checked:o.value.autoStart,"onUpdate:checked":n[5]||(n[5]=s=>o.value.autoStart=s)},{default:t(()=>[y("Skip welcome screen")]),_:1},8,["checked"])]),_:1}),a(e(D),{level:4},{default:t(()=>[y(" End Screen ")]),_:1}),a(e(C),{label:"End text"},{default:t(()=>[a(e(F),{value:o.value.endMessage,"onUpdate:value":n[6]||(n[6]=s=>o.value.endMessage=s),type:"text",placeholder:"Thank you"},null,8,["value"])]),_:1}),a(e(C),{label:"Restart button label"},{default:t(()=>[a(e(F),{value:o.value.restartButtonText,"onUpdate:value":n[7]||(n[7]=s=>o.value.restartButtonText=s),placeholder:"Restart",type:"text",disabled:!o.value.allowRestart},null,8,["value","disabled"])]),_:1}),a(e(C),{help:!o.value.isInitial&&"Only initial forms can be restarted"},{default:t(()=>[a(e(J),{checked:o.value.allowRestart,"onUpdate:checked":n[8]||(n[8]=s=>o.value.allowRestart=s),disabled:!o.value.isInitial},{default:t(()=>[y("Show restart button at the end")]),_:1},8,["checked","disabled"])]),_:1},8,["help"]),a(e(D),{level:4},{default:t(()=>[y(" Alert Messages ")]),_:1}),a(e(C),{label:"Error message"},{default:t(()=>[a(e(F),{value:o.value.errorMessage,"onUpdate:value":n[9]||(n[9]=s=>o.value.errorMessage=s),type:"text",placeholder:"Something went wrong"},null,8,["value"])]),_:1})]),_:1}))}});const vt=G(ft,[["__scopeId","data-v-aff64cb2"]]),gt=R({__name:"QueryParamsModal",props:{open:{type:Boolean},queryParams:{}},emits:["update:query-params","close"],setup(h,{emit:p}){const g=M(n(h.queryParams));function n(v){return Object.entries(v).map(([r,f])=>({key:r,value:f,id:Math.random().toString()}))}function s(){const v={};return g.value.forEach(({key:r,value:f})=>{v[r]=f}),v}const m=(v,r,f)=>{g.value[v]={key:r,value:f},p("update:query-params",s())},k=()=>{const v=g.value.length;g.value.push({key:`param-${v}`,value:"value"}),p("update:query-params",s())},l=v=>{g.value.splice(v,1),p("update:query-params",s())};return(v,r)=>(u(),_(e(Fe),{open:v.open,onCancel:r[1]||(r[1]=f=>p("close"))},{footer:t(()=>[a(e(L),{type:"primary",onClick:r[0]||(r[0]=f=>p("close"))},{default:t(()=>[y("OK")]),_:1})]),default:t(()=>[a(e(O),{vertical:"",gap:"20"},{default:t(()=>[a(e(I),null,{default:t(()=>[y("Query params")]),_:1}),(u(!0),b(j,null,$e(g.value,(f,$)=>(u(),_(e(C),{key:$},{default:t(()=>[a(e(sa),null,{default:t(()=>[a(e(F),{value:f.key,"onUpdate:value":T=>f.key=T,type:"text",placeholder:"name",onChange:()=>m($,f.key,f.value)},null,8,["value","onUpdate:value","onChange"]),a(e(F),{value:f.value,"onUpdate:value":T=>f.value=T,type:"text",placeholder:"value",onChange:()=>m($,f.key,f.value)},null,8,["value","onUpdate:value","onChange"]),a(e(L),{danger:"",onClick:T=>l($)},{default:t(()=>[y("remove")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128)),a(e(C),null,{default:t(()=>[a(e(L),{type:"dashed",style:{width:"100%"},onClick:k},{default:t(()=>[y(" Add Query Param ")]),_:1})]),_:1})]),_:1})]),_:1},8,["open"]))}}),$r=R({__name:"FormEditor",setup(h){const p=He(),o=Te(),g=new se(E.array(E.object({formId:E.string(),queryParams:E.record(E.string())})),"abstra:queryParams"),n=M(null),s=M("source-code"),m=M("preview"),k=M(null),l=M(null),v=M(null),r=M({}),f=H(()=>{var i;return(i=d.value)!=null&&i.form.hasChanges()?{title:"Unsaved changes",message:"Save the form before running the workflow"}:null}),$=(i,c)=>{var S;(S=n.value)==null||S.setHighlight(i,c)},T=()=>{var i,c;(i=n.value)==null||i.restartEditor(),(c=n.value)==null||c.startPreviewMode()},{result:d,loading:ue,refetch:de}=Xe(async()=>{const[i,c]=await Promise.all([Ye.get(o.params.id),Je.get()]),S=g.get();return S==null||S.map(Z=>{Z.formId===i.id&&(r.value=Z.queryParams)}),Re({form:i,workspace:c})});ee([()=>r,d],()=>{K()});const me=()=>{var S;if(z.value=!1,!d.value)return;const i=g.get()||[];if(!i.some(Z=>{var U;return Z.formId===((U=d.value)==null?void 0:U.form.id)})){g.set([...i,{formId:(S=d.value)==null?void 0:S.form.id,queryParams:r.value}]);return}g.set(i.map(Z=>{var U;return Z.formId===((U=d.value)==null?void 0:U.form.id)?{formId:Z.formId,queryParams:r.value}:Z}))};function N(){var c;if(!d.value)return;const i=d.value.form.codeContent;(c=n.value)==null||c.updateLocalEditorCode(i),K()}function K(){if(!d.value)return;v.value=d.value.form.makeRunnerData(d.value.workspace),k.value=new je({formRunnerData:v.value,logService:q,connectionManager:new Ge(d.value.form.id,"editor",r.value),onFormStart:T,onFormEnd:pe,onRedirect:ye,onStateUpdate:c=>l.value=c,onStackTraceUpdate:$});const i=k.value.getState();l.value=i.formState}const pe=()=>{var i;(i=n.value)==null||i.restartEditor()};async function ce(){var i,c,S;(i=X.value)==null||i.closeConsole();try{await((c=d.value)==null?void 0:c.form.save()),N(),m.value="preview",(S=k.value)==null||S.start()}catch{Ee.error({message:"Error saving"})}}function fe(){var i,c;(i=n.value)==null||i.restartEditor(),(c=k.value)==null||c.resetForm()}function ve(){p.push({name:"stages"})}const X=M(null),ge=i=>{!d.value||(d.value.form.file=i)},q=Be.create(),Y=new Ie(i=>q.log(i),o.params.id);function ye(i,c){Ke("editor",p,i,c)}const z=M(!1),he=()=>{var i;!!l.value&&W.includes((i=l.value)==null?void 0:i.type)||(z.value=!0)};ee(()=>o.params.id,()=>{de()});const x=i=>{var c;return i!==s.value&&((c=d.value)==null?void 0:c.form.hasChanges())};return Ze(()=>{Y.connect()}),Pe(()=>{Y.close()}),(i,c)=>(u(),_(Ue,null,Le({navbar:t(()=>[e(d)?(u(),_(e(da),{key:0,title:e(d).form.title,style:{padding:"5px 25px",border:"1px solid #f6f6f6"},onBack:ve},{extra:t(()=>[a(ua,{"docs-path":"concepts/forms","editing-model":e(d).form},null,8,["editing-model"])]),_:1},8,["title"])):A("",!0)]),content:t(()=>[e(d)?(u(),_(Ne,{key:0},{left:t(()=>[a(e(re),{"active-key":s.value,"onUpdate:activeKey":c[0]||(c[0]=S=>s.value=S)},{rightExtra:t(()=>[a(xe,{model:e(d).form,onSave:N},null,8,["model"])]),default:t(()=>[a(e(V),{key:"source-code",tab:"Source code",disabled:x("source-code")},null,8,["disabled"]),a(e(V),{key:"settings",tab:"Settings",disabled:x("settings")},null,8,["disabled"]),a(e(V),{key:"notifications",tab:"Notifications",disabled:x("notifications")},null,8,["disabled"])]),_:1},8,["active-key"]),ae(a(qe,{ref_key:"code",ref:n,script:e(d).form,workspace:e(d).workspace,onUpdateFile:ge,onSave:N},null,8,["script","workspace"]),[[te,s.value==="source-code"]]),s.value==="settings"?(u(),_(vt,{key:0,form:e(d).form},null,8,["form"])):A("",!0),s.value==="notifications"?(u(),_(ot,{key:1,form:e(d).form},null,8,["form"])):A("",!0),a(gt,{"query-params":r.value,"onUpdate:queryParams":c[1]||(c[1]=S=>r.value=S),open:z.value,onClose:me},null,8,["query-params","open"])]),center:t(()=>[a(e(re),{"active-key":m.value,"onUpdate:activeKey":c[2]||(c[2]=S=>m.value=S)},{rightExtra:t(()=>[a(ct,{"form-state-type":l.value.type,"disabled-warning":null,"start-message":"Save & Start form",onStart:ce,onReset:fe},null,8,["form-state-type"])]),default:t(()=>[a(e(V),{key:"preview",tab:"Preview"}),a(e(V),{key:"tasks",tab:"Tasks"})]),_:1},8,["active-key"]),ae(a(it,{"form-state":l.value,"form-runner-data":v.value,"is-loading":e(ue),"disabled-warning":f.value,"current-path":e(d).form.path,"query-params":r.value,controller:k.value,onOpenQueryParamsModal:he},null,8,["form-state","form-runner-data","is-loading","disabled-warning","current-path","query-params","controller"]),[[te,m.value==="preview"]]),m.value==="tasks"?(u(),_(ia,{key:0,"stage-id":e(d).form.id},null,8,["stage-id"])):A("",!0)]),right:t(()=>[a(ze,{"stage-type":"forms",workspace:e(d).workspace,stage:e(d).form,"log-service":e(q)},null,8,["workspace","stage","log-service"])]),_:1})):A("",!0)]),_:2},[e(d)?{name:"footer",fn:t(()=>[a(We,{ref_key:"smartConsole",ref:X,"stage-type":"forms",stage:e(d).form,workspace:e(d).workspace},null,8,["stage","workspace"])]),key:"0"}:void 0]),1024))}});export{$r as default};
//# sourceMappingURL=FormEditor.75d2206f.js.map
