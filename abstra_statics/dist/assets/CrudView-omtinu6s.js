import{c as N,d as j,B as z,r as L}from"./router-BfX34XLs.js";import{_ as O}from"./DocsButton.vue_vue_type_script_setup_true_lang-DoAQCamW.js";import{i as E}from"./url-D2MDCvfR.js";import{G}from"./PhDotsThreeVertical.vue-CMiDmYDS.js";import{a as R,ae as S,P as J,r as A,p as u,e as s,u as n,a8 as Q,w as a,j as d,aJ as W,b as _,M as V,W as B,aK as q,g as b,aL as H,bj as X,b8 as Y,ba as Z,S as p,U as y,bk as K,c as ee,a4 as te,f as w,v as $,aj as le,aQ as M,B as ae,bl as ne,K as se,b7 as oe,ak as h,bm as U,be as ue,bf as re,bg as ie,bd as D,R as P,h as ce,aN as de}from"./jwt-decode.esm-X_JHyrHe.js";import{S as F}from"./index-D_wdY2um.js";(function(){try{var o=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},m=new Error().stack;m&&(o._sentryDebugIds=o._sentryDebugIds||{},o._sentryDebugIds[m]="a7b2e403-3bd1-43e5-ba1d-8e94d887ee75",o._sentryDebugIdIdentifier="sentry-dbid-a7b2e403-3bd1-43e5-ba1d-8e94d887ee75")}catch{}})();const pe=R({__name:"CreationModal",props:{entityName:{},fields:{},create:{type:Function}},setup(o,{expose:m}){const v=o,T=S.translate("i18n_creationmodal_title",null,{entityName:v.entityName}),i=J({inputValue:{}}),x=A(!1),g=()=>x.value=!0,C=()=>{x.value=!1,i.inputValue={}},I=async()=>{try{await v.create(i.inputValue),C()}catch(c){c instanceof Error&&K.error({message:S.translate("i18n_creationmodal_failed_to_create"),description:c.message})}},r=(c,t)=>{const e=c.target.value,l=v.fields.find(k=>k.key===t);l?.format?i.inputValue[t]=l.format(e):i.inputValue[t]=e},f=(c,t)=>{const e=c.target.value,l=v.fields.find(k=>k.key===t);l?.blur?i.inputValue[t]=l.blur(e):i.inputValue[t]=e};return m({open:g,close:C}),(c,t)=>(s(),u(n(Q),{open:x.value,title:n(T),onCancel:C,onOk:I},{default:a(()=>[d(n(W),{layout:"vertical"},{default:a(()=>[(s(!0),_(V,null,B(o.fields,e=>(s(),u(n(q),{key:e.key,label:e.label,help:e.hint?.(i.inputValue[e.key]),tooltip:e.tooltip},{default:a(()=>[!e.type||e.type==="text"||e.type==="password"?(s(),u(n(H),{key:0,value:i.inputValue[e.key],"onUpdate:value":l=>i.inputValue[e.key]=l,placeholder:e.placeholder??"",type:e.type??"text",onInput:l=>r(l,e.key),onBlur:l=>f(l,e.key)},null,8,["value","onUpdate:value","placeholder","type","onInput","onBlur"])):e.type==="multiline-text"?(s(),u(n(X),{key:1,value:i.inputValue[e.key],"onUpdate:value":l=>i.inputValue[e.key]=l,placeholder:e.placeholder??"",onInput:l=>r(l,e.key),onBlur:l=>f(l,e.key)},null,8,["value","onUpdate:value","placeholder","onInput","onBlur"])):e.type==="select"?(s(),u(n(Y),{key:2,value:i.inputValue[e.key],"onUpdate:value":l=>i.inputValue[e.key]=l,mode:e.mode,"show-search":!0,"option-filter-prop":"label",placeholder:e.placeholder??"Select options..."},{default:a(()=>[(s(!0),_(V,null,B(e.options,l=>(s(),u(n(Z),{key:typeof l=="string"?l:l.value,value:typeof l=="string"?l:l.value,label:typeof l=="string"?l:l.label},{default:a(()=>[p(y(typeof l=="string"?l:l.label),1)]),_:2},1032,["value","label"]))),128))]),_:2},1032,["value","onUpdate:value","mode","placeholder"])):b("",!0)]),_:2},1032,["label","help","tooltip"]))),128))]),_:1})]),_:1},8,["open","title"]))}}),ye={class:"action-warning"},fe=R({__name:"CrudView",props:{table:{},loading:{type:Boolean},title:{},emptyTitle:{},entityName:{},description:{},create:{type:Function},createButtonText:{},docsPath:{},live:{type:Boolean},fields:{}},setup(o){const m=o,v=A(null),T=(r,f)=>{const c=m.table.rows[0]?.cells[f].type;if(!(c==="actions"||c==="slot"))return(t,e)=>i(t,e,f)},i=(r,f,c)=>{const t=r.cells[c],e=f.cells[c];return t.type==="text"&&e.type==="text"||t.type==="tag"&&e.type==="tag"?t.text.localeCompare(e.text):t.type==="tags"&&e.type==="tags"?t.tags[0].text.localeCompare(e.tags[0].text):t.type==="secret"&&e.type==="secret"||t.type==="link"&&e.type==="link"?t.text.localeCompare(e.text):(t.type==="actions"&&e.type==="actions",0)},x=async()=>{m.fields?v.value?.open():m.create&&await m.create({})},g=A(!1);async function C(r,f){if(!g.value){g.value=!0;try{"onClick"in r?await r.onClick({key:f.key}):"link"in r&&(typeof r.link=="string"&&E(r.link)?open(r.link,"_blank"):L.push(r.link))}finally{g.value=!1}}}const I=ee(()=>({"--columnCount":`${m.table.columns.length}`}));return(r,f)=>{const c=te("RouterLink");return s(),_(V,null,[d(n(F),{direction:"vertical",class:"crud-view"},{default:a(()=>[d(n($),{align:"center",justify:"space-between"},{default:a(()=>[o.title?(s(),u(n(le),{key:0},{default:a(()=>[p(y(o.title),1)]),_:1})):b("",!0),w(r.$slots,"more",{},void 0,!0)]),_:3}),o.description?(s(),u(n(M),{key:0},{default:a(()=>[p(y(o.description)+" ",1),w(r.$slots,"description",{},void 0,!0),o.docsPath?(s(),u(O,{key:0,path:o.docsPath},null,8,["path"])):b("",!0)]),_:3})):b("",!0),d(n($),{gap:"middle"},{default:a(()=>[o.createButtonText?(s(),u(n(ae),{key:0,type:"primary",onClick:x},{default:a(()=>[p(y(o.createButtonText),1)]),_:1})):b("",!0),w(r.$slots,"secondary",{},void 0,!0)]),_:3}),w(r.$slots,"extra",{},void 0,!0),d(n(ne),{"filter-dropdown":!0,size:"small",style:se(I.value),"data-source":o.table.rows,loading:g.value||o.loading&&!o.live,height:400,columns:o.table.columns?.map((t,e)=>({...t,key:e,filtered:!0,align:t.align??"center",sorter:T(t,e)}))},{emptyText:a(()=>[p(y(o.emptyTitle),1)]),headerCell:a(t=>[p(y(t.title),1)]),bodyCell:a(({column:{key:t},record:e})=>[e.cells[t].type==="slot"?w(r.$slots,e.cells[t].key,{key:0,payload:e.cells[t].payload},void 0,!0):(s(),u(n(D),{key:1,open:e.cells[t].hover?void 0:!1},{content:a(()=>[d(n(M),{style:{width:"300px",overflow:"auto","font-family":"monospace"},copyable:"",content:e.cells[t].hover},null,8,["content"])]),default:a(()=>[e.cells[t].type==="text"?(s(),u(n(h),{key:0,secondary:e.cells[t].secondary,code:e.cells[t].code},{default:a(()=>[d(n(z),{dot:e.cells[t].contentType==="warning",color:"#faad14"},{default:a(()=>[p(y(e.cells[t].text),1)]),_:2},1032,["dot"])]),_:2},1032,["secondary","code"])):e.cells[t].type==="secret"?(s(),u(n(h),{key:1,copyable:{text:e.cells[t].text}},{default:a(()=>[...f[0]||(f[0]=[p(" ******** ",-1)])]),_:1},8,["copyable"])):e.cells[t].type==="tag"?(s(),u(n(U),{key:2,color:e.cells[t].tagColor},{default:a(()=>[p(y(e.cells[t].text),1)]),_:2},1032,["color"])):e.cells[t].type==="tags"?(s(),u(n(F),{key:3},{default:a(()=>[(s(!0),_(V,null,B(e.cells[t].tags,(l,k)=>(s(),u(n(U),{key:k,color:l.color},{default:a(()=>[p(y(l.text),1)]),_:2},1032,["color"]))),128))]),_:2},1024)):e.cells[t].type==="link"?(s(),u(c,{key:4,to:e.cells[t].to},{default:a(()=>[p(y(e.cells[t].text),1)]),_:2},1032,["to"])):e.cells[t].type==="actions"?(s(),u(n(ue),{key:5},{overlay:a(()=>[d(n(re),{disabled:g.value},{default:a(()=>[(s(!0),_(V,null,B(e.cells[t].actions.filter(l=>!l.hide),(l,k)=>(s(),u(n(ie),{key:k,danger:l.dangerous,onClick:me=>C(l,e)},{default:a(()=>[l.popoverMessage?(s(),u(n(D),{key:0,placement:"left"},{content:a(()=>[ce("div",ye,[d(n(h),null,{default:a(()=>[p(y(l.popoverMessage),1)]),_:2},1024)])]),default:a(()=>[d(n(h),{disabled:l.disabled,class:"action-item"},{default:a(()=>[l.icon?(s(),u(P(l.icon),{key:0})):b("",!0),p(" "+y(l.label),1)]),_:2},1032,["disabled"])]),_:2},1024)):(s(),u(n(h),{key:1,disabled:l.disabled,class:"action-item"},{default:a(()=>[l.icon?(s(),u(P(l.icon),{key:0})):b("",!0),p(" "+y(l.label),1)]),_:2},1032,["disabled"]))]),_:2},1032,["danger","onClick"]))),128))]),_:2},1032,["disabled"])]),default:a(()=>[d(n(G),{style:{cursor:"pointer"},size:"25px"})]),_:2},1024)):b("",!0)]),_:2},1032,["open"]))]),footer:a(()=>[o.live?(s(),u(n(j),{key:0,justify:"end",gutter:10},{default:a(()=>[d(n(N),{style:{display:"flex","align-items":"center"}},{default:a(()=>[d(n(oe),{size:"small",style:{display:"flex","align-items":"center"}})]),_:1}),d(n(N),null,{default:a(()=>[d(n(h),null,{default:a(()=>[p(y(n(S).translate("i18n_crudview_auto_updating")),1)]),_:1})]),_:1})]),_:1})):b("",!0)]),_:3},8,["style","data-source","loading","columns"])]),_:3}),o.fields&&o.create?(s(),u(pe,{key:0,ref_key:"modalRef",ref:v,fields:o.fields,"entity-name":o.entityName,create:o.create},null,8,["fields","entity-name","create"])):b("",!0)],64)}}}),Ce=de(fe,[["__scopeId","data-v-21fb039e"]]);export{Ce as C};
//# sourceMappingURL=CrudView-omtinu6s.js.map
