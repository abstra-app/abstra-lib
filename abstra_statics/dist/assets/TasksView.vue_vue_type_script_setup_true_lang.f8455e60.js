import{T as P}from"./tasksController.603d6c5b.js";import{s as B}from"./metadata.19ba303f.js";import{c as F}from"./string.569a6924.js";import{t as R}from"./ant-design.ac028450.js";import{R as E}from"./dayjs.019c21b1.js";import{b as o,ee as U,d as V,f as M,X as $,ah as G,o as u,Y as b,w as i,u as e,aS as T,cB as S,aB as w,cA as J,c as f,d4 as L,aG as v,de as X,ec as Y,e9 as A,dj as O,d7 as q,S as C,c_ as H}from"./index.e1ec3e10.js";import{a as Q,A as _}from"./index.3b0dcd0b.js";(function(){try{var r=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},n=new Error().stack;n&&(r._sentryDebugIds=r._sentryDebugIds||{},r._sentryDebugIds[n]="b01b9bca-5d3a-4c48-8091-d0c866a958b1",r._sentryDebugIdIdentifier="sentry-dbid-b01b9bca-5d3a-4c48-8091-d0c866a958b1")}catch{}})();var W={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M168 504.2c1-43.7 10-86.1 26.9-126 17.3-41 42.1-77.7 73.7-109.4S337 212.3 378 195c42.4-17.9 87.4-27 133.9-27s91.5 9.1 133.8 27A341.5 341.5 0 01755 268.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.7 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c0-6.7-7.7-10.5-12.9-6.3l-56.4 44.1C765.8 155.1 646.2 92 511.8 92 282.7 92 96.3 275.6 92 503.8a8 8 0 008 8.2h60c4.4 0 7.9-3.5 8-7.8zm756 7.8h-60c-4.4 0-7.9 3.5-8 7.8-1 43.7-10 86.1-26.9 126-17.3 41-42.1 77.8-73.7 109.4A342.45 342.45 0 01512.1 856a342.24 342.24 0 01-243.2-100.8c-9.9-9.9-19.2-20.4-27.8-31.4l60.2-47a8 8 0 00-3-14.1l-175.7-43c-5-1.2-9.9 2.6-9.9 7.7l-.7 181c0 6.7 7.7 10.5 12.9 6.3l56.4-44.1C258.2 868.9 377.8 932 512.2 932c229.2 0 415.5-183.7 419.8-411.8a8 8 0 00-8-8.2z"}}]},name:"sync",theme:"outlined"};const Z=W;function x(r){for(var n=1;n<arguments.length;n++){var d=arguments[n]!=null?Object(arguments[n]):{},p=Object.keys(d);typeof Object.getOwnPropertySymbols=="function"&&(p=p.concat(Object.getOwnPropertySymbols(d).filter(function(t){return Object.getOwnPropertyDescriptor(d,t).enumerable}))),p.forEach(function(t){K(r,t,d[t])})}return r}function K(r,n,d){return n in r?Object.defineProperty(r,n,{value:d,enumerable:!0,configurable:!0,writable:!0}):r[n]=d,r}var h=function(n,d){var p=x({},n,d.attrs);return o(U,x({},p,{icon:Z}),null)};h.displayName="SyncOutlined";h.inheritAttrs=!1;const ee=h,te={key:3,style:{"min-width":"100px"}},de=V({__name:"TasksView",props:{api:{},stages:{}},setup(r){const n=r,{setup:d,tearDown:p,state:t,getColumns:I,fetchTasks:k}=P({api:n.api,poll:!0,stages:n.stages}),z=a=>a.dataIndex===void 0&&"children"in a&&Array.isArray(a.children)&&a.children.length===0,D=M(()=>n.stages?t.tasks.map(a=>{var l,g,c,m,y;const s=(l=n.stages)==null?void 0:l.find(j=>j.id===a.targetStageId);return s?{...a,targetStageTitle:s.stageTitle,targetStageType:s.stageType,completedAt:(y=(m=a.completed)==null?void 0:m.at)!=null?y:"Not completed",createdAt:a.created.at,deleted:!1}:{...a,targetStageTitle:null,targetStageType:null,completedAt:(c=(g=a.completed)==null?void 0:g.at)!=null?c:"Not completed",createdAt:a.created.at,deleted:!0}}):t.tasks.map(a=>{var s,l;return{...a,deleted:!1,completedAt:(l=(s=a.completed)==null?void 0:s.at)!=null?l:"Not completed",createdAt:a.created.at}})),N=(a,s,l)=>{var m,y;const g=(m=a.current)!=null?m:1,c=(y=a.pageSize)!=null?y:10;t.pagination.currentIndex=g-1,t.pagination.pageSize=c,k()};return $(()=>d()),G(()=>p()),(a,s)=>(u(),b(T,null,[o(e(J),{layout:"vertical"},{default:i(()=>[o(e(Q),{gutter:10},{default:i(()=>[o(e(_),{span:10},{default:i(()=>[o(e(S),{label:"Stage"},{default:i(()=>[o(e(w),{value:e(t).filters.stage,"onUpdate:value":s[0]||(s[0]=l=>e(t).filters.stage=l),options:e(t).filterOptions.stages,placeholder:"All","allow-clear":""},null,8,["value","options"])]),_:1})]),_:1}),o(e(_),{span:6},{default:i(()=>[o(e(S),{label:"Status"},{default:i(()=>[o(e(w),{value:e(t).filters.status,"onUpdate:value":s[1]||(s[1]=l=>e(t).filters.status=l),options:e(t).filterOptions.statuses,"option-label":"label","option-value":"value",filter:!1,placeholder:"All","allow-clear":""},null,8,["value","options"])]),_:1})]),_:1}),o(e(_),{span:8},{default:i(()=>[o(e(S),{label:"Created at date"},{default:i(()=>[o(e(E),{value:e(t).filters.dateRange,"onUpdate:value":s[2]||(s[2]=l=>e(t).filters.dateRange=l),style:{width:"100%"}},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1}),o(e(H),{columns:e(I)(),"data-source":D.value,scroll:{x:"max-content",y:1e3},bordered:"",size:"small",pagination:{current:e(t).pagination.currentIndex+1,pageSize:e(t).pagination.pageSize,total:e(t).pagination.totalCount},onChange:N},{bodyCell:i(({column:l,text:g,record:c})=>[l.key==="payload"?(u(),f(e(L),{key:0,"tree-data":e(R)(c.payload),selectable:!1},null,8,["tree-data"])):l.key==="targetStageTitle"?(u(),b(T,{key:1},[c.deleted?(u(),f(e(X),{key:0},{default:i(()=>[v("Not found")]),_:1})):(u(),f(e(O),{key:1,gap:"small",justify:"center"},{default:i(()=>[(u(),f(Y(e(B)(c.targetStageType)),{size:"20"})),v(" ["+A(c.targetStageId.split("-")[0])+"] "+A(c.targetStageTitle),1)]),_:2},1024))],64)):l.dataIndex==="status"?(u(),f(e(O),{key:2,gap:"small",justify:"center"},{default:i(()=>[o(e(q),null,{default:i(()=>[v(A(e(F)(String(g)))+" ",1),g==="started"?(u(),f(e(ee),{key:0,spin:!0,style:{"margin-left":"4px"}})):C("",!0)]),_:2},1024)]),_:2},1024)):z(l)?(u(),b("div",te)):C("",!0)]),_:1},8,["columns","data-source","pagination"])],64))}});export{de as _};
//# sourceMappingURL=TasksView.vue_vue_type_script_setup_true_lang.f8455e60.js.map
