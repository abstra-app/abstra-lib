import{_ as P}from"./AbstraButton.vue_vue_type_script_setup_true_lang-BBCNEuoZ.js";import{o as De}from"./omniChatStore-ChGwTBJq.js";import{n as Y}from"./string-DXA1IHkK.js";import{I as Ye}from"./PhMagnifyingGlass.vue-BvuHcLVu.js";import{a as ve,i as de,c as X,b as I,e as c,f as qe,g as ne,h as T,m as Ge,bn as Je,r as S,ae as i,M as me,j as s,u as e,a8 as ge,w as n,ak as K,S as f,U as y,v as Q,b7 as Ae,W as Te,p as A,K as ue,aJ as je,aK as ce,aL as fe,bl as Ne,bo as Se,b8 as Qe,bp as Ie,bq as Xe,br as Ce,bs as J,ad as et,ac as tt,P as at,D as lt,Y as nt,a4 as st,aj as rt,bt as Ve}from"./jwt-decode.esm-X_JHyrHe.js";import{e as ot,f as it,C as dt,c as ut,d as pt}from"./router-BfX34XLs.js";import{p as ct,T as mt}from"./tables-DRvslhiY.js";import{T as ft}from"./TableCard-BWwAkUf8.js";import{_ as yt}from"./TablesTabs.vue_vue_type_script_setup_true_lang-o4wAoufD.js";import{u as pe}from"./uuid-D9z6_VWD.js";import{read as Me,utils as be}from"./xlsx-sIPcJk3-.js";import{A as _t}from"./index-CpAGQ-Bl.js";import{u as bt}from"./useTables-VXRXSmnY.js";import"./record-BoeAoZE0.js";import"./PhCopySimple.vue-BV1eyDq6.js";import"./ts.worker-BwKuk5mh.js";import"./PhKey.vue-n8HkN7h3.js";import"./PhPencil.vue-DSr0MYkS.js";import"./vue-flow-core-D3L2Xhbt.js";import"./index-DP71ioDC.js";(function(){try{var z=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},j=new Error().stack;j&&(z._sentryDebugIds=z._sentryDebugIds||{},z._sentryDebugIds[j]="5086d264-db37-4840-bcb9-48b156775c8a",z._sentryDebugIdIdentifier="sentry-dbid-5086d264-db37-4840-bcb9-48b156775c8a")}catch{}})();const gt=["width","height","fill","transform"],vt={key:0},ht=T("path",{d:"M216.49,79.52l-56-56A12,12,0,0,0,152,20H56A20,20,0,0,0,36,40V216a20,20,0,0,0,20,20H200a20,20,0,0,0,20-20V88A12,12,0,0,0,216.49,79.52ZM183,80H160V57ZM60,212V44h76V92a12,12,0,0,0,12,12h48V212Zm100.49-72.49a12,12,0,0,1-17,17L140,153v31a12,12,0,0,1-24,0V153l-3.51,3.52a12,12,0,0,1-17-17l24-24a12,12,0,0,1,17,0Z"},null,-1),wt=[ht],kt={key:1},xt=T("path",{d:"M208,88H152V32Z",opacity:"0.2"},null,-1),Dt=T("path",{d:"M213.66,82.34l-56-56A8,8,0,0,0,152,24H56A16,16,0,0,0,40,40V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V88A8,8,0,0,0,213.66,82.34ZM160,51.31,188.69,80H160ZM200,216H56V40h88V88a8,8,0,0,0,8,8h48V216Zm-42.34-77.66a8,8,0,0,1-11.32,11.32L136,139.31V184a8,8,0,0,1-16,0V139.31l-10.34,10.35a8,8,0,0,1-11.32-11.32l24-24a8,8,0,0,1,11.32,0Z"},null,-1),Nt=[xt,Dt],St={key:2},It=T("path",{d:"M213.66,82.34l-56-56A8,8,0,0,0,152,24H56A16,16,0,0,0,40,40V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V88A8,8,0,0,0,213.66,82.34Zm-56,67.32a8,8,0,0,1-11.32,0L136,139.31V184a8,8,0,0,1-16,0V139.31l-10.34,10.35a8,8,0,0,1-11.32-11.32l24-24a8,8,0,0,1,11.32,0l24,24A8,8,0,0,1,157.66,149.66ZM152,88V44l44,44Z"},null,-1),Ct=[It],Vt={key:3},Mt=T("path",{d:"M212.24,83.76l-56-56A6,6,0,0,0,152,26H56A14,14,0,0,0,42,40V216a14,14,0,0,0,14,14H200a14,14,0,0,0,14-14V88A6,6,0,0,0,212.24,83.76ZM158,46.48,193.52,82H158ZM200,218H56a2,2,0,0,1-2-2V40a2,2,0,0,1,2-2h90V88a6,6,0,0,0,6,6h50V216A2,2,0,0,1,200,218Zm-43.76-78.24a6,6,0,1,1-8.48,8.48L134,134.49V184a6,6,0,0,1-12,0V134.49l-13.76,13.75a6,6,0,0,1-8.48-8.48l24-24a6,6,0,0,1,8.48,0Z"},null,-1),At=[Mt],Tt={key:4},jt=T("path",{d:"M213.66,82.34l-56-56A8,8,0,0,0,152,24H56A16,16,0,0,0,40,40V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V88A8,8,0,0,0,213.66,82.34ZM160,51.31,188.69,80H160ZM200,216H56V40h88V88a8,8,0,0,0,8,8h48V216Zm-42.34-77.66a8,8,0,0,1-11.32,11.32L136,139.31V184a8,8,0,0,1-16,0V139.31l-10.34,10.35a8,8,0,0,1-11.32-11.32l24-24a8,8,0,0,1,11.32,0Z"},null,-1),Ut=[jt],$t={key:5},Ft=T("path",{d:"M210.83,85.17l-56-56A4,4,0,0,0,152,28H56A12,12,0,0,0,44,40V216a12,12,0,0,0,12,12H200a12,12,0,0,0,12-12V88A4,4,0,0,0,210.83,85.17ZM156,41.65,198.34,84H156ZM200,220H56a4,4,0,0,1-4-4V40a4,4,0,0,1,4-4h92V88a4,4,0,0,0,4,4h52V216A4,4,0,0,1,200,220Zm-45.17-78.83a4,4,0,0,1-5.66,5.66L132,129.66V184a4,4,0,0,1-8,0V129.66l-17.17,17.17a4,4,0,0,1-5.66-5.66l24-24a4,4,0,0,1,5.66,0Z"},null,-1),Zt=[Ft],Bt={name:"PhFileArrowUp"},Ht=ve({...Bt,props:{weight:{type:String},size:{type:[String,Number]},color:{type:String},mirrored:{type:Boolean}},setup(z){const j=z,se=de("weight","regular"),Z=de("size","1em"),U=de("color","currentColor"),q=de("mirrored",!1),C=X(()=>j.weight??se),D=X(()=>j.size??Z),V=X(()=>j.color??U),v=X(()=>j.mirrored!==void 0?j.mirrored?"scale(-1, 1)":void 0:q?"scale(-1, 1)":void 0);return($,_)=>(c(),I("svg",Ge({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256",width:D.value,height:D.value,fill:V.value,transform:v.value},$.$attrs),[qe($.$slots,"default"),C.value==="bold"?(c(),I("g",vt,wt)):C.value==="duotone"?(c(),I("g",kt,Nt)):C.value==="fill"?(c(),I("g",St,Ct)):C.value==="light"?(c(),I("g",Vt,At)):C.value==="regular"?(c(),I("g",Tt,Ut)):C.value==="thin"?(c(),I("g",$t,Zt)):ne("",!0)],16,gt))}}),Et={key:0},Lt={class:"ant-upload-drag-icon"},Pt={class:"ant-upload-text"},zt={class:"ant-upload-hint"},Ot={key:1},Rt={style:{"margin-top":"1rem","max-height":"60vh","overflow-y":"auto"}},Wt=ve({__name:"ImportSpreadsheetsModal",props:{open:{type:Boolean},projectId:{}},emits:["update:open","success"],setup(z,{emit:j}){const se=Je.Dragger,Z=z,U=j,q=X({get:()=>Z.open,set:t=>U("update:open",t)}),C=()=>{const l=(typeof navigator<"u"?navigator.language:"en").split(/[-_]/)[0];return["pt","es","fr","de","it","nl","pl","ru","hi","zh"].includes(l)?"dd/MM/yyyy":"MM/dd/yyyy"},D=S(1),V=S([]),v=S([]),$=S([]),_=S(!1),ee=S(!1),R=S(C()),E=S(!1),te=S("01/02/2025"),ae=S([]),ye=ct.map(t=>({label:t,value:t})),F=[{title:"",dataIndex:"selected",key:"selected",width:50},{title:i.translate("i18n_tables_original_column"),dataIndex:"originalName",key:"originalName",width:150},{title:i.translate("i18n_tables_mapped_column"),dataIndex:"mappedName",key:"mappedName",width:200},{title:i.translate("i18n_tables_column_type"),dataIndex:"type",key:"type",width:120},{title:i.translate("i18n_tables_sample_value"),dataIndex:"sample",key:"sample",width:150}],m=t=>Y(t,!0),oe=t=>Y(t,!1),h=t=>{const a=t.replace(/\.(csv|xlsx|xls)$/i,"").replace(/\s*-\s*/g," ").replace(/_-_/g,"_").replace(/-_/g,"_").replace(/_-/g,"_");return Y(a,!1,!1,!0,!1,!1)},Ue=t=>{if(t==null)return"(empty)";if(t instanceof Date)return t.toLocaleDateString("pt-BR");if(typeof t=="string"){const l=/^(\d{2})\/(\d{2})\/(\d{4})$/,a=t.match(l);if(a){const[,p,d,o]=a,u=new Date(parseInt(o),parseInt(d)-1,parseInt(p));if(u.getFullYear()===parseInt(o)&&u.getMonth()===parseInt(d)-1&&u.getDate()===parseInt(p))return u.toLocaleDateString("pt-BR")}}return typeof t=="object"?JSON.stringify(t).substring(0,50):String(t).substring(0,50)},$e=(t,l)=>{if(t==null||t==="")return null;if(l==="date"){if(t instanceof Date)return t.toISOString();if(typeof t=="number"&&t>100&&t<1e5){const d=new Date(Date.UTC(1899,11,31)),o=1440*60*1e3,u=t>60?t-1:t;return new Date(d.getTime()+u*o).toISOString()}const a=/^(\d{2})\/(\d{2})\/(\d{4})$/,p=String(t).trim().match(a);if(p){const[,d,o,u]=p,r=new Date(Date.UTC(parseInt(u),parseInt(o)-1,parseInt(d)));if(!isNaN(r.getTime()))return r.toISOString()}if(typeof t=="string"||typeof t=="number"){const d=new Date(t);if(!isNaN(d.getTime()))return d.toISOString()}}return t},Fe=t=>{const l=String(t).trim(),a=/^(\d{2})\/(\d{2})\/(\d{4})$/,p=l.match(a);if(!p)return!1;const[,d,o,u]=p,r=parseInt(d),k=parseInt(o);return r>=1&&r<=12&&k>=1&&k<=12},he=t=>{for(const l of t)for(const[,a]of Object.entries(l))if(typeof a=="string"&&Fe(a))return a;return null},Ze=t=>{if(t>=100&&t<=1e5){const l=new Date(1899,11,31),a=1440*60*1e3,p=t>60?t-1:t;return new Date(l.getTime()+p*a)}return null},_e=(t,l)=>{const a=String(t).trim(),p=Number(a);if(!isNaN(p)&&a===String(p)){const M=Ze(p);if(M)return M}const d=/^(\d{2})\/(\d{2})\/(\d{4})$/,o=a.match(d);if(!o)return null;const[,u,r,k]=o,N=parseInt(l==="dd/MM/yyyy"?u:r),x=parseInt(l==="dd/MM/yyyy"?r:u),w=new Date(parseInt(k),x-1,N);return w.getFullYear()===parseInt(k)&&w.getMonth()===x-1&&w.getDate()===N?w:null},we=t=>{const l=t.filter(r=>r!=null&&r!=="");return l.length===0?"text":l.every(r=>r instanceof Date)||l.every(r=>{const k=String(r),N=/^(\d{2})\/(\d{2})\/(\d{4})$/,x=k.match(N);if(x){const[,w,M,re]=x,G=new Date(parseInt(re),parseInt(M)-1,parseInt(w));return G.getFullYear()===parseInt(re)&&G.getMonth()===parseInt(M)-1&&G.getDate()===parseInt(w)}return!1})||l.every(r=>_e(String(r),R.value)!==null||!isNaN(Date.parse(String(r))))?"date":l.every(r=>r===!0||r===!1||r==="true"||r==="false"||r===1||r===0)?"boolean":l.every(r=>String(r).match(/^\d{2}\/\d{2}\/\d{4}$/)?!1:typeof r=="number"||!isNaN(Number(r)))?"numeric":"text"},Be=t=>(t.type==="text/csv"||t.type==="application/vnd.ms-excel"||t.type==="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"||J.error(i.translate("i18n_tables_invalid_file_type")),!1),He=t=>{const l=V.value.indexOf(t);l>-1&&V.value.splice(l,1)},ke=async(t,l=!1)=>new Promise((a,p)=>{const d=new FileReader;d.onload=o=>{try{const u=o.target?.result,r=Me(u,{type:"string",cellDates:!1}),k=r.SheetNames[0],N=r.Sheets[k],x=be.sheet_to_json(N,{defval:null,raw:!0});if(x.length===0){p(new Error("Empty file"));return}if(!l){const B=he(x);if(B){ae.value=x,te.value=B,E.value=!0,a([]);return}}const w=x.map(B=>{const W={};for(const[H,g]of Object.entries(B))if(typeof g=="string"){const L=_e(g,R.value);W[H]=L||g}else W[H]=g;return W}),re=Object.keys(x[0]).map(B=>{const W=w.map(b=>b[B]),H=we(W),g=W.find(b=>b!=null&&b!=="")||null;let L=g;if(H==="date"&&typeof g=="number"&&g>=100&&g<=1e5){const b=new Date(1899,11,31),le=1440*60*1e3,O=g>60?g-1:g;L=new Date(b.getTime()+O*le)}return{id:pe(),selected:!0,originalName:B,mappedName:Y(B,!1),type:H,sample:L}}),G={selected:!0,fileName:t.name,sheetName:null,tableName:h(t.name),columns:re,previewData:w.slice(0,5),rawData:w};a([G])}catch(u){p(u)}},d.onerror=p,d.readAsText(t.originFileObj)}),xe=async(t,l=!1)=>new Promise((a,p)=>{const d=new FileReader;d.onload=o=>{try{const u=new Uint8Array(o.target?.result),r=Me(u,{type:"array",cellDates:!1});if(!l)for(const N of r.SheetNames){const x=r.Sheets[N],w=be.sheet_to_json(x,{defval:null,raw:!0}),M=he(w);if(M){ae.value=w,te.value=M,E.value=!0,a([]);return}}const k=r.SheetNames.map(N=>{const x=r.Sheets[N],w=be.sheet_to_json(x,{defval:null,raw:!0});if(w.length===0)return null;const M=w.map(H=>{const g={};for(const[L,b]of Object.entries(H))if(typeof b=="string"){const le=_e(b,R.value);g[L]=le||b}else g[L]=b;return g}),G=Object.keys(w[0]).map(H=>{const g=M.map(O=>O[H]),L=we(g),b=g.find(O=>O!=null&&O!=="")||null;let le=b;if(L==="date"&&typeof b=="number"&&b>=100&&b<=1e5){const O=new Date(1899,11,31),We=1440*60*1e3,Ke=b>60?b-1:b;le=new Date(O.getTime()+Ke*We)}return{id:pe(),selected:!0,originalName:H,mappedName:Y(H,!1),type:L,sample:le}}),B=h(t.name),W=r.SheetNames.length===1?B:`${B}_${Y(N,!1)}`;return{selected:!0,fileName:t.name,sheetName:N,tableName:W,columns:G,previewData:M.slice(0,5),rawData:M}}).filter(N=>N!==null);a(k)}catch(u){p(u)}},d.onerror=p,d.readAsArrayBuffer(t.originFileObj)}),Ee=async()=>{_.value=!0,v.value=[];try{for(const t of V.value){const l=t.name.toLowerCase();let a=[];l.endsWith(".csv")?a=await ke(t):(l.endsWith(".xlsx")||l.endsWith(".xls"))&&(a=await xe(t)),v.value.push(...a)}v.value.length>0?($.value=[0],D.value=2):J.error(i.translate("i18n_tables_no_valid_sheets"))}catch(t){console.error("Error processing files:",t),J.error(i.translate("i18n_tables_import_error"))}finally{_.value=!1}},Le=t=>t.columns.map(l=>({title:l.mappedName,dataIndex:l.originalName,key:l.originalName,width:150,ellipsis:!0})),Pe=X(()=>{const t=v.value.filter(l=>l.selected);return t.length>0&&t.every(l=>{const a=l.columns.filter(p=>p.selected);return l.tableName.trim()!==""&&a.length>0&&a.every(p=>p.mappedName.trim()!=="")})}),ze=async()=>{ee.value=!0;try{const l={tables:v.value.filter(a=>a.selected).map(a=>{const p={id:pe(),name:"id",type:"uuid",primaryKey:!0,nullable:!1,unique:!0,default:"gen_random_uuid()"},d=a.columns.filter(o=>o.selected);return{id:pe(),name:a.tableName,columns:[p,...d.map(o=>({id:o.id,name:o.mappedName,type:o.type,primaryKey:!1,nullable:!0,unique:!1,default:""}))],data:a.rawData.map(o=>{const u={};return d.forEach(r=>{const k=o[r.originalName];u[r.mappedName]=$e(k,r.type)}),u})}})};await dt.post(`projects/${Z.projectId}/tables/restore`,{tables:l.tables}),J.success(i.translate("i18n_tables_import_success")),ie(),U("success")}catch(t){console.error("Error importing tables:",t),J.error(i.translate("i18n_tables_import_error"))}finally{ee.value=!1}},Oe=async()=>{E.value=!1,_.value=!0;try{v.value=[];for(const t of V.value){const l=t.name.toLowerCase();let a=[];l.endsWith(".csv")?a=await ke(t,!0):(l.endsWith(".xlsx")||l.endsWith(".xls"))&&(a=await xe(t,!0)),v.value.push(...a)}v.value.length>0?($.value=[0],D.value=2):J.error(i.translate("i18n_tables_no_valid_sheets"))}catch(t){console.error("Error reprocessing files:",t),J.error(i.translate("i18n_tables_import_error"))}finally{_.value=!1,ae.value=[]}},Re=()=>{D.value=1},ie=()=>{q.value=!1,D.value=1,V.value=[],v.value=[],$.value=[],_.value=!1,ee.value=!1,R.value=C(),E.value=!1,ae.value=[]};return(t,l)=>(c(),I(me,null,[s(e(ge),{open:q.value,"onUpdate:open":l[4]||(l[4]=a=>q.value=a),title:e(i).translate("i18n_tables_import_spreadsheets"),width:800,footer:null,onCancel:ie},{default:n(()=>[D.value===1?(c(),I("div",Et,[s(e(K),{type:"secondary"},{default:n(()=>[f(y(e(i).translate("i18n_tables_import_description")),1)]),_:1}),s(e(se),{"file-list":V.value,"onUpdate:fileList":l[0]||(l[0]=a=>V.value=a),"before-upload":Be,remove:He,accept:".csv,.xlsx,.xls",multiple:"",style:{"margin-top":"1rem"}},{default:n(()=>[T("p",Lt,[s(e(Ht),{size:48})]),T("p",Pt,y(e(i).translate("i18n_tables_upload_click_or_drag")),1),T("p",zt,y(e(i).translate("i18n_tables_upload_supported_formats")),1)]),_:1},8,["file-list"]),s(e(Q),{justify:"flex-end",gap:"small",style:{"margin-top":"1rem"}},{default:n(()=>[s(P,{onClick:ie},{default:n(()=>[...l[7]||(l[7]=[f(" Cancel ",-1)])]),_:1}),s(P,{type:"primary",disabled:V.value.length===0,loading:_.value,onClick:Ee},{default:n(()=>[...l[8]||(l[8]=[f(" Next ",-1)])]),_:1},8,["disabled","loading"])]),_:1})])):ne("",!0),D.value===2?(c(),I("div",Ot,[s(e(K),{type:"secondary"},{default:n(()=>[f(y(e(i).translate("i18n_tables_import_mapping_description")),1)]),_:1}),s(e(Ae),{spinning:_.value},{default:n(()=>[T("div",Rt,[s(e(ot),{"active-key":$.value,"onUpdate:activeKey":l[3]||(l[3]=a=>$.value=a),accordion:""},{default:n(()=>[(c(!0),I(me,null,Te(v.value,(a,p)=>(c(),A(e(it),{key:p,disabled:!a.selected,style:ue({opacity:a.selected?1:.6})},{header:n(()=>[s(e(Q),{align:"center",gap:"small",onClick:l[2]||(l[2]=Ie(()=>{},["stop"]))},{default:n(()=>[s(e(Se),{checked:a.selected,"onUpdate:checked":d=>a.selected=d,onClick:l[1]||(l[1]=Ie(()=>{},["stop"]))},null,8,["checked","onUpdate:checked"]),T("span",{style:ue({textDecoration:a.selected?"none":"line-through",color:a.selected?"inherit":"#999"})},y(a.fileName)+" "+y(a.sheetName?`- ${a.sheetName}`:""),5)]),_:2},1024)]),default:n(()=>[a.selected?(c(),A(e(je),{key:0,layout:"vertical"},{default:n(()=>[s(e(ce),{label:e(i).translate("i18n_tables_table_name")},{default:n(()=>[s(e(fe),{value:a.tableName,"onUpdate:value":d=>a.tableName=d,placeholder:e(i).translate("i18n_tables_enter_table_name"),onBlur:d=>a.tableName=oe(a.tableName),onInput:d=>a.tableName=m(a.tableName)},null,8,["value","onUpdate:value","placeholder","onBlur","onInput"])]),_:2},1032,["label"]),s(e(ce),{label:e(i).translate("i18n_tables_columns")},{default:n(()=>[s(e(Ne),{columns:F,"data-source":a.columns,pagination:!1,size:"small"},{bodyCell:n(({column:d,record:o})=>[d.key==="selected"?(c(),A(e(Se),{key:0,checked:o.selected,"onUpdate:checked":u=>o.selected=u},null,8,["checked","onUpdate:checked"])):d.key==="originalName"?(c(),A(e(K),{key:1,code:"",style:ue({textDecoration:o.selected?"none":"line-through",opacity:o.selected?1:.5})},{default:n(()=>[f(y(o.originalName),1)]),_:2},1032,["style"])):d.key==="mappedName"?(c(),A(e(fe),{key:2,value:o.mappedName,"onUpdate:value":u=>o.mappedName=u,size:"small",disabled:!o.selected,onBlur:u=>o.mappedName=oe(o.mappedName),onInput:u=>o.mappedName=m(o.mappedName)},null,8,["value","onUpdate:value","disabled","onBlur","onInput"])):d.key==="type"?(c(),A(e(Qe),{key:3,value:o.type,"onUpdate:value":u=>o.type=u,size:"small",style:{width:"100%"},disabled:!o.selected,options:e(ye)},null,8,["value","onUpdate:value","disabled","options"])):d.key==="sample"?(c(),A(e(K),{key:4,type:"secondary",style:ue([{"font-size":"12px"},{opacity:o.selected?1:.5}])},{default:n(()=>[f(y(Ue(o.sample)),1)]),_:2},1032,["style"])):ne("",!0)]),_:1},8,["data-source"])]),_:2},1032,["label"]),s(e(ce),{label:e(i).translate("i18n_tables_preview")},{default:n(()=>[s(e(Ne),{columns:Le(a),"data-source":a.previewData,pagination:!1,scroll:{x:"max-content",y:200},size:"small"},null,8,["columns","data-source"])]),_:2},1032,["label"])]),_:2},1024)):ne("",!0)]),_:2},1032,["disabled","style"]))),128))]),_:1},8,["active-key"])])]),_:1},8,["spinning"]),s(e(Q),{justify:"space-between",style:{"margin-top":"1rem"}},{default:n(()=>[s(P,{onClick:Re},{default:n(()=>[...l[9]||(l[9]=[f(" Back ",-1)])]),_:1}),s(e(Q),{gap:"small"},{default:n(()=>[s(P,{onClick:ie},{default:n(()=>[...l[10]||(l[10]=[f(" Cancel ",-1)])]),_:1}),s(P,{type:"primary",disabled:!Pe.value,loading:ee.value,onClick:ze},{default:n(()=>[f(y(e(i).translate("i18n_tables_import")),1)]),_:1},8,["disabled","loading"])]),_:1})]),_:1})])):ne("",!0)]),_:1},8,["open","title"]),s(e(ge),{open:E.value,"onUpdate:open":l[6]||(l[6]=a=>E.value=a),title:e(i).translate("i18n_tables_date_format"),width:600,closable:!1,"mask-closable":!1},{footer:n(()=>[s(e(Q),{justify:"flex-end"},{default:n(()=>[s(P,{type:"primary",onClick:Oe},{default:n(()=>[f(y(e(i).translate("i18n_tables_confirm_and_continue")),1)]),_:1})]),_:1})]),default:n(()=>[s(e(_t),{type:"warning","show-icon":"",style:{"margin-bottom":"1rem"},message:e(i).translate("i18n_tables_ambiguous_dates_detected"),description:e(i).translate("i18n_tables_ambiguous_dates_description")},null,8,["message","description"]),s(e(K),{strong:"",style:{display:"block","margin-bottom":"0.5rem"}},{default:n(()=>[f(y(e(i).translate("i18n_tables_date_format_description")),1)]),_:1}),s(e(Xe),{value:R.value,"onUpdate:value":l[5]||(l[5]=a=>R.value=a),style:{display:"flex","flex-direction":"column",gap:"0.5rem"}},{default:n(()=>[s(e(Ce),{value:"dd/MM/yyyy"},{default:n(()=>[f(y(e(i).translate("i18n_tables_date_format_ddmmyyyy"))+" ",1),s(e(K),{type:"secondary",style:{display:"block","margin-left":"24px"}},{default:n(()=>[f(y(e(i).translate("i18n_tables_date_format_example",null,"dd/MM/yyyy",te.value)),1)]),_:1})]),_:1}),s(e(Ce),{value:"MM/dd/yyyy"},{default:n(()=>[f(y(e(i).translate("i18n_tables_date_format_mmddyyyy"))+" ",1),s(e(K),{type:"secondary",style:{display:"block","margin-left":"24px"}},{default:n(()=>[f(y(e(i).translate("i18n_tables_date_format_example",null,"MM/dd/yyyy",te.value)),1)]),_:1})]),_:1})]),_:1},8,["value"])]),_:1},8,["open","title"])],64))}}),Kt={key:1,style:{padding:"1rem"}},Yt={style:{flex:"1"}},ya=ve({__name:"Tables",setup(z){const j=et(),Z=tt().params.projectId,{tables:U,loading:q,fetchTables:C}=bt(Z),D=S(""),V=X(()=>{if(!U.value)return[];if(!D.value)return U.value;const F=D.value.toLowerCase();return U.value.filter(m=>m.name.toLowerCase().includes(F))}),v=S(!1),$=S(!1),_=at({name:""}),ee=F=>Y(F,!0),R=F=>Y(F,!1),E=S(!1),te=async()=>{E.value=!0;const F=await mt.create(Z,_.name);await C(!0),E.value=!1,v.value=!1,_.name="",j.push({name:"tableEditor",params:{tableId:F.id,projectId:Z}})},ae=()=>{v.value=!1,_.name=""},ye=()=>{C(!0)};return lt(()=>{const F=De.subscribe("tableCreated",()=>{C(!0)});nt(()=>{De.unsubscribe(F)})}),(F,m)=>{const oe=st("RouterLink");return c(),I(me,null,[s(yt),e(q)?(c(),A(e(Ae),{key:0,style:{width:"100%","margin-top":"2rem"}})):(c(),I("div",Kt,[s(e(Q),{justify:"space-between",align:"center",style:{"margin-bottom":"1rem"}},{default:n(()=>[T("div",Yt,[s(e(rt),{level:3},{default:n(()=>[f(y(e(i).translate("i18n_tables_tables")),1)]),_:1}),s(e(K),{type:"secondary"},{default:n(()=>[f(y(e(i).translate("i18n_tables_description")),1)]),_:1})]),s(e(Q),{gap:"small"},{default:n(()=>[s(P,{onClick:m[0]||(m[0]=h=>$.value=!0)},{default:n(()=>[f(y(e(i).translate("i18n_tables_import_spreadsheets")),1)]),_:1}),s(P,{type:"primary",onClick:m[1]||(m[1]=h=>v.value=!0)},{default:n(()=>[f(y(e(i).translate("i18n_tables_create_table")),1)]),_:1})]),_:1})]),_:1}),e(U)&&e(U).length>0?(c(),A(e(fe),{key:0,value:D.value,"onUpdate:value":m[2]||(m[2]=h=>D.value=h),placeholder:e(i).translate("i18n_tables_search_placeholder"),"allow-clear":"",style:{"margin-bottom":"1rem","max-width":"400px"}},{prefix:n(()=>[s(e(Ye),{size:16})]),_:1},8,["value","placeholder"])):ne("",!0),!e(U)||e(U).length===0?(c(),A(e(Ve),{key:1,description:e(i).translate("i18n_tables_empty_title")},null,8,["description"])):V.value.length===0?(c(),A(e(Ve),{key:2,description:e(i).translate("i18n_tables_no_match")},null,8,["description"])):(c(),A(e(pt),{key:3,gutter:[16,16]},{default:n(()=>[(c(!0),I(me,null,Te(V.value,h=>(c(),A(e(ut),{key:h.id,xs:24,sm:24,md:12,lg:12,xl:8,xxl:8},{default:n(()=>[s(oe,{to:`/projects/${e(Z)}/tables/${h.id}`,style:{"text-decoration":"none",color:"inherit"}},{default:n(()=>[s(ft,{table:h,"project-id":e(Z),"show-edit-button":!1},null,8,["table","project-id"])]),_:2},1032,["to"])]),_:2},1024))),128))]),_:1}))])),s(e(ge),{open:v.value,"onUpdate:open":m[6]||(m[6]=h=>v.value=h),title:e(i).translate("i18n_tables_create_table")},{footer:n(()=>[s(P,{onClick:ae},{default:n(()=>[f(y(e(i).translate("i18n_tables_cancel")),1)]),_:1}),s(P,{type:"primary",loading:E.value,disabled:!_.name.trim(),onClick:te},{default:n(()=>[f(y(e(i).translate("i18n_tables_create")),1)]),_:1},8,["loading","disabled"])]),default:n(()=>[s(e(je),{model:_,layout:"vertical"},{default:n(()=>[s(e(ce),{label:e(i).translate("i18n_tables_table_name"),name:"name"},{default:n(()=>[s(e(fe),{value:_.name,"onUpdate:value":m[3]||(m[3]=h=>_.name=h),placeholder:e(i).translate("i18n_tables_enter_table_name"),onBlur:m[4]||(m[4]=h=>_.name=R(_.name)),onInput:m[5]||(m[5]=h=>_.name=ee(_.name))},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["open","title"]),s(Wt,{open:$.value,"onUpdate:open":m[7]||(m[7]=h=>$.value=h),"project-id":e(Z),onSuccess:ye},null,8,["open","project-id"])],64)}}});export{ya as default};
//# sourceMappingURL=Tables-CRrixAr_.js.map
