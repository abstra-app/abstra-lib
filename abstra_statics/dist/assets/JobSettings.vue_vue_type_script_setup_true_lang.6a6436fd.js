import{f as y,bp as L,d as B,r as _,b as v,et as b,w as d,aT as h,l as q,u as a,c9 as W,ew as R,J as z,o as G,H,af as A,cQ as I,bq as j,eB as F,c as g,eC as $,c2 as J,cD as x,K as Q}from"./outputWidgets.75a5b0b9.js";import{f as E,T}from"./dayjs.d3366d83.js";import{A as U,c as V}from"./Title.b6c9692d.js";import{R as X}from"./SmartConsole.c35b14e7.js";import{F as Y}from"./Form.2c716183.js";(function(){try{var r=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},o=new Error().stack;o&&(r._sentryDebugIds=r._sentryDebugIds||{},r._sentryDebugIds[o]="c5ea7f22-a371-479f-9226-699e25dc10de",r._sentryDebugIdIdentifier="sentry-dbid-c5ea7f22-a371-479f-9226-699e25dc10de")}catch{}})();var Z={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm144.1 454.9L437.7 677.8a8.02 8.02 0 01-12.7-6.5V353.7a8 8 0 0112.7-6.5L656.1 506a7.9 7.9 0 010 12.9z"}}]},name:"play-circle",theme:"filled"};const K=Z;function N(r){for(var o=1;o<arguments.length;o++){var l=arguments[o]!=null?Object(arguments[o]):{},u=Object.keys(l);typeof Object.getOwnPropertySymbols=="function"&&(u=u.concat(Object.getOwnPropertySymbols(l).filter(function(e){return Object.getOwnPropertyDescriptor(l,e).enumerable}))),u.forEach(function(e){ee(r,e,l[e])})}return r}function ee(r,o,l){return o in r?Object.defineProperty(r,o,{value:l,enumerable:!0,configurable:!0,writable:!0}):r[o]=l,r}var M=function(o,l){var u=N({},o,l.attrs);return y(L,N({},u,{icon:K}),null)};M.displayName="PlayCircleFilled";M.inheritAttrs=!1;const te=M,ae={key:0,style:{display:"flex","justify-content":"center",width:"100%"}},ye=B({__name:"JobTester",props:{job:{},logService:{}},setup(r,{expose:o}){const l=r,u=_(!1);async function e(){u.value=!0;try{const{stdout:i,stderr:p}=await l.job.test();l.logService.log({type:"stdout",log:i}),l.logService.log({type:"stderr",log:p})}finally{u.value=!1}}return o({test:e}),(i,p)=>i.job.isInitial?(v(),b("div",ae,[y(a(W),{size:"large",loading:u.value,type:"primary",icon:q(a(te)),onClick:e},{default:d(()=>[h("Run")]),_:1},8,["loading","icon"])])):R("",!0)}}),ne=()=>[...Array(31).keys()].map(r=>r+1),D={0:"Sunday",1:"Monday",2:"Tuesday",3:"Wednesday",4:"Thursday",5:"Friday",6:"Saturday"},le=["hourly","daily","weekly","monthly"],oe={hourly:{minute:"0",hour:"*",day:"*",month:"*",weekday:"*"},daily:{minute:"0",hour:"6",day:"*",month:"*",weekday:"*"},weekly:{minute:"0",hour:"6",day:"*",month:"*",weekday:"1"},monthly:{minute:"0",hour:"6",day:"1",month:"*",weekday:"*"}},ue=B({__name:"CronEditor",props:{crontab:{}},emits:["changeCrontab","saveCrontab","showAdvancedSettings"],setup(r,{emit:o}){const l=r,u=z(()=>{const n=e.hour,c=e.minute;return E(`${n}:${c}:00`,"HH:mm:ss")});G(()=>{const{hour:n,day:c,weekday:m,month:f,minute:C}=l.crontab;f=="*"&&m==="*"&&c!=="*"&&!s([c,n,C])?i.value="monthly":f==="*"&&c==="*"&&m!=="*"&&!s([m,n,C])?i.value="weekly":c==="*"&&m==="*"&&f==="*"&&n!=="*"&&!s([n,C])?i.value="daily":n=="*"&&c==="*"&&m==="*"&&f==="*"&&!s([C])?i.value="hourly":i.value="custom"});const e=H({minute:l.crontab.minute,hour:l.crontab.hour,day:l.crontab.day,month:l.crontab.month,weekday:l.crontab.weekday}),i=_(""),p=_(1),s=n=>n.some(c=>c.includes("-")||c.includes(",")),w=n=>{e.minute=n.minute,e.hour=n.hour,e.day=n.day,e.month=n.month,e.weekday=n.weekday},k=n=>{p.value=0,i.value=n,w(oe[i.value]),o("changeCrontab",e)},O=n=>{p.value=0,e.minute=n,o("changeCrontab",e)},t=n=>{const c=E(n);e.minute=c.minute().toString(),e.hour=c.hour().toString(),o("changeCrontab",e)},S=n=>{p.value=0;const c=n;e.weekday=c,o("changeCrontab",e)},P=n=>{p.value=0;const c=n;e.day=c,o("changeCrontab",e)};return(n,c)=>(v(),b(j,null,[y(a(U),{title:"Recurrence"},{default:d(()=>[y(a(A),{placeholder:"Choose a periodicity",value:i.value,"onUpdate:value":k},{default:d(()=>[h(" > "),y(a(I),{value:"",disabled:"",hidden:""},{default:d(()=>[h("Custom")]),_:1}),(v(!0),b(j,null,F(a(le),(m,f)=>(v(),g(a(I),{key:f,value:m},{default:d(()=>[h($(m),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),y(a(U),null,{default:d(()=>[i.value==="hourly"?(v(),g(a(J),{key:0,value:e.minute,"onUpdate:value":O},{addonBefore:d(()=>[h(" at ")]),addonAfter:d(()=>[h(" minutes ")]),_:1},8,["value"])):i.value==="daily"?(v(),g(a(x),{key:1},{default:d(()=>[y(a(T),{value:u.value,"show-second":!1,"onUpdate:value":t},null,8,["value"])]),_:1})):i.value==="weekly"?(v(),g(a(x),{key:2},{default:d(()=>[h(" on "),y(a(A),{style:{width:"200px"},value:Object.values(a(D))[parseInt(e.weekday)],"onUpdate:value":S},{default:d(()=>[(v(!0),b(j,null,F(a(D),(m,f)=>(v(),g(a(I),{key:f,value:f,selected:m===Object.values(a(D))[parseInt(e.weekday)]},{default:d(()=>[h($(m),1)]),_:2},1032,["value","selected"]))),128))]),_:1},8,["value"]),h(" at "),y(a(T),{value:u.value,"show-second":!1,"onUpdate:value":t},null,8,["value"])]),_:1})):i.value==="monthly"?(v(),g(a(x),{key:3},{default:d(()=>[h(" on "),y(a(A),{value:parseInt(e.day),"onUpdate:value":P},{default:d(()=>[(v(!0),b(j,null,F(a(ne)(),(m,f)=>(v(),g(a(I),{key:f,value:m},{default:d(()=>[h($(m),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"]),h(" at "),y(a(T),{value:u.value,"show-second":!1,"onUpdate:value":t},null,8,["value"])]),_:1})):R("",!0)]),_:1})],64))}}),me=B({__name:"JobSettings",props:{job:{}},setup(r){const o=r,l=_(!1),u=_(o.job),e=()=>{l.value=!l.value},i=()=>{l.value=!1},p=t=>({weekday:t.split(" ")[4],month:t.split(" ")[3],day:t.split(" ")[2],hour:t.split(" ")[1],minute:t.split(" ")[0]}),s=H(p(u.value.schedule)),w=z(()=>`${s.minute} ${s.hour} ${s.day} ${s.month} ${s.weekday}`),k=t=>{s.minute==t.minute&&s.hour==t.hour&&s.day==t.day&&s.month==t.month&&s.weekday==t.weekday||(s.minute=t.minute,s.hour=t.hour,s.day=t.day,s.month=t.month,s.weekday=t.weekday,u.value.schedule=w.value)},O=t=>{t?(u.value.schedule=t,Object.assign(s,p(t))):u.value.schedule=w.value,i()};return Q(()=>u.value.schedule,t=>{k({minute:t.split(" ")[0],hour:t.split(" ")[1],day:t.split(" ")[2],month:t.split(" ")[3],weekday:t.split(" ")[4]})}),(t,S)=>(v(),g(a(Y),{class:"schedule-editor",layout:"vertical"},{default:d(()=>[y(a(U),{label:"Name",required:""},{default:d(()=>[y(a(J),{value:u.value.title,"onUpdate:value":S[0]||(S[0]=P=>u.value.title=P)},null,8,["value"])]),_:1}),y(X,{runtime:u.value},null,8,["runtime"]),y(a(V),{level:3},{default:d(()=>[h("Schedule")]),_:1}),y(ue,{class:"recurrence-settings",crontab:s,onChangeCrontab:k,onSaveCrontab:O,onShowAdvancedSettings:e},null,8,["crontab"])]),_:1}))}});export{te as P,ye as _,me as a};
//# sourceMappingURL=JobSettings.vue_vue_type_script_setup_true_lang.6a6436fd.js.map
